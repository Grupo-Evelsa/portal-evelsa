/*! For license information please see main.ee9f1923.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:C.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+S(l,0):s,_(o)?(r="",null!=e&&(r=e.replace(N,"$&/")+"/"),I(o,t,r,"",function(e){return e})):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(N,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",_(e))for(var c=0;c<e.length;c++){var u=s+S(a=e[c],c);l+=I(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=I(a=a.value,t,r,u=s+S(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var i=[],r=0;return I(e,i,"","",function(e){return t.call(n,e,r++)}),i}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},R={transition:null},j={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:R,ReactCurrentOwner:C};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.act=M,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=C.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!k.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function _(e){if(g=!1,x(e),!m)if(null!==i(c))m=!0,R(w);else{var t=i(u);null!==t&&j(_,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,v(T),T=-1),p=!0;var s=f;try{for(x(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!I());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),x(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&j(_,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,k=!1,E=null,T=-1,N=5,S=-1;function I(){return!(t.unstable_now()-S<N)}function P(){if(null!==E){var e=t.unstable_now();S=e;var n=!0;try{n=E(!0,e)}finally{n?C():(k=!1,E=null)}}else k=!1}if("function"===typeof b)C=function(){b(P)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=P,C=function(){D.postMessage(null)}}else C=function(){y(P,0)};function R(e){E=e,k||(k=!0,C())}function j(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,R(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(g?(v(T),T=-1):g=!0,j(_,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,R(w))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),N=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var O,L=Object.assign;function F(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function U(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(Fr){var i=Fr}Reflect.construct(e,[],t)}else{try{t.call()}catch(Fr){i=Fr}e.call(t.prototype)}else{try{throw Error()}catch(Fr){i=Fr}e()}}catch(Fr){if(Fr&&i&&"string"===typeof Fr.stack){for(var r=Fr.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case w:return"Portal";case E:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(tc){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){$(e,t);var n=H(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),i=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ce=null,ke=null;function Ee(e){if(e=br(e)){if("function"!==typeof we)throw Error(s(280));var t=e.stateNode;t&&(t=_r(t),we(e.stateNode,e.type,t))}}function Te(e){Ce?ke?ke.push(e):ke=[e]:Ce=e}function Ne(){if(Ce){var e=Ce,t=ke;if(ke=Ce=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Se(e,t){return e(t)}function Ie(){}var Pe=!1;function Ae(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Se(e,t,n)}finally{Pe=!1,(null!==Ce||null!==ke)&&(Ie(),Ne())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var i=_r(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Re=!1;if(u)try{var je={};Object.defineProperty(je,"passive",{get:function(){Re=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(ue){Re=!1}function Me(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Le=null,Fe=!1,ze=null,Ue={onError:function(e){Oe=!0,Le=e}};function Ve(e,t,n,i,r,s,o,a,l){Oe=!1,Le=null,Me.apply(Ue,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(s(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return He(r),e;if(o===i)return He(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Xe=r.unstable_requestPaint,$e=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ht(a):0!==(s&=o)&&(i=ht(s))}else 0!==(o=n&~r)?i=ht(o):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,wt,Ct,kt,Et,Tt=!1,Nt=[],St=null,It=null,Pt=null,At=new Map,Dt=new Map,Rt=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ot(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&wt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=vr(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,function(){Ct(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&wt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);xe=i,n.target.dispatchEvent(i),xe=null,t.shift()}return!0}function zt(e,t,n){Ft(e)&&n.delete(t)}function Ut(){Tt=!1,null!==St&&Ft(St)&&(St=null),null!==It&&Ft(It)&&(It=null),null!==Pt&&Ft(Pt)&&(Pt=null),At.forEach(zt),Dt.forEach(zt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Bt(e){function t(t){return Vt(t,e)}if(0<Nt.length){Vt(Nt[0],e);for(var n=1;n<Nt.length;n++){var i=Nt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==St&&Vt(St,e),null!==It&&Vt(It,e),null!==Pt&&Vt(Pt,e),At.forEach(t),Dt.forEach(t),n=0;n<Rt.length;n++)(i=Rt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Rt.shift()}var qt=x.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,i){var r=bt,s=qt.transition;qt.transition=null;try{bt=1,Kt(e,t,n,i)}finally{bt=r,qt.transition=s}}function Gt(e,t,n,i){var r=bt,s=qt.transition;qt.transition=null;try{bt=4,Kt(e,t,n,i)}finally{bt=r,qt.transition=s}}function Kt(e,t,n,i){if(Ht){var r=Qt(e,t,n,i);if(null===r)Hi(e,t,i,Yt,n),Mt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return St=Ot(St,e,t,n,i,r),!0;case"dragenter":return It=Ot(It,e,t,n,i,r),!0;case"mouseover":return Pt=Ot(Pt,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return At.set(s,Ot(At.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Dt.set(s,Ot(Dt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Mt(e,i),4&t&&-1<jt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&_t(s),null===(s=Qt(e,t,n,i))&&Hi(e,t,i,Yt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Hi(e,t,i,null,n)}}var Yt=null;function Qt(e,t,n,i){if(Yt=null,null!==(e=vr(e=_e(i))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,i=n.length,r="value"in $t?$t.value:$t.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=L({},cn,{view:0,detail:0}),dn=sn(hn),fn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(L({},fn,{dataTransfer:0})),gn=sn(L({},hn,{relatedTarget:0})),yn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),xn=sn(L({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function En(){return kn}var Tn=L({},hn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=sn(Tn),Sn=sn(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Pn=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(An),Rn=[9,13,27,32],jn=u&&"CompositionEvent"in window,Mn=null;u&&"documentMode"in document&&(Mn=document.documentMode);var On=u&&"TextEvent"in window&&!Mn,Ln=u&&(!jn||Mn&&8<Mn&&11>=Mn),Fn=String.fromCharCode(32),zn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,i){Te(i),0<(t=Gi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Yn(e){Fi(e,0)}function Qn(e){if(K(xr(e)))return e}function Xn(e,t){if("change"===e)return t}var $n=!1;if(u){var Jn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){Gn&&(Gn.detachEvent("onpropertychange",ni),Kn=Gn=null)}function ni(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Wn(t,Kn,e,_e(e)),Ae(Yn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Kn=n,(Gn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function si(e,t){if("click"===e)return Qn(t)}function oi(e,t){if("input"===e||"change"===e)return Qn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&fi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,yi=null,vi=null,bi=!1;function xi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==Y(i)||("selectionStart"in(i=gi)&&fi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Gi(yi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function _i(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:_i("Animation","AnimationEnd"),animationiteration:_i("Animation","AnimationIteration"),animationstart:_i("Animation","AnimationStart"),transitionend:_i("Transition","TransitionEnd")},Ci={},ki={};function Ei(e){if(Ci[e])return Ci[e];if(!wi[e])return e;var t,n=wi[e];for(t in n)if(n.hasOwnProperty(t)&&t in ki)return Ci[e]=n[t];return e}u&&(ki=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ti=Ei("animationend"),Ni=Ei("animationiteration"),Si=Ei("animationstart"),Ii=Ei("transitionend"),Pi=new Map,Ai="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(e,t){Pi.set(e,t),l(t,[e])}for(var Ri=0;Ri<Ai.length;Ri++){var ji=Ai[Ri];Di(ji.toLowerCase(),"on"+(ji[0].toUpperCase()+ji.slice(1)))}Di(Ti,"onAnimationEnd"),Di(Ni,"onAnimationIteration"),Di(Si,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Ii,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mi));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(Ve.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=Le;Oe=!1,Le=null,Fe||(Fe=!0,ze=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Li(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Li(r,a,c),s=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zi(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(qi(t,e,2,!1),n.add(i))}function Ui(e,t,n){var i=0;t&&(i|=4),qi(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function Bi(e){if(!e[Vi]){e[Vi]=!0,o.forEach(function(t){"selectionchange"!==t&&(Oi.has(t)||Ui(t,!1,e),Ui(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Ui("selectionchange",!1,t))}}function qi(e,t,n,i){switch(Xt(t)){case 1:var r=Wt;break;case 4:r=Gt;break;default:r=Kt}n=r.bind(null,t,n,e),r=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Hi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=vr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Ae(function(){var i=s,r=_e(n),o=[];e:{var a=Pi.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Ti:case Ni:case Si:l=yn;break;case Ii:l=Pn;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Sn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=De(p,d))&&u.push(Wi(p,m,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[pr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(h=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Sn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:xr(l),f=null==c?a:xr(c),(a=new u(m,p+"leave",l,n,r)).target=h,a.relatedTarget=f,m=null,vr(r)===i&&((u=new u(d,p+"enter",c,n,r)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Ki(f))p++;for(f=0,m=d;m;m=Ki(m))f++;for(;0<p-f;)u=Ki(u),p--;for(;0<f-p;)d=Ki(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Ki(u),d=Ki(d)}u=null}else u=null;null!==l&&Yi(o,a,l,u,!1),null!==c&&null!==h&&Yi(o,h,c,u,!0)}if("select"===(l=(a=i?xr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Xn;else if(Hn(a))if($n)g=oi;else{g=ri;var y=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=si);switch(g&&(g=g(e,i))?Wn(o,g,n,r):(y&&y(e,a,i),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=i?xr(i):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(gi=y,yi=i,vi=null);break;case"focusout":vi=yi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,xi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":xi(o,n,r)}var v;if(jn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=en()):(Jt="value"in($t=r)?$t.value:$t.textContent,Bn=!0)),0<(y=Gi(i,b)).length&&(b=new xn(b,e,null,n,r),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=Vn(n))&&(b.data=v))),(v=On?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(zn=!0,Fn);case"textInput":return(e=t.data)===Fn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!jn&&Un(e,t)?(e=en(),Zt=Jt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Gi(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=v))}Fi(o,t)})}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=De(e,n))&&i.unshift(Wi(e,s,r)),null!=(s=De(e,t))&&i.push(Wi(e,s,r))),e=e.return}return i}function Ki(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yi(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=De(n,s))&&o.unshift(Wi(n,l,a)):r||null!=(l=De(n,s))&&o.push(Wi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qi=/\r\n?/g,Xi=/\u0000|\uFFFD/g;function $i(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Xi,"")}function Ji(e,t,n){if(t=$i(t),$i(e)!==t&&n)throw Error(s(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout(function(){throw e})}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Bt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Bt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,fr="__reactProps$"+hr,pr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function vr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[dr]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function _r(e){return e[fr]||null}var wr=[],Cr=-1;function kr(e){return{current:e}}function Er(e){0>Cr||(e.current=wr[Cr],wr[Cr]=null,Cr--)}function Tr(e,t){Cr++,wr[Cr]=e.current,e.current=t}var Nr={},Sr=kr(Nr),Ir=kr(!1),Pr=Nr;function Ar(e,t){var n=e.type.contextTypes;if(!n)return Nr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rr(){Er(Ir),Er(Sr)}function Mr(e,t,n){if(Sr.current!==Nr)throw Error(s(168));Tr(Sr,t),Tr(Ir,n)}function Or(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,q(e)||"Unknown",r));return L({},n,i)}function Lr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nr,Pr=Sr.current,Tr(Sr,e),Tr(Ir,Ir.current),!0}function zr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Or(e,t,Pr),i.__reactInternalMemoizedMergedChildContext=e,Er(Ir),Er(Sr),Tr(Sr,e)):Er(Ir),Tr(Ir,n)}var Ur=null,Vr=!1,Br=!1;function qr(e){null===Ur?Ur=[e]:Ur.push(e)}function Hr(){if(!Br&&null!==Ur){Br=!0;var e=0,t=bt;try{var n=Ur;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Ur=null,Vr=!1}catch(r){throw null!==Ur&&(Ur=Ur.slice(e+1)),Ke(Ze,Hr),r}finally{bt=t,Br=!1}}return null}var Wr=[],Gr=0,Yr=null,Qr=0,Xr=[],Jr=0,Zr=null,es=1,ts="";function ns(e,t){Wr[Gr++]=Qr,Wr[Gr++]=Yr,Yr=e,Qr=t}function is(e,t,n){Xr[Jr++]=es,Xr[Jr++]=ts,Xr[Jr++]=Zr,Zr=e;var i=es;e=ts;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,es=1<<32-ot(t)+r|n<<r|i,ts=s+e}else es=1<<s|n<<r|i,ts=e}function rs(e){null!==e.return&&(ns(e,1),is(e,1,0))}function ss(e){for(;e===Yr;)Yr=Wr[--Gr],Wr[Gr]=null,Qr=Wr[--Gr],Wr[Gr]=null;for(;e===Zr;)Zr=Xr[--Jr],Xr[Jr]=null,ts=Xr[--Jr],Xr[Jr]=null,es=Xr[--Jr],Xr[Jr]=null}var os=null,as=null,ls=!1,cs=null;function us(e,t){var n=Lc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function hs(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,os=e,as=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,os=e,as=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Zr?{id:es,overflow:ts}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Lc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,os=e,as=null,!0);default:return!1}}function ds(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function fs(e){if(ls){var t=as;if(t){var n=t;if(!hs(e,t)){if(ds(e))throw Error(s(418));t=cr(n.nextSibling);var i=os;t&&hs(e,t)?us(i,n):(e.flags=-4097&e.flags|2,ls=!1,os=e)}}else{if(ds(e))throw Error(s(418));e.flags=-4097&e.flags|2,ls=!1,os=e}}}function ps(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;os=e}function ms(e){if(e!==os)return!1;if(!ls)return ps(e),ls=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=as)){if(ds(e))throw gs(),Error(s(418));for(;t;)us(e,t),t=cr(t.nextSibling)}if(ps(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){as=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}as=null}}else as=os?cr(e.stateNode.nextSibling):null;return!0}function gs(){for(var e=as;e;)e=cr(e.nextSibling)}function ys(){as=os=null,ls=!1}function vs(e){null===cs?cs=[e]:cs.push(e)}var bs=x.ReactCurrentBatchConfig;function xs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function _s(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ws(e){return(0,e._init)(e._payload)}function Cs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=zc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=qc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===C?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&ws(s)===t.type)?((i=r(t,n.props)).ref=xs(e,t,n),i.return=e,i):((i=Uc(n.type,n.key,n.props,null,e.mode,i)).ref=xs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Vc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=qc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Uc(t.type,t.key,t.props,null,e.mode,n)).ref=xs(e,null,t),n.return=e,n;case w:return(t=Hc(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Vc(t,e.mode,n,null)).return=e,t;_s(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===r?c(e,t,n,i):null;case w:return n.key===r?u(e,t,n,i):null;case D:return f(e,t,(r=n._init)(n._payload),i)}if(te(n)||M(n))return null!==r?null:h(e,t,n,i,null);_s(e,n)}return null}function p(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case _:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case D:return p(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||M(i))return h(t,e=e.get(n)||null,i,r,null);_s(t,i)}return null}function m(r,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(r,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(r,h),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(r,h),ls&&ns(r,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(r,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return ls&&ns(r,m),c}for(h=i(r,h);m<a.length;m++)null!==(g=p(h,r,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(r,e)}),ls&&ns(r,m),c}function g(r,a,l,c){var u=M(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(r,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(r,m),a=o(b,a,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(r,m),ls&&ns(r,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(r,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return ls&&ns(r,g),u}for(m=i(r,m);!v.done;g++,v=l.next())null!==(v=p(m,r,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach(function(e){return t(r,e)}),ls&&ns(r,g),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===C&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===C){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ws(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=xs(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===C?((s=Vc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=Uc(o.type,o.key,o.props,null,i.mode,l)).ref=xs(i,s,o),l.return=i,i=l)}return a(i);case w:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Hc(o,i.mode,l)).return=i,i=s}return a(i);case D:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return m(i,s,o,l);if(M(o))return g(i,s,o,l);_s(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=qc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var ks=Cs(!0),Es=Cs(!1),Ts=kr(null),Ns=null,Ss=null,Is=null;function Ps(){Is=Ss=Ns=null}function As(e){var t=Ts.current;Er(Ts),e._currentValue=t}function Ds(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Rs(e,t){Ns=e,Is=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ka=!0),e.firstContext=null)}function js(e){var t=e._currentValue;if(Is!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===Ns)throw Error(s(308));Ss=e,Ns.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var Ms=null;function Os(e){null===Ms?Ms=[e]:Ms.push(e)}function Ls(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Os(t)):(n.next=r.next,r.next=n),t.interleaved=n,Fs(e,i)}function Fs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var zs=!1;function Us(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qs(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Rl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Fs(e,n)}return null===(r=i.interleaved)?(t.next=t,Os(i)):(t.next=r.next,r.next=t),i.interleaved=t,Fs(e,n)}function Hs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ws(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Gs(e,t,n,i){var r=e.updateQueue;zs=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=L({},h,d);break e;case 2:zs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Vl|=o,e.lanes=o,e.memoizedState=h}}function Ks(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Ys={},Qs=kr(Ys),Xs=kr(Ys),$s=kr(Ys);function Js(e){if(e===Ys)throw Error(s(174));return e}function Zs(e,t){switch(Tr($s,t),Tr(Xs,e),Tr(Qs,Ys),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Er(Qs),Tr(Qs,t)}function eo(){Er(Qs),Er(Xs),Er($s)}function to(e){Js($s.current);var t=Js(Qs.current),n=le(t,e.type);t!==n&&(Tr(Xs,e),Tr(Qs,n))}function no(e){Xs.current===e&&(Er(Qs),Er(Xs))}var io=kr(0);function ro(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var so=[];function oo(){for(var e=0;e<so.length;e++)so[e]._workInProgressVersionPrimary=null;so.length=0}var ao=x.ReactCurrentDispatcher,lo=x.ReactCurrentBatchConfig,co=0,uo=null,ho=null,fo=null,po=!1,mo=!1,go=0,yo=0;function vo(){throw Error(s(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function xo(e,t,n,i,r,o){if(co=o,uo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ao.current=null===e||null===e.memoizedState?ra:sa,e=n(i,r),mo){o=0;do{if(mo=!1,go=0,25<=o)throw Error(s(301));o+=1,fo=ho=null,t.updateQueue=null,ao.current=oa,e=n(i,r)}while(mo)}if(ao.current=ia,t=null!==ho&&null!==ho.next,co=0,fo=ho=uo=null,po=!1,t)throw Error(s(300));return e}function wo(){var e=0!==go;return go=0,e}function Co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fo?uo.memoizedState=fo=e:fo=fo.next=e,fo}function ko(){if(null===ho){var e=uo.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===fo?uo.memoizedState:fo.next;if(null!==t)fo=t,ho=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===fo?uo.memoizedState=fo=e:fo=fo.next=e}return fo}function Eo(e,t){return"function"===typeof t?t(e):t}function To(e){var t=ko(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ho,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((co&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,uo.lanes|=h,Vl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(ka=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,uo.lanes|=o,Vl|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function No(e){var t=ko(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(ka=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function So(){}function Io(e,t){var n=uo,i=ko(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ka=!0),i=i.queue,Vo(Do.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==fo&&1&fo.memoizedState.tag){if(n.flags|=2048,Oo(9,Ao.bind(null,n,i,r,t),void 0,null),null===jl)throw Error(s(349));0!==(30&co)||Po(n,t,r)}return r}function Po(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=uo.updateQueue)?(t={lastEffect:null,stores:null},uo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ao(e,t,n,i){t.value=n,t.getSnapshot=i,Ro(t)&&jo(e)}function Do(e,t,n){return n(function(){Ro(t)&&jo(e)})}function Ro(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function jo(e){var t=Fs(e,1);null!==t&&lc(t,e,1,-1)}function Mo(e){var t=Co();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=Zo.bind(null,uo,e),[t.memoizedState,e]}function Oo(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=uo.updateQueue)?(t={lastEffect:null,stores:null},uo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Lo(){return ko().memoizedState}function Fo(e,t,n,i){var r=Co();uo.flags|=e,r.memoizedState=Oo(1|t,n,void 0,void 0===i?null:i)}function zo(e,t,n,i){var r=ko();i=void 0===i?null:i;var s=void 0;if(null!==ho){var o=ho.memoizedState;if(s=o.destroy,null!==i&&bo(i,o.deps))return void(r.memoizedState=Oo(t,n,s,i))}uo.flags|=e,r.memoizedState=Oo(1|t,n,s,i)}function Uo(e,t){return Fo(8390656,8,e,t)}function Vo(e,t){return zo(2048,8,e,t)}function Bo(e,t){return zo(4,2,e,t)}function qo(e,t){return zo(4,4,e,t)}function Ho(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Wo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4,4,Ho.bind(null,t,e),n)}function Go(){}function Ko(e,t){var n=ko();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&bo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=ko();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&bo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Qo(e,t,n){return 0===(21&co)?(e.baseState&&(e.baseState=!1,ka=!0),e.memoizedState=n):(ai(n,t)||(n=mt(),uo.lanes|=n,Vl|=n,e.baseState=!0),t)}function Xo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=lo.transition;lo.transition={};try{e(!1),t()}finally{bt=n,lo.transition=i}}function $o(){return ko().memoizedState}function Jo(e,t,n){var i=ac(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ea(e))ta(t,n);else if(null!==(n=Ls(e,t,n,i))){lc(n,e,i,oc()),na(n,t,i)}}function Zo(e,t,n){var i=ac(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ea(e))ta(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Os(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(Fr){}null!==(n=Ls(e,t,r,i))&&(lc(n,e,i,r=oc()),na(n,t,i))}}function ea(e){var t=e.alternate;return e===uo||null!==t&&t===uo}function ta(e,t){mo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function na(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var ia={readContext:js,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},ra={readContext:js,useCallback:function(e,t){return Co().memoizedState=[e,void 0===t?null:t],e},useContext:js,useEffect:Uo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4194308,4,Ho.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=Co();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Co();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Jo.bind(null,uo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Co().memoizedState=e},useState:Mo,useDebugValue:Go,useDeferredValue:function(e){return Co().memoizedState=e},useTransition:function(){var e=Mo(!1),t=e[0];return e=Xo.bind(null,e[1]),Co().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=uo,r=Co();if(ls){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===jl)throw Error(s(349));0!==(30&co)||Po(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Uo(Do.bind(null,i,o,e),[e]),i.flags|=2048,Oo(9,Ao.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=Co(),t=jl.identifierPrefix;if(ls){var n=ts;t=":"+t+"R"+(n=(es&~(1<<32-ot(es)-1)).toString(32)+n),0<(n=go++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=yo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sa={readContext:js,useCallback:Ko,useContext:js,useEffect:Vo,useImperativeHandle:Wo,useInsertionEffect:Bo,useLayoutEffect:qo,useMemo:Yo,useReducer:To,useRef:Lo,useState:function(){return To(Eo)},useDebugValue:Go,useDeferredValue:function(e){return Qo(ko(),ho.memoizedState,e)},useTransition:function(){return[To(Eo)[0],ko().memoizedState]},useMutableSource:So,useSyncExternalStore:Io,useId:$o,unstable_isNewReconciler:!1},oa={readContext:js,useCallback:Ko,useContext:js,useEffect:Vo,useImperativeHandle:Wo,useInsertionEffect:Bo,useLayoutEffect:qo,useMemo:Yo,useReducer:No,useRef:Lo,useState:function(){return No(Eo)},useDebugValue:Go,useDeferredValue:function(e){var t=ko();return null===ho?t.memoizedState=e:Qo(t,ho.memoizedState,e)},useTransition:function(){return[No(Eo)[0],ko().memoizedState]},useMutableSource:So,useSyncExternalStore:Io,useId:$o,unstable_isNewReconciler:!1};function aa(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function la(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ca={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=oc(),r=ac(e),s=Bs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=qs(e,s,r))&&(lc(t,e,r,i),Hs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=oc(),r=ac(e),s=Bs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=qs(e,s,r))&&(lc(t,e,r,i),Hs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=oc(),i=ac(e),r=Bs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=qs(e,r,i))&&(lc(t,e,i,n),Hs(t,e,i))}};function ua(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function ha(e,t,n){var i=!1,r=Nr,s=t.contextType;return"object"===typeof s&&null!==s?s=js(s):(r=Dr(t)?Pr:Sr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Ar(e,r):Nr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ca,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function da(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ca.enqueueReplaceState(t,t.state,null)}function fa(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Us(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=js(s):(s=Dr(t)?Pr:Sr.current,r.context=Ar(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(la(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ca.enqueueReplaceState(r,r.state,null),Gs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function pa(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ma(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ga(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ya="function"===typeof WeakMap?WeakMap:Map;function va(e,t,n){(n=Bs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Ql||(Ql=!0,Xl=i),ga(0,t)},n}function ba(e,t,n){(n=Bs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ga(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ga(0,t),"function"!==typeof i&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function xa(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ya;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Ac.bind(null,e,t,n),t.then(e,e))}function _a(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function wa(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bs(-1,1)).tag=2,qs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var Ca=x.ReactCurrentOwner,ka=!1;function Ea(e,t,n,i){t.child=null===e?Es(t,null,n,i):ks(t,e.child,n,i)}function Ta(e,t,n,i,r){n=n.render;var s=t.ref;return Rs(t,r),i=xo(e,t,n,i,s,r),n=wo(),null===e||ka?(ls&&n&&rs(t),t.flags|=1,Ea(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Qa(e,t,r))}function Na(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Fc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Uc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Sa(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Qa(e,t,r)}return t.flags|=1,(e=zc(s,i)).ref=t.ref,e.return=t,t.child=e}function Sa(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(ka=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Qa(e,t,r);0!==(131072&e.flags)&&(ka=!0)}}return Aa(e,t,n,i,r)}function Ia(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tr(Fl,Ll),Ll|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tr(Fl,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Tr(Fl,Ll),Ll|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Tr(Fl,Ll),Ll|=i;return Ea(e,t,r,n),t.child}function Pa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Aa(e,t,n,i,r){var s=Dr(n)?Pr:Sr.current;return s=Ar(t,s),Rs(t,r),n=xo(e,t,n,i,s,r),i=wo(),null===e||ka?(ls&&i&&rs(t),t.flags|=1,Ea(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Qa(e,t,r))}function Da(e,t,n,i,r){if(Dr(n)){var s=!0;Lr(t)}else s=!1;if(Rs(t,r),null===t.stateNode)Ya(e,t),ha(t,n,i),fa(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=js(c):c=Ar(t,c=Dr(n)?Pr:Sr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&da(t,o,i,c),zs=!1;var d=t.memoizedState;o.state=d,Gs(t,i,o,r),l=t.memoizedState,a!==i||d!==l||Ir.current||zs?("function"===typeof u&&(la(t,n,u,i),l=t.memoizedState),(a=zs||ua(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Vs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:aa(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=js(l):l=Ar(t,l=Dr(n)?Pr:Sr.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&da(t,o,i,l),zs=!1,d=t.memoizedState,o.state=d,Gs(t,i,o,r);var p=t.memoizedState;a!==h||d!==p||Ir.current||zs?("function"===typeof f&&(la(t,n,f,i),p=t.memoizedState),(c=zs||ua(t,n,c,i,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Ra(e,t,n,i,s,r)}function Ra(e,t,n,i,r,s){Pa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&zr(t,n,!1),Qa(e,t,s);i=t.stateNode,Ca.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ks(t,e.child,null,s),t.child=ks(t,null,a,s)):Ea(e,t,a,s),t.memoizedState=i.state,r&&zr(t,n,!0),t.child}function ja(e){var t=e.stateNode;t.pendingContext?Mr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mr(0,t.context,!1),Zs(e,t.containerInfo)}function Ma(e,t,n,i,r){return ys(),vs(r),t.flags|=256,Ea(e,t,n,i),t.child}var Oa,La,Fa,za,Ua={dehydrated:null,treeContext:null,retryLane:0};function Va(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,n){var i,r=t.pendingProps,o=io.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Tr(io,1&o),null===e)return fs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Bc(l,r,0,null),e=Vc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Va(n),t.memoizedState=Ua,e):qa(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ha(e,t,a,i=ma(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Bc({mode:"visible",children:i.children},r,0,null),(o=Vc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ks(t,e.child,null,a),t.child.memoizedState=Va(a),t.memoizedState=Ua,o);if(0===(1&t.mode))return Ha(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ha(e,t,a,i=ma(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),ka||l){if(null!==(i=jl)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Fs(e,r),lc(i,e,r,-1))}return _c(),Ha(e,t,a,i=ma(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Rc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,as=cr(r.nextSibling),os=t,ls=!0,cs=null,null!==e&&(Xr[Jr++]=es,Xr[Jr++]=ts,Xr[Jr++]=Zr,es=e.id,ts=e.overflow,Zr=t),t=qa(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=zc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=zc(i,a):(a=Vc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Va(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ua,r}return e=(a=e.child).sibling,r=zc(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function qa(e,t){return(t=Bc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ha(e,t,n,i){return null!==i&&vs(i),ks(t,e.child,null,n),(e=qa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Wa(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ds(e.return,t,n)}function Ga(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Ka(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Ea(e,t,i.children,n),0!==(2&(i=io.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Wa(e,n,t);else if(19===e.tag)Wa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Tr(io,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ro(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ga(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ro(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ga(t,!0,n,null,s);break;case"together":Ga(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ya(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Vl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=zc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xa(e,t){if(!ls)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function $a(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ja(e,t,n){var i=t.pendingProps;switch(ss(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $a(t),null;case 1:case 17:return Dr(t.type)&&Rr(),$a(t),null;case 3:return i=t.stateNode,eo(),Er(Ir),Er(Sr),oo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ms(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==cs&&(dc(cs),cs=null))),La(e,t),$a(t),null;case 5:no(t);var r=Js($s.current);if(n=t.type,null!==e&&null!=t.stateNode)Fa(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return $a(t),null}if(e=Js(Qs.current),ms(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[dr]=t,i[fr]=o,e=0!==(1&t.mode),n){case"dialog":zi("cancel",i),zi("close",i);break;case"iframe":case"object":case"embed":zi("load",i);break;case"video":case"audio":for(r=0;r<Mi.length;r++)zi(Mi[r],i);break;case"source":zi("error",i);break;case"img":case"image":case"link":zi("error",i),zi("load",i);break;case"details":zi("toggle",i);break;case"input":X(i,o),zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},zi("invalid",i);break;case"textarea":re(i,o),zi("invalid",i)}for(var l in ve(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zi("scroll",i)}switch(n){case"input":G(i),Z(i,o,!0);break;case"textarea":G(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[fr]=i,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":zi("cancel",e),zi("close",e),r=i;break;case"iframe":case"object":case"embed":zi("load",e),r=i;break;case"video":case"audio":for(r=0;r<Mi.length;r++)zi(Mi[r],e);r=i;break;case"source":zi("error",e),r=i;break;case"img":case"image":case"link":zi("error",e),zi("load",e),r=i;break;case"details":zi("toggle",e),r=i;break;case"input":X(e,i),r=Q(e,i),zi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=L({},i,{value:void 0}),zi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),zi("invalid",e)}for(o in ve(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&zi("scroll",e):null!=u&&b(e,o,u,l))}switch(n){case"input":G(e),Z(e,i,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+H(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $a(t),null;case 6:if(e&&null!=t.stateNode)za(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Js($s.current),Js(Qs.current),ms(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(o=i.nodeValue!==n)&&null!==(e=os))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return $a(t),null;case 13:if(Er(io),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ls&&null!==as&&0!==(1&t.mode)&&0===(128&t.flags))gs(),ys(),t.flags|=98560,o=!1;else if(o=ms(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=t}else ys(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$a(t),o=!1}else null!==cs&&(dc(cs),cs=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&io.current)?0===zl&&(zl=3):_c())),null!==t.updateQueue&&(t.flags|=4),$a(t),null);case 4:return eo(),La(e,t),null===e&&Bi(t.stateNode.containerInfo),$a(t),null;case 10:return As(t.type._context),$a(t),null;case 19:if(Er(io),null===(o=t.memoizedState))return $a(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)Xa(o,!1);else{if(0!==zl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ro(e))){for(t.flags|=128,Xa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Tr(io,1&io.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Kl&&(t.flags|=128,i=!0,Xa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ro(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Xa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ls)return $a(t),null}else 2*$e()-o.renderingStartTime>Kl&&1073741824!==n&&(t.flags|=128,i=!0,Xa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=io.current,Tr(io,i?1&n|2:1&n),t):($a(t),null);case 22:case 23:return yc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ll)&&($a(t),6&t.subtreeFlags&&(t.flags|=8192)):$a(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Za(e,t){switch(ss(t),t.tag){case 1:return Dr(t.type)&&Rr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),Er(Ir),Er(Sr),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(Er(io),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ys()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Er(io),null;case 4:return eo(),null;case 10:return As(t.type._context),null;case 22:case 23:return yc(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},La=function(){},Fa=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Js(Qs.current);var s,o=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),o=[];break;case"select":r=L({},r,{value:void 0}),i=L({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ve(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zi("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},za=function(e,t,n,i){n!==i&&(t.flags|=4)};var el=!1,tl=!1,nl="function"===typeof WeakSet?WeakSet:Set,il=null;function rl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Pc(e,t,i)}else n.current=null}function sl(e,t,n){try{n()}catch(i){Pc(e,t,i)}}var ol=!1;function al(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&sl(t,n,s)}r=r.next}while(r!==i)}}function ll(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function cl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ul(e){var t=e.alternate;null!==t&&(e.alternate=null,ul(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[fr],delete t[mr],delete t[gr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function hl(e){return 5===e.tag||3===e.tag||4===e.tag}function dl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||hl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function fl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(fl(e,t,n),e=e.sibling;null!==e;)fl(e,t,n),e=e.sibling}function pl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(pl(e,t,n),e=e.sibling;null!==e;)pl(e,t,n),e=e.sibling}var ml=null,gl=!1;function yl(e,t,n){for(n=n.child;null!==n;)vl(e,t,n),n=n.sibling}function vl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:tl||rl(n,t);case 6:var i=ml,r=gl;ml=null,yl(e,t,n),gl=r,null!==(ml=i)&&(gl?(e=ml,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ml.removeChild(n.stateNode));break;case 18:null!==ml&&(gl?(e=ml,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Bt(e)):lr(ml,n.stateNode));break;case 4:i=ml,r=gl,ml=n.stateNode.containerInfo,gl=!0,yl(e,t,n),ml=i,gl=r;break;case 0:case 11:case 14:case 15:if(!tl&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&sl(n,t,o),r=r.next}while(r!==i)}yl(e,t,n);break;case 1:if(!tl&&(rl(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Pc(n,t,a)}yl(e,t,n);break;case 21:yl(e,t,n);break;case 22:1&n.mode?(tl=(i=tl)||null!==n.memoizedState,yl(e,t,n),tl=i):yl(e,t,n);break;default:yl(e,t,n)}}function bl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new nl),t.forEach(function(t){var i=jc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function xl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:ml=l.stateNode,gl=!1;break e;case 3:case 4:ml=l.stateNode.containerInfo,gl=!0;break e}l=l.return}if(null===ml)throw Error(s(160));vl(o,a,r),ml=null,gl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(Fr){Pc(r,t,Fr)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)_l(t,e),t=t.sibling}function _l(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xl(t,e),wl(e),4&i){try{al(3,e,e.return),ll(3,e)}catch(g){Pc(e,e.return,g)}try{al(5,e,e.return)}catch(g){Pc(e,e.return,g)}}break;case 1:xl(t,e),wl(e),512&i&&null!==n&&rl(n,n.return);break;case 5:if(xl(t,e),wl(e),512&i&&null!==n&&rl(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Pc(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&$(r,o),be(l,a);var u=be(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):b(r,h,d,u)}switch(l){case"input":J(r,o);break;case"textarea":se(r,o);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(r,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[fr]=o}catch(g){Pc(e,e.return,g)}}break;case 6:if(xl(t,e),wl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Pc(e,e.return,g)}}break;case 3:if(xl(t,e),wl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Pc(e,e.return,g)}break;case 4:default:xl(t,e),wl(e);break;case 13:xl(t,e),wl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Gl=$e())),4&i&&bl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(tl=(u=tl)||h,xl(t,e),tl=u):xl(t,e),wl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(il=e,h=e.child;null!==h;){for(d=il=h;null!==il;){switch(p=(f=il).child,f.tag){case 0:case 11:case 14:case 15:al(4,f,f.return);break;case 1:rl(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){i=f,n=f.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Pc(i,n,g)}}break;case 5:rl(f,f.return);break;case 22:if(null!==f.memoizedState){Tl(d);continue}}null!==p?(p.return=f,il=p):Tl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Pc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Pc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:xl(t,e),wl(e),4&i&&bl(e);case 21:}}function wl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(hl(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),pl(e,dl(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;fl(e,dl(e),o);break;default:throw Error(s(161))}}catch(jr){Pc(e,e.return,jr)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Cl(e,t,n){il=e,kl(e,t,n)}function kl(e,t,n){for(var i=0!==(1&e.mode);null!==il;){var r=il,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||el;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||tl;a=el;var c=tl;if(el=o,(tl=l)&&!c)for(il=r;null!==il;)l=(o=il).child,22===o.tag&&null!==o.memoizedState?Nl(r):null!==l?(l.return=o,il=l):Nl(r);for(;null!==s;)il=s,kl(s,t,n),s=s.sibling;il=r,el=a,tl=c}El(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,il=s):El(e)}}function El(e){for(;null!==il;){var t=il;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:tl||ll(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!tl)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:aa(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ks(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ks(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Bt(d)}}}break;default:throw Error(s(163))}tl||512&t.flags&&cl(t)}catch(Kr){Pc(t,t.return,Kr)}}if(t===e){il=null;break}if(null!==(n=t.sibling)){n.return=t.return,il=n;break}il=t.return}}function Tl(e){for(;null!==il;){var t=il;if(t===e){il=null;break}var n=t.sibling;if(null!==n){n.return=t.return,il=n;break}il=t.return}}function Nl(e){for(;null!==il;){var t=il;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ll(4,t)}catch(jr){Pc(t,n,jr)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(jr){Pc(t,r,jr)}}var s=t.return;try{cl(t)}catch(jr){Pc(t,s,jr)}break;case 5:var o=t.return;try{cl(t)}catch(jr){Pc(t,o,jr)}}}catch(jr){Pc(t,t.return,jr)}if(t===e){il=null;break}var a=t.sibling;if(null!==a){a.return=t.return,il=a;break}il=t.return}}var Sl,Il=Math.ceil,Pl=x.ReactCurrentDispatcher,Al=x.ReactCurrentOwner,Dl=x.ReactCurrentBatchConfig,Rl=0,jl=null,Ml=null,Ol=0,Ll=0,Fl=kr(0),zl=0,Ul=null,Vl=0,Bl=0,ql=0,Hl=null,Wl=null,Gl=0,Kl=1/0,Yl=null,Ql=!1,Xl=null,$l=null,Jl=!1,Zl=null,ec=0,nc=0,ic=null,rc=-1,sc=0;function oc(){return 0!==(6&Rl)?$e():-1!==rc?rc:rc=$e()}function ac(e){return 0===(1&e.mode)?1:0!==(2&Rl)&&0!==Ol?Ol&-Ol:null!==bs.transition?(0===sc&&(sc=mt()),sc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function lc(e,t,n,i){if(50<nc)throw nc=0,ic=null,Error(s(185));yt(e,n,i),0!==(2&Rl)&&e===jl||(e===jl&&(0===(2&Rl)&&(Bl|=n),4===zl&&fc(e,Ol)),cc(e,i),1===n&&0===Rl&&0===(1&t.mode)&&(Kl=$e()+500,Vr&&Hr()))}function cc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=dt(e,e===jl?Ol:0);if(0===i)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Vr=!0,qr(e)}(pc.bind(null,e)):qr(pc.bind(null,e)),or(function(){0===(6&Rl)&&Hr()}),n=null;else{switch(xt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Mc(n,uc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function uc(e,t){if(rc=-1,sc=0,0!==(6&Rl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var i=dt(e,e===jl?Ol:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=wc(e,i);else{t=i;var r=Rl;Rl|=2;var o=xc();for(jl===e&&Ol===t||(Yl=null,Kl=$e()+500,vc(e,t));;)try{kc();break}catch(l){bc(e,l)}Ps(),Pl.current=o,Rl=r,null!==Ml?t=0:(jl=null,Ol=0,t=zl)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(i=r,t=hc(e,r))),1===t)throw n=Ul,vc(e,0),fc(e,i),cc(e,$e()),n;if(6===t)fc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=wc(e,i))&&(0!==(o=pt(e))&&(i=o,t=hc(e,o))),1===t))throw n=Ul,vc(e,0),fc(e,i),cc(e,$e()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:Nc(e,Wl,Yl);break;case 3:if(fc(e,i),(130023424&i)===i&&10<(t=Gl+500-$e())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){oc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(Nc.bind(null,e,Wl,Yl),t);break}Nc(e,Wl,Yl);break;case 4:if(fc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=$e()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Il(i/1960))-i)){e.timeoutHandle=ir(Nc.bind(null,e,Wl,Yl),i);break}Nc(e,Wl,Yl);break;default:throw Error(s(329))}}}return cc(e,$e()),e.callbackNode===n?uc.bind(null,e):null}function hc(e,t){var n=Hl;return e.current.memoizedState.isDehydrated&&(vc(e,t).flags|=256),2!==(e=wc(e,t))&&(t=Wl,Wl=n,null!==t&&dc(t)),e}function dc(e){null===Wl?Wl=e:Wl.push.apply(Wl,e)}function fc(e,t){for(t&=~ql,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function pc(e){if(0!==(6&Rl))throw Error(s(327));Sc();var t=dt(e,0);if(0===(1&t))return cc(e,$e()),null;var n=wc(e,t);if(0!==e.tag&&2===n){var i=pt(e);0!==i&&(t=i,n=hc(e,i))}if(1===n)throw n=Ul,vc(e,0),fc(e,t),cc(e,$e()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Nc(e,Wl,Yl),cc(e,$e()),null}function mc(e,t){var n=Rl;Rl|=1;try{return e(t)}finally{0===(Rl=n)&&(Kl=$e()+500,Vr&&Hr())}}function gc(e){null!==Zl&&0===Zl.tag&&0===(6&Rl)&&Sc();var t=Rl;Rl|=1;var n=Dl.transition,i=bt;try{if(Dl.transition=null,bt=1,e)return e()}finally{bt=i,Dl.transition=n,0===(6&(Rl=t))&&Hr()}}function yc(){Ll=Fl.current,Er(Fl)}function vc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Ml)for(n=Ml.return;null!==n;){var i=n;switch(ss(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rr();break;case 3:eo(),Er(Ir),Er(Sr),oo();break;case 5:no(i);break;case 4:eo();break;case 13:case 19:Er(io);break;case 10:As(i.type._context);break;case 22:case 23:yc()}n=n.return}if(jl=e,Ml=e=zc(e.current,null),Ol=Ll=t,zl=0,Ul=null,ql=Bl=Vl=0,Wl=Hl=null,null!==Ms){for(t=0;t<Ms.length;t++)if(null!==(i=(n=Ms[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Ms=null}return e}function bc(e,t){for(;;){var n=Ml;try{if(Ps(),ao.current=ia,po){for(var i=uo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}po=!1}if(co=0,fo=ho=uo=null,mo=!1,go=0,Al.current=null,null===n||null===n.return){zl=1,Ul=t,Ml=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Ol,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=_a(a);if(null!==p){p.flags&=-257,wa(p,a,l,0,t),1&p.mode&&xa(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){xa(o,u,t),_c();break e}c=Error(s(426))}else if(ls&&1&l.mode){var y=_a(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),wa(y,a,l,0,t),vs(pa(c,l));break e}}o=c=pa(c,l),4!==zl&&(zl=2),null===Hl?Hl=[o]:Hl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ws(o,va(0,c,t));break e;case 1:l=c;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===$l||!$l.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Ws(o,ba(o,l,t));break e}}o=o.return}while(null!==o)}Tc(n)}catch($r){t=$r,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function xc(){var e=Pl.current;return Pl.current=ia,null===e?ia:e}function _c(){0!==zl&&3!==zl&&2!==zl||(zl=4),null===jl||0===(268435455&Vl)&&0===(268435455&Bl)||fc(jl,Ol)}function wc(e,t){var n=Rl;Rl|=2;var i=xc();for(jl===e&&Ol===t||(Yl=null,vc(e,t));;)try{Cc();break}catch(r){bc(e,r)}if(Ps(),Rl=n,Pl.current=i,null!==Ml)throw Error(s(261));return jl=null,Ol=0,zl}function Cc(){for(;null!==Ml;)Ec(Ml)}function kc(){for(;null!==Ml&&!Qe();)Ec(Ml)}function Ec(e){var t=Sl(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?Tc(e):Ml=t,Al.current=null}function Tc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ja(n,t,Ll)))return void(Ml=n)}else{if(null!==(n=Za(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return zl=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===zl&&(zl=5)}function Nc(e,t,n){var i=bt,r=Dl.transition;try{Dl.transition=null,bt=1,function(e,t,n,i){do{Sc()}while(null!==Zl);if(0!==(6&Rl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===jl&&(Ml=jl=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,Mc(tt,function(){return Sc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Dl.transition,Dl.transition=null;var a=bt;bt=1;var l=Rl;Rl|=4,Al.current=null,function(e,t){if(er=Ht,fi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(_o){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===r&&(l=a),f===o&&++h===i&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Ht=!1,il=t;null!==il;)if(e=(t=il).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,il=e;else for(;null!==il;){t=il;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:aa(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(_o){Pc(t,t.return,_o)}if(null!==(e=t.sibling)){e.return=t.return,il=e;break}il=t.return}m=ol,ol=!1}(e,n),_l(n,e),pi(tr),Ht=!!er,tr=er=null,e.current=n,Cl(n,e,r),Xe(),Rl=l,bt=a,Dl.transition=o}else e.current=n;if(Jl&&(Jl=!1,Zl=e,ec=r),o=e.pendingLanes,0===o&&($l=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),cc(e,$e()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Ql)throw Ql=!1,e=Xl,Xl=null,e;0!==(1&ec)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===ic?nc++:(nc=0,ic=e):nc=0,Hr()}(e,t,n,i)}finally{Dl.transition=r,bt=i}return null}function Sc(){if(null!==Zl){var e=xt(ec),t=Dl.transition,n=bt;try{if(Dl.transition=null,bt=16>e?16:e,null===Zl)var i=!1;else{if(e=Zl,Zl=null,ec=0,0!==(6&Rl))throw Error(s(331));var r=Rl;for(Rl|=4,il=e.current;null!==il;){var o=il,a=o.child;if(0!==(16&il.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(il=u;null!==il;){var h=il;switch(h.tag){case 0:case 11:case 15:al(8,h,o)}var d=h.child;if(null!==d)d.return=h,il=d;else for(;null!==il;){var f=(h=il).sibling,p=h.return;if(ul(h),h===u){il=null;break}if(null!==f){f.return=p,il=f;break}il=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}il=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,il=a;else e:for(;null!==il;){if(0!==(2048&(o=il).flags))switch(o.tag){case 0:case 11:case 15:al(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,il=v;break e}il=o.return}}var b=e.current;for(il=b;null!==il;){var x=(a=il).child;if(0!==(2064&a.subtreeFlags)&&null!==x)x.return=a,il=x;else e:for(a=b;null!==il;){if(0!==(2048&(l=il).flags))try{switch(l.tag){case 0:case 11:case 15:ll(9,l)}}catch($r){Pc(l,l.return,$r)}if(l===a){il=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,il=_;break e}il=l.return}}if(Rl=r,Hr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch($r){}i=!0}return i}finally{bt=n,Dl.transition=t}}return!1}function Ic(e,t,n){e=qs(e,t=va(0,t=pa(n,t),1),1),t=oc(),null!==e&&(yt(e,1,t),cc(e,t))}function Pc(e,t,n){if(3===e.tag)Ic(e,e,n);else for(;null!==t;){if(3===t.tag){Ic(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===$l||!$l.has(i))){t=qs(t,e=ba(t,e=pa(n,e),1),1),e=oc(),null!==t&&(yt(t,1,e),cc(t,e));break}}t=t.return}}function Ac(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=oc(),e.pingedLanes|=e.suspendedLanes&n,jl===e&&(Ol&n)===n&&(4===zl||3===zl&&(130023424&Ol)===Ol&&500>$e()-Gl?vc(e,0):ql|=n),cc(e,t)}function Dc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=oc();null!==(e=Fs(e,t))&&(yt(e,t,n),cc(e,n))}function Rc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Dc(e,n)}function jc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Dc(e,n)}function Mc(e,t){return Ke(e,t)}function Oc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lc(e,t,n,i){return new Oc(e,t,n,i)}function Fc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zc(e,t){var n=e.alternate;return null===n?((n=Lc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Uc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Fc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case C:return Vc(n.children,r,o,t);case k:a=8,r|=8;break;case E:return(e=Lc(12,n,t,2|r)).elementType=E,e.lanes=o,e;case I:return(e=Lc(13,n,t,r)).elementType=I,e.lanes=o,e;case P:return(e=Lc(19,n,t,r)).elementType=P,e.lanes=o,e;case R:return Bc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case N:a=9;break e;case S:a=11;break e;case A:a=14;break e;case D:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Lc(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Vc(e,t,n,i){return(e=Lc(7,e,i,t)).lanes=n,e}function Bc(e,t,n,i){return(e=Lc(22,e,i,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function qc(e,t,n){return(e=Lc(6,e,null,t)).lanes=n,e}function Hc(e,t,n){return(t=Lc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Gc(e,t,n,i,r,s,o,a,l){return e=new Wc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Lc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Us(s),e}function Kc(e){if(!e)return Nr;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Dr(n))return Or(e,n,t)}return t}function Yc(e,t,n,i,r,s,o,a,l){return(e=Gc(n,i,!0,e,0,s,0,a,l)).context=Kc(null),n=e.current,(s=Bs(i=oc(),r=ac(n))).callback=void 0!==t&&null!==t?t:null,qs(n,s,r),e.current.lanes=r,yt(e,r,i),cc(e,i),e}function Qc(e,t,n,i){var r=t.current,s=oc(),o=ac(r);return n=Kc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bs(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=qs(r,t,o))&&(lc(e,r,o,s),Hs(e,r,o)),o}function Xc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function $c(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Jc(e,t){$c(e,t),(e=e.alternate)&&$c(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ir.current)ka=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ka=!1,function(e,t,n){switch(t.tag){case 3:ja(t),ys();break;case 5:to(t);break;case 1:Dr(t.type)&&Lr(t);break;case 4:Zs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Tr(Ts,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Tr(io,1&io.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ba(e,t,n):(Tr(io,1&io.current),null!==(e=Qa(e,t,n))?e.sibling:null);Tr(io,1&io.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Ka(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Tr(io,io.current),i)break;return null;case 22:case 23:return t.lanes=0,Ia(e,t,n)}return Qa(e,t,n)}(e,t,n);ka=0!==(131072&e.flags)}else ka=!1,ls&&0!==(1048576&t.flags)&&is(t,Qr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ya(e,t),e=t.pendingProps;var r=Ar(t,Sr.current);Rs(t,n),r=xo(null,t,i,e,r,n);var o=wo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(i)?(o=!0,Lr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Us(t),r.updater=ca,t.stateNode=r,r._reactInternals=t,fa(t,i,e,n),t=Ra(null,t,i,!0,o,n)):(t.tag=0,ls&&o&&rs(t),Ea(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ya(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Fc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===A)return 14}return 2}(i),e=aa(i,e),r){case 0:t=Aa(null,t,i,e,n);break e;case 1:t=Da(null,t,i,e,n);break e;case 11:t=Ta(null,t,i,e,n);break e;case 14:t=Na(null,t,i,aa(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Aa(e,t,i,r=t.elementType===i?r:aa(i,r),n);case 1:return i=t.type,r=t.pendingProps,Da(e,t,i,r=t.elementType===i?r:aa(i,r),n);case 3:e:{if(ja(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Vs(e,t),Gs(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ma(e,t,i,n,r=pa(Error(s(423)),t));break e}if(i!==r){t=Ma(e,t,i,n,r=pa(Error(s(424)),t));break e}for(as=cr(t.stateNode.containerInfo.firstChild),os=t,ls=!0,cs=null,n=Es(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ys(),i===r){t=Qa(e,t,n);break e}Ea(e,t,i,n)}t=t.child}return t;case 5:return to(t),null===e&&fs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),Pa(e,t),Ea(e,t,a,n),t.child;case 6:return null===e&&fs(t),null;case 13:return Ba(e,t,n);case 4:return Zs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ks(t,null,i,n):Ea(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Ta(e,t,i,r=t.elementType===i?r:aa(i,r),n);case 7:return Ea(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ea(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Tr(Ts,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Ir.current){t=Qa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Bs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ds(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ds(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Ea(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Rs(t,n),i=i(r=js(r)),t.flags|=1,Ea(e,t,i,n),t.child;case 14:return r=aa(i=t.type,t.pendingProps),Na(e,t,i,r=aa(i.type,r),n);case 15:return Sa(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:aa(i,r),Ya(e,t),t.tag=1,Dr(i)?(e=!0,Lr(t)):e=!1,Rs(t,n),ha(t,i,r),fa(t,i,r,n),Ra(null,t,i,!0,e,n);case 19:return Ka(e,t,n);case 22:return Ia(e,t,n)}throw Error(s(156,t.tag))};var Zc="function"===typeof reportError?reportError:function(e){console.error(e)};function eu(e){this._internalRoot=e}function tu(e){this._internalRoot=e}function nu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function iu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ru(){}function su(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Xc(o);a.call(e)}}Qc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Xc(o);s.call(e)}}var o=Yc(t,i,e,0,null,!1,0,"",ru);return e._reactRootContainer=o,e[pr]=o.current,Bi(8===e.nodeType?e.parentNode:e),gc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Xc(l);a.call(e)}}var l=Gc(e,0,!1,null,0,!1,0,"",ru);return e._reactRootContainer=l,e[pr]=l.current,Bi(8===e.nodeType?e.parentNode:e),gc(function(){Qc(t,l,n,i)}),l}(n,t,e,r,i);return Xc(o)}tu.prototype.render=eu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Qc(e,t,null,null)},tu.prototype.unmount=eu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;gc(function(){Qc(null,e,null,null)}),t[pr]=null}},tu.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Lt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),cc(t,$e()),0===(6&Rl)&&(Kl=$e()+500,Hr()))}break;case 13:gc(function(){var t=Fs(e,1);if(null!==t){var n=oc();lc(t,e,1,n)}}),Jc(e,1)}},wt=function(e){if(13===e.tag){var t=Fs(e,134217728);if(null!==t)lc(t,e,134217728,oc());Jc(e,134217728)}},Ct=function(e){if(13===e.tag){var t=ac(e),n=Fs(e,t);if(null!==n)lc(n,e,t,oc());Jc(e,t)}},kt=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=_r(i);if(!r)throw Error(s(90));K(i),J(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=mc,Ie=gc;var ou={usingClientEntryPoint:!1,Events:[br,xr,_r,Te,Ne,mc]},au={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lu={bundleType:au.bundleType,version:au.version,rendererPackageName:au.rendererPackageName,rendererConfig:au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:au.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{rt=cu.inject(lu),st=cu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ou,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!nu(e))throw Error(s(299));var n=!1,i="",r=Zc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Gc(e,1,!1,null,0,n,0,i,r),e[pr]=t.current,Bi(8===e.nodeType?e.parentNode:e),new eu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return gc(e)},t.hydrate=function(e,t,n){if(!iu(t))throw Error(s(200));return su(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!nu(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Zc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Yc(t,null,e,1,null!=n?n:null,r,0,o,a),e[pr]=t.current,Bi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new tu(t)},t.render=function(e,t,n){if(!iu(t))throw Error(s(200));return su(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!iu(e))throw Error(s(40));return!!e._reactRootContainer&&(gc(function(){su(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0)},t.unstable_batchedUpdates=mc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!iu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return su(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var i=n(43),r=n(391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=s(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function a(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const u=!1,h=!1,d="${JSCORE_VERSION}",f=function(e,t){if(!e)throw p(t)},p=function(e){return new Error("Firebase Database ("+d+") INTERNAL ASSERT FAILED: "+e)},m=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&i+1<e.length&&56320===(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},g={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],s=r+1<e.length,o=s?e[r+1]:0,a=r+2<e.length,l=a?e[r+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(n[c],n[u],n[h],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(m(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],s=r<e.length?n[e.charAt(r)]:0;++r;const o=r<e.length?n[e.charAt(r)]:64;++r;const a=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==s||null==o||null==a)throw new y;const l=t<<2|s>>4;if(i.push(l),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class y extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const v=function(e){const t=m(e);return g.encodeByteArray(t,!0)},b=function(e){return v(e).replace(/\./g,"")},x=function(e){try{return g.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function _(e){return w(void 0,e)}function w(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&C(n)&&(e[n]=w(e[n],t[n]));return e}function C(e){return"__proto__"!==e}const k=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,E=()=>{try{return k()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/portal",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&x(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},T=e=>{var t,n;return null===(n=null===(t=E())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},N=e=>{const t=T(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},S=()=>{var e;return null===(e=E())||void 0===e?void 0:e.config},I=e=>{var t;return null===(t=E())||void 0===t?void 0:t["_".concat(e)]};class P{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function A(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[b(JSON.stringify({alg:"none",type:"JWT"})),b(JSON.stringify(s)),""].join(".")}function D(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function R(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(D())}function j(){var e;const t=null===(e=E())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(i){return!1}}function M(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function O(){return!0===u||!0===h}function L(){try{return"object"===typeof indexedDB}catch(e){return!1}}class F extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,z.prototype.create)}}class z{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),i=this.errors[e],r=i?function(e,t){return e.replace(U,(e,n)=>{const i=t[n];return null!=i?String(i):"<".concat(n,"?>")})}(i,t):"Error",s="".concat(this.serviceName,": ").concat(r," (").concat(n,").");return new F(n,s,t)}}const U=/\{\$([^}]+)}/g;function V(e){return JSON.parse(e)}function B(e){return JSON.stringify(e)}const q=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=V(x(s[0])||""),n=V(x(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(s){}return{header:t,claims:n,data:i,signature:r}};function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function G(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function K(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function Y(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(Q(n)&&Q(s)){if(!Y(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function Q(e){return null!==e&&"object"===typeof e}function X(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function $(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}}),t}function J(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Z{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(i=l^o&(a^l),r=1518500249):(i=o^a^l,r=1859775393):u<60?(i=o&a|l&(o|a),r=2400959708):(i=o^a^l,r=3395469782);const e=(s<<5|s>>>27)+i+c+r+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(r[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<t;)if(r[s]=e[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[i]>>t&255,++n;return e}}class ee{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=te),void 0===i.error&&(i.error=te),void 0===i.complete&&(i.complete=te);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}}),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function te(){}function ne(e,t){return"".concat(e," failed: ").concat(t," argument ")}const ie=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function re(e){return e&&e._delegate?e._delegate:e}class se{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const oe="[DEFAULT]";class ae{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new P;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),i=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:oe})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:i});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&s.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===oe?void 0:r),options:n}),this.instances.set(t,i),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(s){}var r;return i||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;return this.component?this.component.multipleInstances?e:oe:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class le{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ae(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ce=[];var ue;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ue||(ue={}));const he={debug:ue.DEBUG,verbose:ue.VERBOSE,info:ue.INFO,warn:ue.WARN,error:ue.ERROR,silent:ue.SILENT},de=ue.INFO,fe={[ue.DEBUG]:"log",[ue.VERBOSE]:"log",[ue.INFO]:"info",[ue.WARN]:"warn",[ue.ERROR]:"error"},pe=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),i=fe[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];console[i]("[".concat(n,"]  ").concat(e.name,":"),...s)};class me{constructor(e){this.name=e,this._logLevel=de,this._logHandler=pe,this._userLogHandler=null,ce.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ue))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?he[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.DEBUG,...t),this._logHandler(this,ue.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.VERBOSE,...t),this._logHandler(this,ue.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.INFO,...t),this._logHandler(this,ue.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.WARN,...t),this._logHandler(this,ue.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ue.ERROR,...t),this._logHandler(this,ue.ERROR,...t)}}let ge,ye;const ve=new WeakMap,be=new WeakMap,xe=new WeakMap,_e=new WeakMap,we=new WeakMap;let Ce={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return be.get(e);if("objectStoreNames"===t)return e.objectStoreNames||xe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Te(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ke(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ye||(ye=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(Ne(this),n),Te(ve.get(this))}:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Te(e.apply(Ne(this),n))}:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.call(Ne(this),t,...i);return xe.set(s,t.sort?t.sort():[t]),Te(s)}}function Ee(e){return"function"===typeof e?ke(e):(e instanceof IDBTransaction&&function(e){if(be.has(e))return;const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});be.set(e,t)}(e),t=e,(ge||(ge=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Ce):e);var t}function Te(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Te(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ve.set(t,e)}).catch(()=>{}),we.set(t,e),t}(e);if(_e.has(e))return _e.get(e);const t=Ee(e);return t!==e&&(_e.set(e,t),we.set(t,e)),t}const Ne=e=>we.get(e);const Se=["get","getKey","getAll","getAllKeys","count"],Ie=["put","add","delete","clear"],Pe=new Map;function Ae(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Pe.get(t))return Pe.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=Ie.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Se.includes(n))return;const s=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return i&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),r&&t.done]))[0]};return Pe.set(t,s),s}!function(e){Ce=e(Ce)}(e=>c(c({},e),{},{get:(t,n,i)=>Ae(t,n)||e.get(t,n,i),has:(t,n)=>!!Ae(t,n)||e.has(t,n)}));class De{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const Re="@firebase/app",je="0.9.13",Me=new me("@firebase/app"),Oe="@firebase/app-compat",Le="@firebase/analytics-compat",Fe="@firebase/analytics",ze="@firebase/app-check-compat",Ue="@firebase/app-check",Ve="@firebase/auth",Be="@firebase/auth-compat",qe="@firebase/database",He="@firebase/database-compat",We="@firebase/functions",Ge="@firebase/functions-compat",Ke="@firebase/installations",Ye="@firebase/installations-compat",Qe="@firebase/messaging",Xe="@firebase/messaging-compat",$e="@firebase/performance",Je="@firebase/performance-compat",Ze="@firebase/remote-config",et="@firebase/remote-config-compat",tt="@firebase/storage",nt="@firebase/storage-compat",it="@firebase/firestore",rt="@firebase/firestore-compat",st="firebase",ot="[DEFAULT]",at={[Re]:"fire-core",[Oe]:"fire-core-compat",[Fe]:"fire-analytics",[Le]:"fire-analytics-compat",[Ue]:"fire-app-check",[ze]:"fire-app-check-compat",[Ve]:"fire-auth",[Be]:"fire-auth-compat",[qe]:"fire-rtdb",[He]:"fire-rtdb-compat",[We]:"fire-fn",[Ge]:"fire-fn-compat",[Ke]:"fire-iid",[Ye]:"fire-iid-compat",[Qe]:"fire-fcm",[Xe]:"fire-fcm-compat",[$e]:"fire-perf",[Je]:"fire-perf-compat",[Ze]:"fire-rc",[et]:"fire-rc-compat",[tt]:"fire-gcs",[nt]:"fire-gcs-compat",[it]:"fire-fst",[rt]:"fire-fst-compat","fire-js":"fire-js",[st]:"fire-js-all"},lt=new Map,ct=new Map;function ut(e,t){try{e.container.addComponent(t)}catch(n){Me.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ht(e){const t=e.name;if(ct.has(t))return Me.debug("There were multiple attempts to register component ".concat(t,".")),!1;ct.set(t,e);for(const n of lt.values())ut(n,e);return!0}function dt(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ft=new z("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class pt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new se("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ft.create("app-deleted",{appName:this._name})}}const mt="9.23.0";function gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:ot,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!==typeof r||!r)throw ft.create("bad-app-name",{appName:String(r)});if(n||(n=S()),!n)throw ft.create("no-options");const s=lt.get(r);if(s){if(Y(n,s.options)&&Y(i,s.config))return s;throw ft.create("duplicate-app",{appName:r})}const o=new le(r);for(const l of ct.values())o.addComponent(l);const a=new pt(n,i,o);return lt.set(r,a),a}function yt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot;const t=lt.get(e);if(!t&&e===ot&&S())return gt();if(!t)throw ft.create("no-app",{appName:e});return t}function vt(e,t,n){var i;let r=null!==(i=at[e])&&void 0!==i?i:e;n&&(r+="-".concat(n));const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(r,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(r,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Me.warn(e.join(" "))}ht(new se("".concat(r,"-version"),()=>({library:r,version:t}),"VERSION"))}const bt="firebase-heartbeat-store";let xt=null;function _t(){return xt||(xt=function(e,t){let{blocked:n,upgrade:i,blocking:r,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=Te(o);return i&&o.addEventListener("upgradeneeded",e=>{i(Te(o.result),e.oldVersion,e.newVersion,Te(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(bt)}}).catch(e=>{throw ft.create("idb-open",{originalErrorMessage:e.message})})),xt}async function wt(e,t){try{const n=(await _t()).transaction(bt,"readwrite"),i=n.objectStore(bt);await i.put(t,Ct(e)),await n.done}catch(n){if(n instanceof F)Me.warn(n.message);else{const e=ft.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});Me.warn(e.message)}}}function Ct(e){return"".concat(e.name,"!").concat(e.options.appId)}class kt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Tt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Et();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Et(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let i=e.slice();for(const r of e){const e=n.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),Nt(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Nt(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=b(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Et(){return(new Date).toISOString().substring(0,10)}class Tt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!L()&&new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(NS){t(NS)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await _t();return await t.transaction(bt).objectStore(bt).get(Ct(e))}catch(t){if(t instanceof F)Me.warn(t.message);else{const e=ft.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});Me.warn(e.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return wt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Nt(e){return b(JSON.stringify({version:2,heartbeats:e})).length}var St;St="",ht(new se("platform-logger",e=>new De(e),"PRIVATE")),ht(new se("heartbeat",e=>new kt(e),"PRIVATE")),vt(Re,je,St),vt(Re,je,"esm2017"),vt("fire-js","");vt("firebase","9.23.0","app");function It(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Pt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const At=Pt,Dt=new z("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Rt=new me("@firebase/auth");function jt(e){if(Rt.logLevel<=ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];Rt.error("Auth (".concat(mt,"): ").concat(e),...n)}}function Mt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Ft(e,...n)}function Ot(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ft(e,...n)}function Lt(e,t,n){const i=Object.assign(Object.assign({},At()),{[t]:n});return new z("auth","Firebase",i).create(t,{appName:e.name})}function Ft(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if("string"!==typeof e){const t=n[0],i=[...n.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(t,...i)}return Dt.create(e,...n)}function zt(e,t){if(!e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];throw Ft(t,...i)}}function Ut(e){const t="INTERNAL ASSERTION FAILED: "+e;throw jt(t),new Error(t)}function Vt(e,t){e||Ut(t)}function Bt(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function qt(){return"http:"===Ht()||"https:"===Ht()}function Ht(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Wt(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(qt()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Gt{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vt(t>e,"Short delay should be less than long delay!"),this.isMobile=R()||M()}get(){return Wt()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Kt(e,t){Vt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Yt{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void Ut("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void Ut("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void Ut("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Qt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Xt=new Gt(3e4,6e4);function $t(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Jt(e,t,n,i){return Zt(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=X(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Yt.fetch()(tn(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))})}async function Zt(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Qt),t);try{const t=new nn(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw rn(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw rn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw rn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw rn(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Lt(e,a,o);Mt(e,a)}}catch(r){if(r instanceof F)throw r;Mt(e,"network-request-failed",{message:String(r)})}}async function en(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Jt(e,t,n,i,r);return"mfaPendingCredential"in s&&Mt(e,"multi-factor-auth-required",{_serverResponse:s}),s}function tn(e,t,n,i){const r="".concat(t).concat(n,"?").concat(i);return e.config.emulator?Kt(e.config,r):"".concat(e.config.apiScheme,"://").concat(r)}class nn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Ot(this.auth,"network-request-failed")),Xt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rn(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Ot(e,t,i);return r.customData._tokenResponse=n,r}function sn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function on(e){return 1e3*Number(e)}function an(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return jt("JWT malformed, contained fewer than 3 sections"),null;try{const e=x(n);return e?JSON.parse(e):(jt("Failed to decode base64 JWT payload"),null)}catch(r){return jt("Caught error parsing JWT payload as JSON",null===r||void 0===r?void 0:r.toString()),null}}async function ln(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof F&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class cn{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class un{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=sn(this.lastLoginAt),this.creationTime=sn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function hn(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ln(e,async function(e,t){return Jt(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));zt(null===r||void 0===r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=It(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[];const a=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!u&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new un(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class dn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zt(e.idToken,"internal-error"),zt("undefined"!==typeof e.idToken,"internal-error"),zt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){const t=an(e);return zt(t,"internal-error"),zt("undefined"!==typeof t.exp,"internal-error"),zt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return zt(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Zt(e,{},async()=>{const n=X({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=tn(e,i,"/v1/token","key=".concat(r)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Yt.fetch()(s,{method:"POST",headers:o,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new dn;return n&&(zt("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(zt("string"===typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(zt("number"===typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dn,this.toJSON())}_performRefresh(){return Ut("not implemented")}}function fn(e,t){zt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class pn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=It(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cn(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new un(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ln(this,this.stsTokenManager.getToken(this.auth,e));return zt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=re(e),i=await n.getIdToken(t),r=an(i);zt(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"===typeof r.firebase?r.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:sn(on(r.auth_time)),issuedAtTime:sn(on(r.iat)),expirationTime:sn(on(r.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=re(e);await hn(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(zt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new pn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){zt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await hn(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ln(this,async function(e,t){return Jt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:x,providerData:_,stsTokenManager:w}=t;zt(v&&w,e,"internal-error");const C=dn.fromJSON(this.name,w);zt("string"===typeof v,e,"internal-error"),fn(u,e.name),fn(h,e.name),zt("boolean"===typeof b,e,"internal-error"),zt("boolean"===typeof x,e,"internal-error"),fn(d,e.name),fn(f,e.name),fn(p,e.name),fn(m,e.name),fn(g,e.name),fn(y,e.name);const k=new pn({uid:v,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:C,createdAt:g,lastLoginAt:y});return _&&Array.isArray(_)&&(k.providerData=_.map(e=>Object.assign({},e))),m&&(k._redirectEventId=m),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=new dn;i.updateFromServerResponse(t);const r=new pn({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await hn(r),r}}const mn=new Map;function gn(e){Vt(e instanceof Function,"Expected a class definition");let t=mn.get(e);return t?(Vt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,mn.set(e,t),t)}class yn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}yn.type="NONE";const vn=yn;function bn(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class xn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=bn(this.userKey,i.apiKey,r),this.fullPersistenceKey=bn("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new xn(gn(vn),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||gn(vn);const s=bn(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=pn._fromJSON(e,t);c!==r&&(o=n),r=c;break}}catch(l){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(l){}})),new xn(r,e,n)):new xn(r,e,n)}}function _n(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(En(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Nn(t))return"Blackberry";if(Sn(t))return"Webos";if(Cn(t))return"Safari";if((t.includes("chrome/")||kn(t))&&!t.includes("edge/"))return"Chrome";if(Tn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function wn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/firefox\//i.test(e)}function Cn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:D()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/crios\//i.test(e)}function En(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/iemobile/i.test(e)}function Tn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/android/i.test(e)}function Nn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/blackberry/i.test(e)}function Sn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/webos/i.test(e)}function In(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Pn(){return function(){const e=D();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function An(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D();return In(e)||Tn(e)||Sn(e)||Nn(e)||/windows phone/i.test(e)||En(e)}function Dn(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=_n(D());break;case"Worker":t="".concat(_n(D()),"-").concat(e);break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(mt,"/").concat(i)}async function Rn(e,t){return Jt(e,"GET","/v2/recaptchaConfig",$t(e,t))}function jn(e){return void 0!==e&&void 0!==e.enterprise}class Mn{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}function On(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Ot("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(i)})}function Ln(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Fn{constructor(e){this.type="recaptcha-enterprise",this.auth=Bn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,i){const r=window.grecaptcha;jn(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Rn(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0!==i.recaptchaKey){const n=new Mn(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(r=>{if(!t&&jn(window.grecaptcha))n(r,e,i);else{if("undefined"===typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));On("https://www.google.com/recaptcha/enterprise.js?render="+r).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function zn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=new Fn(e);let s;try{s=await r.verify(n)}catch(NS){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Un{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(r){i(r)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Vn{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qn(this),this.idTokenSubscription=new qn(this),this.beforeStateQueue=new Un(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Dt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gn(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await xn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===i||void 0===i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return zt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await hn(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?re(e):null;return t&&zt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&zt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(gn(e))})}async initializeRecaptchaConfig(){const e=await Rn(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Mn(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new Fn(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new z("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gn(e)||this._popupRedirectResolver;zt(t,this,"argument-error"),this.redirectPersistenceManager=await xn.create(this,[gn(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"===typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return zt(s,this,"internal-error"),s.then(()=>r(this.currentUser)),"function"===typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Rt.logLevel<=ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];Rt.warn("Auth (".concat(mt,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Bn(e){return re(e)}class qn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ee(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return zt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Hn(e,t,n){const i=Bn(e);zt(i._canInitEmulator,i,"emulator-config-failed"),zt(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Wn(t),{host:o,port:a}=function(e){const t=Wn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Gn(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Gn(t)}}}(t),l=null===a?"":":".concat(a);i.config.emulator={url:"".concat(s,"//").concat(o).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Wn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Gn(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Kn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ut("not implemented")}_getIdTokenResponse(e){return Ut("not implemented")}_linkToIdToken(e,t){return Ut("not implemented")}_getReauthenticationResolver(e){return Ut("not implemented")}}async function Yn(e,t){return Jt(e,"POST","/v1/accounts:update",t)}async function Qn(e,t){return en(e,"POST","/v1/accounts:signInWithPassword",$t(e,t))}class Xn extends Kn{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Xn(e,t,"password")}static _fromEmailAndCode(e,t){return new Xn(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await zn(e,n,"signInWithPassword");return Qn(e,t)}return Qn(e,n).catch(async t=>{if(t.code==="auth/".concat("missing-recaptcha-token")){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await zn(e,n,"signInWithPassword");return Qn(e,t)}return Promise.reject(t)});case"emailLink":return async function(e,t){return en(e,"POST","/v1/accounts:signInWithEmailLink",$t(e,t))}(e,{email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Yn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return en(e,"POST","/v1/accounts:signInWithEmailLink",$t(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Mt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function $n(e,t){return en(e,"POST","/v1/accounts:signInWithIdp",$t(e,t))}class Jn extends Kn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Jn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=It(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Jn(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return $n(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,$n(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$n(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=X(t)}return e}}const Zn={USER_NOT_FOUND:"user-not-found"};class ei extends Kn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ei({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ei({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return en(e,"POST","/v1/accounts:signInWithPhoneNumber",$t(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await en(e,"POST","/v1/accounts:signInWithPhoneNumber",$t(e,t));if(n.temporaryProof)throw rn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return en(e,"POST","/v1/accounts:signInWithPhoneNumber",$t(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Zn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new ei({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ti{constructor(e){var t,n,i,r,s,o;const a=$(J(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);zt(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=$(J(e)).link,n=t?$(J(t)).deep_link_id:null,i=$(J(e)).deep_link_id;return(i?$(J(i)).link:null)||i||n||t||e}(e);try{return new ti(t)}catch(n){return null}}}class ni{constructor(){this.providerId=ni.PROVIDER_ID}static credential(e,t){return Xn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ti.parseLink(t);return zt(n,"argument-error"),Xn._fromEmailAndCode(e,n.code,n.tenantId)}}ni.PROVIDER_ID="password",ni.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ni.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ii{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ri extends ii{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class si extends ri{constructor(){super("facebook.com")}static credential(e){return Jn._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return si.credentialFromTaggedObject(e)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return si.credential(t.oauthAccessToken)}catch(n){return null}}}si.FACEBOOK_SIGN_IN_METHOD="facebook.com",si.PROVIDER_ID="facebook.com";class oi extends ri{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Jn._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return oi.credential(n,i)}catch(r){return null}}}oi.GOOGLE_SIGN_IN_METHOD="google.com",oi.PROVIDER_ID="google.com";class ai extends ri{constructor(){super("github.com")}static credential(e){return Jn._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ai.credential(t.oauthAccessToken)}catch(n){return null}}}ai.GITHUB_SIGN_IN_METHOD="github.com",ai.PROVIDER_ID="github.com";class li extends ri{constructor(){super("twitter.com")}static credential(e,t){return Jn._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=t;if(!n||!i)return null;try{return li.credential(n,i)}catch(r){return null}}}async function ci(e,t){return en(e,"POST","/v1/accounts:signUp",$t(e,t))}li.TWITTER_SIGN_IN_METHOD="twitter.com",li.PROVIDER_ID="twitter.com";class ui{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=await pn._fromIdTokenResponse(e,n,i),s=hi(n);return new ui({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=hi(n);return new ui({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function hi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class di extends F{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,di.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new di(e,t,n,i)}}function fi(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw di._fromErrorAndOperation(e,n,t,i);throw n})}async function pi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=await ln(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ui._forOperation(e,"link",i)}async function mi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:i}=e,r="reauthenticate";try{const s=await ln(e,fi(i,r,t,e),n);zt(s.idToken,i,"internal-error");const o=an(s.idToken);zt(o,i,"internal-error");const{sub:a}=o;return zt(e.uid===a,i,"user-mismatch"),ui._forOperation(e,r,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Mt(i,"user-mismatch"),s}}async function gi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i="signIn",r=await fi(e,i,t),s=await ui._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}async function yi(e,t){return gi(Bn(e),t)}function vi(e){return re(e).signOut()}new WeakMap;const bi="__sak";class xi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bi,"1"),this.storage.removeItem(bi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class _i extends xi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=D();return Cn(e)||In(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=An(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Pn()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_i.type="LOCAL";const wi=_i;class Ci extends xi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ci.type="SESSION";const ki=Ci;class Ei{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ei(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ti(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Ei.receivers=[];class Ni{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const i="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const l=Ti("",20);i.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(c),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Si(){return window}function Ii(){return"undefined"!==typeof Si().WorkerGlobalScope&&"function"===typeof Si().importScripts}const Pi="firebaseLocalStorageDb",Ai="firebaseLocalStorage",Di="fbase_key";class Ri{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ji(e,t){return e.transaction([Ai],t?"readwrite":"readonly").objectStore(Ai)}function Mi(){const e=indexedDB.open(Pi,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Ai,{keyPath:Di})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Ai)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Pi);return new Ri(e).toPromise()}(),t(await Mi()))})})}async function Oi(e,t,n){const i=ji(e,!0).put({[Di]:t,value:n});return new Ri(i).toPromise()}function Li(e,t){const n=ji(e,!0).delete(t);return new Ri(n).toPromise()}class Fi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Mi()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ii()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ei._getInstance(Ii()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ni(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mi();return await Oi(e,bi,"1"),await Li(e,bi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Oi(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=ji(e,!1).get(t),i=await new Ri(n).toPromise();return void 0===i?null:i.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Li(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=ji(e,!1).getAll();return new Ri(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Fi.type="LOCAL";const zi=Fi;Ln("rcb"),new Gt(3e4,6e4);const Ui="recaptcha";async function Vi(e,t,n){var i;const r=await n.verify();try{let s;if(zt("string"===typeof r,e,"argument-error"),zt(n.type===Ui,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){zt("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Jt(e,"POST","/v2/accounts/mfaEnrollment:start",$t(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{zt("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;zt(n,e,"missing-multi-factor-info");const o=await function(e,t){return Jt(e,"POST","/v2/accounts/mfaSignIn:start",$t(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Jt(e,"POST","/v1/accounts:sendVerificationCode",$t(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}class Bi{constructor(e){this.providerId=Bi.PROVIDER_ID,this.auth=Bn(e)}verifyPhoneNumber(e,t){return Vi(this.auth,e,re(t))}static credential(e,t){return ei._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Bi.credentialFromTaggedObject(t)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:i}=t;return n&&i?ei._fromTokenResponse(n,i):null}}function qi(e,t){return t?gn(t):(zt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Bi.PROVIDER_ID="phone",Bi.PHONE_SIGN_IN_METHOD="phone";class Hi extends Kn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $n(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $n(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $n(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Wi(e){return gi(e.auth,new Hi(e),e.bypassAuthState)}function Gi(e){const{auth:t,user:n}=e;return zt(n,t,"internal-error"),mi(n,new Hi(e),e.bypassAuthState)}async function Ki(e){const{auth:t,user:n}=e;return zt(n,t,"internal-error"),pi(n,new Hi(e),e.bypassAuthState)}class Yi{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wi;case"linkViaPopup":case"linkViaRedirect":return Ki;case"reauthViaPopup":case"reauthViaRedirect":return Gi;default:Mt(this.auth,"internal-error")}}resolve(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Qi=new Gt(2e3,1e4);class Xi extends Yi{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Xi.currentPopupAction&&Xi.currentPopupAction.cancel(),Xi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zt(e,this.auth,"internal-error"),e}async onExecution(){Vt(1===this.filter.length,"Popup operations only handle one event");const e=Ti();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Ot(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Ot(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ot(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Qi.get())};e()}}Xi.currentPopupAction=null;const $i=new Map;class Ji extends Yi{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=$i.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=tr(t),i=er(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}$i.set(this.auth._key(),e)}return this.bypassAuthState||$i.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Zi(e,t){$i.set(e._key(),t)}function er(e){return gn(e._redirectPersistence)}function tr(e){return bn("pendingRedirect",e.config.apiKey,e.name)}async function nr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Bn(e),r=qi(i,t),s=new Ji(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class ir{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!sr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Ot(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(rr(e))}saveEventToCache(e){this.cachedEventUids.add(rr(e)),this.lastProcessedEventTime=Date.now()}}function rr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function sr(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const or=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ar=/^https?/;async function lr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Jt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const i of t)try{if(cr(i))return}catch(n){}Mt(e,"unauthorized-domain")}function cr(e){const t=Bt(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!ar.test(n))return!1;if(or.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const ur=new Gt(3e4,6e4);function hr(){const e=Si().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let dr=null;function fr(e){return dr=dr||function(e){return new Promise((t,n)=>{var i,r,s;function o(){hr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{hr(),n(Ot(e,"network-request-failed"))},timeout:ur.get()})}if(null===(r=null===(i=Si().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Si().gapi)||void 0===s?void 0:s.load)){const t=Ln("iframefcb");return Si()[t]=()=>{gapi.load?o():n(Ot(e,"network-request-failed"))},On("https://apis.google.com/js/api.js?onload=".concat(t)).catch(e=>n(e))}o()}}).catch(e=>{throw dr=null,e})}(e),dr}const pr=new Gt(5e3,15e3),mr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yr(e){const t=e.config;zt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Kt(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),i={apiKey:t.apiKey,appName:e.name,v:mt},r=gr.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),"".concat(n,"?").concat(X(i).slice(1))}const vr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class br{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function xr(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},vr),{width:i.toString(),height:r.toString(),top:s,left:o}),c=D().toLowerCase();n&&(a=kn(c)?"_blank":n),wn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,i]=t;return"".concat(e).concat(n,"=").concat(i,",")},"");if(function(){var e;return In(arguments.length>0&&void 0!==arguments[0]?arguments[0]:D())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new br(null);const h=window.open(t||"",a,u);zt(h,e,"popup-blocked");try{h.focus()}catch(d){}return new br(h)}const _r="__/auth/handler",wr="emulator/auth/handler",Cr=encodeURIComponent("fac");async function kr(e,t,n,i,r,s){zt(e.config.authDomain,e,"auth-domain-config-required"),zt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:mt,eventId:r};if(t instanceof ii){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",G(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof ri){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Cr,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(_r);return Kt(t,wr)}(e),"?").concat(X(a).slice(1)).concat(c)}const Er="webStorageSupport";const Tr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ki,this._completeRedirectFn=nr,this._overrideRedirectResult=Zi}async _openPopup(e,t,n,i){var r;Vt(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return xr(e,await kr(e,t,n,Bt(),i),Ti())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){Si().location.href=e}(await kr(e,t,n,Bt(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Vt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await fr(e),n=Si().gapi;return zt(n,e,"internal-error"),t.open({where:document.body,url:yr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mr,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Ot(e,"network-request-failed"),s=Si().setTimeout(()=>{i(r)},pr.get());function o(){Si().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}(e),n=new ir(e);return t.register("authEvent",t=>{zt(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Er,{type:Er},n=>{var i;const r=null===(i=null===n||void 0===n?void 0:n[0])||void 0===i?void 0:i[Er];void 0!==r&&t(!!r),Mt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=lr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return An()||Cn()||In()}};var Nr="@firebase/auth",Sr="0.23.2";class Ir{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){zt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Pr=I("authIdTokenMaxAge")||300;let Ar=null;function Dr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();const t=dt(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=dt(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Y(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Mt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Tr,persistence:[zi,wi,ki]}),i=I("authTokenSyncURL");if(i){const e=(r=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Pr)return;const i=null===t||void 0===t?void 0:t.token;Ar!==i&&(Ar=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}}))});!function(e,t,n){re(e).beforeAuthStateChanged(t,n)}(n,e,()=>e(n.currentUser)),function(e,t,n,i){re(e).onIdTokenChanged(t,n,i)}(n,t=>e(t))}var r;const s=T("auth");return s&&Hn(n,"http://".concat(s)),n}var Rr;Rr="Browser",ht(new se("auth",(e,t)=>{let{options:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;zt(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:Rr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dn(Rr)},c=new Vn(i,r,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(gn);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ht(new se("auth-internal",e=>(e=>new Ir(e))(Bn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),vt(Nr,Sr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Rr)),vt(Nr,Sr,"esm2017");var jr,Mr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Or={},Lr=Lr||{},Fr=Mr||self;function zr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Ur(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Vr="closure_uid_"+(1e9*Math.random()>>>0),Br=0;function qr(e,t,n){return e.call.apply(e.bind,arguments)}function Hr(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Wr(e,t,n){return(Wr=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?qr:Hr).apply(null,arguments)}function Gr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Kr(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function Yr(){this.s=this.s,this.o=this.o}Yr.prototype.s=!1,Yr.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Vr)&&e[Vr]||(e[Vr]=++Br))},Yr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Qr=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Xr(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function $r(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(zr(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function Jr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Jr.prototype.h=function(){this.defaultPrevented=!0};var Zr=function(){if(!Fr.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Fr.addEventListener("test",()=>{},t),Fr.removeEventListener("test",()=>{},t)}catch(n){}return e}();function es(e){return/^[\s\xa0]*$/.test(e)}function ts(){var e=Fr.navigator;return e&&(e=e.userAgent)?e:""}function ns(e){return-1!=ts().indexOf(e)}function is(e){return is[" "](e),e}is[" "]=function(){};var rs,ss,os=ns("Opera"),as=ns("Trident")||ns("MSIE"),ls=ns("Edge"),cs=ls||as,us=ns("Gecko")&&!(-1!=ts().toLowerCase().indexOf("webkit")&&!ns("Edge"))&&!(ns("Trident")||ns("MSIE"))&&!ns("Edge"),hs=-1!=ts().toLowerCase().indexOf("webkit")&&!ns("Edge");function ds(){var e=Fr.document;return e?e.documentMode:void 0}e:{var fs="",ps=function(){var e=ts();return us?/rv:([^\);]+)(\)|;)/.exec(e):ls?/Edge\/([\d\.]+)/.exec(e):as?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):hs?/WebKit\/(\S+)/.exec(e):os?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(ps&&(fs=ps?ps[1]:""),as){var ms=ds();if(null!=ms&&ms>parseFloat(fs)){rs=String(ms);break e}}rs=fs}if(Fr.document&&as){var gs=ds();ss=gs||(parseInt(rs,10)||void 0)}else ss=void 0;var ys=ss;function vs(e,t){if(Jr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(us){e:{try{is(t.nodeName);var r=!0;break e}catch(s){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:bs[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&vs.$.h.call(this)}}Kr(vs,Jr);var bs={2:"touch",3:"pen",4:"mouse"};vs.prototype.h=function(){vs.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var xs="closure_listenable_"+(1e6*Math.random()|0),_s=0;function ws(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++_s,this.fa=this.ia=!1}function Cs(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function ks(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function Es(e){const t={};for(const n in e)t[n]=e[n];return t}const Ts="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ns(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<Ts.length;t++)n=Ts[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function Ss(e){this.src=e,this.g={},this.h=0}function Is(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Qr(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Cs(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Ps(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==i)return r}return-1}Ss.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Ps(e,t,i,r);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new ws(t,this.src,s,!!i,r)).ia=n,e.push(t)),t};var As="closure_lm_"+(1e6*Math.random()|0),Ds={};function Rs(e,t,n,i,r){if(i&&i.once)return Ms(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Rs(e,t[s],n,i,r);return null}return n=Bs(n),e&&e[xs]?e.O(t,n,Ur(i)?!!i.capture:!!i,r):js(e,t,n,!1,i,r)}function js(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=Ur(r)?!!r.capture:!!r,a=Us(e);if(a||(e[As]=a=new Ss(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=zs;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Zr||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Fs(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function Ms(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Ms(e,t[s],n,i,r);return null}return n=Bs(n),e&&e[xs]?e.P(t,n,Ur(i)?!!i.capture:!!i,r):js(e,t,n,!0,i,r)}function Os(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)Os(e,t[s],n,i,r);else i=Ur(i)?!!i.capture:!!i,n=Bs(n),e&&e[xs]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Ps(s=e.g[t],n,i,r))&&(Cs(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Us(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ps(t,n,i,r)),(n=-1<e?t[e]:null)&&Ls(n))}function Ls(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[xs])Is(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Fs(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Us(t))?(Is(n,e),0==n.h&&(n.src=null,t[As]=null)):Cs(e)}}}function Fs(e){return e in Ds?Ds[e]:Ds[e]="on"+e}function zs(e,t){if(e.fa)e=!0;else{t=new vs(t,this);var n=e.listener,i=e.la||e.src;e.ia&&Ls(e),e=n.call(i,t)}return e}function Us(e){return(e=e[As])instanceof Ss?e:null}var Vs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bs(e){return"function"===typeof e?e:(e[Vs]||(e[Vs]=function(t){return e.handleEvent(t)}),e[Vs])}function qs(){Yr.call(this),this.i=new Ss(this),this.S=this,this.J=null}function Hs(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"===typeof t)t=new Jr(t,e);else if(t instanceof Jr)t.target=t.target||e;else{var r=t;Ns(t=new Jr(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=Ws(o,i,!0,t)&&r}if(r=Ws(o=t.g=e,i,!0,t)&&r,r=Ws(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=Ws(o=t.g=n[s],i,!1,t)&&r}function Ws(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Is(e.i,o),r=!1!==a.call(l,i)&&r}}return r&&!i.defaultPrevented}Kr(qs,Yr),qs.prototype[xs]=!0,qs.prototype.removeEventListener=function(e,t,n,i){Os(this,e,t,n,i)},qs.prototype.N=function(){if(qs.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Cs(n[i]);delete t.g[e],t.h--}}this.J=null},qs.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},qs.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var Gs=Fr.JSON.stringify;function Ks(){var e=eo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ys=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Qs,e=>e.reset());class Qs{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Xs(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function $s(e){Fr.setTimeout(()=>{throw e},0)}let Js,Zs=!1,eo=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ys.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},to=()=>{const e=Fr.Promise.resolve(void 0);Js=()=>{e.then(no)}};var no=()=>{for(var e;e=Ks();){try{e.h.call(e.g)}catch(n){$s(n)}var t=Ys;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Zs=!1};function io(e,t){qs.call(this),this.h=e||1,this.g=t||Fr,this.j=Wr(this.qb,this),this.l=Date.now()}function ro(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function so(e,t,n){if("function"===typeof e)n&&(e=Wr(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Wr(e.handleEvent,e)}return 2147483647<Number(t)?-1:Fr.setTimeout(e,t||0)}function oo(e){e.g=so(()=>{e.g=null,e.i&&(e.i=!1,oo(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Kr(io,qs),(jr=io.prototype).ga=!1,jr.T=null,jr.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Hs(this,"tick"),this.ga&&(ro(this),this.start()))}},jr.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},jr.N=function(){io.$.N.call(this),ro(this),delete this.g};class ao extends Yr{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:oo(this)}N(){super.N(),this.g&&(Fr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lo(e){Yr.call(this),this.h=e,this.g={}}Kr(lo,Yr);var co=[];function uo(e,t,n,i){Array.isArray(n)||(n&&(co[0]=n.toString()),n=co);for(var r=0;r<n.length;r++){var s=Rs(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ho(e){ks(e.g,function(e,t){this.g.hasOwnProperty(t)&&Ls(e)},e),e.g={}}function fo(){this.g=!0}function po(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Gs(n)}catch(a){return t}}(e,n)+(i?" "+i:"")})}lo.prototype.N=function(){lo.$.N.call(this),ho(this)},lo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fo.prototype.Ea=function(){this.g=!1},fo.prototype.info=function(){};var mo={},go=null;function yo(){return go=go||new qs}function vo(e){Jr.call(this,mo.Ta,e)}function bo(e){const t=yo();Hs(t,new vo(t))}function xo(e,t){Jr.call(this,mo.STAT_EVENT,e),this.stat=t}function _o(e){const t=yo();Hs(t,new xo(t,e))}function wo(e,t){Jr.call(this,mo.Ua,e),this.size=t}function Co(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Fr.setTimeout(function(){e()},t)}mo.Ta="serverreachability",Kr(vo,Jr),mo.STAT_EVENT="statevent",Kr(xo,Jr),mo.Ua="timingevent",Kr(wo,Jr);var ko={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Eo={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function To(){}function No(e){return e.h||(e.h=e.i())}function So(){}To.prototype.h=null;var Io,Po={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Ao(){Jr.call(this,"d")}function Do(){Jr.call(this,"c")}function Ro(){}function jo(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new lo(this),this.P=Oo,e=cs?125:void 0,this.V=new io(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Mo}function Mo(){this.i=null,this.g="",this.h=!1}Kr(Ao,Jr),Kr(Do,Jr),Kr(Ro,To),Ro.prototype.g=function(){return new XMLHttpRequest},Ro.prototype.i=function(){return{}},Io=new Ro;var Oo=45e3,Lo={},Fo={};function zo(e,t,n){e.L=1,e.v=ra(Zo(t)),e.s=n,e.S=!0,Uo(e,null)}function Uo(e,t){e.G=Date.now(),Ho(e),e.A=Zo(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),ya(n.i,"t",i),e.C=0,n=e.l.J,e.h=new Mo,e.g=vl(e.l,n?t:null,!e.s),0<e.O&&(e.M=new ao(Wr(e.Pa,e,e.g),e.O)),uo(e.U,e.g,"readystatechange",e.nb),t=e.I?Es(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),bo(),function(e,t,n,i,r,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.W,e.s)}function Vo(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function Bo(e,t,n){let i,r=!0;for(;!e.J&&e.C<n.length;){if(i=qo(e,n),i==Fo){4==t&&(e.o=4,_o(14),r=!1),po(e.j,e.m,null,"[Incomplete Response]");break}if(i==Lo){e.o=4,_o(15),po(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}po(e.j,e.m,i,null),Qo(e,i)}Vo(e)&&i!=Fo&&i!=Lo&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,_o(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),ul(t),t.M=!0,_o(11))):(po(e.j,e.m,n,"[Invalid Chunked Response]"),Yo(e),Ko(e))}function qo(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Fo:(n=Number(t.substring(n,i)),isNaN(n)?Lo:(i+=1)+n>t.length?Fo:(t=t.slice(i,i+n),e.C=i+n,t))}function Ho(e){e.Y=Date.now()+e.P,Wo(e,e.P)}function Wo(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Co(Wr(e.lb,e),t)}function Go(e){e.B&&(Fr.clearTimeout(e.B),e.B=null)}function Ko(e){0==e.l.H||e.J||fl(e.l,e)}function Yo(e){Go(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,ro(e.V),ho(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Qo(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||ka(n.i,e)))if(!e.K&&ka(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(c){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;dl(n),nl(n)}cl(n),_o(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=Co(Wr(n.ib,n),6e3));if(1>=Ca(n.i)&&n.oa){try{n.oa()}catch(c){}n.oa=void 0}}else ml(n,11)}else if((e.K||n.g==e)&&dl(n),!es(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const t=c[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=c[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Ea(s,s.h),s.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,ia(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=yl(i,i.J?i.pa:null,i.Y),o.K){Ta(i.i,o);var a=o,l=i.L;l&&a.setTimeout(l),a.B&&(Go(a),Ho(a)),i.g=o}else ll(i);0<n.j.length&&rl(n)}else"stop"!=c[0]&&"close"!=c[0]||ml(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ml(n,7):tl(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}bo()}catch(c){}}function Xo(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(zr(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(zr(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(zr(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}(jr=jo.prototype).setTimeout=function(e){this.P=e},jr.nb=function(e){e=e.target;const t=this.M;t&&3==Qa(e)?t.l():this.Pa(e)},jr.Pa=function(e){try{if(e==this.g)e:{const u=Qa(this.g);var t=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||cs||this.g&&(this.h.h||this.g.ja()||Xa(this.g)))){this.J||4!=u||7==t||bo(),Go(this);var n=this.g.da();this.ca=n;t:if(Vo(this)){var i=Xa(this.g);e="";var r=i.length,s=4==Qa(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Yo(this),Ko(this);var o="";break t}this.h.i=new Fr.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!es(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,_o(12),Yo(this),Ko(this);break e}po(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qo(this,n)}this.S?(Bo(this,u,o),cs&&this.i&&3==u&&(uo(this.U,this.V,"tick",this.mb),this.V.start())):(po(this.j,this.m,o,null),Qo(this,o)),4==u&&Yo(this),this.i&&!this.J&&(4==u?fl(this.l,this):(this.i=!1,Ho(this)))}else(function(e){const t={};e=(e.g&&2<=Qa(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(es(e[i]))continue;var n=Xs(e[i]);const r=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,_o(12)):(this.o=0,_o(13)),Yo(this),Ko(this)}}}catch(u){}},jr.mb=function(){if(this.g){var e=Qa(this.g),t=this.g.ja();this.C<t.length&&(Go(this),Bo(this,e,t),this.i&&4!=e&&Ho(this))}},jr.cancel=function(){this.J=!0,Yo(this)},jr.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(bo(),_o(17)),Yo(this),this.o=2,Ko(this)):Wo(this,this.Y-e)};var $o=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jo(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Jo){this.h=e.h,ea(this,e.j),this.s=e.s,this.g=e.g,ta(this,e.m),this.l=e.l;var t=e.i,n=new fa;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),na(this,n),this.o=e.o}else e&&(t=String(e).match($o))?(this.h=!1,ea(this,t[1]||"",!0),this.s=sa(t[2]||""),this.g=sa(t[3]||"",!0),ta(this,t[4]),this.l=sa(t[5]||"",!0),na(this,t[6]||"",!0),this.o=sa(t[7]||"")):(this.h=!1,this.i=new fa(null,this.h))}function Zo(e){return new Jo(e)}function ea(e,t,n){e.j=n?sa(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ta(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function na(e,t,n){t instanceof fa?(e.i=t,function(e,t){t&&!e.j&&(pa(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(ma(this,t),ya(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=oa(t,ha)),e.i=new fa(t,e.h))}function ia(e,t,n){e.i.set(t,n)}function ra(e){return ia(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function sa(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function oa(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,aa),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function aa(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Jo.prototype.toString=function(){var e=[],t=this.j;t&&e.push(oa(t,la,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(oa(t,la,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(oa(n,"/"==n.charAt(0)?ua:ca,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",oa(n,da)),e.join("")};var la=/[#\/\?@]/g,ca=/[#\?:]/g,ua=/[#\?]/g,ha=/[#\?@]/g,da=/#/g;function fa(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function pa(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function ma(e,t){pa(e),t=va(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ga(e,t){return pa(e),t=va(e,t),e.g.has(t)}function ya(e,t,n){ma(e,t),0<n.length&&(e.i=null,e.g.set(va(e,t),Xr(n)),e.h+=n.length)}function va(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(jr=fa.prototype).add=function(e,t){pa(this),this.i=null,e=va(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},jr.forEach=function(e,t){pa(this),this.g.forEach(function(n,i){n.forEach(function(n){e.call(t,n,i,this)},this)},this)},jr.ta=function(){pa(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},jr.Z=function(e){pa(this);let t=[];if("string"===typeof e)ga(this,e)&&(t=t.concat(this.g.get(va(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},jr.set=function(e,t){return pa(this),this.i=null,ga(this,e=va(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},jr.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},jr.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")};var ba=class{constructor(e,t){this.g=e,this.map=t}};function xa(e){this.l=e||_a,Fr.PerformanceNavigationTiming?e=0<(e=Fr.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Fr.g&&Fr.g.Ka&&Fr.g.Ka()&&Fr.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var _a=10;function wa(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ca(e){return e.h?1:e.g?e.g.size:0}function ka(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ea(e,t){e.g?e.g.add(t):e.h=t}function Ta(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Na(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Xr(e.i)}xa.prototype.cancel=function(){if(this.i=Na(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Sa,Ia=class{stringify(e){return Fr.JSON.stringify(e,void 0)}parse(e){return Fr.JSON.parse(e,void 0)}};function Pa(){this.g=new Ia}function Aa(e,t,n){const i=n||"";try{Xo(e,function(e,n){let r=e;Ur(e)&&(r=Gs(e)),t.push(i+n+"="+encodeURIComponent(r))})}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function Da(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(s){}}function Ra(e){this.l=e.fc||null,this.j=e.ob||!1}function ja(e,t){qs.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Ma,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Kr(Ra,To),Ra.prototype.g=function(){return new ja(this.l,this.j)},Ra.prototype.i=(Sa={},function(){return Sa}),Kr(ja,qs);var Ma=0;function Oa(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function La(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Fa(e)}function Fa(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(jr=ja.prototype).open=function(e,t){if(this.readyState!=Ma)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Fa(this)},jr.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Fr).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},jr.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,La(this)),this.readyState=Ma},jr.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Fa(this)),this.g&&(this.readyState=3,Fa(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof Fr.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Oa(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},jr.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?La(this):Fa(this),3==this.readyState&&Oa(this)}},jr.Za=function(e){this.g&&(this.response=this.responseText=e,La(this))},jr.Ya=function(e){this.g&&(this.response=e,La(this))},jr.ka=function(){this.g&&La(this)},jr.setRequestHeader=function(e,t){this.v.append(e,t)},jr.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},jr.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ja.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var za=Fr.JSON.parse;function Ua(e){qs.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Va,this.L=this.M=!1}Kr(Ua,qs);var Va="",Ba=/^https?$/i,qa=["POST","PUT"];function Ha(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Wa(e),Ka(e)}function Wa(e){e.F||(e.F=!0,Hs(e,"complete"),Hs(e,"error"))}function Ga(e){if(e.h&&"undefined"!=typeof Lr&&(!e.C[1]||4!=Qa(e)||2!=e.da()))if(e.v&&4==Qa(e))so(e.La,0,e);else if(Hs(e,"readystatechange"),4==Qa(e)){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===a){var r=String(e.I).match($o)[1]||null;!r&&Fr.self&&Fr.self.location&&(r=Fr.self.location.protocol.slice(0,-1)),i=!Ba.test(r?r.toLowerCase():"")}n=i}if(n)Hs(e,"complete"),Hs(e,"success");else{e.m=6;try{var s=2<Qa(e)?e.g.statusText:""}catch(o){s=""}e.j=s+" ["+e.da()+"]",Wa(e)}}finally{Ka(e)}}}function Ka(e,t){if(e.g){Ya(e);const i=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Hs(e,"ready");try{i.onreadystatechange=r}catch(n){}}}function Ya(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Fr.clearTimeout(e.A),e.A=null)}function Qa(e){return e.g?e.g.readyState:0}function Xa(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Va:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(tc){return null}}function $a(e){let t="";return ks(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Ja(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=$a(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ia(e,t,n))}function Za(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function el(e){this.Ga=0,this.j=[],this.l=new fo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Za("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Za("baseRetryDelayMs",5e3,e),this.hb=Za("retryDelaySeedMs",1e4,e),this.eb=Za("forwardChannelMaxRetries",2,e),this.xa=Za("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new xa(e&&e.concurrentRequestLimit),this.Ja=new Pa,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function tl(e){if(il(e),3==e.H){var t=e.W++,n=Zo(e.I);if(ia(n,"SID",e.K),ia(n,"RID",t),ia(n,"TYPE","terminate"),ol(e,n),(t=new jo(e,e.l,t)).L=2,t.v=ra(Zo(n)),n=!1,Fr.navigator&&Fr.navigator.sendBeacon)try{n=Fr.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&Fr.Image&&((new Image).src=t.v,n=!0),n||(t.g=vl(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Ho(t)}gl(e)}function nl(e){e.g&&(ul(e),e.g.cancel(),e.g=null)}function il(e){nl(e),e.u&&(Fr.clearTimeout(e.u),e.u=null),dl(e),e.i.cancel(),e.m&&("number"===typeof e.m&&Fr.clearTimeout(e.m),e.m=null)}function rl(e){if(!wa(e.i)&&!e.m){e.m=!0;var t=e.Na;Js||to(),Zs||(Js(),Zs=!0),eo.add(t,e),e.C=0}}function sl(e,t){var n;n=t?t.m:e.W++;const i=Zo(e.I);ia(i,"SID",e.K),ia(i,"RID",n),ia(i,"AID",e.V),ol(e,i),e.o&&e.s&&Ja(i,e.o,e.s),n=new jo(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=al(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Ea(e.i,n),zo(n,i,t)}function ol(e,t){e.na&&ks(e.na,function(e,n){ia(t,n,e)}),e.h&&Xo({},function(e,n){ia(t,n,e)})}function al(e,t,n){n=Math.min(e.j.length,n);var i=e.h?Wr(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{Aa(a,e,"req"+n+"_")}catch(dc){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function ll(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Js||to(),Zs||(Js(),Zs=!0),eo.add(t,e),e.A=0}}function cl(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=Co(Wr(e.Ma,e),pl(e,e.A)),e.A++,!0)}function ul(e){null!=e.B&&(Fr.clearTimeout(e.B),e.B=null)}function hl(e){e.g=new jo(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Zo(e.wa);ia(t,"RID","rpc"),ia(t,"SID",e.K),ia(t,"AID",e.V),ia(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&ia(t,"TO",e.qa),ia(t,"TYPE","xmlhttp"),ol(e,t),e.o&&e.s&&Ja(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=ra(Zo(t)),n.s=null,n.S=!0,Uo(n,e)}function dl(e){null!=e.v&&(Fr.clearTimeout(e.v),e.v=null)}function fl(e,t){var n=null;if(e.g==t){dl(e),ul(e),e.g=null;var i=2}else{if(!ka(e.i,t))return;n=t.F,Ta(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var r=e.C;Hs(i=yo(),new wo(i,n)),rl(e)}else ll(e);else if(3==(r=t.o)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(Ca(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=Co(Wr(e.Na,e,t),pl(e,e.C)),e.C++,!0))}(e,t)||2==i&&cl(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:ml(e,5);break;case 4:ml(e,10);break;case 3:ml(e,6);break;default:ml(e,2)}}function pl(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function ml(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=Wr(e.pb,e);n||(n=new Jo("//www.google.com/images/cleardot.gif"),Fr.location&&"http"==Fr.location.protocol||ea(n,"https"),ra(n)),function(e,t){const n=new fo;if(Fr.Image){const i=new Image;i.onload=Gr(Da,n,i,"TestLoadImage: loaded",!0,t),i.onerror=Gr(Da,n,i,"TestLoadImage: error",!1,t),i.onabort=Gr(Da,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=Gr(Da,n,i,"TestLoadImage: timeout",!1,t),Fr.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}(n.toString(),i)}else _o(2);e.H=0,e.h&&e.h.za(t),gl(e),il(e)}function gl(e){if(e.H=0,e.ma=[],e.h){const t=Na(e.i);0==t.length&&0==e.j.length||($r(e.ma,t),$r(e.ma,e.j),e.i.i.length=0,Xr(e.j),e.j.length=0),e.h.ya()}}function yl(e,t,n){var i=n instanceof Jo?Zo(n):new Jo(n);if(""!=i.g)t&&(i.g=t+"."+i.g),ta(i,i.m);else{var r=Fr.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new Jo(null);i&&ea(s,i),t&&(s.g=t),r&&ta(s,r),n&&(s.l=n),i=s}return n=e.F,t=e.Da,n&&t&&ia(i,n,t),ia(i,"VER",e.ra),ol(e,i),i}function vl(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Ua(new Ra({ob:!0})):new Ua(e.va)).Oa(e.J),t}function bl(){}function xl(){if(as&&!(10<=Number(ys)))throw Error("Environmental error: no available transport.")}function _l(e,t){qs.call(this),this.g=new el(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!es(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!es(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new kl(this)}function wl(e){Ao.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Cl(){Do.call(this),this.status=1}function kl(e){this.g=e}function El(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Tl(e,t,n){n||(n=0);var i=Array(16);if("string"===typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function Nl(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}(jr=Ua.prototype).Oa=function(e){this.M=e},jr.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Io.g(),this.C=this.u?No(this.u):No(Io),this.g.onreadystatechange=Wr(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void Ha(this,s)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!==typeof i.keys||"function"!==typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),r=Fr.FormData&&e instanceof Fr.FormData,!(0<=Qr(qa,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ya(this),0<this.B&&((this.L=function(e){return as&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Wr(this.ua,this)):this.A=so(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Ha(this,s)}},jr.ua=function(){"undefined"!=typeof Lr&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Hs(this,"timeout"),this.abort(8))},jr.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Hs(this,"complete"),Hs(this,"abort"),Ka(this))},jr.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ka(this,!0)),Ua.$.N.call(this)},jr.La=function(){this.s||(this.G||this.v||this.l?Ga(this):this.kb())},jr.kb=function(){Ga(this)},jr.isActive=function(){return!!this.g},jr.da=function(){try{return 2<Qa(this)?this.g.status:-1}catch(Sa){return-1}},jr.ja=function(){try{return this.g?this.g.responseText:""}catch(Sa){return""}},jr.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),za(t)}},jr.Ia=function(){return this.m},jr.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(jr=el.prototype).ra=8,jr.H=1,jr.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new jo(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Es(s),Ns(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"===typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=al(this,r,t),ia(n=Zo(this.I),"RID",e),ia(n,"CVER",22),this.F&&ia(n,"X-HTTP-Session-Id",this.F),ol(this,n),s&&(this.O?t="headers="+encodeURIComponent(String($a(s)))+"&"+t:this.o&&Ja(n,this.o,s)),Ea(this.i,r),this.bb&&ia(n,"TYPE","init"),this.P?(ia(n,"$req",t),ia(n,"SID","null"),r.aa=!0,zo(r,n,null)):zo(r,n,t),this.H=2}}else 3==this.H&&(e?sl(this,e):0==this.j.length||wa(this.i)||sl(this))},jr.Ma=function(){if(this.u=null,hl(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Co(Wr(this.jb,this),e)}},jr.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,_o(10),nl(this),hl(this))},jr.ib=function(){null!=this.v&&(this.v=null,nl(this),cl(this),_o(19))},jr.pb=function(e){e?(this.l.info("Successfully pinged google.com"),_o(2)):(this.l.info("Failed to ping google.com"),_o(1))},jr.isActive=function(){return!!this.h&&this.h.isActive(this)},(jr=bl.prototype).Ba=function(){},jr.Aa=function(){},jr.za=function(){},jr.ya=function(){},jr.isActive=function(){return!0},jr.Va=function(){},xl.prototype.g=function(e,t){return new _l(e,t)},Kr(_l,qs),_l.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;_o(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=yl(e,null,e.Y),rl(e)},_l.prototype.close=function(){tl(this.g)},_l.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Gs(e),e=n);t.j.push(new ba(t.fb++,e)),3==t.H&&rl(t)},_l.prototype.N=function(){this.g.h=null,delete this.j,tl(this.g),delete this.g,_l.$.N.call(this)},Kr(wl,Ao),Kr(Cl,Do),Kr(kl,bl),kl.prototype.Ba=function(){Hs(this.g,"a")},kl.prototype.Aa=function(e){Hs(this.g,new wl(e))},kl.prototype.za=function(e){Hs(this.g,new Cl)},kl.prototype.ya=function(){Hs(this.g,"b")},Kr(El,function(){this.blockSize=-1}),El.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},El.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,s=0;s<t;){if(0==r)for(;s<=n;)Tl(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[r++]=e.charCodeAt(s++),r==this.blockSize){Tl(this,i),r=0;break}}else for(;s<t;)if(i[r++]=e[s++],r==this.blockSize){Tl(this,i),r=0;break}}this.h=r,this.i+=t},El.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var Sl={};function Il(e){return-128<=e&&128>e?function(e,t){var n=Sl;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new Nl([0|e],0>e?-1:0)}):new Nl([0|e],0>e?-1:0)}function Pl(e){if(isNaN(e)||!isFinite(e))return Dl;if(0>e)return Ll(Pl(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=Al;return new Nl(t,0)}var Al=4294967296,Dl=Il(0),Rl=Il(1),jl=Il(16777216);function Ml(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Ol(e){return-1==e.h}function Ll(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new Nl(n,~e.h).add(Rl)}function Fl(e,t){return e.add(Ll(t))}function zl(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Ul(e,t){this.g=e,this.h=t}function Vl(e,t){if(Ml(t))throw Error("division by zero");if(Ml(e))return new Ul(Dl,Dl);if(Ol(e))return t=Vl(Ll(e),t),new Ul(Ll(t.g),Ll(t.h));if(Ol(t))return t=Vl(e,Ll(t)),new Ul(Ll(t.g),t.h);if(30<e.g.length){if(Ol(e)||Ol(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Rl,i=t;0>=i.X(e);)n=Bl(n),i=Bl(i);var r=ql(n,1),s=ql(i,1);for(i=ql(i,2),n=ql(n,2);!Ml(i);){var o=s.add(i);0>=o.X(e)&&(r=r.add(n),s=o),i=ql(i,1),n=ql(n,1)}return t=Fl(e,r.R(t)),new Ul(r,t)}for(r=Dl;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=Pl(n)).R(t);Ol(o)||0<o.X(e);)o=(s=Pl(n-=i)).R(t);Ml(s)&&(s=Rl),r=r.add(s),e=Fl(e,o)}return new Ul(r,e)}function Bl(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new Nl(n,e.h)}function ql(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],s=0;s<i;s++)r[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Nl(r,e.h)}(jr=Nl.prototype).ea=function(){if(Ol(this))return-Ll(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:Al+i)*t,t*=Al}return e},jr.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Ml(this))return"0";if(Ol(this))return"-"+Ll(this).toString(e);for(var t=Pl(Math.pow(e,6)),n=this,i="";;){var r=Vl(n,t).g,s=((0<(n=Fl(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Ml(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},jr.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},jr.X=function(e){return Ol(e=Fl(this,e))?-1:Ml(e)?0:1},jr.abs=function(){return Ol(this)?Ll(this):this},jr.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var s=i+(65535&this.D(r))+(65535&e.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new Nl(n,-2147483648&n[n.length-1]?-1:0)},jr.R=function(e){if(Ml(this)||Ml(e))return Dl;if(Ol(this))return Ol(e)?Ll(this).R(Ll(e)):Ll(Ll(this).R(e));if(Ol(e))return Ll(this.R(Ll(e)));if(0>this.X(jl)&&0>e.X(jl))return Pl(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=e.D(r)>>>16,l=65535&e.D(r);n[2*i+2*r]+=o*l,zl(n,2*i+2*r),n[2*i+2*r+1]+=s*l,zl(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,zl(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,zl(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new Nl(n,0)},jr.gb=function(e){return Vl(this,e).h},jr.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new Nl(n,this.h&e.h)},jr.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new Nl(n,this.h|e.h)},jr.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new Nl(n,this.h^e.h)},xl.prototype.createWebChannel=xl.prototype.g,_l.prototype.send=_l.prototype.u,_l.prototype.open=_l.prototype.m,_l.prototype.close=_l.prototype.close,ko.NO_ERROR=0,ko.TIMEOUT=8,ko.HTTP_ERROR=6,Eo.COMPLETE="complete",So.EventType=Po,Po.OPEN="a",Po.CLOSE="b",Po.ERROR="c",Po.MESSAGE="d",qs.prototype.listen=qs.prototype.O,Ua.prototype.listenOnce=Ua.prototype.P,Ua.prototype.getLastError=Ua.prototype.Sa,Ua.prototype.getLastErrorCode=Ua.prototype.Ia,Ua.prototype.getStatus=Ua.prototype.da,Ua.prototype.getResponseJson=Ua.prototype.Wa,Ua.prototype.getResponseText=Ua.prototype.ja,Ua.prototype.send=Ua.prototype.ha,Ua.prototype.setWithCredentials=Ua.prototype.Oa,El.prototype.digest=El.prototype.l,El.prototype.reset=El.prototype.reset,El.prototype.update=El.prototype.j,Nl.prototype.add=Nl.prototype.add,Nl.prototype.multiply=Nl.prototype.R,Nl.prototype.modulo=Nl.prototype.gb,Nl.prototype.compare=Nl.prototype.X,Nl.prototype.toNumber=Nl.prototype.ea,Nl.prototype.toString=Nl.prototype.toString,Nl.prototype.getBits=Nl.prototype.D,Nl.fromNumber=Pl,Nl.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Ll(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Pl(Math.pow(n,8)),r=Dl,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Pl(Math.pow(n,o)),r=r.R(o).add(Pl(a))):r=(r=r.R(i)).add(Pl(a))}return r};var Hl=Or.createWebChannelTransport=function(){return new xl},Wl=Or.getStatEventTarget=function(){return yo()},Gl=Or.ErrorCode=ko,Kl=Or.EventType=Eo,Yl=Or.Event=mo,Ql=Or.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Xl=Or.FetchXmlHttpFactory=Ra,$l=Or.WebChannel=So,Jl=Or.XhrIo=Ua,Zl=Or.Md5=El,ec=Or.Integer=Nl;const tc="@firebase/firestore";class nc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nc.UNAUTHENTICATED=new nc(null),nc.GOOGLE_CREDENTIALS=new nc("google-credentials-uid"),nc.FIRST_PARTY=new nc("first-party-uid"),nc.MOCK_USER=new nc("mock-user");let ic="9.23.0";const rc=new me("@firebase/firestore");function sc(){return rc.logLevel}function oc(e){if(rc.logLevel<=ue.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(cc);rc.debug("Firestore (".concat(ic,"): ").concat(e),...r)}}function ac(e){if(rc.logLevel<=ue.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(cc);rc.error("Firestore (".concat(ic,"): ").concat(e),...r)}}function lc(e){if(rc.logLevel<=ue.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.map(cc);rc.warn("Firestore (".concat(ic,"): ").concat(e),...r)}}function cc(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function uc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(ic,") INTERNAL ASSERTION FAILED: ")+e;throw ac(t),new Error(t)}function hc(e,t){e||uc()}function dc(e,t){return e}const fc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pc extends F{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class mc{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class gc{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class yc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(nc.UNAUTHENTICATED))}shutdown(){}}class vc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class bc{constructor(e){this.t=e,this.currentUser=nc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new mc;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new mc,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const t=r;e.enqueueRetryable(async()=>{await t.promise,await i(this.currentUser)})},o=e=>{oc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(oc("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new mc)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(oc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(hc("string"==typeof t.accessToken),new gc(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return hc(null===e||"string"==typeof e),new nc(e)}}class xc{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=nc.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class _c{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new xc(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(nc.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cc{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&oc("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.T;return this.T=e.token,oc("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const i=e=>{oc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?i(e):oc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(hc("string"==typeof e.token),this.T=e.token,new wc(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function kc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}class Ec{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=kc(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<t&&(n+=e.charAt(i[r]%62))}return n}}function Tc(e,t){return e<t?-1:e>t?1:0}function Nc(e,t,n){return e.length===t.length&&e.every((e,i)=>n(e,t[i]))}class Sc{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pc(fc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pc(fc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new pc(fc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pc(fc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sc.fromMillis(Date.now())}static fromDate(e){return Sc.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Sc(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Tc(this.nanoseconds,e.nanoseconds):Tc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ic{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ic(e)}static min(){return new Ic(new Sc(0,0))}static max(){return new Ic(new Sc(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Pc{constructor(e,t,n){void 0===t?t=0:t>e.length&&uc(),void 0===n?n=e.length-t:n>e.length-t&&uc(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Pc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pc?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ac extends Pc{construct(e,t,n){return new Ac(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n){if(r.indexOf("//")>=0)throw new pc(fc.INVALID_ARGUMENT,"Invalid segment (".concat(r,"). Paths must not contain // in them."));e.push(...r.split("/").filter(e=>e.length>0))}return new Ac(e)}static emptyPath(){return new Ac([])}}const Dc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rc extends Pc{construct(e,t,n){return new Rc(e,t,n)}static isValidIdentifier(e){return Dc.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rc.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Rc(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new pc(fc.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new pc(fc.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new pc(fc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new pc(fc.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rc(t)}static emptyPath(){return new Rc([])}}class jc{constructor(e){this.path=e}static fromPath(e){return new jc(Ac.fromString(e))}static fromName(e){return new jc(Ac.fromString(e).popFirst(5))}static empty(){return new jc(Ac.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ac.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ac.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jc(new Ac(e.slice()))}}class Mc{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}Mc.UNKNOWN_ID=-1;function Oc(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Ic.fromTimestamp(1e9===i?new Sc(n+1,0):new Sc(n,i));return new Fc(r,jc.empty(),t)}function Lc(e){return new Fc(e.readTime,e.key,-1)}class Fc{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Fc(Ic.min(),jc.empty(),-1)}static max(){return new Fc(Ic.max(),jc.empty(),-1)}}function zc(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=jc.comparator(e.documentKey,t.documentKey),0!==n?n:Tc(e.largestBatchId,t.largestBatchId))}const Uc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Vc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Bc(e){if(e.code!==fc.FAILED_PRECONDITION||e.message!==Uc)throw e;oc("LocalStore","Unexpectedly lost primary lease")}class qc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&uc(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new qc((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof qc?t:qc.resolve(t)}catch(e){return qc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):qc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):qc.reject(t)}static resolve(e){return new qc((t,n)=>{t(e)})}static reject(e){return new qc((t,n)=>{n(e)})}static waitFor(e){return new qc((t,n)=>{let i=0,r=0,s=!1;e.forEach(e=>{++i,e.next(()=>{++r,s&&r===i&&t()},e=>n(e))}),s=!0,r===i&&t()})}static or(e){let t=qc.resolve(!1);for(const n of e)t=t.next(e=>e?qc.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,i)=>{n.push(t.call(this,e,i))}),this.waitFor(n)}static mapArray(e,t){return new qc((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===r&&n(s)},e=>i(e))}})}static doWhile(e,t){return new qc((n,i)=>{const r=()=>{!0===e()?t().next(()=>{r()},i):n()};r()})}}function Hc(e){return"IndexedDbTransactionError"===e.name}class Wc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function Gc(e){return null==e}function Kc(e){return 0===e&&1/e==-1/0}function Yc(e){return"number"==typeof e&&Number.isInteger(e)&&!Kc(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}Wc.ct=-1;const Qc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Xc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$c=Xc;function Jc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Zc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function eu(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class tu{constructor(e,t){this.comparator=e,this.root=t||iu.EMPTY}insert(e,t){return new tu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,iu.BLACK,null,null))}remove(e){return new tu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,iu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nu(this.root,e,this.comparator,!1)}getReverseIterator(){return new nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nu(this.root,e,this.comparator,!0)}}class nu{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class iu{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:iu.RED,this.left=null!=i?i:iu.EMPTY,this.right=null!=r?r:iu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new iu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return iu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return iu.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,iu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,iu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw uc();if(this.right.isRed())throw uc();const e=this.left.check();if(e!==this.right.check())throw uc();return e+(this.isRed()?0:1)}}iu.EMPTY=null,iu.RED=!0,iu.BLACK=!1,iu.EMPTY=new class{constructor(){this.size=0}get key(){throw uc()}get value(){throw uc()}get color(){throw uc()}get left(){throw uc()}get right(){throw uc()}copy(e,t,n,i,r){return this}insert(e,t,n){return new iu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ru{constructor(e){this.comparator=e,this.data=new tu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new su(this.data.getIterator())}getIteratorFrom(e){return new su(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ru))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ru(this.comparator);return t.data=e,t}}class su{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ou{constructor(e){this.fields=e,e.sort(Rc.comparator)}static empty(){return new ou([])}unionWith(e){let t=new ru(Rc.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ou(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nc(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class au extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lu{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new au("Invalid base64 string: "+e):e}}(e);return new lu(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new lu(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Tc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lu.EMPTY_BYTE_STRING=new lu("");const cu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uu(e){if(hc(!!e),"string"==typeof e){let t=0;const n=cu.exec(e);if(hc(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:hu(e.seconds),nanos:hu(e.nanos)}}function hu(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function du(e){return"string"==typeof e?lu.fromBase64String(e):lu.fromUint8Array(e)}function fu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pu(e){const t=e.mapValue.fields.__previous_value__;return fu(t)?pu(t):t}function mu(e){const t=uu(e.mapValue.fields.__local_write_time__.timestampValue);return new Sc(t.seconds,t.nanos)}class gu{constructor(e,t,n,i,r,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class yu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof yu&&e.projectId===this.projectId&&e.database===this.database}}const vu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function bu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?fu(e)?4:Ru(e)?9007199254740991:10:uc()}function xu(e,t){if(e===t)return!0;const n=bu(e);if(n!==bu(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return mu(e).isEqual(mu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=uu(e.timestampValue),i=uu(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return du(e.bytesValue).isEqual(du(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return hu(e.geoPointValue.latitude)===hu(t.geoPointValue.latitude)&&hu(e.geoPointValue.longitude)===hu(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return hu(e.integerValue)===hu(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=hu(e.doubleValue),i=hu(t.doubleValue);return n===i?Kc(n)===Kc(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Nc(e.arrayValue.values||[],t.arrayValue.values||[],xu);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Jc(n)!==Jc(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!xu(n[r],i[r])))return!1;return!0}(e,t);default:return uc()}}function _u(e,t){return void 0!==(e.values||[]).find(e=>xu(e,t))}function wu(e,t){if(e===t)return 0;const n=bu(e),i=bu(t);if(n!==i)return Tc(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Tc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=hu(e.integerValue||e.doubleValue),i=hu(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Cu(e.timestampValue,t.timestampValue);case 4:return Cu(mu(e),mu(t));case 5:return Tc(e.stringValue,t.stringValue);case 6:return function(e,t){const n=du(e),i=du(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=Tc(n[r],i[r]);if(0!==e)return e}return Tc(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Tc(hu(e.latitude),hu(t.latitude));return 0!==n?n:Tc(hu(e.longitude),hu(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=wu(n[r],i[r]);if(e)return e}return Tc(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===vu.mapValue&&t===vu.mapValue)return 0;if(e===vu.mapValue)return 1;if(t===vu.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const e=Tc(i[o],s[o]);if(0!==e)return e;const t=wu(n[i[o]],r[s[o]]);if(0!==t)return t}return Tc(i.length,s.length)}(e.mapValue,t.mapValue);default:throw uc()}}function Cu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Tc(e,t);const n=uu(e),i=uu(t),r=Tc(n.seconds,i.seconds);return 0!==r?r:Tc(n.nanos,i.nanos)}function ku(e){return Eu(e)}function Eu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=uu(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?du(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,jc.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Eu(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+="".concat(r,":").concat(Eu(e.fields[r]));return n+"}"}(e.mapValue):uc();var t,n}function Tu(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Nu(e){return!!e&&"integerValue"in e}function Su(e){return!!e&&"arrayValue"in e}function Iu(e){return!!e&&"nullValue"in e}function Pu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Au(e){return!!e&&"mapValue"in e}function Du(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Zc(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Du(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Du(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ru(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class ju{constructor(e){this.value=e}static empty(){return new ju({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Au(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Du(t)}setAll(e){let t=Rc.emptyPath(),n={},i=[];e.forEach((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=Du(e):i.push(r.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Au(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Au(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Zc(t,(t,n)=>e[t]=n);for(const i of n)delete e[i]}clone(){return new ju(Du(this.value))}}function Mu(e){const t=[];return Zc(e.fields,(e,n)=>{const i=new Rc([e]);if(Au(n)){const e=Mu(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)}),new ou(t)}class Ou{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ou(e,0,Ic.min(),Ic.min(),Ic.min(),ju.empty(),0)}static newFoundDocument(e,t,n,i){return new Ou(e,1,t,Ic.min(),n,i,0)}static newNoDocument(e,t){return new Ou(e,2,t,Ic.min(),Ic.min(),ju.empty(),0)}static newUnknownDocument(e,t){return new Ou(e,3,t,Ic.min(),Ic.min(),ju.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ic.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ju.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ju.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ic.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ou&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ou(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Lu{constructor(e,t){this.position=e,this.inclusive=t}}function Fu(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?jc.comparator(jc.fromName(o.referenceValue),n.key):wu(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function zu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!xu(e.position[n],t.position[n]))return!1;return!0}class Uu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Vu(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Bu{}class qu extends Bu{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new $u(e,t,n):"array-contains"===t?new th(e,n):"in"===t?new nh(e,n):"not-in"===t?new ih(e,n):"array-contains-any"===t?new rh(e,n):new qu(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Ju(e,n):new Zu(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(wu(t,this.value)):null!==t&&bu(this.value)===bu(t)&&this.matchesComparison(wu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return uc()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Hu extends Bu{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Hu(e,t)}matches(e){return Wu(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(e=>e.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Wu(e){return"and"===e.op}function Gu(e){return Ku(e)&&Wu(e)}function Ku(e){for(const t of e.filters)if(t instanceof Hu)return!1;return!0}function Yu(e){if(e instanceof qu)return e.field.canonicalString()+e.op.toString()+ku(e.value);if(Gu(e))return e.filters.map(e=>Yu(e)).join(",");{const t=e.filters.map(e=>Yu(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Qu(e,t){return e instanceof qu?function(e,t){return t instanceof qu&&e.op===t.op&&e.field.isEqual(t.field)&&xu(e.value,t.value)}(e,t):e instanceof Hu?function(e,t){return t instanceof Hu&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,i)=>e&&Qu(n,t.filters[i]),!0)}(e,t):void uc()}function Xu(e){return e instanceof qu?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ku(e.value))}(e):e instanceof Hu?function(e){return e.op.toString()+" {"+e.getFilters().map(Xu).join(" ,")+"}"}(e):"Filter"}class $u extends qu{constructor(e,t,n){super(e,t,n),this.key=jc.fromName(n.referenceValue)}matches(e){const t=jc.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ju extends qu{constructor(e,t){super(e,"in",t),this.keys=eh("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Zu extends qu{constructor(e,t){super(e,"not-in",t),this.keys=eh("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function eh(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>jc.fromName(e.referenceValue))}class th extends qu{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Su(t)&&_u(t.arrayValue,this.value)}}class nh extends qu{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&_u(this.value.arrayValue,t)}}class ih extends qu{constructor(e,t){super(e,"not-in",t)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!_u(this.value.arrayValue,t)}}class rh extends qu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Su(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>_u(this.value.arrayValue,e))}}class sh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.dt=null}}function oh(e){return new sh(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function ah(e){const t=dc(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Yu(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Gc(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ku(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ku(e)).join(",")),t.dt=e}return t.dt}function lh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Vu(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Qu(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!zu(e.startAt,t.startAt)&&zu(e.endAt,t.endAt)}function ch(e){return jc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class uh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function hh(e,t,n,i,r,s,o,a){return new uh(e,t,n,i,r,s,o,a)}function dh(e){return new uh(e)}function fh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ph(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function mh(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function gh(e){return null!==e.collectionGroup}function yh(e){const t=dc(e);if(null===t.wt){t.wt=[];const e=mh(t),n=ph(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Uu(e)),t.wt.push(new Uu(Rc.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Uu(Rc.keyField(),e))}}}return t.wt}function vh(e){const t=dc(e);if(!t._t)if("F"===t.limitType)t._t=oh(t.path,t.collectionGroup,yh(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const r of yh(t)){const t="desc"===r.dir?"asc":"desc";e.push(new Uu(r.field,t))}const n=t.endAt?new Lu(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Lu(t.startAt.position,t.startAt.inclusive):null;t._t=oh(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t._t}function bh(e,t){t.getFirstInequalityField(),mh(e);const n=e.filters.concat([t]);return new uh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function xh(e,t,n){return new uh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function _h(e,t){return lh(vh(e),vh(t))&&e.limitType===t.limitType}function wh(e){return"".concat(ah(vh(e)),"|lt:").concat(e.limitType)}function Ch(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Xu(e)).join(", "),"]")),Gc(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ku(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ku(e)).join(",")),"Target(".concat(t,")")}(vh(e)),"; limitType=").concat(e.limitType,")")}function kh(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):jc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of yh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=Fu(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,yh(e),t))&&!(e.endAt&&!function(e,t,n){const i=Fu(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,yh(e),t))}(e,t)}function Eh(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Th(e){return(t,n)=>{let i=!1;for(const r of yh(e)){const e=Nh(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function Nh(e,t,n){const i=e.field.isKeyField()?jc.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?wu(i,r):uc()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return uc()}}class Sh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zc(this.inner,(t,n)=>{for(const[i,r]of n)e(i,r)})}isEmpty(){return eu(this.inner)}size(){return this.innerSize}}const Ih=new tu(jc.comparator);function Ph(){return Ih}const Ah=new tu(jc.comparator);function Dh(){let e=Ah;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.insert(r.key,r);return e}function Rh(e){let t=Ah;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function jh(){return Oh()}function Mh(){return Oh()}function Oh(){return new Sh(e=>e.toString(),(e,t)=>e.isEqual(t))}const Lh=new tu(jc.comparator),Fh=new ru(jc.comparator);function zh(){let e=Fh;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)e=e.add(r);return e}const Uh=new ru(Tc);function Vh(){return Uh}function Bh(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kc(t)?"-0":t}}function qh(e){return{integerValue:""+e}}function Hh(e,t){return Yc(t)?qh(t):Bh(e,t)}class Wh{constructor(){this._=void 0}}function Gh(e,t,n){return e instanceof Qh?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&fu(t)&&(t=pu(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Xh?$h(e,t):e instanceof Jh?Zh(e,t):function(e,t){const n=Yh(e,t),i=td(n)+td(e.gt);return Nu(n)&&Nu(e.gt)?qh(i):Bh(e.serializer,i)}(e,t)}function Kh(e,t,n){return e instanceof Xh?$h(e,t):e instanceof Jh?Zh(e,t):n}function Yh(e,t){return e instanceof ed?Nu(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class Qh extends Wh{}class Xh extends Wh{constructor(e){super(),this.elements=e}}function $h(e,t){const n=nd(t);for(const i of e.elements)n.some(e=>xu(e,i))||n.push(i);return{arrayValue:{values:n}}}class Jh extends Wh{constructor(e){super(),this.elements=e}}function Zh(e,t){let n=nd(t);for(const i of e.elements)n=n.filter(e=>!xu(e,i));return{arrayValue:{values:n}}}class ed extends Wh{constructor(e,t){super(),this.serializer=e,this.gt=t}}function td(e){return hu(e.integerValue||e.doubleValue)}function nd(e){return Su(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class id{constructor(e,t){this.field=e,this.transform=t}}class rd{constructor(e,t){this.version=e,this.transformResults=t}}class sd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sd}static exists(e){return new sd(void 0,e)}static updateTime(e){return new sd(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function od(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ad{}function ld(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new vd(e.key,sd.none()):new fd(e.key,e.data,sd.none());{const n=e.data,i=ju.empty();let r=new ru(Rc.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new pd(e.key,i,new ou(r.toArray()),sd.none())}}function cd(e,t,n){e instanceof fd?function(e,t,n){const i=e.value.clone(),r=gd(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof pd?function(e,t,n){if(!od(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=gd(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(md(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ud(e,t,n,i){return e instanceof fd?function(e,t,n,i){if(!od(e.precondition,t))return n;const r=e.value.clone(),s=yd(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof pd?function(e,t,n,i){if(!od(e.precondition,t))return n;const r=yd(e.fieldTransforms,i,t),s=t.data;return s.setAll(md(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,i):function(e,t,n){return od(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function hd(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=Yh(i.transform,e||null);null!=r&&(null===n&&(n=ju.empty()),n.set(i.field,r))}return n||null}function dd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Nc(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Xh&&t instanceof Xh||e instanceof Jh&&t instanceof Jh?Nc(e.elements,t.elements,xu):e instanceof ed&&t instanceof ed?xu(e.gt,t.gt):e instanceof Qh&&t instanceof Qh}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class fd extends ad{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class pd extends ad{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function md(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function gd(e,t,n){const i=new Map;hc(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,Kh(o,a,n[r]))}return i}function yd(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,Gh(e,s,t))}return i}class vd extends ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class bd extends ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xd{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&cd(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ud(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ud(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Mh();return this.mutations.forEach(i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=ld(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Ic.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),zh())}isEqual(e){return this.batchId===e.batchId&&Nc(this.mutations,e.mutations,(e,t)=>dd(e,t))&&Nc(this.baseMutations,e.baseMutations,(e,t)=>dd(e,t))}}class _d{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){hc(e.mutations.length===n.length);let i=Lh;const r=e.mutations;for(let s=0;s<r.length;s++)i=i.insert(r[s].key,n[s].version);return new _d(e,t,n,i)}}class wd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Cd{constructor(e,t){this.count=e,this.unchangedNames=t}}var kd,Ed;function Td(e){switch(e){default:return uc();case fc.CANCELLED:case fc.UNKNOWN:case fc.DEADLINE_EXCEEDED:case fc.RESOURCE_EXHAUSTED:case fc.INTERNAL:case fc.UNAVAILABLE:case fc.UNAUTHENTICATED:return!1;case fc.INVALID_ARGUMENT:case fc.NOT_FOUND:case fc.ALREADY_EXISTS:case fc.PERMISSION_DENIED:case fc.FAILED_PRECONDITION:case fc.ABORTED:case fc.OUT_OF_RANGE:case fc.UNIMPLEMENTED:case fc.DATA_LOSS:return!0}}function Nd(e){if(void 0===e)return ac("GRPC error has no .code"),fc.UNKNOWN;switch(e){case kd.OK:return fc.OK;case kd.CANCELLED:return fc.CANCELLED;case kd.UNKNOWN:return fc.UNKNOWN;case kd.DEADLINE_EXCEEDED:return fc.DEADLINE_EXCEEDED;case kd.RESOURCE_EXHAUSTED:return fc.RESOURCE_EXHAUSTED;case kd.INTERNAL:return fc.INTERNAL;case kd.UNAVAILABLE:return fc.UNAVAILABLE;case kd.UNAUTHENTICATED:return fc.UNAUTHENTICATED;case kd.INVALID_ARGUMENT:return fc.INVALID_ARGUMENT;case kd.NOT_FOUND:return fc.NOT_FOUND;case kd.ALREADY_EXISTS:return fc.ALREADY_EXISTS;case kd.PERMISSION_DENIED:return fc.PERMISSION_DENIED;case kd.FAILED_PRECONDITION:return fc.FAILED_PRECONDITION;case kd.ABORTED:return fc.ABORTED;case kd.OUT_OF_RANGE:return fc.OUT_OF_RANGE;case kd.UNIMPLEMENTED:return fc.UNIMPLEMENTED;case kd.DATA_LOSS:return fc.DATA_LOSS;default:return uc()}}(Ed=kd||(kd={}))[Ed.OK=0]="OK",Ed[Ed.CANCELLED=1]="CANCELLED",Ed[Ed.UNKNOWN=2]="UNKNOWN",Ed[Ed.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ed[Ed.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ed[Ed.NOT_FOUND=5]="NOT_FOUND",Ed[Ed.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ed[Ed.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ed[Ed.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ed[Ed.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ed[Ed.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ed[Ed.ABORTED=10]="ABORTED",Ed[Ed.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ed[Ed.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ed[Ed.INTERNAL=13]="INTERNAL",Ed[Ed.UNAVAILABLE=14]="UNAVAILABLE",Ed[Ed.DATA_LOSS=15]="DATA_LOSS";class Sd{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Id}static getOrCreateInstance(){return null===Id&&(Id=new Sd),Id}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Id=null;function Pd(){return new TextEncoder}const Ad=new ec([4294967295,4294967295],0);function Dd(e){const t=Pd().encode(e),n=new Zl;return n.update(t),new Uint8Array(n.digest())}function Rd(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new ec([n,i],0),new ec([r,s],0)]}class jd{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Md("Invalid padding: ".concat(t));if(n<0)throw new Md("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Md("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Md("Invalid padding when bitmap length is 0: ".concat(t));this.It=8*e.length-t,this.Tt=ec.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(ec.fromNumber(n)));return 1===i.compare(Ad)&&(i=new ec([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=Dd(e),[n,i]=Rd(t);for(let r=0;r<this.hashCount;r++){const e=this.Et(n,i,r);if(!this.At(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),s=new jd(r,i,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.It)return;const t=Dd(e),[n,i]=Rd(t);for(let r=0;r<this.hashCount;r++){const e=this.Et(n,i,r);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Md extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Od{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Ld.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Od(Ic.min(),i,new tu(Tc),Ph(),zh())}}class Ld{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ld(n,t,zh(),zh(),zh())}}class Fd{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class zd{constructor(e,t){this.targetId=e,this.Vt=t}}class Ud{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lu.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Vd{constructor(){this.St=0,this.Dt=Hd(),this.Ct=lu.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=zh(),t=zh(),n=zh();return this.Dt.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:uc()}}),new Ld(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Hd()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Bd{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Ph(),this.zt=qd(),this.Wt=new tu(Tc)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:uc()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((e,n)=>{this.te(n)&&t(n)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,r=this.se(n);if(r){const s=r.target;if(ch(s))if(0===i){const e=new jc(s.path);this.Yt(n,e,Ou.newNoDocument(e,Ic.min()))}else hc(1===i);else{const r=this.ie(n);if(r!==i){const i=this.re(e,r);if(0!==i){this.ee(n);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=Sd.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var i,r,s,o,a,l;const c={localCacheCount:t,existenceFilterCount:n.count},u=n.unchangedNames;return u&&(c.bloomFilter={applied:0===e,hashCount:null!==(i=null==u?void 0:u.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(o=null===(s=null===(r=null==u?void 0:u.bits)||void 0===r?void 0:r.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===(a=null==u?void 0:u.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),c}(i,r,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let a,l;try{a=du(r).toUint8Array()}catch(e){if(e instanceof au)return lc("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{l=new jd(a,s,o)}catch(e){return lc(e instanceof Md?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(n=>{const r=this.Gt.ue(),s="projects/".concat(r.projectId,"/databases/").concat(r.database,"/documents/").concat(n.path.canonicalString());t.vt(s)||(this.Yt(e,n,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((n,i)=>{const r=this.se(i);if(r){if(n.current&&ch(r.target)){const t=new jc(r.target.path);null!==this.jt.get(t)||this.ae(i,t)||this.Yt(i,t,Ou.newNoDocument(t,e))}n.Mt&&(t.set(i,n.Ot()),n.Ft())}});let n=zh();this.zt.forEach((e,t)=>{let i=!0;t.forEachWhile(e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)}),i&&(n=n.add(e))}),this.jt.forEach((t,n)=>n.setReadTime(e));const i=new Od(e,t,this.Wt,this.jt,n);return this.jt=Ph(),this.zt=qd(),this.Wt=new tu(Tc),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Vd,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new ru(Tc),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||oc("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Vd),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function qd(){return new tu(jc.comparator)}function Hd(){return new tu(jc.comparator)}const Wd={asc:"ASCENDING",desc:"DESCENDING"},Gd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Kd={and:"AND",or:"OR"};class Yd{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Qd(e,t){return e.useProto3Json||Gc(t)?t:{value:t}}function Xd(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function $d(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Jd(e,t){return Xd(e,t.toTimestamp())}function Zd(e){return hc(!!e),Ic.fromTimestamp(function(e){const t=uu(e);return new Sc(t.seconds,t.nanos)}(e))}function ef(e,t){return function(e){return new Ac(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function tf(e){const t=Ac.fromString(e);return hc(wf(t)),t}function nf(e,t){return ef(e.databaseId,t.path)}function rf(e,t){const n=tf(t);if(n.get(1)!==e.databaseId.projectId)throw new pc(fc.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new pc(fc.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new jc(lf(n))}function sf(e,t){return ef(e.databaseId,t)}function of(e){const t=tf(e);return 4===t.length?Ac.emptyPath():lf(t)}function af(e){return new Ac(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function lf(e){return hc(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function cf(e,t,n){return{name:nf(e,t),fields:n.value.mapValue.fields}}function uf(e,t){let n;if(t instanceof fd)n={update:cf(e,t.key,t.value)};else if(t instanceof vd)n={delete:nf(e,t.key)};else if(t instanceof pd)n={update:cf(e,t.key,t.data),updateMask:_f(t.fieldMask)};else{if(!(t instanceof bd))return uc();n={verify:nf(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Qh)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Xh)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Jh)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ed)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw uc()}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Jd(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:uc()}(e,t.precondition)),n}function hf(e,t){return{documents:[sf(e,t.path)]}}function df(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=sf(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=sf(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(e){if(0!==e.length)return xf(Hu.create(e,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:vf(e.field),direction:mf(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Qd(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ff(e){let t=of(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){hc(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=pf(e);return t instanceof Hu&&Gu(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>function(e){return new Uu(bf(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Gc(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Lu(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Lu(n,t)}(n.endAt)),hh(t,r,o,s,a,"F",l,c)}function pf(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=bf(e.unaryFilter.field);return qu.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=bf(e.unaryFilter.field);return qu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=bf(e.unaryFilter.field);return qu.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=bf(e.unaryFilter.field);return qu.create(r,"!=",{nullValue:"NULL_VALUE"});default:return uc()}}(e):void 0!==e.fieldFilter?function(e){return qu.create(bf(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return uc()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Hu.create(e.compositeFilter.filters.map(e=>pf(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return uc()}}(e.compositeFilter.op))}(e):uc()}function mf(e){return Wd[e]}function gf(e){return Gd[e]}function yf(e){return Kd[e]}function vf(e){return{fieldPath:e.canonicalString()}}function bf(e){return Rc.fromServerFormat(e.fieldPath)}function xf(e){return e instanceof qu?function(e){if("=="===e.op){if(Pu(e.value))return{unaryFilter:{field:vf(e.field),op:"IS_NAN"}};if(Iu(e.value))return{unaryFilter:{field:vf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Pu(e.value))return{unaryFilter:{field:vf(e.field),op:"IS_NOT_NAN"}};if(Iu(e.value))return{unaryFilter:{field:vf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vf(e.field),op:gf(e.op),value:e.value}}}(e):e instanceof Hu?function(e){const t=e.getFilters().map(e=>xf(e));return 1===t.length?t[0]:{compositeFilter:{op:yf(e.op),filters:t}}}(e):uc()}function _f(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function wf(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Cf{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ic.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ic.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:lu.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Cf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class kf{constructor(e){this.fe=e}}function Ef(e){const t=ff({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?xh(t,t.limit,"L"):t}class Tf{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(hu(e.integerValue));else if("doubleValue"in e){const n=hu(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Kc(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie("".concat(n.seconds||"")),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(du(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?Ru(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):uc()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),jc.fromName(e).path.forEach(e=>{this.ye(t,60),this.be(e,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Tf.Ve=new Tf;class Nf{constructor(){this.rn=new Sf}addToCollectionParentIndex(e,t){return this.rn.add(t),qc.resolve()}getCollectionParents(e,t){return qc.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return qc.resolve()}deleteFieldIndex(e,t){return qc.resolve()}getDocumentsMatchingTarget(e,t){return qc.resolve(null)}getIndexType(e,t){return qc.resolve(0)}getFieldIndexes(e,t){return qc.resolve([])}getNextCollectionGroupToUpdate(e){return qc.resolve(null)}getMinOffset(e,t){return qc.resolve(Fc.min())}getMinOffsetFromCollectionGroup(e,t){return qc.resolve(Fc.min())}updateCollectionGroup(e,t,n){return qc.resolve()}updateIndexEntries(e,t){return qc.resolve()}}class Sf{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ru(Ac.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ru(Ac.comparator)).toArray()}}new Uint8Array(0);class If{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new If(e,If.DEFAULT_COLLECTION_PERCENTILE,If.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}If.DEFAULT_COLLECTION_PERCENTILE=10,If.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,If.DEFAULT=new If(41943040,If.DEFAULT_COLLECTION_PERCENTILE,If.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),If.DISABLED=new If(-1,0,0);class Pf{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Pf(0)}static Mn(){return new Pf(-1)}}class Af{constructor(){this.changes=new Sh(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ou.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?qc.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Df{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Rf{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&ud(n.mutation,e,ou.empty(),Sc.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,zh()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zh();const i=jh();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(e=>{let t=Dh();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=jh();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,zh()))}populateOverlays(e,t,n){const i=[];return n.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,i){let r=Ph();const s=Oh(),o=Oh();return t.forEach((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof pd)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),ud(o.mutation,t,o.mutation.getFieldMask(),Sc.now())):s.set(t.key,ou.empty())}),this.recalculateAndSaveOverlays(e,r).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new Df(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Oh();let i=new tu((e,t)=>e-t),r=zh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const r of e)r.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||ou.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||zh()).add(e);i=i.insert(r.batchId,a)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,l=i.value,c=Mh();l.forEach(e=>{if(!r.has(e)){const i=ld(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return qc.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return function(e){return jc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):qc.resolve(jh());let o=-1,a=r;return s.next(t=>qc.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?qc.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,r)).next(()=>this.computeViews(e,a,t,zh())).next(e=>({batchId:o,changes:Rh(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new jc(t)).next(e=>{let t=Dh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let r=Dh();return this.indexManager.getCollectionParents(e,i).next(s=>qc.forEach(s,s=>{const o=function(e,t){return new uh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{r=r.insert(e,t)})})}).next(()=>r))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(r=>(i=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(e=>{i.forEach((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,Ou.newInvalidDocument(i)))});let n=Dh();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&ud(s.mutation,r,ou.empty(),Sc.now()),kh(t,r)&&(n=n.insert(e,r))}),n})}}class jf{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return qc.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Zd(n.createTime)}),qc.resolve()}getNamedQuery(e,t){return qc.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:Ef(e.bundledQuery),readTime:Zd(e.readTime)}}(t)),qc.resolve()}}class Mf{constructor(){this.overlays=new tu(jc.comparator),this.ls=new Map}getOverlay(e,t){return qc.resolve(this.overlays.get(t))}getOverlays(e,t){const n=jh();return qc.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,i)=>{this.we(e,t,i)}),qc.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.ls.delete(n)),qc.resolve()}getOverlaysForCollection(e,t,n){const i=jh(),r=t.length+1,s=new jc(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return qc.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new tu((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=jh(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=jh(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=i)););return qc.resolve(o)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new wd(t,n));let r=this.ls.get(t);void 0===r&&(r=zh(),this.ls.set(t,r)),this.ls.set(t,r.add(n.key))}}class Of{constructor(){this.fs=new ru(Lf.ds),this.ws=new ru(Lf._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Lf(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.ys(new Lf(e,t))}ps(e,t){e.forEach(e=>this.removeReference(e,t))}Is(e){const t=new jc(new Ac([])),n=new Lf(t,e),i=new Lf(t,e+1),r=[];return this.ws.forEachInRange([n,i],e=>{this.ys(e),r.push(e.key)}),r}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new jc(new Ac([])),n=new Lf(t,e),i=new Lf(t,e+1);let r=zh();return this.ws.forEachInRange([n,i],e=>{r=r.add(e.key)}),r}containsKey(e){const t=new Lf(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Lf{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return jc.comparator(e.key,t.key)||Tc(e.As,t.As)}static _s(e,t){return Tc(e.As,t.As)||jc.comparator(e.key,t.key)}}class Ff{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new ru(Lf.ds)}checkEmpty(e){return qc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new xd(r,t,n,i);this.mutationQueue.push(s);for(const o of i)this.Rs=this.Rs.add(new Lf(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return qc.resolve(s)}lookupMutationBatch(e,t){return qc.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.bs(n),r=i<0?0:i;return qc.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return qc.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return qc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Lf(t,0),i=new Lf(t,Number.POSITIVE_INFINITY),r=[];return this.Rs.forEachInRange([n,i],e=>{const t=this.Ps(e.As);r.push(t)}),qc.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ru(Tc);return t.forEach(e=>{const t=new Lf(e,0),i=new Lf(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,i],e=>{n=n.add(e.As)})}),qc.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;jc.isDocumentKey(r)||(r=r.child(""));const s=new Lf(new jc(r),0);let o=new ru(Tc);return this.Rs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.As)),!0)},s),qc.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach(e=>{const n=this.Ps(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){hc(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return qc.forEach(t.mutations,i=>{const r=new Lf(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new Lf(t,0),i=this.Rs.firstAfterOrEqual(n);return qc.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,qc.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class zf{constructor(e){this.Ds=e,this.docs=new tu(jc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return qc.resolve(n?n.document.mutableCopy():Ou.newInvalidDocument(t))}getEntries(e,t){let n=Ph();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ou.newInvalidDocument(e))}),qc.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Ph();const s=t.path,o=new jc(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||zc(Lc(o),n)<=0||(i.has(o.key)||kh(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return qc.resolve(r)}getAllFromCollectionGroup(e,t,n,i){uc()}Cs(e,t){return qc.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Uf(this)}getSize(e){return qc.resolve(this.size)}}class Uf extends Af{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),qc.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class Vf{constructor(e){this.persistence=e,this.xs=new Sh(e=>ah(e),lh),this.lastRemoteSnapshotVersion=Ic.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Of,this.targetCount=0,this.Ms=Pf.kn()}forEachTarget(e,t){return this.xs.forEach((e,n)=>t(n)),qc.resolve()}getLastRemoteSnapshotVersion(e){return qc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return qc.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),qc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),qc.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Pf(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,qc.resolve()}updateTargetData(e,t){return this.Fn(t),qc.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,qc.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.xs.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),qc.waitFor(r).next(()=>i)}getTargetCount(e){return qc.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return qc.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),qc.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(t=>{r.push(i.markPotentiallyOrphaned(e,t))}),qc.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),qc.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return qc.resolve(n)}containsKey(e,t){return qc.resolve(this.ks.containsKey(t))}}class Bf{constructor(e,t){this.$s={},this.overlays={},this.Os=new Wc(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Vf(this),this.indexManager=new Nf,this.remoteDocumentCache=function(e){return new zf(e)}(e=>this.referenceDelegate.Ls(e)),this.serializer=new kf(t),this.qs=new jf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Mf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new Ff(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){oc("MemoryPersistence","Starting transaction:",e);const i=new qf(this.Os.next());return this.referenceDelegate.Us(),n(i).next(e=>this.referenceDelegate.Ks(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Gs(e,t){return qc.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class qf extends Vc{constructor(e){super(),this.currentSequenceNumber=e}}class Hf{constructor(e){this.persistence=e,this.Qs=new Of,this.js=null}static zs(e){return new Hf(e)}get Ws(){if(this.js)return this.js;throw uc()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),qc.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),qc.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),qc.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(e=>this.Ws.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ws.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qc.forEach(this.Ws,n=>{const i=jc.fromPath(n);return this.Hs(e,i).next(e=>{e||t.removeEntry(i,Ic.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return qc.or([()=>qc.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Wf{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=zh(),i=zh();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Wf(e,t.fromCache,n,i)}}class Gf{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(r=>r||this.Gi(e,t,i,n)).next(n=>n||this.Qi(e,t))}Ki(e,t){if(fh(t))return qc.resolve(null);let n=vh(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=xh(t,null,"F"),n=vh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const r=zh(...i);return this.Ui.getDocuments(e,r).next(i=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ji(t,i);return this.zi(t,s,r,n.readTime)?this.Ki(e,xh(t,null,"F")):this.Wi(e,s,t,n)}))})))}Gi(e,t,n,i){return fh(t)||i.isEqual(Ic.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(r=>{const s=this.ji(t,r);return this.zi(t,s,n,i)?this.Qi(e,t):(sc()<=ue.DEBUG&&oc("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ch(t)),this.Wi(e,s,t,Oc(i,-1)))})}ji(e,t){let n=new ru(Th(e));return t.forEach((t,i)=>{kh(e,i)&&(n=n.add(i))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Qi(e,t){return sc()<=ue.DEBUG&&oc("QueryEngine","Using full collection scan to execute query:",Ch(t)),this.Ui.getDocumentsMatchingQuery(e,t,Fc.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Kf{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new tu(Tc),this.Yi=new Sh(e=>ah(e),lh),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rf(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function Yf(e,t,n,i){return new Kf(e,t,n,i)}async function Qf(e,t){const n=dc(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next(r=>(i=r,n.tr(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const r=[],s=[];let o=zh();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({er:e,removedBatchIds:r,addedBatchIds:s}))})})}function Xf(e){const t=dc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function $f(e,t,n){let i=zh(),r=zh();return n.forEach(e=>i=i.add(e)),t.getEntries(e,i).next(e=>{let i=Ph();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Ic.min())?(t.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),i=i.insert(n,s)):oc("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{nr:i,sr:r}})}function Jf(e,t){const n=dc(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Zf(e,t){const n=dc(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let i;return n.Bs.getTargetData(e,t).next(r=>r?(i=r,qc.resolve(i)):n.Bs.allocateTargetId(e).next(r=>(i=new Cf(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,i).next(()=>i))))}).then(e=>{const i=n.Ji.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e})}async function ep(e,t,n){const i=dc(e),r=i.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,e=>i.persistence.referenceDelegate.removeTarget(e,r))}catch(e){if(!Hc(e))throw e;oc("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}i.Ji=i.Ji.remove(t),i.Yi.delete(r.target)}function tp(e,t,n){const i=dc(e);let r=Ic.min(),s=zh();return i.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const i=dc(e),r=i.Yi.get(n);return void 0!==r?qc.resolve(i.Ji.get(r)):i.Bs.getTargetData(t,n)}(i,e,vh(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>i.Hi.getDocumentsMatchingQuery(e,t,n?r:Ic.min(),n?s:zh())).next(e=>(np(i,Eh(t),e),{documents:e,ir:s})))}function np(e,t,n){let i=e.Xi.get(t)||Ic.min();n.forEach((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)}),e.Xi.set(t,i)}class ip{constructor(){this.activeTargetIds=Vh()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rp{constructor(){this.Hr=new ip,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new ip,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class sp{Yr(e){}shutdown(){}}class op{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){oc("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){oc("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ap=null;function lp(){return null===ap?ap=268435456+Math.round(2147483648*Math.random()):ap++,"0x"+ap.toString(16)}const cp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class up{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const hp="WebChannelConnection";class dp extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,r){const s=lp(),o=this.To(e,t);oc("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={};return this.Eo(a,i,r),this.Ao(e,o,a,n).then(t=>(oc("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw lc("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t})}vo(e,t,n,i,r,s){return this.Io(e,t,n,i,r)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ic,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}To(e,t){const n=cp[e];return"".concat(this.mo,"/v1/").concat(t,":").concat(n)}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const r=lp();return new Promise((s,o)=>{const a=new Jl;a.setWithCredentials(!0),a.listenOnce(Kl.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Gl.NO_ERROR:const t=a.getResponseJson();oc(hp,"XHR for RPC '".concat(e,"' ").concat(r," received:"),JSON.stringify(t)),s(t);break;case Gl.TIMEOUT:oc(hp,"RPC '".concat(e,"' ").concat(r," timed out")),o(new pc(fc.DEADLINE_EXCEEDED,"Request time out"));break;case Gl.HTTP_ERROR:const n=a.getStatus();if(oc(hp,"RPC '".concat(e,"' ").concat(r," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(fc).indexOf(t)>=0?t:fc.UNKNOWN}(t.status);o(new pc(e,t.message))}else o(new pc(fc.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new pc(fc.UNAVAILABLE,"Connection failed."));break;default:uc()}}finally{oc(hp,"RPC '".concat(e,"' ").concat(r," completed."))}});const l=JSON.stringify(i);oc(hp,"RPC '".concat(e,"' ").concat(r," sending request:"),i),a.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=lp(),r=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Hl(),o=Wl(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new Xl({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=r.join("");oc(hp,"Creating RPC '".concat(e,"' stream ").concat(i,": ").concat(c),a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new up({ro:t=>{d?oc(hp,"Not sending because RPC '".concat(e,"' stream ").concat(i," is closed:"),t):(h||(oc(hp,"Opening RPC '".concat(e,"' stream ").concat(i," transport.")),u.open(),h=!0),oc(hp,"RPC '".concat(e,"' stream ").concat(i," sending:"),t),u.send(t))},oo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,$l.EventType.OPEN,()=>{d||oc(hp,"RPC '".concat(e,"' stream ").concat(i," transport opened."))}),p(u,$l.EventType.CLOSE,()=>{d||(d=!0,oc(hp,"RPC '".concat(e,"' stream ").concat(i," transport closed")),f.wo())}),p(u,$l.EventType.ERROR,t=>{d||(d=!0,lc(hp,"RPC '".concat(e,"' stream ").concat(i," transport errored:"),t),f.wo(new pc(fc.UNAVAILABLE,"The operation could not be completed")))}),p(u,$l.EventType.MESSAGE,t=>{var n;if(!d){const r=t.data[0];hc(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){oc(hp,"RPC '".concat(e,"' stream ").concat(i," received error:"),o);const t=o.status;let n=function(e){const t=kd[e];if(void 0!==t)return Nd(t)}(t),r=o.message;void 0===n&&(n=fc.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.wo(new pc(n,r)),u.close()}else oc(hp,"RPC '".concat(e,"' stream ").concat(i," received:"),r),f._o(r)}}),p(o,Yl.STAT_EVENT,t=>{t.stat===Ql.PROXY?oc(hp,"RPC '".concat(e,"' stream ").concat(i," detected buffering proxy")):t.stat===Ql.NOPROXY&&oc(hp,"RPC '".concat(e,"' stream ").concat(i," detected no buffering proxy"))}),setTimeout(()=>{f.fo()},0),f}}function fp(){return"undefined"!=typeof document?document:null}function pp(e){return new Yd(e,!0)}class mp{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&oc("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.So," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class gp{constructor(e,t,n,i,r,s,o,a){this.ii=e,this.$o=n,this.Oo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new mp(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===fc.RESOURCE_EXHAUSTED?(ac(t.toString()),ac("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===fc.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,i]=e;this.Fo===t&&this.Zo(n,i)},t=>{e(()=>{const e=new pc(fc.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(e=>{n(()=>this.tu(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return oc("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(oc("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yp extends gp{constructor(e,t,n,i,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:uc()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(hc(void 0===t||"string"==typeof t),lu.fromBase64String(t||"")):(hc(void 0===t||t instanceof Uint8Array),lu.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?fc.UNKNOWN:Nd(e.code);return new pc(t,e.message||"")}(o);n=new Ud(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=rf(e,i.document.name),s=Zd(i.document.updateTime),o=i.document.createTime?Zd(i.document.createTime):Ic.min(),a=new ju({mapValue:{fields:i.document.fields}}),l=Ou.newFoundDocument(r,s,o,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Fd(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=rf(e,i.document),s=i.readTime?Zd(i.readTime):Ic.min(),o=Ou.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Fd([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=rf(e,i.document),s=i.removedTargetIds||[];n=new Fd([],s,r,null)}else{if(!("filter"in t))return uc();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,s=new Cd(i,r),o=e.targetId;n=new zd(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ic.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ic.min():t.readTime?Zd(t.readTime):Ic.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=af(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=ch(i)?{documents:hf(e,i)}:{query:df(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=$d(e,t.resumeToken);const i=Qd(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Ic.min())>0){n.readTime=Xd(e,t.snapshotVersion.toTimestamp());const i=Qd(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return uc()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=af(this.serializer),t.removeTarget=e,this.Wo(t)}}class vp extends gp{constructor(e,t,n,i,r,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(hc(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(hc(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Zd(e.updateTime):Zd(t);return n.isEqual(Ic.min())&&(n=Zd(t)),new rd(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Zd(e.commitTime);return this.listener.cu(n,t)}return hc(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=af(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>uf(this.serializer,e))};this.Wo(t)}}class bp extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new pc(fc.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[r,s]=i;return this.connection.Io(e,t,n,r,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===fc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new pc(fc.UNKNOWN,e.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(r=>{let[s,o]=r;return this.connection.vo(e,t,n,s,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===fc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new pc(fc.UNKNOWN,e.toString())})}terminate(){this.lu=!0}}class xp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.mu?(ac(t),this.mu=!1):oc("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class _p{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=r,this.Pu.Yr(e=>{n.enqueueAndForget(async()=>{Pp(this)&&(oc("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=dc(e);t.vu.add(4),await Cp(t),t.bu.set("Unknown"),t.vu.delete(4),await wp(t)}(this))})}),this.bu=new xp(n,i)}}async function wp(e){if(Pp(e))for(const t of e.Ru)await t(!0)}async function Cp(e){for(const t of e.Ru)await t(!1)}function kp(e,t){const n=dc(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Ip(n)?Sp(n):Yp(n).Ko()&&Tp(n,t))}function Ep(e,t){const n=dc(e),i=Yp(n);n.Au.delete(t),i.Ko()&&Np(n,t),0===n.Au.size&&(i.Ko()?i.jo():Pp(n)&&n.bu.set("Unknown"))}function Tp(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ic.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Yp(e).su(t)}function Np(e,t){e.Vu.qt(t),Yp(e).iu(t)}function Sp(e){e.Vu=new Bd({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),Yp(e).start(),e.bu.gu()}function Ip(e){return Pp(e)&&!Yp(e).Uo()&&e.Au.size>0}function Pp(e){return 0===dc(e).vu.size}function Ap(e){e.Vu=void 0}async function Dp(e){e.Au.forEach((t,n)=>{Tp(e,t)})}async function Rp(e,t){Ap(e),Ip(e)?(e.bu.Iu(t),Sp(e)):e.bu.set("Unknown")}async function jp(e,t,n){if(e.bu.set("Online"),t instanceof Ud&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.Au.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.Au.delete(i),e.Vu.removeTarget(i))}(e,t)}catch(n){oc("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Mp(e,n)}else if(t instanceof Fd?e.Vu.Ht(t):t instanceof zd?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Ic.min()))try{const t=await Xf(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Au.get(i);r&&e.Au.set(i,r.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const i=e.Au.get(t);if(!i)return;e.Au.set(t,i.withResumeToken(lu.EMPTY_BYTE_STRING,i.snapshotVersion)),Np(e,t);const r=new Cf(i.target,t,n,i.sequenceNumber);Tp(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){oc("RemoteStore","Failed to raise snapshot:",t),await Mp(e,t)}}async function Mp(e,t,n){if(!Hc(t))throw t;e.vu.add(1),await Cp(e),e.bu.set("Offline"),n||(n=()=>Xf(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{oc("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await wp(e)})}function Op(e,t){return t().catch(n=>Mp(e,n,t))}async function Lp(e){const t=dc(e),n=Qp(t);let i=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;Fp(t);)try{const e=await Jf(t.localStore,i);if(null===e){0===t.Eu.length&&n.jo();break}i=e.batchId,zp(t,e)}catch(e){await Mp(t,e)}Up(t)&&Vp(t)}function Fp(e){return Pp(e)&&e.Eu.length<10}function zp(e,t){e.Eu.push(t);const n=Qp(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function Up(e){return Pp(e)&&!Qp(e).Uo()&&e.Eu.length>0}function Vp(e){Qp(e).start()}async function Bp(e){Qp(e).hu()}async function qp(e){const t=Qp(e);for(const n of e.Eu)t.uu(n.mutations)}async function Hp(e,t,n){const i=e.Eu.shift(),r=_d.from(i,t,n);await Op(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await Lp(e)}async function Wp(e,t){t&&Qp(e).ou&&await async function(e,t){if(Td(n=t.code)&&n!==fc.ABORTED){const n=e.Eu.shift();Qp(e).Qo(),await Op(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Lp(e)}var n}(e,t),Up(e)&&Vp(e)}async function Gp(e,t){const n=dc(e);n.asyncQueue.verifyOperationInProgress(),oc("RemoteStore","RemoteStore received new credentials");const i=Pp(n);n.vu.add(3),await Cp(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await wp(n)}async function Kp(e,t){const n=dc(e);t?(n.vu.delete(2),await wp(n)):t||(n.vu.add(2),await Cp(n),n.bu.set("Unknown"))}function Yp(e){return e.Su||(e.Su=function(e,t,n){const i=dc(e);return i.fu(),new yp(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:Dp.bind(null,e),ao:Rp.bind(null,e),nu:jp.bind(null,e)}),e.Ru.push(async t=>{t?(e.Su.Qo(),Ip(e)?Sp(e):e.bu.set("Unknown")):(await e.Su.stop(),Ap(e))})),e.Su}function Qp(e){return e.Du||(e.Du=function(e,t,n){const i=dc(e);return i.fu(),new vp(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:Bp.bind(null,e),ao:Wp.bind(null,e),au:qp.bind(null,e),cu:Hp.bind(null,e)}),e.Ru.push(async t=>{t?(e.Du.Qo(),await Lp(e)):(await e.Du.stop(),e.Eu.length>0&&(oc("RemoteStore","Stopping write stream with ".concat(e.Eu.length," pending writes")),e.Eu=[]))})),e.Du}class Xp{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new mc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new Xp(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new pc(fc.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $p(e,t){if(ac("AsyncQueue","".concat(t,": ").concat(e)),Hc(e))return new pc(fc.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Jp{constructor(e){this.comparator=e?(t,n)=>e(t,n)||jc.comparator(t.key,n.key):(e,t)=>jc.comparator(e.key,t.key),this.keyedMap=Dh(),this.sortedSet=new tu(this.comparator)}static emptySet(e){return new Jp(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jp))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Jp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Zp{constructor(){this.Cu=new tu(jc.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):uc():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class em{constructor(e,t,n,i,r,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new em(e,t,Jp.emptySet(t),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class tm{constructor(){this.Nu=void 0,this.listeners=[]}}class nm{constructor(){this.queries=new Sh(e=>wh(e),_h),this.onlineState="Unknown",this.ku=new Set}}async function im(e,t){const n=dc(e),i=t.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new tm),r)try{s.Nu=await n.onListen(i)}catch(e){const n=$p(e,"Initialization of query '".concat(Ch(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.listeners.push(t),t.Mu(n.onlineState),s.Nu&&t.$u(s.Nu)&&am(n)}async function rm(e,t){const n=dc(e),i=t.query;let r=!1;const s=n.queries.get(i);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function sm(e,t){const n=dc(e);let i=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(r)&&(i=!0);t.Nu=r}}i&&am(n)}function om(e,t,n){const i=dc(e),r=i.queries.get(t);if(r)for(const s of r.listeners)s.onError(n);i.queries.delete(t)}function am(e){e.ku.forEach(e=>{e.next()})}class lm{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new em(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=em.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class cm{constructor(e){this.key=e}}class um{constructor(e){this.key=e}}class hm{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=zh(),this.mutatedKeys=zh(),this.tc=Th(e),this.ec=new Jp(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Zp,i=t?t.ec:this.ec;let r=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((e,t)=>{const c=i.get(e),u=kh(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.rc(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.tc(u,a)>0||l&&this.tc(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),r=d?r.add(e):r.delete(e)):(s=s.delete(e),r=r.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:o,mutatedKeys:r}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const r=e.ic.xu();r.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return uc()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc)),this.oc(n);const s=t?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==r.length||a?{snapshot:new em(this.query,e.ec,i,r,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Zp,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=zh(),this.ec.forEach(e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))});const t=[];return e.forEach(e=>{this.Zu.has(e)||t.push(new um(e))}),this.Zu.forEach(n=>{e.has(n)||t.push(new cm(n))}),t}hc(e){this.Yu=e.ir,this.Zu=zh();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return em.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class dm{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class fm{constructor(e){this.key=e,this.fc=!1}}class pm{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new Sh(e=>wh(e),_h),this._c=new Map,this.mc=new Set,this.gc=new tu(jc.comparator),this.yc=new Map,this.Ic=new Of,this.Tc={},this.Ec=new Map,this.Ac=Pf.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function mm(e,t){const n=Rm(e);let i,r;const s=n.wc.get(t);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.lc();else{const e=await Zf(n.localStore,vh(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,r=await gm(n,t,i,"current"===s,e.resumeToken),n.isPrimaryClient&&kp(n.remoteStore,e)}return r}async function gm(e,t,n,i,r){e.Rc=(t,n,i)=>async function(e,t,n,i){let r=t.view.sc(n);r.zi&&(r=await tp(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.sc(n,r)}));const s=i&&i.targetChanges.get(t.targetId),o=t.view.applyChanges(r,e.isPrimaryClient,s);return Nm(e,t.targetId,o.cc),o.snapshot}(e,t,n,i);const s=await tp(e.localStore,t,!0),o=new hm(t,s.ir),a=o.sc(s.documents),l=Ld.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),c=o.applyChanges(a,e.isPrimaryClient,l);Nm(e,n,c.cc);const u=new dm(t,n,o);return e.wc.set(t,u),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),c.snapshot}async function ym(e,t){const n=dc(e),i=n.wc.get(t),r=n._c.get(i.targetId);if(r.length>1)return n._c.set(i.targetId,r.filter(e=>!_h(e,t))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ep(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),Ep(n.remoteStore,i.targetId),Em(n,i.targetId)}).catch(Bc)):(Em(n,i.targetId),await ep(n.localStore,i.targetId,!0))}async function vm(e,t){const n=dc(e);try{const e=await function(e,t){const n=dc(e),i=t.snapshotVersion;let r=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});r=n.Ji;const o=[];t.targetChanges.forEach((s,a)=>{const l=r.get(a);if(!l)return;o.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Bs.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(lu.EMPTY_BYTE_STRING,Ic.min()).withLastLimboFreeSnapshotVersion(Ic.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,i)),r=r.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.Bs.updateTargetData(e,c))});let a=Ph(),l=zh();if(t.documentUpdates.forEach(i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))}),o.push($f(e,s,t.documentUpdates).next(e=>{a=e.nr,l=e.sr})),!i.isEqual(Ic.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next(t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,i));o.push(t)}return qc.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ji=r,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const i=n.yc.get(t);i&&(hc(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.fc=!0:e.modifiedDocuments.size>0?hc(i.fc):e.removedDocuments.size>0&&(hc(i.fc),i.fc=!1))}),await Pm(n,e,t)}catch(e){await Bc(e)}}function bm(e,t,n){const i=dc(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.wc.forEach((n,i)=>{const r=i.view.Mu(t);r.snapshot&&e.push(r.snapshot)}),function(e,t){const n=dc(e);n.onlineState=t;let i=!1;n.queries.forEach((e,n)=>{for(const r of n.listeners)r.Mu(t)&&(i=!0)}),i&&am(n)}(i.eventManager,t),e.length&&i.dc.nu(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function xm(e,t,n){const i=dc(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.yc.get(t),s=r&&r.key;if(s){let e=new tu(jc.comparator);e=e.insert(s,Ou.newNoDocument(s,Ic.min()));const n=zh().add(s),r=new Od(Ic.min(),new Map,new tu(Tc),e,n);await vm(i,r),i.gc=i.gc.remove(s),i.yc.delete(t),Im(i)}else await ep(i.localStore,t,!1).then(()=>Em(i,t,n)).catch(Bc)}async function _m(e,t){const n=dc(e),i=t.batch.batchId;try{const e=await function(e,t){const n=dc(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const i=t.batch.keys(),r=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,s=r.keys();let o=qc.resolve();return s.forEach(e=>{o=o.next(()=>i.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);hc(null!==s),t.version.compareTo(s)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,r))}(n,e,t,r).next(()=>r.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=zh();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,i))})}(n.localStore,t);km(n,i,null),Cm(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Pm(n,e)}catch(e){await Bc(e)}}async function wm(e,t,n){const i=dc(e);try{const e=await function(e,t){const n=dc(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(hc(null!==t),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>n.localDocuments.getDocuments(e,i))})}(i.localStore,t);km(i,t,n),Cm(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await Pm(i,e)}catch(n){await Bc(n)}}function Cm(e,t){(e.Ec.get(t)||[]).forEach(e=>{e.resolve()}),e.Ec.delete(t)}function km(e,t,n){const i=dc(e);let r=i.Tc[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Tc[i.currentUser.toKey()]=r}}function Em(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const i of e._c.get(t))e.wc.delete(i),n&&e.dc.Pc(i,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach(t=>{e.Ic.containsKey(t)||Tm(e,t)})}function Tm(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(Ep(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Im(e))}function Nm(e,t,n){for(const i of n)i instanceof cm?(e.Ic.addReference(i.key,t),Sm(e,i)):i instanceof um?(oc("SyncEngine","Document no longer in limbo: "+i.key),e.Ic.removeReference(i.key,t),e.Ic.containsKey(i.key)||Tm(e,i.key)):uc()}function Sm(e,t){const n=t.key,i=n.path.canonicalString();e.gc.get(n)||e.mc.has(i)||(oc("SyncEngine","New document in limbo: "+n),e.mc.add(i),Im(e))}function Im(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new jc(Ac.fromString(t)),i=e.Ac.next();e.yc.set(i,new fm(n)),e.gc=e.gc.insert(n,i),kp(e.remoteStore,new Cf(vh(dh(n.path)),i,"TargetPurposeLimboResolution",Wc.ct))}}async function Pm(e,t,n){const i=dc(e),r=[],s=[],o=[];i.wc.isEmpty()||(i.wc.forEach((e,a)=>{o.push(i.Rc(a,t,n).then(e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){r.push(e);const t=Wf.Li(a.targetId,e);s.push(t)}}))}),await Promise.all(o),i.dc.nu(r),await async function(e,t){const n=dc(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>qc.forEach(t,t=>qc.forEach(t.Fi,i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i)).next(()=>qc.forEach(t.Bi,i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))}catch(e){if(!Hc(e))throw e;oc("LocalStore","Failed to update sequence numbers: "+e)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.Ji.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(e,r)}}}(i.localStore,s))}async function Am(e,t){const n=dc(e);if(!n.currentUser.isEqual(t)){oc("SyncEngine","User change. New user:",t.toKey());const e=await Qf(n.localStore,t);n.currentUser=t,function(e){e.Ec.forEach(e=>{e.forEach(e=>{e.reject(new pc(fc.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Pm(n,e.er)}}function Dm(e,t){const n=dc(e),i=n.yc.get(t);if(i&&i.fc)return zh().add(i.key);{let e=zh();const i=n._c.get(t);if(!i)return e;for(const t of i){const i=n.wc.get(t);e=e.unionWith(i.view.nc)}return e}}function Rm(e){const t=dc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=vm.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dm.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=xm.bind(null,t),t.dc.nu=sm.bind(null,t.eventManager),t.dc.Pc=om.bind(null,t.eventManager),t}function jm(e){const t=dc(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_m.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=wm.bind(null,t),t}class Mm{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=pp(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Yf(this.persistence,new Gf,e.initialUser,this.serializer)}createPersistence(e){return new Bf(Hf.zs,this.serializer)}createSharedClientState(e){return new rp}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Om{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>bm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Am.bind(null,this.syncEngine),await Kp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new nm}createDatastore(e){const t=pp(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new dp(i));var i;return function(e,t,n,i){return new bp(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>bm(this.syncEngine,e,0),s=op.D()?new op:new sp,new _p(t,n,i,r,s);var t,n,i,r,s}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new pm(e,t,n,i,r,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=dc(e);oc("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await Cp(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class Lm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):ac("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Fm{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new pc(fc.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=dc(e),i=af(n.serializer)+"/documents",r={documents:t.map(e=>nf(n.serializer,e))},s=await n.vo("BatchGetDocuments",i,r,t.length),o=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){hc(!!t.found),t.found.name,t.found.updateTime;const n=rf(e,t.found.name),i=Zd(t.found.updateTime),r=t.found.createTime?Zd(t.found.createTime):Ic.min(),s=new ju({mapValue:{fields:t.found.fields}});return Ou.newFoundDocument(n,i,r,s)}(e,t):"missing"in t?function(e,t){hc(!!t.missing),hc(!!t.readTime);const n=rf(e,t.missing),i=Zd(t.readTime);return Ou.newNoDocument(n,i)}(e,t):uc()}(n.serializer,e);o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=o.get(e.toString());hc(!!t),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new vd(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=jc.fromPath(t);this.mutations.push(new bd(n,this.precondition(n)))}),await async function(e,t){const n=dc(e),i=af(n.serializer)+"/documents",r={writes:t.map(e=>uf(n.serializer,e))};await n.Io("Commit",i,r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw uc();t=Ic.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new pc(fc.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ic.min())?sd.exists(!1):sd.updateTime(t):sd.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ic.min()))throw new pc(fc.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return sd.updateTime(t)}return sd.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class zm{constructor(e,t,n,i,r){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=r,this.Bc=n.maxAttempts,this.qo=new mp(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new Fm(this.datastore),t=this.qc(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Uc(e)}))}).catch(e=>{this.Uc(e)})})}qc(e){try{const t=this.updateFunction(e);return!Gc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Td(t)}return!1}}class Um{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=nc.UNAUTHENTICATED,this.clientId=Ec.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{oc("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(oc("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new pc(fc.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=$p(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Vm(e,t){e.asyncQueue.verifyOperationInProgress(),oc("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async e=>{i.isEqual(e)||(await Qf(t.localStore,e),i=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Bm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Hm(e);oc("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener(e=>Gp(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Gp(t.remoteStore,n)),e._onlineComponents=t}function qm(e){return"FirebaseError"===e.name?e.code===fc.FAILED_PRECONDITION||e.code===fc.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function Hm(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){oc("FirestoreClient","Using user provided OfflineComponentProvider");try{await Vm(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!qm(n))throw n;lc("Error using user provided cache. Falling back to memory cache: "+n),await Vm(e,new Mm)}}else oc("FirestoreClient","Using default OfflineComponentProvider"),await Vm(e,new Mm);return e._offlineComponents}async function Wm(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(oc("FirestoreClient","Using user provided OnlineComponentProvider"),await Bm(e,e._uninitializedComponentsProvider._online)):(oc("FirestoreClient","Using default OnlineComponentProvider"),await Bm(e,new Om))),e._onlineComponents}function Gm(e){return Wm(e).then(e=>e.syncEngine)}function Km(e){return Wm(e).then(e=>e.datastore)}async function Ym(e){const t=await Wm(e),n=t.eventManager;return n.onListen=mm.bind(null,t.syncEngine),n.onUnlisten=ym.bind(null,t.syncEngine),n}function Qm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new mc;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const s=new Lm({next:s=>{t.enqueueAndForget(()=>rm(e,o));const a=s.docs.has(n);!a&&s.fromCache?r.reject(new pc(fc.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&i&&"server"===i.source?r.reject(new pc(fc.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:e=>r.reject(e)}),o=new lm(dh(n.path),s,{includeMetadataChanges:!0,Ku:!0});return im(e,o)}(await Ym(e),e.asyncQueue,t,n,i)),i.promise}function Xm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new mc;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const s=new Lm({next:n=>{t.enqueueAndForget(()=>rm(e,o)),n.fromCache&&"server"===i.source?r.reject(new pc(fc.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),o=new lm(n,s,{includeMetadataChanges:!0,Ku:!0});return im(e,o)}(await Ym(e),e.asyncQueue,t,n,i)),i.promise}function $m(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Jm=new Map;function Zm(e,t,n){if(!n)throw new pc(fc.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function eg(e){if(!jc.isDocumentKey(e))throw new pc(fc.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function tg(e){if(jc.isDocumentKey(e))throw new pc(fc.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ng(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":uc()}function ig(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new pc(fc.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ng(e);throw new pc(fc.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}class rg{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new pc(fc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new pc(fc.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new pc(fc.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$m(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new pc(fc.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new pc(fc.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new pc(fc.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class sg{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new pc(fc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new pc(fc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rg(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new yc;switch(e.type){case"firstParty":return new _c(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new pc(fc.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Jm.get(e);t&&(oc("ComponentProvider","Removing Datastore"),Jm.delete(e),t.terminate())}(this),Promise.resolve()}}class og{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new og(this.firestore,e,this._key)}}class ag{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ag(this.firestore,e,this._query)}}class lg extends ag{constructor(e,t,n){super(e,t,dh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new og(this.firestore,null,new jc(e))}withConverter(e){return new lg(this.firestore,e,this._path)}}function cg(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=re(e),Zm("collection","path",t),e instanceof sg){const n=Ac.fromString(t,...i);return tg(n),new lg(e,null,n)}{if(!(e instanceof og||e instanceof lg))throw new pc(fc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ac.fromString(t,...i));return tg(n),new lg(e.firestore,null,n)}}function ug(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(e=re(e),1===arguments.length&&(t=Ec.A()),Zm("doc","path",t),e instanceof sg){const n=Ac.fromString(t,...i);return eg(n),new og(e,null,new jc(n))}{if(!(e instanceof og||e instanceof lg))throw new pc(fc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ac.fromString(t,...i));return eg(n),new og(e.firestore,e instanceof lg?e.converter:null,new jc(n))}}class hg{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new mp(this,"async_queue_retry"),this.Xc=()=>{const e=fp();e&&oc("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=fp();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=fp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new mc;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Hc(e))throw e;oc("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw ac("INTERNAL UNHANDLED ERROR: ",t),e}).then(e=>(this.Hc=!1,e))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=Xp.createAndSchedule(this,e,t,n,e=>this.na(e));return this.zc.push(i),i}Zc(){this.Wc&&uc()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function dg(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class fg extends sg{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new hg,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||mg(this),this._firestoreClient.terminate()}}function pg(e){return e._firestoreClient||mg(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function mg(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new gu(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,$m(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new Um(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=r.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}class gg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gg(lu.fromBase64String(e))}catch(e){throw new pc(fc.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new gg(lu.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class yg{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;++i)if(0===t[i].length)throw new pc(fc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rc(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vg{constructor(e){this._methodName=e}}class bg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pc(fc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pc(fc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Tc(this._lat,e._lat)||Tc(this._long,e._long)}}const xg=/^__.*__$/;class _g{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new pd(e,this.data,this.fieldMask,t,this.fieldTransforms):new fd(e,this.data,t,this.fieldTransforms)}}class wg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new pd(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Cg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw uc()}}class kg{constructor(e,t,n,i,r,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.ua(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new kg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Vg(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Cg(this.ca)&&xg.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Eg{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||pp(e)}ya(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new kg({ca:e,methodName:t,ga:n,path:Rc.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tg(e){const t=e._freezeSettings(),n=pp(e._databaseId);return new Eg(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ng(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.ya(s.merge||s.mergeFields?2:0,t,n,r);Lg("Data must be an object, but it was:",o,i);const a=Mg(i,o);let l,c;if(s.merge)l=new ou(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const i of s.mergeFields){const r=Fg(t,i,n);if(!o.contains(r))throw new pc(fc.INVALID_ARGUMENT,"Field '".concat(r,"' is specified in your field mask but missing from your input data."));Bg(e,r)||e.push(r)}l=new ou(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new _g(new ju(a),l,c)}class Sg extends vg{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a("".concat(this._methodName,"() can only appear at the top level of your update data")):e._a("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sg}}function Ig(e,t,n){return new kg({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Pg extends vg{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=Ig(this,e,!0),n=this.pa.map(e=>jg(e,t)),i=new Xh(n);return new id(e.path,i)}isEqual(e){return this===e}}function Ag(e,t,n,i){const r=e.ya(1,t,n);Lg("Data must be an object, but it was:",r,i);const s=[],o=ju.empty();Zc(i,(e,i)=>{const a=Ug(t,e,n);i=re(i);const l=r.da(a);if(i instanceof Sg)s.push(a);else{const e=jg(i,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new ou(s);return new wg(o,a,r.fieldTransforms)}function Dg(e,t,n,i,r,s){const o=e.ya(1,t,n),a=[Fg(t,i,n)],l=[r];if(s.length%2!=0)throw new pc(fc.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)a.push(Fg(t,s[d])),l.push(s[d+1]);const c=[],u=ju.empty();for(let d=a.length-1;d>=0;--d)if(!Bg(c,a[d])){const e=a[d];let t=l[d];t=re(t);const n=o.da(e);if(t instanceof Sg)c.push(e);else{const i=jg(t,n);null!=i&&(c.push(e),u.set(e,i))}}const h=new ou(c);return new wg(u,h,o.fieldTransforms)}function Rg(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return jg(n,e.ya(i?4:3,t))}function jg(e,t){if(Og(e=re(e)))return Lg("Unsupported field value:",t,e),Mg(e,t);if(e instanceof vg)return function(e,t){if(!Cg(t.ca))throw t._a("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t._a("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=jg(r,t.wa(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=re(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Hh(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Sc.fromDate(e);return{timestampValue:Xd(t.serializer,n)}}if(e instanceof Sc){const n=new Sc(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Xd(t.serializer,n)}}if(e instanceof bg)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof gg)return{bytesValue:$d(t.serializer,e._byteString)};if(e instanceof og){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t._a("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:ef(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a("Unsupported field value: ".concat(ng(e)))}(e,t)}function Mg(e,t){const n={};return eu(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Zc(e,(e,i)=>{const r=jg(i,t.ha(e));null!=r&&(n[e]=r)}),{mapValue:{fields:n}}}function Og(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Sc||e instanceof bg||e instanceof gg||e instanceof og||e instanceof vg)}function Lg(e,t,n){if(!Og(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const i=ng(n);throw"an object"===i?t._a(e+" a custom object"):t._a(e+" "+i)}}function Fg(e,t,n){if((t=re(t))instanceof yg)return t._internalPath;if("string"==typeof t)return Ug(e,t);throw Vg("Field path arguments must be of type string or ",e,!1,void 0,n)}const zg=new RegExp("[~\\*/\\[\\]]");function Ug(e,t,n){if(t.search(zg)>=0)throw Vg("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new yg(...t.split("."))._internalPath}catch(i){throw Vg("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Vg(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(i)),o&&(l+=" in document ".concat(r)),l+=")"),new pc(fc.INVALID_ARGUMENT,a+e+l)}function Bg(e,t){return e.some(e=>e.isEqual(t))}class qg{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new og(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Hg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Wg("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Hg extends qg{data(){return super.data()}}function Wg(e,t){return"string"==typeof t?Ug(e,t):t instanceof yg?t._internalPath:t._delegate._internalPath}function Gg(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new pc(fc.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kg{}class Yg extends Kg{}function Qg(e,t){let n=[];for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t instanceof Kg&&n.push(t),n=n.concat(r),function(e){const t=e.filter(e=>e instanceof Jg).length,n=e.filter(e=>e instanceof Xg).length;if(t>1||t>0&&n>0)throw new pc(fc.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class Xg extends Yg{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Xg(e,t,n)}_apply(e){const t=this._parse(e);return iy(e._query,t),new ag(e.firestore,e.converter,bh(e._query,t))}_parse(e){const t=Tg(e.firestore),n=function(e,t,n,i,r,s,o){let a;if(r.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new pc(fc.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){ny(o,s);const t=[];for(const n of o)t.push(ty(i,e,n));a={arrayValue:{values:t}}}else a=ty(i,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||ny(o,s),a=Rg(n,"where",o,"in"===s||"not-in"===s);return qu.create(r,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function $g(e,t,n){const i=t,r=Wg("where",e);return Xg._create(r,i,n)}class Jg extends Kg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Jg(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Hu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const r of i)iy(n,r),n=bh(n,r)}(e._query,t),new ag(e.firestore,e.converter,bh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Zg extends Yg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Zg(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new pc(fc.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new pc(fc.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new Uu(t,n);return function(e,t){if(null===ph(e)){const n=mh(e);null!==n&&ry(e,n,t.field)}}(e,i),i}(e._query,this._field,this._direction);return new ag(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new uh(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function ey(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Wg("orderBy",e);return Zg._create(n,t)}function ty(e,t,n){if("string"==typeof(n=re(n))){if(""===n)throw new pc(fc.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gh(t)&&-1!==n.indexOf("/"))throw new pc(fc.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const i=t.path.child(Ac.fromString(n));if(!jc.isDocumentKey(i))throw new pc(fc.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(i,"' is not because it has an odd number of segments (").concat(i.length,")."));return Tu(e,new jc(i))}if(n instanceof og)return Tu(e,n._key);throw new pc(fc.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(ng(n),"."))}function ny(e,t){if(!Array.isArray(e)||0===e.length)throw new pc(fc.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function iy(e,t){if(t.isInequality()){const n=mh(e),i=t.field;if(null!==n&&!n.isEqual(i))throw new pc(fc.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(i.toString(),"'"));const r=ph(e);null!==r&&ry(e,i,r)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new pc(fc.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new pc(fc.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}function ry(e,t,n){if(!n.isEqual(t))throw new pc(fc.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}class sy{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(bu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hu(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(du(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw uc()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Zc(e,(e,i)=>{n[e]=this.convertValue(i,t)}),n}convertGeoPoint(e){return new bg(hu(e.latitude),hu(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=pu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(mu(e));default:return null}}convertTimestamp(e){const t=uu(e);return new Sc(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ac.fromString(e);hc(wf(n));const i=new yu(n.get(1),n.get(3)),r=new jc(n.popFirst(5));return i.isEqual(t)||ac("Document ".concat(r," contains a document reference within a different database (").concat(i.projectId,"/").concat(i.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),r}}function oy(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class ay extends sy{constructor(e){super(),this.firestore=e}convertBytes(e){return new gg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new og(this.firestore,null,t)}}class ly{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cy extends qg{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new uy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Wg("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class uy extends cy{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class hy{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ly(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new uy(this._firestore,this._userDataWriter,n.key,n,new ly(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new pc(fc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const i=new uy(e._firestore,e._userDataWriter,n.doc.key,n.doc,new ly(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const i=new uy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ly(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,s=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:dy(t.type),doc:i,oldIndex:r,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function dy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return uc()}}function fy(e){e=ig(e,og);const t=ig(e.firestore,fg);return Qm(pg(t),e._key).then(n=>_y(t,e,n))}class py extends sy{constructor(e){super(),this.firestore=e}convertBytes(e){return new gg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new og(this.firestore,null,t)}}function my(e){e=ig(e,ag);const t=ig(e.firestore,fg),n=pg(t),i=new py(t);return Gg(e._query),Xm(n,e._query).then(n=>new hy(t,i,e,n))}function gy(e,t,n){e=ig(e,og);const i=ig(e.firestore,fg),r=oy(e.converter,t,n);return xy(i,[Ng(Tg(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,sd.none())])}function yy(e,t,n){e=ig(e,og);const i=ig(e.firestore,fg),r=Tg(i);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=re(t))||t instanceof yg?Dg(r,"updateDoc",e._key,t,n,a):Ag(r,"updateDoc",e._key,t),xy(i,[s.toMutation(e._key,sd.exists(!0))])}function vy(e,t){const n=ig(e.firestore,fg),i=ug(e),r=oy(e.converter,t);return xy(n,[Ng(Tg(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,sd.exists(!1))]).then(()=>i)}function by(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,s,o;e=re(e);let a={includeMetadataChanges:!1},l=0;"object"!=typeof n[l]||dg(n[l])||(a=n[l],l++);const c={includeMetadataChanges:a.includeMetadataChanges};if(dg(n[l])){const e=n[l];n[l]=null===(r=e.next)||void 0===r?void 0:r.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let u,h,d;if(e instanceof og)h=ig(e.firestore,fg),d=dh(e._key.path),u={next:t=>{n[l]&&n[l](_y(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=ig(e,ag);h=ig(t.firestore,fg),d=t._query;const i=new py(h);u={next:e=>{n[l]&&n[l](new hy(h,i,t,e))},error:n[l+1],complete:n[l+2]},Gg(e._query)}return function(e,t,n,i){const r=new Lm(i),s=new lm(t,r,n);return e.asyncQueue.enqueueAndForget(async()=>im(await Ym(e),s)),()=>{r.Dc(),e.asyncQueue.enqueueAndForget(async()=>rm(await Ym(e),s))}}(pg(h),d,c,u)}function xy(e,t){return function(e,t){const n=new mc;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const i=jm(e);try{const e=await function(e,t){const n=dc(e),i=Sc.now(),r=t.reduce((e,t)=>e.add(t.key),zh());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Ph(),l=zh();return n.Zi.getEntries(e,r).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(r=>{s=r;const o=[];for(const e of t){const t=hd(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new pd(e.key,t,Mu(t.value.mapValue),sd.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)}).next(t=>{o=t;const i=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)})}).then(()=>({batchId:o.batchId,changes:Rh(s)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Tc[e.currentUser.toKey()];i||(i=new tu(Tc)),i=i.insert(t,n),e.Tc[e.currentUser.toKey()]=i}(i,e.batchId,n),await Pm(i,e.changes),await Lp(i.remoteStore)}catch(e){const t=$p(e,"Failed to persist write");n.reject(t)}}(await Gm(e),t,n)),n.promise}(pg(e),t)}function _y(e,t,n){const i=n.docs.get(t._key),r=new py(e);return new cy(e,r,t._key,i,new ly(n.hasPendingWrites,n.fromCache),t.converter)}const wy={maxAttempts:5};class Cy{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Tg(e)}set(e,t,n){this._verifyNotCommitted();const i=ky(e,this._firestore),r=oy(i.converter,t,n),s=Ng(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(s.toMutation(i._key,sd.none())),this}update(e,t,n){this._verifyNotCommitted();const i=ky(e,this._firestore);let r;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return r="string"==typeof(t=re(t))||t instanceof yg?Dg(this._dataReader,"WriteBatch.update",i._key,t,n,o):Ag(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,sd.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ky(e,this._firestore);return this._mutations=this._mutations.concat(new vd(t._key,sd.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pc(fc.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ky(e,t){if((e=re(e)).firestore!==t)throw new pc(fc.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Ey extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Tg(e)}get(e){const t=ky(e,this._firestore),n=new ay(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return uc();const i=e[0];if(i.isFoundDocument())return new qg(this._firestore,n,i.key,i,t.converter);if(i.isNoDocument())return new qg(this._firestore,n,t._key,null,t.converter);throw uc()})}set(e,t,n){const i=ky(e,this._firestore),r=oy(i.converter,t,n),s=Ng(this._dataReader,"Transaction.set",i._key,r,null!==i.converter,n);return this._transaction.set(i._key,s),this}update(e,t,n){const i=ky(e,this._firestore);let r;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return r="string"==typeof(t=re(t))||t instanceof yg?Dg(this._dataReader,"Transaction.update",i._key,t,n,o):Ag(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}delete(e){const t=ky(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ky(e,this._firestore),n=new py(this._firestore);return super.get(e).then(e=>new cy(this._firestore,n,t._key,e._document,new ly(!1,!1),t.converter))}}function Ty(e,t,n){e=ig(e,fg);const i=Object.assign(Object.assign({},wy),n);return function(e){if(e.maxAttempts<1)throw new pc(fc.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(e,t,n){const i=new mc;return e.asyncQueue.enqueueAndForget(async()=>{const r=await Km(e);new zm(e.asyncQueue,r,n,t,i).run()}),i.promise}(pg(e),n=>t(new Ey(e,n)),i)}function Ny(){return new Sg("deleteField")}function Sy(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Pg("arrayUnion",t)}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ic=e}(mt),ht(new se("firestore",(e,n)=>{let{instanceIdentifier:i,options:r}=n;const s=e.getProvider("app").getImmediate(),o=new fg(new bc(e.getProvider("auth-internal")),new Cc(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new pc(fc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yu(e.options.projectId,t)}(s,i),s);return r=Object.assign({useFetchStreams:t},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),vt(tc,"3.13.0",e),vt(tc,"3.13.0","esm2017")}();const Iy="firebasestorage.googleapis.com",Py="storageBucket";class Ay extends F{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(jy(e),"Firebase Storage: ".concat(t," (").concat(jy(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ay.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var Dy,Ry;function jy(e){return"storage/"+e}function My(){return new Ay(Dy.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Oy(){return new Ay(Dy.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ly(){return new Ay(Dy.CANCELED,"User canceled the upload/download.")}function Fy(){return new Ay(Dy.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zy(e){return new Ay(Dy.INVALID_ARGUMENT,e)}function Uy(){return new Ay(Dy.APP_DELETED,"The Firebase app was deleted.")}function Vy(e,t){return new Ay(Dy.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function By(e){throw new Ay(Dy.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Dy||(Dy={}));class qy{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=qy.makeFromUrl(e,t)}catch(r){return new qy(e,"")}if(""===n.path)return n;throw i=e,new Ay(Dy.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";const r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(i,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===Iy?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(i,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],i=t.regex.exec(e);if(i){const e=i[t.indices.bucket];let r=i[t.indices.path];r||(r=""),n=new qy(e,r),t.postModify(n);break}}if(null==n)throw function(e){return new Ay(Dy.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class Hy{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function Wy(e){return"string"===typeof e||e instanceof String}function Gy(e){return Ky()&&e instanceof Blob}function Ky(){return"undefined"!==typeof Blob&&!j()}function Yy(e,t,n,i){if(i<t)throw zy("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(i>n)throw zy("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function Qy(e,t,n){let i=t;return null==n&&(i="https://".concat(t)),"".concat(n,"://").concat(i,"/v0").concat(e)}function Xy(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){n=n+(t(i)+"="+t(e[i]))+"&"}return n=n.slice(0,-1),n}function $y(e,t){const n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return n||i||r}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Ry||(Ry={}));class Jy{constructor(e,t,n,i,r,s,o,a,l,c,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new Zy(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===Ry.NO_ERROR,r=n.getStatus();if(!t||$y(r,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Ry.ABORT;return void e(!1,new Zy(!1,null,t))}const s=-1!==this.successCodes_.indexOf(r);e(!0,new Zy(s,n))})},t=(e,t)=>{const n=this.resolve_,i=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(s){i(s)}else if(null!==r){const e=My();e.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,e)):i(e)}else if(t.canceled){i(this.appDelete_?Uy():Ly())}else{i(Oy())}};this.canceled_?t(0,new Zy(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return 2===a}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.apply(null,n)}}function h(t){r=setTimeout(()=>{r=null,e(f,l())},t)}function d(){s&&clearTimeout(s)}function f(e){if(c)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(e)return d(),void u.call(null,e,...n);if(l()||o)return d(),void u.call(null,e,...n);let s;i<64&&(i*=2),1===a?(a=2,s=0):s=1e3*(i+Math.random()),h(s)}let p=!1;function m(e){p||(p=!0,d(),c||(null!==r?(e||(a=2),clearTimeout(r),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Zy{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function ev(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function tv(){const e=ev();for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(Ky())return new Blob(n);throw new Ay(Dy.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function nv(e){if("undefined"===typeof atob)throw t="base-64",new Ay(Dy.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const iv="raw",rv="base64",sv="base64url",ov="data_url";class av{constructor(e,t){this.data=e,this.contentType=t||null}}function lv(e,t){switch(e){case iv:return new av(cv(t));case rv:case sv:return new av(uv(e,t));case ov:return new av(function(e){const t=new hv(e);return t.base64?uv(rv,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw Vy(ov,"Malformed data URL.")}return cv(t)}(t.rest)}(t),new hv(t).contentType)}throw My()}function cv(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|63&i);else if(55296===(64512&i)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){i=65536|(1023&i)<<10|1023&e.charCodeAt(++n),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}else t.push(239,191,189)}else 56320===(64512&i)?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(t)}function uv(e,t){switch(e){case rv:{const n=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(n||i){throw Vy(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case sv:{const n=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(n||i){throw Vy(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=nv(t)}catch(r){if(r.message.includes("polyfill"))throw r;throw Vy(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);return i}class hv{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Vy(ov,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class dv{constructor(e,t){let n=0,i="";Gy(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Gy(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new dv(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new dv(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Ky()){const e=t.map(e=>e instanceof dv?e.data_:e);return new dv(tv.apply(null,e))}{const e=t.map(e=>Wy(e)?lv(iv,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const i=new Uint8Array(n);let r=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)i[r++]=e[t]}),new dv(i,!0)}}uploadData(){return this.data_}}function fv(e){let t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function pv(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function mv(e,t){return t}class gv{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||mv}}let yv=null;function vv(){if(yv)return yv;const e=[];e.push(new gv("bucket")),e.push(new gv("generation")),e.push(new gv("metageneration")),e.push(new gv("name","fullPath",!0));const t=new gv("name");t.xform=function(e,t){return function(e){return!Wy(e)||e.length<2?e:pv(e)}(t)},e.push(t);const n=new gv("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new gv("timeCreated")),e.push(new gv("updated")),e.push(new gv("md5Hash",null,!0)),e.push(new gv("cacheControl",null,!0)),e.push(new gv("contentDisposition",null,!0)),e.push(new gv("contentEncoding",null,!0)),e.push(new gv("contentLanguage",null,!0)),e.push(new gv("contentType",null,!0)),e.push(new gv("metadata","customMetadata",!0)),yv=e,yv}function bv(e,t,n){const i={type:"file"},r=n.length;for(let s=0;s<r;s++){const e=n[s];i[e.local]=e.xform(i,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,i=e.fullPath,r=new qy(n,i);return t._makeStorageReference(r)}})}(i,e),i}function xv(e,t,n){const i=fv(t);if(null===i)return null;return bv(e,i,n)}function _v(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const i=t[r];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}class wv{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Cv(e){if(!e)throw My()}function kv(e,t){return function(n,i){const r=xv(e,i,t);return Cv(null!==r),r}}function Ev(e,t){return function(n,i){const r=xv(e,i,t);return Cv(null!==r),function(e,t,n,i){const r=fv(t);if(null===r)return null;if(!Wy(r.downloadTokens))return null;const s=r.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(t=>{const r=e.bucket,s=e.fullPath;return Qy("/b/"+o(r)+"/o/"+o(s),n,i)+Xy({alt:"media",token:t})})[0]}(r,i,e.host,e._protocol)}}function Tv(e){return function(t,n){let i;var r,s;return 401===t.getStatus()?i=t.getErrorText().includes("Firebase App Check token is invalid")?new Ay(Dy.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Ay(Dy.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,i=new Ay(Dy.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(r=e.path,i=new Ay(Dy.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):i=n,i.status=t.getStatus(),i.serverResponse=n.serverResponse,i}}function Nv(e){const t=Tv(e);return function(n,i){let r=t(n,i);var s;return 404===n.getStatus()&&(s=e.path,r=new Ay(Dy.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}function Sv(e,t,n){const i=Qy(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new wv(i,"GET",kv(e,n),r);return s.errorHandler=Nv(t),s}function Iv(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),i}function Pv(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const l=Iv(t,i,r),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+_v(l,n)+"\r\n--"+a+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+a+"--",h=dv.getBlob(c,i,u);if(null===h)throw Fy();const d={name:l.fullPath},f=Qy(s,e.host,e._protocol),p=e.maxUploadRetryTime,m=new wv(f,"POST",kv(e,n),p);return m.urlParams=d,m.headers=o,m.body=h.uploadData(),m.errorHandler=Tv(t),m}class Av{constructor(e,t,n,i){this.current=e,this.total=t,this.finalized=!!n,this.metadata=i||null}}function Dv(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(i){Cv(!1)}return Cv(!!n&&-1!==(t||["active"]).indexOf(n)),n}const Rv=262144;function jv(e,t,n,i,r,s,o,a){const l=new Av(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw new Ay(Dy.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const c=l.total-l.current;let u=c;r>0&&(u=Math.min(u,r));const h=l.current,d=h+u;let f="";f=0===u?"finalize":c===u?"upload, finalize":"upload";const p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":"".concat(l.current)},m=i.slice(h,d);if(null===m)throw Fy();const g=t.maxUploadRetryTime,y=new wv(n,"POST",function(e,n){const r=Dv(e,["active","final"]),o=l.current+u,a=i.size();let c;return c="final"===r?kv(t,s)(e,n):null,new Av(o,a,"final"===r,c)},g);return y.headers=p,y.body=m.uploadData(),y.progressCallback=a||null,y.errorHandler=Tv(e),y}const Mv="running",Ov="paused",Lv="success",Fv="canceled",zv="error";function Uv(e){switch(e){case"running":case"pausing":case"canceling":return Mv;case"paused":return Ov;case"success":return Lv;case"canceled":return Fv;default:return zv}}class Vv{constructor(e,t,n){const i=function(e){return"function"===typeof e}(e)||null!=t||null!=n;if(i)this.next=e,this.error=null!==t&&void 0!==t?t:void 0,this.complete=null!==n&&void 0!==n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function Bv(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];Promise.resolve().then(()=>e(...n))}}class qv{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ry.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ry.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ry.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,i){if(this.sent_)throw By("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw By("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw By("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw By("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw By("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Hv extends qv{initXhr(){this.xhr_.responseType="text"}}function Wv(){return new Hv}class Gv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=vv(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(Dy.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if($y(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=Oy()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(Dy.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(t=>{let[n,i]=t;switch(this._state){case"running":e(n,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const n=function(e,t,n,i,r){const s=t.bucketOnlyServerUrl(),o=Iv(t,i,r),a={name:o.fullPath},l=Qy(s,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(i.size()),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},u=_v(o,n),h=e.maxUploadRetryTime,d=new wv(l,"POST",function(e){let t;Dv(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){Cv(!1)}return Cv(Wy(t)),t},h);return d.urlParams=a,d.headers=c,d.body=u,d.errorHandler=Tv(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,Wv,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const i=function(e,t,n,i){const r=e.maxUploadRetryTime,s=new wv(n,"POST",function(e){const t=Dv(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(s){Cv(!1)}n||Cv(!1);const r=Number(n);return Cv(!isNaN(r)),new Av(r,i.size(),"final"===t)},r);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=Tv(t),s}(this._ref.storage,this._ref._location,e,this._blob),r=this._ref.storage._makeRequest(i,Wv,t,n);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Rv*this._chunkMultiplier,t=new Av(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((i,r)=>{let s;try{s=jv(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(a){return this._error=a,void this._transition("error")}const o=this._ref.storage._makeRequest(s,Wv,i,r,!1);this._request=o,o.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){2*(Rv*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=Sv(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(n,Wv,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=Pv(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,Wv,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Ly(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Uv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,i){const r=new Vv(t||void 0,n||void 0,i||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Uv(this._state)){case Lv:Bv(this._resolve.bind(null,this.snapshot))();break;case Fv:case zv:Bv(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Uv(this._state)){case Mv:case Ov:e.next&&Bv(e.next.bind(e,this.snapshot))();break;case Lv:e.complete&&Bv(e.complete.bind(e))();break;default:e.error&&Bv(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Kv{constructor(e,t){this._service=e,this._location=t instanceof qy?t:qy.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Kv(e,t)}get root(){const e=new qy(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pv(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new qy(this._location.bucket,e);return new Kv(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Ay(Dy.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Yv(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const i=Qy(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new wv(i,"GET",Ev(e,n),r);return s.errorHandler=Nv(t),s}(e.storage,e._location,vv());return e.storage.makeRequestWithTokens(t,Wv).then(e=>{if(null===e)throw new Ay(Dy.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function Qv(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),i=new qy(e._location.bucket,n);return new Kv(e.storage,i)}function Xv(e,t){if(e instanceof Zv){const n=e;if(null==n._bucket)throw new Ay(Dy.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Py+"' property when initializing the app?");const i=new Kv(n,n._bucket);return null!=t?Xv(i,t):i}return void 0!==t?Qv(e,t):e}function $v(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Zv)return new Kv(e,t);throw zy("To use ref(service, url), the first argument must be a Storage instance.")}return Xv(e,t)}function Jv(e,t){const n=null===t||void 0===t?void 0:t[Py];return null==n?null:qy.makeFromBucketSpec(n,e)}class Zv{constructor(e,t,n,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=Iy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?qy.makeFromBucketSpec(i,this._host):Jv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=qy.makeFromBucketSpec(this._url,e):this._bucket=Jv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Yy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Yy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Kv(this,e)}_makeRequest(e,t,n,i){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new Hy(Uy());{const s=function(e,t,n,i,r,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const a=Xy(e.urlParams),l=e.url+a,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,i),new Jy(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o)}(e,this._appId,n,i,t,this._firebaseVersion,r);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const eb="@firebase/storage",tb="0.11.2",nb="storage";function ib(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Gv(e,new dv(t),n)}(e=re(e),t,n)}function rb(e){return Yv(e=re(e))}function sb(e,t){return $v(e=re(e),t)}function ob(e,t){let{instanceIdentifier:n}=t;const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Zv(i,r,s,n,mt)}function ab(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lb(e){return e+.5|0}ht(new se(nb,ob,"PUBLIC").setMultipleInstances(!0)),vt(eb,tb,""),vt(eb,tb,"esm2017");const cb=(e,t,n)=>Math.max(Math.min(e,n),t);function ub(e){return cb(lb(2.55*e),0,255)}function hb(e){return cb(lb(255*e),0,255)}function db(e){return cb(lb(e/2.55)/100,0,1)}function fb(e){return cb(lb(100*e),0,100)}const pb={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},mb=[..."0123456789ABCDEF"],gb=e=>mb[15&e],yb=e=>mb[(240&e)>>4]+mb[15&e],vb=e=>(240&e)>>4===(15&e);function bb(e){var t=(e=>vb(e.r)&&vb(e.g)&&vb(e.b)&&vb(e.a))(e)?gb:yb;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const xb=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function _b(e,t,n){const i=t*Math.min(n,1-n),r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-i*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function wb(e,t,n){const i=function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(i+e/60)%6;return n-n*t*Math.max(Math.min(r,4-r,1),0)};return[i(5),i(3),i(1)]}function Cb(e,t,n){const i=_b(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function kb(e){const t=e.r/255,n=e.g/255,i=e.b/255,r=Math.max(t,n,i),s=Math.min(t,n,i),o=(r+s)/2;let a,l,c;return r!==s&&(c=r-s,l=o>.5?c/(2-r-s):c/(r+s),a=function(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}(t,n,i,c,r),a=60*a+.5),[0|a,l||0,o]}function Eb(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(hb)}function Tb(e,t,n){return Eb(_b,e,t,n)}function Nb(e){return(e%360+360)%360}function Sb(e){const t=xb.exec(e);let n,i=255;if(!t)return;t[5]!==n&&(i=t[6]?ub(+t[5]):hb(+t[5]));const r=Nb(+t[2]),s=+t[3]/100,o=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Eb(Cb,e,t,n)}(r,s,o):"hsv"===t[1]?function(e,t,n){return Eb(wb,e,t,n)}(r,s,o):Tb(r,s,o),{r:n[0],g:n[1],b:n[2],a:i}}const Ib={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Pb={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Ab;function Db(e){Ab||(Ab=function(){const e={},t=Object.keys(Pb),n=Object.keys(Ib);let i,r,s,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],r=0;r<n.length;r++)s=n[r],a=a.replace(s,Ib[s]);s=parseInt(Pb[o],16),e[a]=[s>>16&255,s>>8&255,255&s]}return e}(),Ab.transparent=[0,0,0,0]);const t=Ab[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const Rb=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const jb=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,Mb=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Ob(e,t,n){if(e){let i=kb(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,0===t?360:1)),i=Tb(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function Lb(e,t){return e?Object.assign(t||{},e):e}function Fb(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=hb(e[3]))):(t=Lb(e,{r:0,g:0,b:0,a:1})).a=hb(t.a),t}function zb(e){return"r"===e.charAt(0)?function(e){const t=Rb.exec(e);let n,i,r,s=255;if(t){if(t[7]!==n){const e=+t[7];s=t[8]?ub(e):cb(255*e,0,255)}return n=+t[1],i=+t[3],r=+t[5],n=255&(t[2]?ub(n):cb(n,0,255)),i=255&(t[4]?ub(i):cb(i,0,255)),r=255&(t[6]?ub(r):cb(r,0,255)),{r:n,g:i,b:r,a:s}}}(e):Sb(e)}class Ub{constructor(e){if(e instanceof Ub)return e;const t=typeof e;let n;"object"===t?n=Fb(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*pb[e[1]],g:255&17*pb[e[2]],b:255&17*pb[e[3]],a:5===n?17*pb[e[4]]:255}:7!==n&&9!==n||(t={r:pb[e[1]]<<4|pb[e[2]],g:pb[e[3]]<<4|pb[e[4]],b:pb[e[5]]<<4|pb[e[6]],a:9===n?pb[e[7]]<<4|pb[e[8]]:255})),t}(e)||Db(e)||zb(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=Lb(this._rgb);return e&&(e.a=db(e.a)),e}set rgb(e){this._rgb=Fb(e)}rgbString(){return this._valid?function(e){return e&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(db(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"))}(this._rgb):void 0}hexString(){return this._valid?bb(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=kb(e),n=t[0],i=fb(t[1]),r=fb(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(i,"%, ").concat(r,"%, ").concat(db(e.a),")"):"hsl(".concat(n,", ").concat(i,"%, ").concat(r,"%)")}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let r;const s=t===r?.5:t,o=2*s-1,a=n.a-i.a,l=((o*a===-1?o:(o+a)/(1+o*a))+1)/2;r=1-l,n.r=255&l*n.r+r*i.r+.5,n.g=255&l*n.g+r*i.g+.5,n.b=255&l*n.b+r*i.b+.5,n.a=s*n.a+(1-s)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const i=Mb(db(e.r)),r=Mb(db(e.g)),s=Mb(db(e.b));return{r:hb(jb(i+n*(Mb(db(t.r))-i))),g:hb(jb(r+n*(Mb(db(t.g))-r))),b:hb(jb(s+n*(Mb(db(t.b))-s))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new Ub(this.rgb)}alpha(e){return this._rgb.a=hb(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=lb(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ob(this._rgb,2,e),this}darken(e){return Ob(this._rgb,2,-e),this}saturate(e){return Ob(this._rgb,1,e),this}desaturate(e){return Ob(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=kb(e);n[0]=Nb(n[0]+t),n=Tb(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function Vb(){}const Bb=(()=>{let e=0;return()=>e++})();function qb(e){return null===e||void 0===e}function Hb(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function Wb(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function Gb(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function Kb(e,t){return Gb(e)?e:t}function Yb(e,t){return"undefined"===typeof e?t:e}const Qb=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Xb(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function $b(e,t,n,i){let r,s,o;if(Hb(e))if(s=e.length,i)for(r=s-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<s;r++)t.call(n,e[r],r);else if(Wb(e))for(o=Object.keys(e),s=o.length,r=0;r<s;r++)t.call(n,e[o[r]],o[r])}function Jb(e,t){let n,i,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Zb(e){if(Hb(e))return e.map(Zb);if(Wb(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=Zb(e[n[r]]);return t}return e}function ex(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function tx(e,t,n,i){if(!ex(e))return;const r=t[e],s=n[e];Wb(r)&&Wb(s)?nx(r,s,i):t[e]=Zb(s)}function nx(e,t,n){const i=Hb(t)?t:[t],r=i.length;if(!Wb(e))return e;const s=(n=n||{}).merger||tx;let o;for(let a=0;a<r;++a){if(o=i[a],!Wb(o))continue;const t=Object.keys(o);for(let i=0,r=t.length;i<r;++i)s(t[i],e,o,n)}return e}function ix(e,t){return nx(e,t,{merger:rx})}function rx(e,t,n){if(!ex(e))return;const i=t[e],r=n[e];Wb(i)&&Wb(r)?ix(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Zb(r))}const sx={"":e=>e,x:e=>e.x,y:e=>e.y};function ox(e,t){const n=sx[t]||(sx[t]=function(e){const t=function(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function ax(e){return e.charAt(0).toUpperCase()+e.slice(1)}const lx=e=>"undefined"!==typeof e,cx=e=>"function"===typeof e,ux=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const hx=Math.PI,dx=2*hx,fx=dx+hx,px=Number.POSITIVE_INFINITY,mx=hx/180,gx=hx/2,yx=hx/4,vx=2*hx/3,bx=Math.log10,xx=Math.sign;function _x(e,t,n){return Math.abs(e-t)<n}function wx(e){const t=Math.round(e);e=_x(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(bx(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Cx(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function kx(e,t,n){let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function Ex(e){return e*(hx/180)}function Tx(e){return e*(180/hx)}function Nx(e){if(!Gb(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Sx(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*hx&&(s+=dx),{angle:s,distance:r}}function Ix(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Px(e,t){return(e-t+fx)%dx-hx}function Ax(e){return(e%dx+dx)%dx}function Dx(e,t,n,i){const r=Ax(e),s=Ax(t),o=Ax(n),a=Ax(s-r),l=Ax(o-r),c=Ax(r-s),u=Ax(r-o);return r===s||r===o||i&&s===o||a>l&&c<u}function Rx(e,t,n){return Math.max(t,Math.min(n,e))}function jx(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function Mx(e,t,n){n=n||(n=>e[n]<t);let i,r=e.length-1,s=0;for(;r-s>1;)i=s+r>>1,n(i)?s=i:r=i;return{lo:s,hi:r}}const Ox=(e,t,n,i)=>Mx(e,n,i?i=>{const r=e[i][t];return r<n||r===n&&e[i+1][t]===n}:i=>e[i][t]<n),Lx=(e,t,n)=>Mx(e,n,i=>e[i][t]>=n);const Fx=["push","pop","shift","splice","unshift"];function zx(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);-1!==r&&i.splice(r,1),i.length>0||(Fx.forEach(t=>{delete e[t]}),delete e._chartjs)}function Ux(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Vx="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function Bx(e,t){let n=[],i=!1;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];n=s,i||(i=!0,Vx.call(window,()=>{i=!1,e.apply(t,n)}))}}const qx=e=>"start"===e?"left":"end"===e?"right":"center",Hx=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function Wx(e,t,n){const i=t.length;let r=0,s=i;if(e._sorted){const{iScale:o,vScale:a,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=o.axis,{min:h,max:d,minDefined:f,maxDefined:p}=o.getUserBounds();if(f){if(r=Math.min(Ox(l,u,h).lo,n?i:Ox(t,u,o.getPixelForValue(h)).lo),c){const e=l.slice(0,r+1).reverse().findIndex(e=>!qb(e[a.axis]));r-=Math.max(0,e)}r=Rx(r,0,i-1)}if(p){let e=Math.max(Ox(l,o.axis,d,!0).hi+1,n?0:Ox(t,u,o.getPixelForValue(d),!0).hi+1);if(c){const t=l.slice(e-1).findIndex(e=>!qb(e[a.axis]));e+=Math.max(0,t)}s=Rx(e,r,i)-r}else s=i-r}return{start:r,count:s}}function Gx(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Kx=e=>0===e||1===e,Yx=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*dx/n),Qx=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*dx/n)+1,Xx={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*gx),easeOutSine:e=>Math.sin(e*gx),easeInOutSine:e=>-.5*(Math.cos(hx*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>Kx(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Kx(e)?e:Yx(e,.075,.3),easeOutElastic:e=>Kx(e)?e:Qx(e,.075,.3),easeInOutElastic(e){const t=.1125;return Kx(e)?e:e<.5?.5*Yx(2*e,t,.45):.5+.5*Qx(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Xx.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*Xx.easeInBounce(2*e):.5*Xx.easeOutBounce(2*e-1)+.5};function $x(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function Jx(e){return $x(e)?e:new Ub(e)}function Zx(e){return $x(e)?e:new Ub(e).saturate(.5).darken(.1).hexString()}const e_=["x","y","borderWidth","radius","tension"],t_=["color","borderColor","backgroundColor"];const n_=new Map;function i_(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let i=n_.get(n);return i||(i=new Intl.NumberFormat(e,t),n_.set(n,i)),i}(t,n).format(e)}const r_={values:e=>Hb(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const i=this.chart.options.locale;let r,s=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),s=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const o=bx(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),i_(e,i,l)},logarithmic(e,t,n){if(0===e)return"0";const i=n[t].significand||e/Math.pow(10,Math.floor(bx(e)));return[1,2,3,5,10,15].includes(i)||t>.8*n.length?r_.numeric.call(this,e,t,n):""}};var s_={formatters:r_};const o_=Object.create(null),a_=Object.create(null);function l_(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const t=n[i];e=e[t]||(e[t]=Object.create(null))}return e}function c_(e,t,n){return"string"===typeof t?nx(l_(e,t),n):nx(l_(e,""),t)}class u_{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Zx(t.backgroundColor),this.hoverBorderColor=(e,t)=>Zx(t.borderColor),this.hoverColor=(e,t)=>Zx(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return c_(this,e,t)}get(e){return l_(this,e)}describe(e,t){return c_(a_,e,t)}override(e,t){return c_(o_,e,t)}route(e,t,n,i){const r=l_(this,e),s=l_(this,n),o="_"+t;Object.defineProperties(r,{[o]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[o],t=s[i];return Wb(e)?Object.assign({},t,e):Yb(e,t)},set(e){this[o]=e}}})}apply(e){e.forEach(e=>e(this))}}var h_=new u_({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:t_},numbers:{type:"number",properties:e_}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:s_.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function d_(e,t,n,i,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>i&&(i=s),i}function f_(e,t,n,i){let r=(i=i||{}).data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let o=0;const a=n.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=n[l],void 0===h||null===h||Hb(h)){if(Hb(h))for(c=0,u=h.length;c<u;c++)d=h[c],void 0===d||null===d||Hb(d)||(o=d_(e,r,s,o,d))}else o=d_(e,r,s,o,h);e.restore();const f=s.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[s[l]];s.splice(0,f)}return o}function p_(e,t,n){const i=e.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function m_(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function g_(e,t,n,i){y_(e,t,n,i,null)}function y_(e,t,n,i,r){let s,o,a,l,c,u,h,d;const f=t.pointStyle,p=t.rotation,m=t.radius;let g=(p||0)*mx;if(f&&"object"===typeof f&&(s=f.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return e.save(),e.translate(n,i),e.rotate(g),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(m)||m<=0)){switch(e.beginPath(),f){default:r?e.ellipse(n,i,r/2,m,0,0,dx):e.arc(n,i,m,0,dx),e.closePath();break;case"triangle":u=r?r/2:m,e.moveTo(n+Math.sin(g)*u,i-Math.cos(g)*m),g+=vx,e.lineTo(n+Math.sin(g)*u,i-Math.cos(g)*m),g+=vx,e.lineTo(n+Math.sin(g)*u,i-Math.cos(g)*m),e.closePath();break;case"rectRounded":c=.516*m,l=m-c,o=Math.cos(g+yx)*l,h=Math.cos(g+yx)*(r?r/2-c:l),a=Math.sin(g+yx)*l,d=Math.sin(g+yx)*(r?r/2-c:l),e.arc(n-h,i-a,c,g-hx,g-gx),e.arc(n+d,i-o,c,g-gx,g),e.arc(n+h,i+a,c,g,g+gx),e.arc(n-d,i+o,c,g+gx,g+hx),e.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=r?r/2:l,e.rect(n-u,i-l,2*u,2*l);break}g+=yx;case"rectRot":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-a),e.lineTo(n+d,i-o),e.lineTo(n+h,i+a),e.lineTo(n-d,i+o),e.closePath();break;case"crossRot":g+=yx;case"cross":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-a),e.lineTo(n+h,i+a),e.moveTo(n+d,i-o),e.lineTo(n-d,i+o);break;case"star":h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-a),e.lineTo(n+h,i+a),e.moveTo(n+d,i-o),e.lineTo(n-d,i+o),g+=yx,h=Math.cos(g)*(r?r/2:m),o=Math.cos(g)*m,a=Math.sin(g)*m,d=Math.sin(g)*(r?r/2:m),e.moveTo(n-h,i-a),e.lineTo(n+h,i+a),e.moveTo(n+d,i-o),e.lineTo(n-d,i+o);break;case"line":o=r?r/2:Math.cos(g)*m,a=Math.sin(g)*m,e.moveTo(n-o,i-a),e.lineTo(n+o,i+a);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(g)*(r?r/2:m),i+Math.sin(g)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function v_(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function b_(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function x_(e){e.restore()}function __(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if("middle"===r){const i=(t.x+n.x)/2;e.lineTo(i,t.y),e.lineTo(i,n.y)}else"after"===r!==!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function w_(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function C_(e,t,n,i,r){if(r.strikethrough||r.underline){const s=e.measureText(i),o=t-s.actualBoundingBoxLeft,a=t+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,u),e.lineTo(a,u),e.stroke()}}function k_(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function E_(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=Hb(t)?t:[t],a=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),qb(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&k_(e,s.backdrop),a&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),qb(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,n,i,s.maxWidth)),e.fillText(c,n,i,s.maxWidth),C_(e,n,i,c,s),i+=Number(r.lineHeight);e.restore()}function T_(e,t){const{x:n,y:i,w:r,h:s,radius:o}=t;e.arc(n+o.topLeft,i+o.topLeft,o.topLeft,1.5*hx,hx,!0),e.lineTo(n,i+s-o.bottomLeft),e.arc(n+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,hx,gx,!0),e.lineTo(n+r-o.bottomRight,i+s),e.arc(n+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,gx,0,!0),e.lineTo(n+r,i+o.topRight),e.arc(n+r-o.topRight,i+o.topRight,o.topRight,0,-gx,!0),e.lineTo(n+o.topLeft,i)}const N_=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,S_=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function I_(e,t){const n=(""+e).match(N_);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}const P_=e=>+e||0;function A_(e,t){const n={},i=Wb(t),r=i?Object.keys(t):t,s=Wb(e)?i?n=>Yb(e[n],e[t[n]]):t=>e[t]:()=>e;for(const o of r)n[o]=P_(s(o));return n}function D_(e){return A_(e,{top:"y",right:"x",bottom:"y",left:"x"})}function R_(e){return A_(e,["topLeft","topRight","bottomLeft","bottomRight"])}function j_(e){const t=D_(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function M_(e,t){e=e||{},t=t||h_.font;let n=Yb(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let i=Yb(e.style,t.style);i&&!(""+i).match(S_)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:Yb(e.family,t.family),lineHeight:I_(Yb(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:Yb(e.weight,t.weight),string:""};return r.string=function(e){return!e||qb(e.size)||qb(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(r),r}function O_(e,t,n,i){let r,s,o,a=!0;for(r=0,s=e.length;r<s;++r)if(o=e[r],void 0!==o&&(void 0!==t&&"function"===typeof o&&(o=o(t),a=!1),void 0!==n&&Hb(o)&&(o=o[n%o.length],a=!1),void 0!==o))return i&&!a&&(i.cacheable=!1),o}function L_(e,t){return Object.assign(Object.create(e),t)}function F_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const r=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=Q_("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:r,_fallback:n,_getTarget:i,override:i=>F_([i,...e],t,r,n)};return new Proxy(s,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,i)=>q_(n,i,()=>function(e,t,n,i){let r;for(const s of t)if(r=Q_(V_(s,e),n),"undefined"!==typeof r)return B_(e,r)?K_(n,i,e,r):r}(i,t,e,n)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>X_(e).includes(t),ownKeys:e=>X_(e),set(e,t,n){const r=e._storage||(e._storage=i());return e[t]=r[t]=n,delete e._keys,!0}})}function z_(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:U_(e,i),setContext:t=>z_(e,t,n,i),override:r=>z_(e.override(r),t,n,i)};return new Proxy(r,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>q_(e,t,()=>function(e,t,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=e;let a=i[t];cx(a)&&o.isScriptable(t)&&(a=function(e,t,n,i){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(s,o||i);a.delete(e),B_(e,l)&&(l=K_(r._scopes,r,e,l));return l}(t,a,e,n));Hb(a)&&a.length&&(a=function(e,t,n,i){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=n;if("undefined"!==typeof s.index&&i(e))return t[s.index%t.length];if(Wb(t[0])){const n=t,i=r._scopes.filter(e=>e!==n);t=[];for(const l of n){const n=K_(i,r,e,l);t.push(z_(n,s,o&&o[e],a))}}return t}(t,a,e,o.isIndexable));B_(t,a)&&(a=z_(a,r,s&&s[t],o));return a}(e,t,n)),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,i)=>(e[n]=i,delete t[n],!0)})}function U_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:cx(n)?n:()=>n,isIndexable:cx(i)?i:()=>i}}const V_=(e,t)=>e?e+ax(t):t,B_=(e,t)=>Wb(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function q_(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const i=n();return e[t]=i,i}function H_(e,t,n){return cx(e)?e(t,n):e}const W_=(e,t)=>!0===e?t:"string"===typeof e?ox(t,e):void 0;function G_(e,t,n,i,r){for(const s of t){const t=W_(n,s);if(t){e.add(t);const s=H_(t._fallback,n,r);if("undefined"!==typeof s&&s!==n&&s!==i)return s}else if(!1===t&&"undefined"!==typeof i&&n!==i)return null}return!1}function K_(e,t,n,i){const r=t._rootScopes,s=H_(t._fallback,n,i),o=[...e,...r],a=new Set;a.add(i);let l=Y_(a,o,n,s||n,i);return null!==l&&(("undefined"===typeof s||s===n||(l=Y_(a,o,s,l,i),null!==l))&&F_(Array.from(a),[""],r,s,()=>function(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];if(Hb(r)&&Wb(n))return n;return r||{}}(t,n,i)))}function Y_(e,t,n,i,r){for(;n;)n=G_(e,t,n,i,r);return n}function Q_(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function X_(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}function $_(e,t,n,i){const{iScale:r}=e,{key:s="r"}=this._parsing,o=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+n,u=t[c],o[a]={r:r.parse(ox(u,s),c)};return o}const J_=Number.EPSILON||1e-14,Z_=(e,t)=>t<e.length&&!e[t].skip&&e[t],ew=e=>"x"===e?"y":"x";function tw(e,t,n,i){const r=e.skip?t:e,s=t,o=n.skip?t:n,a=Ix(s,r),l=Ix(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:s.x-h*(o.x-r.x),y:s.y-h*(o.y-r.y)},next:{x:s.x+d*(o.x-r.x),y:s.y+d*(o.y-r.y)}}}function nw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=ew(t),i=e.length,r=Array(i).fill(0),s=Array(i);let o,a,l,c=Z_(e,0);for(o=0;o<i;++o)if(a=l,l=c,c=Z_(e,o+1),l){if(c){const e=c[t]-l[t];r[o]=0!==e?(c[n]-l[n])/e:0}s[o]=a?c?xx(r[o-1])!==xx(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}!function(e,t,n){const i=e.length;let r,s,o,a,l,c=Z_(e,0);for(let u=0;u<i-1;++u)l=c,c=Z_(e,u+1),l&&c&&(_x(t[u],0,J_)?n[u]=n[u+1]=0:(r=n[u]/t[u],s=n[u+1]/t[u],a=Math.pow(r,2)+Math.pow(s,2),a<=9||(o=3/Math.sqrt(a),n[u]=r*o*t[u],n[u+1]=s*o*t[u])))}(e,r,s),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const i=ew(n),r=e.length;let s,o,a,l=Z_(e,0);for(let c=0;c<r;++c){if(o=a,a=l,l=Z_(e,c+1),!a)continue;const r=a[n],u=a[i];o&&(s=(r-o[n])/3,a["cp1".concat(n)]=r-s,a["cp1".concat(i)]=u-s*t[c]),l&&(s=(l[n]-r)/3,a["cp2".concat(n)]=r+s,a["cp2".concat(i)]=u+s*t[c])}}(e,s,t)}function iw(e,t,n){return Math.max(Math.min(e,n),t)}function rw(e,t,n,i,r){let s,o,a,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)nw(e,r);else{let n=i?e[e.length-1]:e[0];for(s=0,o=e.length;s<o;++s)a=e[s],l=tw(n,a,e[Math.min(s+1,o-(i?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,n=a}t.capBezierPoints&&function(e,t){let n,i,r,s,o,a=v_(e[0],t);for(n=0,i=e.length;n<i;++n)o=s,s=a,a=n<i-1&&v_(e[n+1],t),s&&(r=e[n],o&&(r.cp1x=iw(r.cp1x,t.left,t.right),r.cp1y=iw(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=iw(r.cp2x,t.left,t.right),r.cp2y=iw(r.cp2y,t.top,t.bottom)))}(e,n)}function sw(){return"undefined"!==typeof window&&"undefined"!==typeof document}function ow(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function aw(e,t,n){let i;return"string"===typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[n])):i=e,i}const lw=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const cw=["top","right","bottom","left"];function uw(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=cw[r];i[s]=parseFloat(e[t+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function hw(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=lw(n),s="border-box"===r.boxSizing,o=uw(r,"padding"),a=uw(r,"border","width"),{x:l,y:c,box:u}=function(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=i;let o,a,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(r,s,e.target))o=r,a=s;else{const e=t.getBoundingClientRect();o=i.clientX-e.left,a=i.clientY-e.top,l=!0}return{x:o,y:a,box:l}}(e,n),h=o.left+(u&&a.left),d=o.top+(u&&a.top);let{width:f,height:p}=t;return s&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((l-h)/f*n.width/i),y:Math.round((c-d)/p*n.height/i)}}const dw=e=>Math.round(10*e)/10;function fw(e,t,n,i){const r=lw(e),s=uw(r,"margin"),o=aw(r.maxWidth,e,"clientWidth")||px,a=aw(r.maxHeight,e,"clientHeight")||px,l=function(e,t,n){let i,r;if(void 0===t||void 0===n){const s=e&&ow(e);if(s){const e=s.getBoundingClientRect(),o=lw(s),a=uw(o,"border","width"),l=uw(o,"padding");t=e.width-l.width-a.width,n=e.height-l.height-a.height,i=aw(o.maxWidth,s,"clientWidth"),r=aw(o.maxHeight,s,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:i||px,maxHeight:r||px}}(e,t,n);let{width:c,height:u}=l;if("content-box"===r.boxSizing){const e=uw(r,"border","width"),t=uw(r,"padding");c-=t.width+e.width,u-=t.height+e.height}c=Math.max(0,c-s.width),u=Math.max(0,i?c/i:u-s.height),c=dw(Math.min(c,o,l.maxWidth)),u=dw(Math.min(u,a,l.maxHeight)),c&&!u&&(u=dw(c/2));return(void 0!==t||void 0!==n)&&i&&l.height&&u>l.height&&(u=l.height,c=dw(Math.floor(u*i))),{width:c,height:u}}function pw(e,t,n){const i=t||1,r=Math.floor(e.height*i),s=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height="".concat(e.height,"px"),o.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==i||o.height!==r||o.width!==s)&&(e.currentDevicePixelRatio=i,o.height=r,o.width=s,e.ctx.setTransform(i,0,0,i,0,0),!0)}const mw=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};sw()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(t){}return e}();function gw(e,t){const n=function(e,t){return lw(e).getPropertyValue(t)}(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function yw(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function vw(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:"middle"===i?n<.5?e.y:t.y:"after"===i?n<1?e.y:t.y:n>0?t.y:e.y}}function bw(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},o=yw(e,r,n),a=yw(r,s,n),l=yw(s,t,n),c=yw(o,a,n),u=yw(a,l,n);return yw(c,u,n)}function xw(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function _w(e,t){let n,i;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function ww(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Cw(e){return"angle"===e?{between:Dx,compare:Px,normalize:Ax}:{between:jx,compare:(e,t)=>e-t,normalize:e=>e}}function kw(e){let{start:t,end:n,count:i,loop:r,style:s}=e;return{start:t%i,end:n%i,loop:r&&(n-t+1)%i===0,style:s}}function Ew(e,t,n){if(!n)return[e];const{property:i,start:r,end:s}=n,o=t.length,{compare:a,between:l,normalize:c}=Cw(i),{start:u,end:h,loop:d,style:f}=function(e,t,n){const{property:i,start:r,end:s}=n,{between:o,normalize:a}=Cw(i),l=t.length;let c,u,{start:h,end:d,loop:f}=e;if(f){for(h+=l,d+=l,c=0,u=l;c<u&&o(a(t[h%l][i]),r,s);++c)h--,d--;h%=l,d%=l}return d<h&&(d+=l),{start:h,end:d,loop:f,style:e.style}}(e,t,n),p=[];let m,g,y,v=!1,b=null;const x=()=>v||l(r,y,m)&&0!==a(r,y),_=()=>!v||0===a(s,m)||l(s,y,m);for(let w=u,C=u;w<=h;++w)g=t[w%o],g.skip||(m=c(g[i]),m!==y&&(v=l(m,r,s),null===b&&x()&&(b=0===a(m,r)?w:C),null!==b&&_()&&(p.push(kw({start:b,end:w,loop:d,count:o,style:f})),b=null),C=w,y=m));return null!==b&&p.push(kw({start:b,end:h,loop:d,count:o,style:f})),p}function Tw(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const s=Ew(i[r],e.points,t);s.length&&n.push(...s)}return n}function Nw(e,t,n,i){return i&&i.setContext&&n?function(e,t,n,i){const r=e._chart.getContext(),s=Sw(e.options),{_datasetIndex:o,options:{spanGaps:a}}=e,l=n.length,c=[];let u=s,h=t[0].start,d=h;function f(e,t,i,r){const s=a?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=s;for(;n[t%l].skip;)t+=s;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:i,style:r}),u=r,h=t%l)}}for(const p of t){h=a?h:p.start;let e,t=n[h%l];for(d=h+1;d<=p.end;d++){const s=n[d%l];e=Sw(i.setContext(L_(r,{type:"segment",p0:t,p1:s,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),Iw(e,u)&&f(h,d-1,p.loop,u),t=s,u=e}h<d-1&&f(h,d-1,p.loop,u)}return c}(e,t,n,i):t}function Sw(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Iw(e,t){if(!t)return!1;const n=[],i=function(e,t){return $x(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,i)!==JSON.stringify(t,i)}function Pw(e,t,n){return e.options.clip?e[n]:t[n]}function Aw(e,t){const n=t._clip;if(n.disabled)return!1;const i=function(e,t){const{xScale:n,yScale:i}=e;return n&&i?{left:Pw(n,t,"left"),right:Pw(n,t,"right"),top:Pw(i,t,"top"),bottom:Pw(i,t,"bottom")}:t}(t,e.chartArea);return{left:!1===n.left?0:i.left-(!0===n.left?0:n.left),right:!1===n.right?e.width:i.right+(!0===n.right?0:n.right),top:!1===n.top?0:i.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?e.height:i.bottom+(!0===n.bottom?0:n.bottom)}}class Dw{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const r=t.listeners[i],s=t.duration;r.forEach(i=>i({chart:e,initial:t.initial,numSteps:s,currentStep:Math.min(n-t.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=Vx.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const r=n.items;let s,o=r.length-1,a=!1;for(;o>=0;--o)s=r[o],s._active?(s._total>n.duration&&(n.duration=s._total),s.tick(e),a=!0):(r[o]=r[r.length-1],r.pop());a&&(i.draw(),this._notify(i,n,e,"progress")),r.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=r.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Rw=new Dw;const jw="transparent",Mw={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const i=Jx(e||jw),r=i.valid&&Jx(t||jw);return r&&r.valid?r.mix(i,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class Ow{constructor(e,t,n,i){const r=t[n];i=O_([e.to,i,r,e.from]);const s=O_([e.from,r,i]);this._active=!0,this._fn=e.fn||Mw[e.type||typeof s],this._easing=Xx[e.easing]||Xx.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=s,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],r=n-this._start,s=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(s,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=O_([e.to,t,i,e.from]),this._from=O_([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,r=this._from,s=this._loop,o=this._to;let a;if(this._active=r!==o&&(s||t<n),!this._active)return this._target[i]=o,void this._notify(!0);t<0?this._target[i]=r:(a=t/n%2,a=s&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[i]=this._fn(r,o,a))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class Lw{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Wb(e))return;const t=Object.keys(h_.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const r=e[i];if(!Wb(r))return;const s={};for(const e of t)s[e]=r[e];(Hb(r.properties)&&r.properties||[i]).forEach(e=>{e!==i&&n.has(e)||n.set(e,s)})})}_animateOptions(e,t){const n=t.options,i=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!i)return[];const r=this._createAnimations(i,n);return n.$shared&&function(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const t=e[i[r]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then(()=>{e.options=n},()=>{}),r}_createAnimations(e,t){const n=this._properties,i=[],r=e.$animations||(e.$animations={}),s=Object.keys(t),o=Date.now();let a;for(a=s.length-1;a>=0;--a){const l=s[a];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(e,t));continue}const c=t[l];let u=r[l];const h=n.get(l);if(u){if(h&&u.active()){u.update(h,c,o);continue}u.cancel()}h&&h.duration?(r[l]=u=new Ow(h,e,l,c),i.push(u)):e[l]=c}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(Rw.add(this._chart,n),!0):void 0}}function Fw(e,t){const n=e&&e.options||{},i=n.reverse,r=void 0===n.min?t:0,s=void 0===n.max?t:0;return{start:i?s:r,end:i?r:s}}function zw(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function Uw(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=e.keys,s="single"===i.mode;let o,a,l,c;if(null===t)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(u=!0,i.all)continue;break}c=e.values[l],Gb(c)&&(s||0===t||xx(t)===xx(c))&&(t+=c)}return u||i.all?t:0}function Vw(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function Bw(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function qw(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const t=e[r.index];if(n&&t>0||!n&&t<0)return r.index}return null}function Hw(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:o,index:a}=i,l=s.axis,c=o.axis,u=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(s,o,i),h=t.length;let d;for(let f=0;f<h;++f){const e=t[f],{[l]:n,[c]:s}=e;d=(e._stacks||(e._stacks={}))[c]=Bw(r,u,n),d[a]=s,d._top=qw(d,o,!0,i.type),d._bottom=qw(d,o,!1,i.type);(d._visualValues||(d._visualValues={}))[a]=s}}function Ww(e,t){const n=e.scales;return Object.keys(n).filter(e=>n[e].axis===t).shift()}function Gw(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[i]||void 0===t[i][n])return;delete t[i][n],void 0!==t[i]._visualValues&&void 0!==t[i]._visualValues[n]&&delete t[i]._visualValues[n]}}}const Kw=e=>"reset"===e||"none"===e,Yw=(e,t)=>t?e:Object.assign({},e);class Qw{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Vw(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Gw(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(e,t,n,i)=>"x"===e?t:"r"===e?i:n,r=t.xAxisID=Yb(n.xAxisID,Ww(e,"x")),s=t.yAxisID=Yb(n.yAxisID,Ww(e,"y")),o=t.rAxisID=Yb(n.rAxisID,Ww(e,"r")),a=t.indexAxis,l=t.iAxisID=i(a,r,s,o),c=t.vAxisID=i(a,s,r,o);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(s),t.rScale=this.getScaleForId(o),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&zx(this._data,this),e._stacked&&Gw(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Wb(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:i}=t,r="x"===n.axis?"x":"y",s="x"===i.axis?"x":"y",o=Object.keys(e),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[s]:e[u]};return a}(t,e)}else if(n!==t){if(n){zx(n,this);const e=this._cachedMeta;Gw(e),e._parsed=[]}t&&Object.isExtensible(t)&&(r=this,(i=t)._chartjs?i._chartjs.listeners.push(r):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),Fx.forEach(e=>{const t="_onData"+ax(e),n=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];const o=n.apply(this,r);return i._chartjs.listeners.forEach(e=>{"function"===typeof e[t]&&e[t](...r)}),o}})}))),this._syncList=[],this._data=t}var i,r}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const r=t._stacked;t._stacked=Vw(t.vScale,t),t.stack!==n.stack&&(i=!0,Gw(t),t.stack=n.stack),this._resyncElements(e),(i||r!==t._stacked)&&(Hw(this,t._parsed),t._stacked=Vw(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:r,_stacked:s}=n,o=r.axis;let a,l,c,u=0===e&&t===i.length||n._sorted,h=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,c=i;else{c=Hb(i[e])?this.parseArrayData(n,i,e,t):Wb(i[e])?this.parseObjectData(n,i,e,t):this.parsePrimitiveData(n,i,e,t);const r=()=>null===l[o]||h&&l[o]<h[o];for(a=0;a<t;++a)n._parsed[a+e]=l=c[a],u&&(r()&&(u=!1),h=l);n._sorted=u}s&&Hw(this,c)}parsePrimitiveData(e,t,n,i){const{iScale:r,vScale:s}=e,o=r.axis,a=s.axis,l=r.getLabels(),c=r===s,u=new Array(i);let h,d,f;for(h=0,d=i;h<d;++h)f=h+n,u[h]={[o]:c||r.parse(l[f],f),[a]:s.parse(t[f],f)};return u}parseArrayData(e,t,n,i){const{xScale:r,yScale:s}=e,o=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+n,u=t[c],o[a]={x:r.parse(u[0],c),y:s.parse(u[1],c)};return o}parseObjectData(e,t,n,i){const{xScale:r,yScale:s}=e,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l=new Array(i);let c,u,h,d;for(c=0,u=i;c<u;++c)h=c+n,d=t[h],l[c]={x:r.parse(ox(d,o),h),y:s.parse(ox(d,a),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,r=this._cachedMeta,s=t[e.axis];return Uw({keys:zw(i,!0),values:t._stacks[e.axis]._visualValues},s,r.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const r=n[t.axis];let s=null===r?NaN:r;const o=i&&n._stacks[t.axis];i&&o&&(i.values=o,s=Uw(i,r,this._cachedMeta.index)),e.min=Math.min(e.min,s),e.max=Math.max(e.max,s)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,r=n._sorted&&e===n.iScale,s=i.length,o=this._getOtherScale(e),a=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:zw(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(o);let h,d;function f(){d=i[h];const t=d[o.axis];return!Gb(d[e.axis])||c>t||u<t}for(h=0;h<s&&(f()||(this.updateRangeFromParsed(l,e,d,a),!r));++h);if(r)for(h=s-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(l,e,d,a);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,r,s;for(i=0,r=t.length;i<r;++i)s=t[i][e.axis],Gb(s)&&n.push(s);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,i,r;return Wb(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:!1===e}}(Yb(this.options.clip,function(e,t,n){if(!1===n)return!1;const i=Fw(e,n),r=Fw(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],r=t.chartArea,s=[],o=this._drawStart||0,a=this._drawCount||i.length-o,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,r,o,a),c=o;c<o+a;++c){const t=i[c];t.hidden||(t.active&&l?s.push(t):t.draw(e,r))}for(c=0;c<s.length;++c)s[c].draw(e,r)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,n){return L_(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),r.parsed=this.getParsed(e),r.raw=i.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return L_(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const i="active"===t,r=this._cachedDataOpts,s=e+"-"+t,o=r[s],a=this.enableOptionSharing&&lx(n);if(o)return Yw(o,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=i?["".concat(e,"Hover"),"hover",e,""]:[e,""],h=l.getOptionScopes(this.getDataset(),c),d=Object.keys(h_.elements[e]),f=l.resolveNamedOptions(h,d,()=>this.getContext(n,i,t),u);return f.$shared&&(f.$shared=a,r[s]=Object.freeze(Yw(f,a))),f}_resolveAnimations(e,t,n){const i=this.chart,r=this._cachedDataOpts,s="animation-".concat(t),o=r[s];if(o)return o;let a;if(!1!==i.options.animation){const i=this.chart.config,r=i.datasetAnimationScopeKeys(this._type,t),s=i.getOptionScopes(this.getDataset(),r);a=i.createResolver(s,this.getContext(e,n,t))}const l=new Lw(i,a&&a.animations);return a&&a._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Kw(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,r=this.getSharedOptions(n),s=this.includeOptions(t,r)||r!==i;return this.updateSharedOptions(r,t,n),{sharedOptions:r,includeOptions:s}}updateElement(e,t,n,i){Kw(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!Kw(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const r=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[o,a,l]of this._syncList)this[o](a,l);this._syncList=[];const i=n.length,r=t.length,s=Math.min(r,i);s&&this.parse(0,s),r>i?this._insertElements(i,r-i,e):r<i&&this._removeElements(r,i-r)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this._cachedMeta,r=i.data,s=e+t;let o;const a=e=>{for(e.length+=t,o=e.length-1;o>=s;o--)e[o]=e[o-t]};for(a(r),o=e;o<s;++o)r[o]=new this.dataElementType;this._parsing&&a(i._parsed),this.parse(e,t),n&&this.updateElements(r,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&Gw(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Xw(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let t=0,r=n.length;t<r;t++)i=i.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=Ux(i.sort((e,t)=>e-t))}return e._cache.$bar}(t,e.type);let i,r,s,o,a=t._length;const l=()=>{32767!==s&&-32768!==s&&(lx(o)&&(a=Math.min(a,Math.abs(s-o)||a)),o=s)};for(i=0,r=n.length;i<r;++i)s=t.getPixelForValue(n[i]),l();for(o=void 0,i=0,r=t.ticks.length;i<r;++i)s=t.getPixelForTick(i),l();return a}function $w(e,t,n,i){return Hb(e)?function(e,t,n,i){const r=n.parse(e[0],i),s=n.parse(e[1],i),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}(e,t,n,i):t[n.axis]=n.parse(e,i),t}function Jw(e,t,n,i){const r=e.iScale,s=e.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=t[c],h={},h[r.axis]=a||r.parse(o[c],c),l.push($w(d,h,s,c));return l}function Zw(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function eC(e,t,n,i){let r=t.borderSkipped;const s={};if(!r)return void(e.borderSkipped=s);if(!0===r)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:l,top:c,bottom:u}=function(e){let t,n,i,r,s;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:t,top:r,bottom:s}}(e);"middle"===r&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=u:(s[tC(u,o,a,l)]=!0,r=c)),s[tC(r,o,a,l)]=!0,e.borderSkipped=s}function tC(e,t,n,i){var r,s,o;return i?(o=n,e=nC(e=(r=e)===(s=t)?o:r===o?s:r,n,t)):e=nC(e,t,n),e}function nC(e,t,n){return"start"===e?t:"end"===e?n:e}function iC(e,t,n){let{inflateAmount:i}=t;e.inflateAmount="auto"===i?1===n?.33:0:i}a(Qw,"defaults",{}),a(Qw,"datasetElementType",null),a(Qw,"dataElementType",null);class rC extends Qw{parsePrimitiveData(e,t,n,i){return Jw(e,t,n,i)}parseArrayData(e,t,n,i){return Jw(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:r,vScale:s}=e,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l="x"===r.axis?o:a,c="x"===s.axis?o:a,u=[];let h,d,f,p;for(h=n,d=n+i;h<d;++h)p=t[h],f={},f[r.axis]=r.parse(ox(p,l),h),u.push($w(ox(p,c),f,s,h));return u}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const r=n._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,r=this.getParsed(e),s=r._custom,o=Zw(s)?"["+s.start+", "+s.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const r="reset"===i,{index:s,_cachedMeta:{vScale:o}}=this,a=o.getBasePixel(),l=o.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(t,i);for(let d=t;d<t+n;d++){const t=this.getParsed(d),n=r||qb(t[o.axis])?{base:a,head:a}:this._calculateBarValuePixels(d),f=this._calculateBarIndexPixels(d,c),p=(t._stacks||{})[o.axis],m={horizontal:l,base:n.base,enableBorderRadius:!p||Zw(t._custom)||s===p._top||s===p._bottom,x:l?n.head:f.center,y:l?f.center:n.head,height:l?f.size:Math.abs(n.size),width:l?Math.abs(n.size):f.size};h&&(m.options=u||this.resolveDataElementOptions(d,e[d].active?"active":i));const g=m.options||e[d].options;eC(m,g,p,s),iC(m,g,c.ratio),this.updateElement(e[d],d,m,i)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),r=n.options.stacked,s=[],o=this._cachedMeta.controller.getParsed(t),a=o&&o[n.axis],l=e=>{const t=e._parsed.find(e=>e[n.axis]===a),i=t&&t[e.vScale.axis];if(qb(i)||isNaN(i))return!0};for(const c of i)if((void 0===t||!l(c))&&((!1===r||-1===s.indexOf(c.stack)||void 0===r&&void 0===c.stack)&&s.push(c.stack),c.index===e))break;return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Yb("x"===this.chart.options.indexAxis?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const i=this._getStacks(e,n),r=void 0!==t?i.indexOf(t):-1;return-1===r?i.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,i=[];let r,s;for(r=0,s=t.data.length;r<s;++r)i.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const o=e.barThickness;return{min:o||Xw(t),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:i},options:{base:r,minBarLength:s}}=this,o=r||0,a=this.getParsed(e),l=a._custom,c=Zw(l);let u,h,d=a[t.axis],f=0,p=n?this.applyStack(t,a,n):d;p!==d&&(f=p-d,p=d),c&&(d=l.barStart,p=l.barEnd-l.barStart,0!==d&&xx(d)!==xx(l.barEnd)&&(f=0),f+=d);const m=qb(r)||c?f:r;let g=t.getPixelForValue(m);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(f+p):g,h=u-g,Math.abs(h)<s){h=function(e,t,n){return 0!==e?xx(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(h,t,o)*s,d===o&&(g-=h/2);const e=t.getPixelForDecimal(0),r=t.getPixelForDecimal(1),l=Math.min(e,r),f=Math.max(e,r);g=Math.max(Math.min(g,f),l),u=g+h,n&&!c&&(a._stacks[t.axis]._visualValues[i]=t.getValueForPixel(u)-t.getValueForPixel(g))}if(g===t.getPixelForValue(o)){const e=xx(h)*t.getLineWidthForValue(o)/2;g+=e,h-=e}return{size:h,base:g,head:u,center:u+h/2}}_calculateBarIndexPixels(e,t){const n=t.scale,i=this.options,r=i.skipNull,s=Yb(i.maxBarThickness,1/0);let o,a;const l=this._getAxisCount();if(t.grouped){const n=r?this._getStackCount(e):t.stackCount,c="flex"===i.barThickness?function(e,t,n,i){const r=t.pixels,s=r[e];let o=e>0?r[e-1]:null,a=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;null===o&&(o=s-(null===a?t.end-t.start:a-s)),null===a&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:n.barPercentage,start:c}}(e,t,i,n*l):function(e,t,n,i){const r=n.barThickness;let s,o;return qb(r)?(s=t.min*n.categoryPercentage,o=n.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:t.pixels[e]-s/2}}(e,t,i,n*l),u="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,h=this._getAxis().indexOf(Yb(u,this.getFirstScaleIdForIndexAxis())),d=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0)+h;o=c.start+c.chunk*d+c.chunk/2,a=Math.min(s,c.chunk*c.ratio)}else o=n.getPixelForValue(this.getParsed(e)[n.axis],e),a=Math.min(s,t.min*t.ratio);return{base:o-a/2,head:o+a/2,center:o,size:a}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length;let r=0;for(;r<i;++r)null===this.getParsed(r)[t.axis]||n[r].hidden||n[r].draw(this._ctx)}}a(rC,"id","bar"),a(rC,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),a(rC,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class sC extends Qw{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,i){const r=super.parsePrimitiveData(e,t,n,i);for(let s=0;s<r.length;s++)r[s]._custom=this.resolveDataElementOptions(s+n).radius;return r}parseArrayData(e,t,n,i){const r=super.parseArrayData(e,t,n,i);for(let s=0;s<r.length;s++){const e=t[n+s];r[s]._custom=Yb(e[2],this.resolveDataElementOptions(s+n).radius)}return r}parseObjectData(e,t,n,i){const r=super.parseObjectData(e,t,n,i);for(let s=0;s<r.length;s++){const e=t[n+s];r[s]._custom=Yb(e&&e.r&&+e.r,this.resolveDataElementOptions(s+n).radius)}return r}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=t,s=this.getParsed(e),o=i.getLabelForValue(s.x),a=r.getLabelForValue(s.y),l=s._custom;return{label:n[e]||"",value:"("+o+", "+a+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:o}=this._cachedMeta,{sharedOptions:a,includeOptions:l}=this._getSharedOptions(t,i),c=s.axis,u=o.axis;for(let h=t;h<t+n;h++){const t=e[h],n=!r&&this.getParsed(h),d={},f=d[c]=r?s.getPixelForDecimal(.5):s.getPixelForValue(n[c]),p=d[u]=r?o.getBasePixel():o.getPixelForValue(n[u]);d.skip=isNaN(f)||isNaN(p),l&&(d.options=a||this.resolveDataElementOptions(h,t.active?"active":i),r&&(d.options.radius=0)),this.updateElement(t,h,d,i)}}resolveDataElementOptions(e,t){const n=this.getParsed(e);let i=super.resolveDataElementOptions(e,t);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const r=i.radius;return"active"!==t&&(i.radius=0),i.radius+=Yb(n&&n._custom,r),i}}a(sC,"id","bubble"),a(sC,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),a(sC,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class oC extends Qw{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let r,s,o=e=>+n[e];if(Wb(n[e])){const{key:e="value"}=this._parsing;o=t=>+ox(n[t],e)}for(r=e,s=e+t;r<s;++r)i._parsed[r]=o(r)}}_getRotation(){return Ex(this.options.rotation-90)}_getCircumference(){return Ex(this.options.circumference)}_getRotationExtents(){let e=dx,t=-dx;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,r=i._getRotation(),s=i._getCircumference();e=Math.min(e,r),t=Math.max(t,r+s)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,r=i.data,s=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-s)/2,0),a=Math.min((l=this.options.cutout,c=o,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const u=this._getRingWeight(this.index),{circumference:h,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:m,offsetY:g}=function(e,t,n){let i=1,r=1,s=0,o=0;if(t<dx){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),d=Math.sin(l),f=(e,t,i)=>Dx(e,a,l,!0)?1:Math.max(t,t*n,i,i*n),p=(e,t,i)=>Dx(e,a,l,!0)?-1:Math.min(t,t*n,i,i*n),m=f(0,c,h),g=f(gx,u,d),y=p(hx,c,h),v=p(hx+gx,u,d);i=(m-y)/2,r=(g-v)/2,s=-(m+y)/2,o=-(g+v)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}(d,h,a),y=(n.width-s)/f,v=(n.height-s)/p,b=Math.max(Math.min(y,v)/2,0),x=Qb(this.options.radius,b),_=(x-Math.max(x*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*x,this.offsetY=g*x,i.total=this.calculateTotal(),this.outerRadius=x-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*u,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,r=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===i._parsed[e]||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*r/dx)}updateElements(e,t,n,i){const r="reset"===i,s=this.chart,o=s.chartArea,a=s.options.animation,l=(o.left+o.right)/2,c=(o.top+o.bottom)/2,u=r&&a.animateScale,h=u?0:this.innerRadius,d=u?0:this.outerRadius,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,i);let m,g=this._getRotation();for(m=0;m<t;++m)g+=this._circumference(m,r);for(m=t;m<t+n;++m){const t=this._circumference(m,r),n=e[m],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:d,innerRadius:h};p&&(s.options=f||this.resolveDataElementOptions(m,n.active?"active":i)),g+=t,this.updateElement(n,m,s,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,i=0;for(n=0;n<t.length;n++){const r=e._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||t[n].hidden||(i+=Math.abs(r))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?dx*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=i_(t._parsed[e],n.options.locale);return{label:i[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,r,s,o,a;if(!e)for(i=0,r=n.data.datasets.length;i<r;++i)if(n.isDatasetVisible(i)){s=n.getDatasetMeta(i),e=s.data,o=s.controller;break}if(!e)return 0;for(i=0,r=e.length;i<r;++i)a=o.resolveDataElementOptions(i),"inner"!==a.borderAlign&&(t=Math.max(t,a.borderWidth||0,a.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Yb(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}a(oC,"id","doughnut"),a(oC,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),a(oC,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),a(oC,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return t.labels.map((t,r)=>{const s=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:i,lineWidth:s.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class aC extends Qw{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:i=[],_dataset:r}=t,s=this.chart._animationsDisabled;let{start:o,count:a}=Wx(t,i,s);this._drawStart=o,this._drawCount=a,Gx(t)&&(o=0,a=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=i;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!s,options:l},e),this.updateElements(i,o,a,e)}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:o,_stacked:a,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(t,i),h=s.axis,d=o.axis,{spanGaps:f,segment:p}=this.options,m=Cx(f)?f:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||r||"none"===i,y=t+n,v=e.length;let b=t>0&&this.getParsed(t-1);for(let x=0;x<v;++x){const n=e[x],f=g?n:{};if(x<t||x>=y){f.skip=!0;continue}const v=this.getParsed(x),_=qb(v[d]),w=f[h]=s.getPixelForValue(v[h],x),C=f[d]=r||_?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,v,a):v[d],x);f.skip=isNaN(w)||isNaN(C)||_,f.stop=x>0&&Math.abs(v[h]-b[h])>m,p&&(f.parsed=v,f.raw=l.data[x]),u&&(f.options=c||this.resolveDataElementOptions(x,n.active?"active":i)),g||this.updateElement(n,x,f,i),b=v}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const r=i[0].size(this.resolveDataElementOptions(0)),s=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,r,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}a(aC,"id","line"),a(aC,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),a(aC,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class lC extends Qw{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],r=i_(t._parsed[e].r,n.options.locale);return{label:i[e]||"",value:r}}parseObjectData(e,t,n,i){return $_.bind(this)(e,t,n,i)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((e,n)=>{const i=this.getParsed(n).r;!isNaN(i)&&this.chart.getDataVisibility(n)&&(i<t.min&&(t.min=i),i>t.max&&(t.max=i))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,n=e.options,i=Math.min(t.right-t.left,t.bottom-t.top),r=Math.max(i/2,0),s=(r-Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=r-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(e,t,n,i){const r="reset"===i,s=this.chart,o=s.options.animation,a=this._cachedMeta.rScale,l=a.xCenter,c=a.yCenter,u=a.getIndexAngle(0)-.5*hx;let h,d=u;const f=360/this.countVisibleElements();for(h=0;h<t;++h)d+=this._computeAngle(h,i,f);for(h=t;h<t+n;h++){const t=e[h];let n=d,p=d+this._computeAngle(h,i,f),m=s.getDataVisibility(h)?a.getDistanceFromCenterForValue(this.getParsed(h).r):0;d=p,r&&(o.animateScale&&(m=0),o.animateRotate&&(n=p=u));const g={x:l,y:c,innerRadius:0,outerRadius:m,startAngle:n,endAngle:p,options:this.resolveDataElementOptions(h,t.active?"active":i)};this.updateElement(t,h,g,i)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((e,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++}),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?Ex(this.resolveDataElementOptions(e,t).angle||n):0}}a(lC,"id","polarArea"),a(lC,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),a(lC,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:i}}=e.legend.options;return t.labels.map((t,r)=>{const s=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:i,lineWidth:s.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class cC extends oC{}a(cC,"id","pie"),a(cC,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class uC extends Qw{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,i){return $_.bind(this)(e,t,n,i)}update(e){const t=this._cachedMeta,n=t.dataset,i=t.data||[],r=t.iScale.getLabels();if(n.points=i,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const s={_loop:!0,_fullLoop:r.length===i.length,options:t};this.updateElement(n,void 0,s,e)}this.updateElements(i,0,i.length,e)}updateElements(e,t,n,i){const r=this._cachedMeta.rScale,s="reset"===i;for(let o=t;o<t+n;o++){const t=e[o],n=this.resolveDataElementOptions(o,t.active?"active":i),a=r.getPointPositionForValue(o,this.getParsed(o).r),l=s?r.xCenter:a.x,c=s?r.yCenter:a.y,u={x:l,y:c,angle:a.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(t,o,u,i)}}}a(uC,"id","radar"),a(uC,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),a(uC,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class hC extends Qw{getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:r}=t,s=this.getParsed(e),o=i.getLabelForValue(s.x),a=r.getLabelForValue(s.y);return{label:n[e]||"",value:"("+o+", "+a+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,i=this.chart._animationsDisabled;let{start:r,count:s}=Wx(t,n,i);if(this._drawStart=r,this._drawCount=s,Gx(t)&&(r=0,s=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:r,_dataset:s}=t;r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=n;const o=this.resolveDatasetElementOptions(e);o.segment=this.options.segment,this.updateElement(r,void 0,{animated:!i,options:o},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,r,s,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,i){const r="reset"===i,{iScale:s,vScale:o,_stacked:a,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,i),u=this.getSharedOptions(c),h=this.includeOptions(i,u),d=s.axis,f=o.axis,{spanGaps:p,segment:m}=this.options,g=Cx(p)?p:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||r||"none"===i;let v=t>0&&this.getParsed(t-1);for(let b=t;b<t+n;++b){const t=e[b],n=this.getParsed(b),c=y?t:{},p=qb(n[f]),x=c[d]=s.getPixelForValue(n[d],b),_=c[f]=r||p?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,n,a):n[f],b);c.skip=isNaN(x)||isNaN(_)||p,c.stop=b>0&&Math.abs(n[d]-v[d])>g,m&&(c.parsed=n,c.raw=l.data[b]),h&&(c.options=u||this.resolveDataElementOptions(b,t.active?"active":i)),y||this.updateElement(t,b,c,i),v=n}this.updateSharedOptions(u,i,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}const n=e.dataset,i=n.options&&n.options.borderWidth||0;if(!t.length)return i;const r=t[0].size(this.resolveDataElementOptions(0)),s=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(i,r,s)/2}}a(hC,"id","scatter"),a(hC,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),a(hC,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function dC(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class fC{static override(e){Object.assign(fC.prototype,e)}constructor(e){a(this,"options",void 0),this.options=e||{}}init(){}formats(){return dC()}parse(){return dC()}format(){return dC()}add(){return dC()}diff(){return dC()}startOf(){return dC()}endOf(){return dC()}}var pC=fC;function mC(e,t,n,i){const{controller:r,data:s,_sorted:o}=e,a=r._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(a&&t===a.axis&&"r"!==t&&o&&s.length){const o=a._reversePixels?Lx:Ox;if(!i){const i=o(s,t,n);if(l){const{vScale:t}=r._cachedMeta,{_parsed:n}=e,s=n.slice(0,i.lo+1).reverse().findIndex(e=>!qb(e[t.axis]));i.lo-=Math.max(0,s);const o=n.slice(i.hi).findIndex(e=>!qb(e[t.axis]));i.hi+=Math.max(0,o)}return i}if(r._sharedOptions){const e=s[0],i="function"===typeof e.getRange&&e.getRange(t);if(i){const e=o(s,t,n-i),r=o(s,t,n+i);return{lo:e.lo,hi:r.hi}}}}return{lo:0,hi:s.length-1}}function gC(e,t,n,i,r){const s=e.getSortedVisibleDatasetMetas(),o=n[t];for(let a=0,l=s.length;a<l;++a){const{index:e,data:n}=s[a],{lo:l,hi:c}=mC(s[a],t,o,r);for(let t=l;t<=c;++t){const r=n[t];r.skip||i(r,e,t)}}}function yC(e,t,n,i,r){const s=[];if(!r&&!e.isPointInArea(t))return s;return gC(e,n,t,function(n,o,a){(r||v_(n,e.chartArea,0))&&n.inRange(t.x,t.y,i)&&s.push({element:n,datasetIndex:o,index:a})},!0),s}function vC(e,t,n,i,r,s){let o=[];const a=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,i){const r=t?Math.abs(e.x-i.x):0,s=n?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(n);let l=Number.POSITIVE_INFINITY;return gC(e,n,t,function(n,c,u){const h=n.inRange(t.x,t.y,r);if(i&&!h)return;const d=n.getCenterPoint(r);if(!(!!s||e.isPointInArea(d))&&!h)return;const f=a(t,d);f<l?(o=[{element:n,datasetIndex:c,index:u}],l=f):f===l&&o.push({element:n,datasetIndex:c,index:u})}),o}function bC(e,t,n,i,r,s){return s||e.isPointInArea(t)?"r"!==n||i?vC(e,t,n,i,r,s):function(e,t,n,i){let r=[];return gC(e,n,t,function(e,n,s){const{startAngle:o,endAngle:a}=e.getProps(["startAngle","endAngle"],i),{angle:l}=Sx(e,{x:t.x,y:t.y});Dx(l,o,a)&&r.push({element:e,datasetIndex:n,index:s})}),r}(e,t,n,r):[]}function xC(e,t,n,i,r){const s=[],o="x"===n?"inXRange":"inYRange";let a=!1;return gC(e,n,t,(e,i,l)=>{e[o]&&e[o](t[n],r)&&(s.push({element:e,datasetIndex:i,index:l}),a=a||e.inRange(t.x,t.y,r))}),i&&!a?[]:s}var _C={evaluateInteractionItems:gC,modes:{index(e,t,n,i){const r=hw(t,e),s=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?yC(e,r,s,i,o):bC(e,r,s,!1,i,o),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=a[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,n,i){const r=hw(t,e),s=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?yC(e,r,s,i,o):bC(e,r,s,!1,i,o);if(a.length>0){const t=a[0].datasetIndex,n=e.getDatasetMeta(t).data;a=[];for(let e=0;e<n.length;++e)a.push({element:n[e],datasetIndex:t,index:e})}return a},point:(e,t,n,i)=>yC(e,hw(t,e),n.axis||"xy",i,n.includeInvisible||!1),nearest(e,t,n,i){const r=hw(t,e),s=n.axis||"xy",o=n.includeInvisible||!1;return bC(e,r,s,n.intersect,i,o)},x:(e,t,n,i)=>xC(e,hw(t,e),"x",n.intersect,i),y:(e,t,n,i)=>xC(e,hw(t,e),"y",n.intersect,i)}};const wC=["left","top","right","bottom"];function CC(e,t){return e.filter(e=>e.pos===t)}function kC(e,t){return e.filter(e=>-1===wC.indexOf(e.pos)&&e.box.axis===t)}function EC(e,t){return e.sort((e,n)=>{const i=t?n:e,r=t?e:n;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function TC(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:i,stackWeight:r}=n;if(!e||!wC.includes(i))continue;const s=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return t}(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let s,o,a;for(s=0,o=e.length;s<o;++s){a=e[s];const{fullSize:o}=a.box,l=n[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*i:o&&t.availableWidth,a.height=r):(a.width=i,a.height=c?c*r:o&&t.availableHeight)}return n}function NC(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function SC(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function IC(e,t,n,i){const{pos:r,box:s}=n,o=e.maxPadding;if(!Wb(r)){n.size&&(e[r]-=n.size);const t=i[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?s.height:s.width),n.size=t.size/t.count,e[r]+=n.size}s.getPadding&&SC(o,s.getPadding());const a=Math.max(0,t.outerWidth-NC(o,e,"left","right")),l=Math.max(0,t.outerHeight-NC(o,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function PC(e,t){const n=t.maxPadding;function i(e){const i={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{i[e]=Math.max(t[e],n[e])}),i}return i(e?["left","right"]:["top","bottom"])}function AC(e,t,n,i){const r=[];let s,o,a,l,c,u;for(s=0,o=e.length,c=0;s<o;++s){a=e[s],l=a.box,l.update(a.width||t.w,a.height||t.h,PC(a.horizontal,t));const{same:o,other:h}=IC(t,n,a,i);c|=o&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&AC(r,t,n,i)||u}function DC(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function RC(e,t,n,i){const r=n.padding;let{x:s,y:o}=t;for(const a of e){const e=a.box,l=i[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const i=t.w*c,s=l.size||e.height;lx(l.start)&&(o=l.start),e.fullSize?DC(e,r.left,o,n.outerWidth-r.right-r.left,s):DC(e,t.left+l.placed,o,i,s),l.start=o,l.placed+=i,o=e.bottom}else{const i=t.h*c,o=l.size||e.width;lx(l.start)&&(s=l.start),e.fullSize?DC(e,s,r.top,o,n.outerHeight-r.bottom-r.top):DC(e,s,t.top+l.placed,o,i),l.start=s,l.placed+=i,s=e.right}}t.x=s,t.y=o}var jC={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=j_(e.options.layout.padding),s=Math.max(t-r.width,0),o=Math.max(n-r.height,0),a=function(e){const t=function(e){const t=[];let n,i,r,s,o,a;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],({position:s,options:{stack:o,stackWeight:a=1}}=r),t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return t}(e),n=EC(t.filter(e=>e.box.fullSize),!0),i=EC(CC(t,"left"),!0),r=EC(CC(t,"right")),s=EC(CC(t,"top"),!0),o=EC(CC(t,"bottom")),a=kC(t,"x"),l=kC(t,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:CC(t,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}(e.boxes),l=a.vertical,c=a.horizontal;$b(e.boxes,e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()});const u=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},r);SC(d,j_(i));const f=Object.assign({maxPadding:d,w:s,h:o,x:r.left,y:r.top},r),p=TC(l.concat(c),h);AC(a.fullSize,f,h,p),AC(l,f,h,p),AC(c,f,h,p)&&AC(l,f,h,p),function(e){const t=e.maxPadding;function n(n){const i=Math.max(t[n]-e[n],0);return e[n]+=i,i}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(f),RC(a.leftAndTop,f,h,p),f.x+=f.w,f.y+=f.h,RC(a.rightAndBottom,f,h,p),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},$b(a.chartArea,t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class MC{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class OC extends MC{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const LC="$chartjs",FC={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},zC=e=>null===e||""===e;const UC=!!mw&&{passive:!0};function VC(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,UC)}function BC(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function qC(e,t,n){const i=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||BC(n.addedNodes,i),t=t&&!BC(n.removedNodes,i);t&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function HC(e,t,n){const i=e.canvas,r=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||BC(n.removedNodes,i),t=t&&!BC(n.addedNodes,i);t&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const WC=new Map;let GC=0;function KC(){const e=window.devicePixelRatio;e!==GC&&(GC=e,WC.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function YC(e,t,n){const i=e.canvas,r=i&&ow(i);if(!r)return;const s=Bx((e,t)=>{const i=r.clientWidth;n(e,t),i<r.clientWidth&&n()},window),o=new ResizeObserver(e=>{const t=e[0],n=t.contentRect.width,i=t.contentRect.height;0===n&&0===i||s(n,i)});return o.observe(r),function(e,t){WC.size||window.addEventListener("resize",KC),WC.set(e,t)}(e,s),o}function QC(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){WC.delete(e),WC.size||window.removeEventListener("resize",KC)}(e)}function XC(e,t,n){const i=e.canvas,r=Bx(t=>{null!==e.ctx&&n(function(e,t){const n=FC[e.type]||e.type,{x:i,y:r}=hw(e,t);return{type:n,chart:t,native:e,x:void 0!==i?i:null,y:void 0!==r?r:null}}(t,e))},e);return function(e,t,n){e&&e.addEventListener(t,n,UC)}(i,t,r),r}class $C extends MC{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[LC]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",zC(r)){const t=gw(e,"width");void 0!==t&&(e.width=t)}if(zC(i))if(""===e.style.height)e.height=e.width/(t||2);else{const t=gw(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[LC])return!1;const n=t[LC].initial;["height","width"].forEach(e=>{const i=n[e];qb(i)?t.removeAttribute(e):t.setAttribute(e,i)});const i=n.style||{};return Object.keys(i).forEach(e=>{t.style[e]=i[e]}),t.width=t.width,delete t[LC],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),r={attach:qC,detach:HC,resize:YC}[t]||XC;i[t]=r(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:QC,detach:QC,resize:QC}[t]||VC)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return fw(e,t,n,i)}isAttached(e){const t=e&&ow(e);return!(!t||!t.isConnected)}}class JC{constructor(){a(this,"x",void 0),a(this,"y",void 0),a(this,"active",!1),a(this,"options",void 0),a(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Cx(this.x)&&Cx(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach(e=>{i[e]=n[e]&&n[e].active()?n[e]._to:this[e]}),i}}function ZC(e,t){const n=e.options.ticks,i=function(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}(e),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?function(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}(t):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>r)return function(e,t,n,i){let r,s=0,o=n[0];for(i=Math.ceil(i),r=0;r<e.length;r++)r===o&&(t.push(e[r]),s++,o=n[s*i])}(t,c,s,o/r),c;const u=function(e,t,n){const i=function(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}(e),r=t.length/n;if(!i)return Math.max(r,1);const s=function(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(0|n)&&t.push(n),t.sort((e,t)=>e-t).pop(),t}(i);for(let o=0,a=s.length-1;o<a;o++){const e=s[o];if(e>r)return e}return Math.max(r,1)}(s,t,r);if(o>0){let e,n;const i=o>1?Math.round((l-a)/(o-1)):null;for(ek(t,c,u,qb(i)?0:a-i,a),e=0,n=o-1;e<n;e++)ek(t,c,u,s[e],s[e+1]);return ek(t,c,u,l,qb(i)?t.length:l+i),c}return ek(t,c,u),c}function ek(e,t,n,i,r){const s=Yb(i,0),o=Math.min(Yb(r,e.length),e.length);let a,l,c,u=0;for(n=Math.ceil(n),r&&(a=r-i,n=a/Math.floor(a/n)),c=s;c<0;)u++,c=Math.round(s+u*n);for(l=Math.max(s,0);l<o;l++)l===c&&(t.push(e[l]),u++,c=Math.round(s+u*n))}a(JC,"defaults",{}),a(JC,"defaultRoutes",void 0);const tk=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,nk=(e,t)=>Math.min(t||e,e);function ik(e,t){const n=[],i=e.length/t,r=e.length;let s=0;for(;s<r;s+=i)n.push(e[Math.floor(s)]);return n}function rk(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),s=e._startPixel,o=e._endPixel,a=1e-6;let l,c=e.getPixelForTick(r);if(!(n&&(l=1===i?Math.max(c-s,o-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<s-a||c>o+a)))return c}function sk(e){return e.drawTicks?e.tickLength:0}function ok(e,t){if(!e.display)return 0;const n=M_(e.font,t),i=j_(e.padding);return(Hb(e.text)?e.text.length:1)*n.lineHeight+i.height}function ak(e,t,n){let i=qx(e);return(n&&"right"!==t||!n&&"right"===t)&&(i=(e=>"left"===e?"right":"right"===e?"left":e)(i)),i}class lk extends JC{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=Kb(e,Number.POSITIVE_INFINITY),t=Kb(t,Number.NEGATIVE_INFINITY),n=Kb(n,Number.POSITIVE_INFINITY),i=Kb(i,Number.NEGATIVE_INFINITY),{min:Kb(e,n),max:Kb(t,i),minDefined:Gb(e),maxDefined:Gb(t)}}getMinMax(e){let t,{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let a=0,l=o.length;a<l;++a)t=o[a].controller.getMinMax(this,e),r||(n=Math.min(n,t.min)),s||(i=Math.max(i,t.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:Kb(n,Kb(i,n)),max:Kb(i,Kb(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Xb(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:r,ticks:s}=this.options,o=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:i,max:r}=e,s=Qb(t,(r-i)/2),o=(e,t)=>n&&0===e?0:e+t;return{min:o(i,-Math.abs(s)),max:o(r,s)}}(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=o<this.ticks.length;this._convertTicksToLabels(a?ik(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=ZC(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Xb(this.options.afterUpdate,[this])}beforeSetDimensions(){Xb(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Xb(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Xb(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Xb(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,r;for(n=0,i=e.length;n<i;n++)r=e[n],r.label=Xb(t.callback,[r.value,n,e],this)}afterTickToLabelConversion(){Xb(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Xb(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=nk(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,r=t.maxRotation;let s,o,a,l=i;if(!this._isVisible()||!t.display||i>=r||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),u=c.widest.width,h=c.highest.height,d=Rx(this.chart.width-u,0,this.maxWidth);s=e.offset?this.maxWidth/n:d/(n-1),u+6>s&&(s=d/(n-(e.offset?.5:1)),o=this.maxHeight-sk(e.grid)-t.padding-ok(e.title,this.chart.options.font),a=Math.sqrt(u*u+h*h),l=Tx(Math.min(Math.asin(Rx((c.highest.height+6)/s,-1,1)),Math.asin(Rx(o/a,-1,1))-Math.asin(Rx(h/a,-1,1)))),l=Math.max(i,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){Xb(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Xb(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:r}}=this,s=this._isVisible(),o=this.isHorizontal();if(s){const s=ok(i,t.options.font);if(o?(e.width=this.maxWidth,e.height=sk(r)+s):(e.height=this.maxHeight,e.width=sk(r)+s),n.display&&this.ticks.length){const{first:t,last:i,widest:r,highest:s}=this._getLabelSizes(),a=2*n.padding,l=Ex(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(o){const t=n.mirror?0:u*r.width+c*s.height;e.height=Math.min(this.maxHeight,e.height+t+a)}else{const t=n.mirror?0:c*r.width+u*s.height;e.width=Math.min(this.maxWidth,e.width+t+a)}this._calculatePadding(t,i,u,c)}}this._handleMargins(),o?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:r,padding:s},position:o}=this.options,a=0!==this.labelRotation,l="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,h=0;a?l?(u=i*e.width,h=n*t.height):(u=n*e.height,h=i*t.width):"start"===r?h=t.width:"end"===r?u=e.width:"inner"!==r&&(u=e.width/2,h=t.width/2),this.paddingLeft=Math.max((u-o+s)*this.width/(this.width-o),0),this.paddingRight=Math.max((h-c+s)*this.width/(this.width-c),0)}else{let n=t.height/2,i=e.height/2;"start"===r?(n=0,i=e.height):"end"===r&&(n=t.height,i=0),this.paddingTop=n+s,this.paddingBottom=i+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Xb(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)qb(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=ik(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:r}=this,s=[],o=[],a=Math.floor(t/nk(t,n));let l,c,u,h,d,f,p,m,g,y,v,b=0,x=0;for(l=0;l<t;l+=a){if(h=e[l].label,d=this._resolveTickFontOptions(l),i.font=f=d.string,p=r[f]=r[f]||{data:{},gc:[]},m=d.lineHeight,g=y=0,qb(h)||Hb(h)){if(Hb(h))for(c=0,u=h.length;c<u;++c)v=h[c],qb(v)||Hb(v)||(g=d_(i,p.data,p.gc,g,v),y+=m)}else g=d_(i,p.data,p.gc,g,h),y=m;s.push(g),o.push(y),b=Math.max(g,b),x=Math.max(y,x)}!function(e,t){$b(e,e=>{const n=e.gc,i=n.length/2;let r;if(i>t){for(r=0;r<i;++r)delete e.data[n[r]];n.splice(0,i)}})}(r,t);const _=s.indexOf(b),w=o.indexOf(x),C=e=>({width:s[e]||0,height:o[e]||0});return{first:C(0),last:C(t-1),widest:C(_),highest:C(w),widths:s,heights:o}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Rx(this._alignToPixels?p_(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return L_(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=L_(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=Ex(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),r=this._getLabelSizes(),s=e.autoSkipPadding||0,o=r?r.widest.width+s:0,a=r?r.highest.height+s:0;return this.isHorizontal()?a*n>o*i?o/n:a/i:a*i<o*n?a/n:o/i}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:r,position:s,border:o}=i,a=r.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),u=sk(r),h=[],d=o.setContext(this.getContext()),f=d.display?d.width:0,p=f/2,m=function(e){return p_(n,e,f)};let g,y,v,b,x,_,w,C,k,E,T,N;if("top"===s)g=m(this.bottom),_=this.bottom-u,C=g-p,E=m(e.top)+p,N=e.bottom;else if("bottom"===s)g=m(this.top),E=e.top,N=m(e.bottom)-p,_=g+p,C=this.top+u;else if("left"===s)g=m(this.right),x=this.right-u,w=g-p,k=m(e.left)+p,T=e.right;else if("right"===s)g=m(this.left),k=e.left,T=m(e.right)-p,x=g+p,w=this.left+u;else if("x"===t){if("center"===s)g=m((e.top+e.bottom)/2+.5);else if(Wb(s)){const e=Object.keys(s)[0],t=s[e];g=m(this.chart.scales[e].getPixelForValue(t))}E=e.top,N=e.bottom,_=g+p,C=_+u}else if("y"===t){if("center"===s)g=m((e.left+e.right)/2);else if(Wb(s)){const e=Object.keys(s)[0],t=s[e];g=m(this.chart.scales[e].getPixelForValue(t))}x=g-p,w=x-u,k=e.left,T=e.right}const S=Yb(i.ticks.maxTicksLimit,c),I=Math.max(1,Math.ceil(c/S));for(y=0;y<c;y+=I){const e=this.getContext(y),t=r.setContext(e),i=o.setContext(e),s=t.lineWidth,c=t.color,u=i.dash||[],d=i.dashOffset,f=t.tickWidth,p=t.tickColor,m=t.tickBorderDash||[],g=t.tickBorderDashOffset;v=rk(this,y,a),void 0!==v&&(b=p_(n,v,s),l?x=w=k=T=b:_=C=E=N=b,h.push({tx1:x,ty1:_,tx2:w,ty2:C,x1:k,y1:E,x2:T,y2:N,width:s,color:c,borderDash:u,borderDashOffset:d,tickWidth:f,tickColor:p,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,h}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:r}=n,s=this.isHorizontal(),o=this.ticks,{align:a,crossAlign:l,padding:c,mirror:u}=r,h=sk(n.grid),d=h+c,f=u?-c:d,p=-Ex(this.labelRotation),m=[];let g,y,v,b,x,_,w,C,k,E,T,N,S="middle";if("top"===i)_=this.bottom-f,w=this._getXAxisLabelAlignment();else if("bottom"===i)_=this.top+f,w=this._getXAxisLabelAlignment();else if("left"===i){const e=this._getYAxisLabelAlignment(h);w=e.textAlign,x=e.x}else if("right"===i){const e=this._getYAxisLabelAlignment(h);w=e.textAlign,x=e.x}else if("x"===t){if("center"===i)_=(e.top+e.bottom)/2+d;else if(Wb(i)){const e=Object.keys(i)[0],t=i[e];_=this.chart.scales[e].getPixelForValue(t)+d}w=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===i)x=(e.left+e.right)/2-d;else if(Wb(i)){const e=Object.keys(i)[0],t=i[e];x=this.chart.scales[e].getPixelForValue(t)}w=this._getYAxisLabelAlignment(h).textAlign}"y"===t&&("start"===a?S="top":"end"===a&&(S="bottom"));const I=this._getLabelSizes();for(g=0,y=o.length;g<y;++g){v=o[g],b=v.label;const e=r.setContext(this.getContext(g));C=this.getPixelForTick(g)+r.labelOffset,k=this._resolveTickFontOptions(g),E=k.lineHeight,T=Hb(b)?b.length:1;const t=T/2,n=e.color,a=e.textStrokeColor,c=e.textStrokeWidth;let h,d=w;if(s?(x=C,"inner"===w&&(d=g===y-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),N="top"===i?"near"===l||0!==p?-T*E+E/2:"center"===l?-I.highest.height/2-t*E+E:-I.highest.height+E/2:"near"===l||0!==p?E/2:"center"===l?I.highest.height/2-t*E:I.highest.height-T*E,u&&(N*=-1),0===p||e.showLabelBackdrop||(x+=E/2*Math.sin(p))):(_=C,N=(1-T)*E/2),e.showLabelBackdrop){const t=j_(e.backdropPadding),n=I.heights[g],i=I.widths[g];let r=N-t.top,s=0-t.left;switch(S){case"middle":r-=n/2;break;case"bottom":r-=n}switch(w){case"center":s-=i/2;break;case"right":s-=i;break;case"inner":g===y-1?s-=i:g>0&&(s-=i/2)}h={left:s,top:r,width:i+t.width,height:n+t.height,color:e.backdropColor}}m.push({label:b,font:k,textOffset:N,options:{rotation:p,color:n,strokeColor:a,strokeWidth:c,textAlign:d,textBaseline:S,translation:[x,_],backdrop:h}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ex(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:r}}=this.options,s=e+r,o=this._getLabelSizes().widest.width;let a,l;return"left"===t?i?(l=this.right+r,"near"===n?a="left":"center"===n?(a="center",l+=o/2):(a="right",l+=o)):(l=this.right-s,"near"===n?a="right":"center"===n?(a="center",l-=o/2):(a="left",l=this.left)):"right"===t?i?(l=this.left+r,"near"===n?a="right":"center"===n?(a="center",l-=o/2):(a="left",l-=o)):(l=this.left+s,"near"===n?a="left":"center"===n?(a="center",l+=o/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:r,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,r,s),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex(t=>t.value===e);if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,s;const o=(e,t,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(r=0,s=i.length;r<s;++r){const e=i[r];t.drawOnChartArea&&o({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&o({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,r=n.setContext(this.getContext()),s=n.display?r.width:0;if(!s)return;const o=i.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=p_(e,this.left,s)-s/2,c=p_(e,this.right,o)+o/2,u=h=a):(u=p_(e,this.top,s)-s/2,h=p_(e,this.bottom,o)+o/2,l=c=a),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(l,u),t.lineTo(c,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&b_(t,n);const i=this.getLabelItems(e);for(const r of i){const e=r.options,n=r.font;E_(t,r.label,0,r.textOffset,n,e)}n&&x_(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const r=M_(n.font),s=j_(n.padding),o=n.align;let a=r.lineHeight/2;"bottom"===t||"center"===t||Wb(t)?(a+=s.bottom,Hb(n.text)&&(a+=r.lineHeight*(n.text.length-1))):a+=s.top;const{titleX:l,titleY:c,maxWidth:u,rotation:h}=function(e,t,n,i){const{top:r,left:s,bottom:o,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let h,d,f,p=0;const m=o-r,g=a-s;if(e.isHorizontal()){if(d=Hx(i,s,a),Wb(n)){const e=Object.keys(n)[0],i=n[e];f=u[e].getPixelForValue(i)+m-t}else f="center"===n?(c.bottom+c.top)/2+m-t:tk(e,n,t);h=a-s}else{if(Wb(n)){const e=Object.keys(n)[0],i=n[e];d=u[e].getPixelForValue(i)-g+t}else d="center"===n?(c.left+c.right)/2-g+t:tk(e,n,t);f=Hx(i,o,r),p="left"===n?-gx:gx}return{titleX:d,titleY:f,maxWidth:h,rotation:p}}(this,a,t,o);E_(e,n.text,0,0,r,{color:n.color,maxWidth:u,rotation:h,textAlign:ak(o,t,i),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Yb(e.grid&&e.grid.z,-1),i=Yb(e.border&&e.border.z,0);return this._isVisible()&&this.draw===lk.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let r,s;for(r=0,s=t.length;r<s;++r){const s=t[r];s[n]!==this.id||e&&s.type!==e||i.push(s)}return i}_resolveTickFontOptions(e){return M_(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class ck{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const i=this.items,r=e.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in i||(i[r]=e,function(e,t,n){const i=nx(Object.create(null),[n?h_.get(n):{},h_.get(t),e.defaults]);h_.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),r=i.pop(),s=[e].concat(i).join("."),o=t[n].split("."),a=o.pop(),l=o.join(".");h_.route(s,r,l,a)})}(t,e.defaultRoutes);e.descriptors&&h_.describe(t,e.descriptors)}(e,s,n),this.override&&h_.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in h_[i]&&(delete h_[i][n],this.override&&delete o_[n])}}class uk{constructor(){this.controllers=new ck(Qw,"datasets",!0),this.elements=new ck(JC,"elements"),this.plugins=new ck(Object,"plugins"),this.scales=new ck(lk,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach(t=>{const i=n||this._getRegistryForType(t);n||i.isForType(t)||i===this.plugins&&t.id?this._exec(e,i,t):$b(t,t=>{const i=n||this._getRegistryForType(t);this._exec(e,i,t)})})}_exec(e,t,n){const i=ax(e);Xb(n["before"+i],[],n),t[e](n),Xb(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var hk=new uk;class dk{constructor(){this._init=[]}notify(e,t,n,i){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=i?this._descriptors(e).filter(i):this._descriptors(e),s=this._notify(r,e,t,n);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(e,t,n,i){i=i||{};for(const r of e){const e=r.plugin;if(!1===Xb(e[n],[t,i,r.options],e)&&i.cancelable)return!1}return!0}invalidate(){qb(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Yb(n.options&&n.options.plugins,{}),r=function(e){const t={},n=[],i=Object.keys(hk.plugins.items);for(let s=0;s<i.length;s++)n.push(hk.getPlugin(i[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const e=r[s];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==i||t?function(e,t,n,i){let{plugins:r,localIds:s}=t;const o=[],a=e.getContext();for(const l of r){const t=l.id,r=fk(n[t],i);null!==r&&o.push({plugin:l,options:pk(e.config,{plugin:l,local:s[t]},r,a)})}return o}(e,r,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function fk(e,t){return t||!1!==e?!0===e?{}:e:null}function pk(e,t,n,i){let{plugin:r,local:s}=t;const o=e.pluginScopeKeys(r),a=e.getOptionScopes(n,o);return s&&r.defaults&&a.push(r.defaults),e.createResolver(a,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mk(e,t){const n=h_.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function gk(e){if("x"===e||"y"===e||"r"===e)return e}function yk(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function vk(e){if(gk(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n){const t=r.axis||yk(r.position)||e.length>1&&gk(e[0].toLowerCase());if(t)return t}throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function bk(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function xk(e,t){const n=o_[e.type]||{scales:{}},i=t.scales||{},r=mk(e.type,t),s=Object.create(null);return Object.keys(i).forEach(t=>{const o=i[t];if(!Wb(o))return console.error("Invalid scale configuration for scale: ".concat(t));if(o._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const a=vk(t,o,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(n.length)return bk(e,"x",n[0])||bk(e,"y",n[0])}return{}}(t,e),h_.scales[o.type]),l=function(e,t){return e===t?"_index_":"_value_"}(a,r),c=n.scales||{};s[t]=ix(Object.create(null),[{axis:a},o,c[a],c[l]])}),e.data.datasets.forEach(n=>{const r=n.type||e.type,o=n.indexAxis||mk(r,t),a=(o_[r]||{}).scales||{};Object.keys(a).forEach(e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,o),r=n[t+"AxisID"]||t;s[r]=s[r]||Object.create(null),ix(s[r],[{axis:t},i[r],a[e]])})}),Object.keys(s).forEach(e=>{const t=s[e];ix(t,[h_.scales[t.type],h_.scale])}),s}function _k(e){const t=e.options||(e.options={});t.plugins=Yb(t.plugins,{}),t.scales=xk(e,t)}function wk(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Ck=new Map,kk=new Set;function Ek(e,t){let n=Ck.get(e);return n||(n=t(),Ck.set(e,n),kk.add(n)),n}const Tk=(e,t,n)=>{const i=ox(t,n);void 0!==i&&e.add(i)};class Nk{constructor(e){this._config=function(e){return(e=e||{}).data=wk(e.data),_k(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=wk(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),_k(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ek(e,()=>[["datasets.".concat(e),""]])}datasetAnimationScopeKeys(e,t){return Ek("".concat(e,".transition.").concat(t),()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]])}datasetElementScopeKeys(e,t){return Ek("".concat(e,"-").concat(t),()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return Ek("".concat(n,"-plugin-").concat(t),()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return i&&!t||(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:r}=this,s=this._cachedScopes(e,n),o=s.get(t);if(o)return o;const a=new Set;t.forEach(t=>{e&&(a.add(e),t.forEach(t=>Tk(a,e,t))),t.forEach(e=>Tk(a,i,e)),t.forEach(e=>Tk(a,o_[r]||{},e)),t.forEach(e=>Tk(a,h_,e)),t.forEach(e=>Tk(a,a_,e))});const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),kk.has(t)&&s.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,o_[t]||{},h_.datasets[t]||{},{type:t},h_,a_]}resolveNamedOptions(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const r={$shared:!0},{resolver:s,subPrefixes:o}=Sk(this._resolverCache,e,i);let a=s;if(function(e,t){const{isScriptable:n,isIndexable:i}=U_(e);for(const r of t){const t=n(r),s=i(r),o=(s||t)&&e[r];if(t&&(cx(o)||Ik(o))||s&&Hb(o))return!0}return!1}(s,t)){r.$shared=!1;a=z_(s,n=cx(n)?n():n,this.createResolver(e,n,o))}for(const l of t)r[l]=a[l];return r}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],i=arguments.length>3?arguments[3]:void 0;const{resolver:r}=Sk(this._resolverCache,e,n);return Wb(t)?z_(r,t,void 0,i):r}}function Sk(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let s=i.get(r);if(!s){s={resolver:F_(t,n),subPrefixes:n.filter(e=>!e.toLowerCase().includes("hover"))},i.set(r,s)}return s}const Ik=e=>Wb(e)&&Object.getOwnPropertyNames(e).some(t=>cx(e[t]));const Pk=["top","bottom","left","right","chartArea"];function Ak(e,t){return"top"===e||"bottom"===e||-1===Pk.indexOf(e)&&"x"===t}function Dk(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function Rk(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Xb(n&&n.onComplete,[e],t)}function jk(e){const t=e.chart,n=t.options.animation;Xb(n&&n.onProgress,[e],t)}function Mk(e){return sw()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Ok={},Lk=e=>{const t=Mk(e);return Object.values(Ok).filter(e=>e.canvas===t).pop()};function Fk(e,t,n){const i=Object.keys(e);for(const r of i){const i=+r;if(i>=t){const s=e[r];delete e[r],(n>0||i>t)&&(e[i+n]=s)}}}class zk{static register(){hk.add(...arguments),Uk()}static unregister(){hk.remove(...arguments),Uk()}constructor(e,t){const n=this.config=new Nk(t),i=Mk(e),r=Lk(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!sw()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?OC:$C}(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,s.aspectRatio),a=o&&o.canvas,l=a&&a.height,c=a&&a.width;this.id=Bb(),this.ctx=o,this.canvas=a,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new dk,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}(e=>this.update(e),s.resizeDelay||0),this._dataChanges=[],Ok[this.id]=this,o&&a?(Rw.listen(this,"complete",Rk),Rw.listen(this,"progress",jk),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:r}=this;return qb(e)?t&&r?r:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return hk}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():pw(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return m_(this.canvas,this.ctx),this}stop(){return Rw.stop(this),this}resize(e,t){Rw.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(i,e,t,r),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,pw(this,o,!0)&&(this.notifyPlugins("resize",{size:s}),Xb(n.onResize,[this,s],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){$b(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce((e,t)=>(e[t]=!1,e),{});let r=[];t&&(r=r.concat(Object.keys(t).map(e=>{const n=t[e],i=vk(e,n),r="r"===i,s="x"===i;return{options:n,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}}))),$b(r,t=>{const r=t.options,s=r.id,o=vk(s,r),a=Yb(r.type,t.dtype);void 0!==r.position&&Ak(r.position,o)===Ak(t.dposition)||(r.position=t.dposition),i[s]=!0;let l=null;if(s in n&&n[s].type===a)l=n[s];else{l=new(hk.getScale(a))({id:s,type:a,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(r,e)}),$b(i,(e,t)=>{e||delete n[t]}),$b(n,e=>{jC.configure(this,e,e.options),jC.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((e,t)=>e.index-t.index),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Dk("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,n)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const i=t[n];let r=this.getDatasetMeta(n);const s=i.type||this.config.type;if(r.type&&r.type!==s&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=s,r.indexAxis=i.indexAxis||mk(s,this.options),r.order=i.order||0,r.index=n,r.label=""+i.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const t=hk.getController(s),{datasetElementType:i,dataElementType:o}=h_.datasets[s];Object.assign(t,{dataElementType:hk.getElement(o),datasetElementType:i&&hk.getElement(i)}),r.controller=new t(this,n),e.push(r.controller)}}return this._updateMetasets(),e}_resetElements(){$b(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!i&&-1===r.indexOf(e);e.buildOrUpdateElements(t),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=n.layout.autoPadding?s:0,this._updateLayout(s),i||$b(r,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Dk("z","_idx"));const{_active:o,_lastEvent:a}=this;a?this._eventHandler(a,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){$b(this.scales,e=>{jC.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);ux(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:r}of t){Fk(e,i,"_removeElements"===n?-r:r)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),i=n(0);for(let r=1;r<t;r++)if(!ux(i,n(r)))return;return Array.from(i).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;jC.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],$b(this.boxes,e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,cx(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Rw.has(this)?this.attached&&!Rw.running(this)&&Rw.start(this):(this.draw(),Rk({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,r;for(i=0,r=t.length;i<r;++i){const r=t[i];e&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=Aw(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(i&&b_(t,i),e.controller.draw(),i&&x_(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return v_(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const r=_C.modes[t];return"function"===typeof r?r(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter(e=>e&&e._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=L_(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",r=this.getDatasetMeta(e),s=r.controller._resolveAnimations(void 0,i);lx(t)?(r.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),s.update(r,{visible:n}),this.update(t=>t.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Rw.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),m_(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Ok[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,i)=>{t.addEventListener(this,n,i),e[n]=i},i=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};$b(this.options.events,e=>n(e,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,i)=>{t.addEventListener(this,n,i),e[n]=i},i=(n,i)=>{e[n]&&(t.removeEventListener(this,n,i),delete e[n])},r=(e,t)=>{this.canvas&&this.resize(e,t)};let s;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",r),n("detach",s)};s=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),n("attach",o)},t.isAttached(this.canvas)?o():s()}unbindEvents(){$b(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},$b(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let r,s,o,a;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),o=0,a=e.length;o<a;++o){s=e[o];const t=s&&this.getDatasetMeta(s.datasetIndex).controller;t&&t[i+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(e=>{let{datasetIndex:t,index:n}=e;const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[n],index:n}});!Jb(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,n){const i=this.options.hover,r=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),s=r(t,e),o=n?e:r(e,t);s.length&&this.updateHoverStyle(s,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const r=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(r||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:r}=this,s=t,o=this._getActiveElements(e,i,n,s),a=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,i){return n&&"mouseout"!==e.type?i?t:e:null}(e,this._lastEvent,n,a);n&&(this._lastEvent=null,Xb(r.onHover,[e,o,this],this),a&&Xb(r.onClick,[e,o,this],this));const c=!Jb(o,i);return(c||t)&&(this._active=o,this._updateHoverStyles(o,i,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,i){if("mouseout"===e.type)return[];if(!n)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,i)}}function Uk(){return $b(zk.instances,e=>e._plugins.invalidate())}function Vk(e,t,n,i){const r=A_(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const s=(n-t)/2,o=Math.min(s,i*t/2),a=e=>{const t=(n-Math.min(s,e))*i/2;return Rx(e,0,Math.min(s,t))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:Rx(r.innerStart,0,o),innerEnd:Rx(r.innerEnd,0,o)}}function Bk(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function qk(e,t,n,i,r,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+i+n-c,0),d=u>0?u+i+n+c:0;let f=0;const p=r-l;if(i){const e=((u>0?u-i:0)+(h>0?h-i:0))/2;f=(p-(0!==e?p*e/(e+i):p))/2}const m=(p-Math.max(.001,p*h-n/hx)/h)/2,g=l+m+f,y=r-m-f,{outerStart:v,outerEnd:b,innerStart:x,innerEnd:_}=Vk(t,d,h,y-g),w=h-v,C=h-b,k=g+v/w,E=y-b/C,T=d+x,N=d+_,S=g+x/T,I=y-_/N;if(e.beginPath(),s){const t=(k+E)/2;if(e.arc(o,a,h,k,t),e.arc(o,a,h,t,E),b>0){const t=Bk(C,E,o,a);e.arc(t.x,t.y,b,E,y+gx)}const n=Bk(N,y,o,a);if(e.lineTo(n.x,n.y),_>0){const t=Bk(N,I,o,a);e.arc(t.x,t.y,_,y+gx,I+Math.PI)}const i=(y-_/d+(g+x/d))/2;if(e.arc(o,a,d,y-_/d,i,!0),e.arc(o,a,d,i,g+x/d,!0),x>0){const t=Bk(T,S,o,a);e.arc(t.x,t.y,x,S+Math.PI,g-gx)}const r=Bk(w,g,o,a);if(e.lineTo(r.x,r.y),v>0){const t=Bk(w,k,o,a);e.arc(t.x,t.y,v,g-gx,k)}}else{e.moveTo(o,a);const t=Math.cos(k)*h+o,n=Math.sin(k)*h+a;e.lineTo(t,n);const i=Math.cos(E)*h+o,r=Math.sin(E)*h+a;e.lineTo(i,r)}e.closePath()}function Hk(e,t,n,i,r){const{fullCircles:s,startAngle:o,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d,borderRadius:f}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=d,p?(e.lineWidth=2*c,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let m=t.endAngle;if(s){qk(e,t,n,i,m,r);for(let t=0;t<s;++t)e.stroke();isNaN(a)||(m=o+(a%dx||dx))}p&&function(e,t,n){const{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:l}=t;let c=r/a;e.beginPath(),e.arc(s,o,a,i-c,n+c),l>r?(c=r/l,e.arc(s,o,l,n+c,i-c,!0)):e.arc(s,o,r,n+gx,i-gx),e.closePath(),e.clip()}(e,t,m),l.selfJoin&&m-o>=hx&&0===f&&"miter"!==u&&function(e,t,n){const{startAngle:i,x:r,y:s,outerRadius:o,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,h=Math.min(c/o,Ax(i-n));if(e.beginPath(),e.arc(r,s,o-c/2,i+h/2,n-h/2),a>0){const t=Math.min(c/a,Ax(i-n));e.arc(r,s,a+c/2,n-t/2,i+t/2,!0)}else{const t=Math.min(c/2,o*Ax(i-n));if("round"===u)e.arc(r,s,t,n-hx/2,i+hx/2,!0);else if("bevel"===u){const o=2*t*t,a=-o*Math.cos(n+hx/2)+r,l=-o*Math.sin(n+hx/2)+s,c=o*Math.cos(i+hx/2)+r,u=o*Math.sin(i+hx/2)+s;e.lineTo(a,l),e.lineTo(c,u)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,m),s||(qk(e,t,n,i,m,r),e.stroke())}a(zk,"defaults",h_),a(zk,"instances",Ok),a(zk,"overrides",o_),a(zk,"registry",hk),a(zk,"version","4.5.0"),a(zk,"getChart",Lk);class Wk extends JC{constructor(e){super(),a(this,"circumference",void 0),a(this,"endAngle",void 0),a(this,"fullCircles",void 0),a(this,"innerRadius",void 0),a(this,"outerRadius",void 0),a(this,"pixelMargin",void 0),a(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.getProps(["x","y"],n),{angle:r,distance:s}=Sx(i,{x:e,y:t}),{startAngle:o,endAngle:a,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=(this.options.spacing+this.options.borderWidth)/2,d=Yb(u,a-o),f=Dx(r,o,a)&&o!==a,p=d>=dx||f,m=jx(s,l+h,c+h);return p&&m}getCenterPoint(e){const{x:t,y:n,startAngle:i,endAngle:r,innerRadius:s,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:a,spacing:l}=this.options,c=(i+r)/2,u=(s+o+l+a)/2;return{x:t+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,i=(t.offset||0)/4,r=(t.spacing||0)/2,s=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>dx?Math.floor(n/dx):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const o=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(o)*i,Math.sin(o)*i);const a=i*(1-Math.sin(Math.min(hx,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,i,r){const{fullCircles:s,startAngle:o,circumference:a}=t;let l=t.endAngle;if(s){qk(e,t,n,i,l,r);for(let t=0;t<s;++t)e.fill();isNaN(a)||(l=o+(a%dx||dx))}qk(e,t,n,i,l,r),e.fill()}(e,this,a,r,s),Hk(e,this,a,r,s),e.restore()}}function Gk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=Yb(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Yb(n.borderDash,t.borderDash)),e.lineDashOffset=Yb(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Yb(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Yb(n.borderWidth,t.borderWidth),e.strokeStyle=Yb(n.borderColor,t.borderColor)}function Kk(e,t,n){e.lineTo(n.x,n.y)}function Yk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.length,{start:r=0,end:s=i-1}=n,{start:o,end:a}=t,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:i,start:l,loop:t.loop,ilen:c<l&&!u?i+c-l:c-l}}function Qk(e,t,n,i){const{points:r,options:s}=t,{count:o,start:a,loop:l,ilen:c}=Yk(r,n,i),u=function(e){return e.stepped?__:e.tension||"monotone"===e.cubicInterpolationMode?w_:Kk}(s);let h,d,f,{move:p=!0,reverse:m}=i||{};for(h=0;h<=c;++h)d=r[(a+(m?c-h:h))%o],d.skip||(p?(e.moveTo(d.x,d.y),p=!1):u(e,f,d,m,s.stepped),f=d);return l&&(d=r[(a+(m?c:0))%o],u(e,f,d,m,s.stepped)),!!l}function Xk(e,t,n,i){const r=t.points,{count:s,start:o,ilen:a}=Yk(r,n,i),{move:l=!0,reverse:c}=i||{};let u,h,d,f,p,m,g=0,y=0;const v=e=>(o+(c?a-e:e))%s,b=()=>{f!==p&&(e.lineTo(g,p),e.lineTo(g,f),e.lineTo(g,m))};for(l&&(h=r[v(0)],e.moveTo(h.x,h.y)),u=0;u<=a;++u){if(h=r[v(u)],h.skip)continue;const t=h.x,n=h.y,i=0|t;i===d?(n<f?f=n:n>p&&(p=n),g=(y*g+t)/++y):(b(),e.lineTo(t,n),d=i,y=0,f=p=n),m=n}b()}function $k(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?Xk:Qk}a(Wk,"id","arc"),a(Wk,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),a(Wk,"defaultRoutes",{backgroundColor:"backgroundColor"}),a(Wk,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const Jk="function"===typeof Path2D;function Zk(e,t,n,i){Jk&&!t.options.segment?function(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),Gk(e,t.options),e.stroke(r)}(e,t,n,i):function(e,t,n,i){const{segments:r,options:s}=t,o=$k(t);for(const a of r)Gk(e,s,a.style),e.beginPath(),o(e,t,a,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}(e,t,n,i)}class eE extends JC{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;rw(this._points,n,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:o,end:a}=function(e,t,n,i){let r=0,s=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}(n,r,s,i);return Nw(e,!0===i?[{start:o,end:a,loop:s}]:function(e,t,n,i){const r=e.length,s=[];let o,a=t,l=e[t];for(o=t+1;o<=n;++o){const n=e[o%r];n.skip||n.stop?l.skip||(i=!1,s.push({start:t%r,end:(o-1)%r,loop:i}),t=a=n.stop?o:null):(a=o,l.skip&&(t=o)),l=n}return null!==a&&s.push({start:t%r,end:a%r,loop:i}),s}(n,o,a<o?a+r:a,!!e._fullLoop&&0===o&&a===r-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,i=e[t],r=this.points,s=Tw(this,{property:t,start:i,end:i});if(!s.length)return;const o=[],a=function(e){return e.stepped?vw:e.tension||"monotone"===e.cubicInterpolationMode?bw:yw}(n);let l,c;for(l=0,c=s.length;l<c;++l){const{start:c,end:u}=s[l],h=r[c],d=r[u];if(h===d){o.push(h);continue}const f=a(h,d,Math.abs((i-h[t])/(d[t]-h[t])),n.stepped);f[t]=e[t],o.push(f)}return 1===o.length?o[0]:o}pathSegment(e,t,n){return $k(this)(e,this,t,n)}path(e,t,n){const i=this.segments,r=$k(this);let s=this._loop;t=t||0,n=n||this.points.length-t;for(const o of i)s&=r(e,this,o,{start:t,end:t+n-1});return!!s}draw(e,t,n,i){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),Zk(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function tE(e,t,n,i){const r=e.options,{[n]:s}=e.getProps([n],i);return Math.abs(t-s)<r.radius+r.hitRadius}a(eE,"id","line"),a(eE,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),a(eE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),a(eE,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class nE extends JC{constructor(e){super(),a(this,"parsed",void 0),a(this,"skip",void 0),a(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const i=this.options,{x:r,y:s}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(t-s,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return tE(this,e,"x",t)}inYRange(e,t){return tE(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!v_(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,g_(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function iE(e,t){const{x:n,y:i,base:r,width:s,height:o}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,h;return e.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),c=i-h,u=i+h):(h=s/2,a=n-h,l=n+h,c=Math.min(i,r),u=Math.max(i,r)),{left:a,top:c,right:l,bottom:u}}function rE(e,t,n,i){return e?0:Rx(t,n,i)}function sE(e){const t=iE(e),n=t.right-t.left,i=t.bottom-t.top,r=function(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,s=D_(i);return{t:rE(r.top,s.top,0,n),r:rE(r.right,s.right,0,t),b:rE(r.bottom,s.bottom,0,n),l:rE(r.left,s.left,0,t)}}(e,n/2,i/2),s=function(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=R_(r),o=Math.min(t,n),a=e.borderSkipped,l=i||Wb(r);return{topLeft:rE(!l||a.top||a.left,s.topLeft,0,o),topRight:rE(!l||a.top||a.right,s.topRight,0,o),bottomLeft:rE(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:rE(!l||a.bottom||a.right,s.bottomRight,0,o)}}(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function oE(e,t,n,i){const r=null===t,s=null===n,o=e&&!(r&&s)&&iE(e,i);return o&&(r||jx(t,o.left,o.right))&&(s||jx(n,o.top,o.bottom))}function aE(e,t){e.rect(t.x,t.y,t.w,t.h)}function lE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-i,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+s,h:e.h+o,radius:e.radius}}a(nE,"id","point"),a(nE,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),a(nE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class cE extends JC{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:i}}=this,{inner:r,outer:s}=sE(this),o=(a=s.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?T_:aE;var a;e.save(),s.w===r.w&&s.h===r.h||(e.beginPath(),o(e,lE(s,t,r)),e.clip(),o(e,lE(r,-t,s)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),o(e,lE(r,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,n){return oE(this,e,t,n)}inXRange(e,t){return oE(this,e,null,t)}inYRange(e,t){return oE(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+i)/2:t,y:r?n:(n+i)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}a(cE,"id","bar"),a(cE,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),a(cE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const uE=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}};class hE extends JC{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Xb(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,n)=>e.sort(t,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,i=M_(n.font),r=i.size,s=this._computeTitleHeight(),{boxWidth:o,itemHeight:a}=uE(n,r);let l,c;t.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,r,o,a)+10):(c=this.maxHeight,l=this._fitCols(s,i,o,a)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:r,maxWidth:s,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+o;let u=e;r.textAlign="left",r.textBaseline="middle";let h=-1,d=-c;return this.legendItems.forEach((e,f)=>{const p=n+t/2+r.measureText(e.text).width;(0===f||l[l.length-1]+p+2*o>s)&&(u+=c,l[l.length-(f>0?0:1)]=0,d+=c,h++),a[f]={left:0,top:d,row:h,width:p,height:i},l[l.length-1]+=p+o}),u}_fitCols(e,t,n,i){const{ctx:r,maxHeight:s,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-e;let u=o,h=0,d=0,f=0,p=0;return this.legendItems.forEach((e,s)=>{const{itemWidth:m,itemHeight:g}=function(e,t,n,i,r){const s=function(e,t,n,i){let r=e.text;r&&"string"!==typeof r&&(r=r.reduce((e,t)=>e.length>t.length?e:t));return t+n.size/2+i.measureText(r).width}(i,e,t,n),o=function(e,t,n){let i=e;"string"!==typeof t.text&&(i=dE(t,n));return i}(r,i,t.lineHeight);return{itemWidth:s,itemHeight:o}}(n,t,r,e,i);s>0&&d+g+2*o>c&&(u+=h+o,l.push({width:h,height:d}),f+=h+o,p++,h=d=0),a[s]={left:f,top:d,col:p,width:m,height:g},h=Math.max(h,m),d+=g+o}),u+=h,l.push({width:h,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:r}}=this,s=xw(r,this.left,this.width);if(this.isHorizontal()){let r=0,o=Hx(n,this.left+i,this.right-this.lineWidths[r]);for(const a of t)r!==a.row&&(r=a.row,o=Hx(n,this.left+i,this.right-this.lineWidths[r])),a.top+=this.top+e+i,a.left=s.leftForLtr(s.x(o),a.width),o+=a.width+i}else{let r=0,o=Hx(n,this.top+e+i,this.bottom-this.columnSizes[r].height);for(const a of t)a.col!==r&&(r=a.col,o=Hx(n,this.top+e+i,this.bottom-this.columnSizes[r].height)),a.top=o,a.left+=this.left+i,a.left=s.leftForLtr(s.x(a.left),a.width),o+=a.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;b_(e,this),this._draw(),x_(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:r,labels:s}=e,o=h_.color,a=xw(e.rtl,this.left,this.width),l=M_(s.font),{padding:c}=s,u=l.size,h=u/2;let d;this.drawTitle(),i.textAlign=a.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:f,boxHeight:p,itemHeight:m}=uE(s,u),g=this.isHorizontal(),y=this._computeTitleHeight();d=g?{x:Hx(r,this.left+c,this.right-n[0]),y:this.top+c+y,line:0}:{x:this.left+c,y:Hx(r,this.top+y+c,this.bottom-t[0].height),line:0},_w(this.ctx,e.textDirection);const v=m+c;this.legendItems.forEach((b,x)=>{i.strokeStyle=b.fontColor,i.fillStyle=b.fontColor;const _=i.measureText(b.text).width,w=a.textAlign(b.textAlign||(b.textAlign=s.textAlign)),C=f+h+_;let k=d.x,E=d.y;a.setWidth(this.width),g?x>0&&k+C+c>this.right&&(E=d.y+=v,d.line++,k=d.x=Hx(r,this.left+c,this.right-n[d.line])):x>0&&E+v>this.bottom&&(k=d.x=k+t[d.line].width+c,d.line++,E=d.y=Hx(r,this.top+y+c,this.bottom-t[d.line].height));if(function(e,t,n){if(isNaN(f)||f<=0||isNaN(p)||p<0)return;i.save();const r=Yb(n.lineWidth,1);if(i.fillStyle=Yb(n.fillStyle,o),i.lineCap=Yb(n.lineCap,"butt"),i.lineDashOffset=Yb(n.lineDashOffset,0),i.lineJoin=Yb(n.lineJoin,"miter"),i.lineWidth=r,i.strokeStyle=Yb(n.strokeStyle,o),i.setLineDash(Yb(n.lineDash,[])),s.usePointStyle){const o={radius:p*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},l=a.xPlus(e,f/2);y_(i,o,l,t+h,s.pointStyleWidth&&f)}else{const s=t+Math.max((u-p)/2,0),o=a.leftForLtr(e,f),l=R_(n.borderRadius);i.beginPath(),Object.values(l).some(e=>0!==e)?T_(i,{x:o,y:s,w:f,h:p,radius:l}):i.rect(o,s,f,p),i.fill(),0!==r&&i.stroke()}i.restore()}(a.x(k),E,b),k=((e,t,n,i)=>e===(i?"left":"right")?n:"center"===e?(t+n)/2:t)(w,k+f+h,g?k+C:this.right,e.rtl),function(e,t,n){E_(i,n.text,e,t+m/2,l,{strikethrough:n.hidden,textAlign:a.textAlign(n.textAlign)})}(a.x(k),E,b),g)d.x+=C+c;else if("string"!==typeof b.text){const e=l.lineHeight;d.y+=dE(b,e)+c}else d.y+=v}),ww(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=M_(t.font),i=j_(t.padding);if(!t.display)return;const r=xw(e.rtl,this.left,this.width),s=this.ctx,o=t.position,a=n.size/2,l=i.top+a;let c,u=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,u=Hx(e.align,u,this.right-h);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+Hx(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const d=Hx(o,u,u+h);s.textAlign=r.textAlign(qx(o)),s.textBaseline="middle",s.strokeStyle=t.color,s.fillStyle=t.color,s.font=n.string,E_(s,t.text,d,c,n)}_computeTitleHeight(){const e=this.options.title,t=M_(e.font),n=j_(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,r;if(jx(e,this.left,this.right)&&jx(t,this.top,this.bottom))for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(i=r[n],jx(e,i.left,i.left+i.width)&&jx(t,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const i=this._hoveredItem,r=((e,t)=>null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index)(i,n);i&&!r&&Xb(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!r&&Xb(t.onHover,[e,n,this],this)}else n&&Xb(t.onClick,[e,n,this],this)}}function dE(e,t){return t*(e.text?e.text.length:0)}var fE={id:"legend",_element:hE,start(e,t,n){const i=e.legend=new hE({ctx:e.ctx,options:n,chart:e});jC.configure(e,i,n),jC.addBox(e,i)},stop(e){jC.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;jC.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const l=e.controller.getStyle(n?0:void 0),c=j_(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:o&&(a||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class pE extends JC{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const i=Hb(n.text)?n.text.length:1;this._padding=j_(n.padding);const r=i*M_(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:i,right:r,options:s}=this,o=s.align;let a,l,c,u=0;return this.isHorizontal()?(l=Hx(o,n,r),c=t+e,a=r-n):("left"===s.position?(l=n+e,c=Hx(o,i,t),u=-.5*hx):(l=r-e,c=Hx(o,t,i),u=.5*hx),a=i-t),{titleX:l,titleY:c,maxWidth:a,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=M_(t.font),i=n.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:o,rotation:a}=this._drawArgs(i);E_(e,t.text,0,0,n,{color:t.color,maxWidth:o,rotation:a,textAlign:qx(t.align),textBaseline:"middle",translation:[r,s]})}}var mE={id:"title",_element:pE,start(e,t,n){!function(e,t){const n=new pE({ctx:e.ctx,options:t,chart:e});jC.configure(e,n,t),jC.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;jC.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;jC.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const gE={average(e){if(!e.length)return!1;let t,n,i=new Set,r=0,s=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();i.add(e.x),r+=e.y,++s}}if(0===s||0===i.size)return!1;const o=[...i].reduce((e,t)=>e+t)/i.size;return{x:o,y:r/s}},nearest(e,t){if(!e.length)return!1;let n,i,r,s=t.x,o=t.y,a=Number.POSITIVE_INFINITY;for(n=0,i=e.length;n<i;++n){const i=e[n].element;if(i&&i.hasValue()){const e=Ix(t,i.getCenterPoint());e<a&&(a=e,r=i)}}if(r){const e=r.tooltipPosition();s=e.x,o=e.y}return{x:s,y:o}}};function yE(e,t){return t&&(Hb(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function vE(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function bE(e,t){const{element:n,datasetIndex:i,index:r}=t,s=e.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:e,label:o,parsed:s.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function xE(e,t){const n=e.chart.ctx,{body:i,footer:r,title:s}=e,{boxWidth:o,boxHeight:a}=t,l=M_(t.bodyFont),c=M_(t.titleFont),u=M_(t.footerFont),h=s.length,d=r.length,f=i.length,p=j_(t.padding);let m=p.height,g=0,y=i.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(y+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),y){m+=f*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(y-f)*l.lineHeight+(y-1)*t.bodySpacing}d&&(m+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let v=0;const b=function(e){g=Math.max(g,n.measureText(e).width+v)};return n.save(),n.font=c.string,$b(e.title,b),n.font=l.string,$b(e.beforeBody.concat(e.afterBody),b),v=t.displayColors?o+2+t.boxPadding:0,$b(i,e=>{$b(e.before,b),$b(e.lines,b),$b(e.after,b)}),v=0,n.font=u.string,$b(e.footer,b),n.restore(),g+=p.width,{width:g,height:m}}function _E(e,t,n,i){const{x:r,width:s}=n,{width:o,chartArea:{left:a,right:l}}=e;let c="center";return"center"===i?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),function(e,t,n,i){const{x:r,width:s}=i,o=n.caretSize+n.caretPadding;return"left"===e&&r+s+o>t.width||"right"===e&&r-s-o<0||void 0}(c,e,t,n)&&(c="center"),c}function wE(e,t,n){const i=n.yAlign||t.yAlign||function(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||_E(e,t,n,i),yAlign:i}}function CE(e,t,n,i){const{caretSize:r,caretPadding:s,cornerRadius:o}=e,{xAlign:a,yAlign:l}=n,c=r+s,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=R_(o);let p=function(e,t){let{x:n,width:i}=e;return"right"===t?n-=i:"center"===t&&(n-=i/2),n}(t,a);const m=function(e,t,n){let{y:i,height:r}=e;return"top"===t?i+=n:i-="bottom"===t?r+n:r/2,i}(t,l,c);return"center"===l?"left"===a?p+=c:"right"===a&&(p-=c):"left"===a?p-=Math.max(u,d)+r:"right"===a&&(p+=Math.max(h,f)+r),{x:Rx(p,0,i.width-t.width),y:Rx(m,0,i.height-t.height)}}function kE(e,t,n){const i=j_(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function EE(e){return yE([],vE(e))}function TE(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const NE={beforeTitle:Vb,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:Vb,beforeBody:Vb,beforeLabel:Vb,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return qb(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Vb,afterBody:Vb,beforeFooter:Vb,footer:Vb,afterFooter:Vb};function SE(e,t,n,i){const r=e[t].call(n,i);return"undefined"===typeof r?NE[t].call(n,i):r}class IE extends JC{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,r=new Lw(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,L_(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,i=SE(n,"beforeTitle",this,e),r=SE(n,"title",this,e),s=SE(n,"afterTitle",this,e);let o=[];return o=yE(o,vE(i)),o=yE(o,vE(r)),o=yE(o,vE(s)),o}getBeforeBody(e,t){return EE(SE(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return $b(e,e=>{const t={before:[],lines:[],after:[]},r=TE(n,e);yE(t.before,vE(SE(r,"beforeLabel",this,e))),yE(t.lines,SE(r,"label",this,e)),yE(t.after,vE(SE(r,"afterLabel",this,e))),i.push(t)}),i}getAfterBody(e,t){return EE(SE(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=SE(n,"beforeFooter",this,e),r=SE(n,"footer",this,e),s=SE(n,"afterFooter",this,e);let o=[];return o=yE(o,vE(i)),o=yE(o,vE(r)),o=yE(o,vE(s)),o}_createItems(e){const t=this._active,n=this.chart.data,i=[],r=[],s=[];let o,a,l=[];for(o=0,a=t.length;o<a;++o)l.push(bE(this.chart,t[o]));return e.filter&&(l=l.filter((t,i,r)=>e.filter(t,i,r,n))),e.itemSort&&(l=l.sort((t,i)=>e.itemSort(t,i,n))),$b(l,t=>{const n=TE(e.callbacks,t);i.push(SE(n,"labelColor",this,t)),r.push(SE(n,"labelPointStyle",this,t)),s.push(SE(n,"labelTextColor",this,t))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=s,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let r,s=[];if(i.length){const e=gE[n.position].call(this,i,this._eventPosition);s=this._createItems(n),this.title=this.getTitle(s,n),this.beforeBody=this.getBeforeBody(s,n),this.body=this.getBody(s,n),this.afterBody=this.getAfterBody(s,n),this.footer=this.getFooter(s,n);const t=this._size=xE(this,n),o=Object.assign({},e,t),a=wE(this.chart,n,o),l=CE(n,o,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,r={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const r=this.getCaretPosition(e,n,i);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:r}=this,{caretSize:s,cornerRadius:o}=n,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:u}=R_(o),{x:h,y:d}=e,{width:f,height:p}=t;let m,g,y,v,b,x;return"center"===r?(b=d+p/2,"left"===i?(m=h,g=m-s,v=b+s,x=b-s):(m=h+f,g=m+s,v=b-s,x=b+s),y=m):(g="left"===i?h+Math.max(a,c)+s:"right"===i?h+f-Math.max(l,u)-s:this.caretX,"top"===r?(v=d,b=v-s,m=g-s,y=g+s):(v=d+p,b=v+s,m=g+s,y=g-s),x=v),{x1:m,x2:g,x3:y,y1:v,y2:b,y3:x}}drawTitle(e,t,n){const i=this.title,r=i.length;let s,o,a;if(r){const l=xw(n.rtl,this.x,this.width);for(e.x=kE(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",s=M_(n.titleFont),o=n.titleSpacing,t.fillStyle=n.titleColor,t.font=s.string,a=0;a<r;++a)t.fillText(i[a],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+o,a+1===r&&(e.y+=n.titleMarginBottom-o)}}_drawColorBox(e,t,n,i,r){const s=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:a,boxWidth:l}=r,c=M_(r.bodyFont),u=kE(this,"left",r),h=i.x(u),d=a<c.lineHeight?(c.lineHeight-a)/2:0,f=t.y+d;if(r.usePointStyle){const t={radius:Math.min(l,a)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},n=i.leftForLtr(h,l)+l/2,c=f+a/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,g_(e,t,n,c),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,g_(e,t,n,c)}else{e.lineWidth=Wb(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=i.leftForLtr(h,l),n=i.leftForLtr(i.xPlus(h,1),l-2),o=R_(s.borderRadius);Object.values(o).some(e=>0!==e)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,T_(e,{x:t,y:f,w:l,h:a,radius:o}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),T_(e,{x:n,y:f+1,w:l-2,h:a-2,radius:o}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,f,l,a),e.strokeRect(t,f,l,a),e.fillStyle=s.backgroundColor,e.fillRect(n,f+1,l-2,a-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:r,bodyAlign:s,displayColors:o,boxHeight:a,boxWidth:l,boxPadding:c}=n,u=M_(n.bodyFont);let h=u.lineHeight,d=0;const f=xw(n.rtl,this.x,this.width),p=function(n){t.fillText(n,f.x(e.x+d),e.y+h/2),e.y+=h+r},m=f.textAlign(s);let g,y,v,b,x,_,w;for(t.textAlign=s,t.textBaseline="middle",t.font=u.string,e.x=kE(this,m,n),t.fillStyle=n.bodyColor,$b(this.beforeBody,p),d=o&&"right"!==m?"center"===s?l/2+c:l+2+c:0,b=0,_=i.length;b<_;++b){for(g=i[b],y=this.labelTextColors[b],t.fillStyle=y,$b(g.before,p),v=g.lines,o&&v.length&&(this._drawColorBox(t,e,b,f,n),h=Math.max(u.lineHeight,a)),x=0,w=v.length;x<w;++x)p(v[x]),h=u.lineHeight;$b(g.after,p)}d=0,h=u.lineHeight,$b(this.afterBody,p),e.y-=r}drawFooter(e,t,n){const i=this.footer,r=i.length;let s,o;if(r){const a=xw(n.rtl,this.x,this.width);for(e.x=kE(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=a.textAlign(n.footerAlign),t.textBaseline="middle",s=M_(n.footerFont),t.fillStyle=n.footerColor,t.font=s.string,o=0;o<r;++o)t.fillText(i[o],a.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:r,yAlign:s}=this,{x:o,y:a}=e,{width:l,height:c}=n,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=R_(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(o+u,a),"top"===s&&this.drawCaret(e,t,n,i),t.lineTo(o+l-h,a),t.quadraticCurveTo(o+l,a,o+l,a+h),"center"===s&&"right"===r&&this.drawCaret(e,t,n,i),t.lineTo(o+l,a+c-f),t.quadraticCurveTo(o+l,a+c,o+l-f,a+c),"bottom"===s&&this.drawCaret(e,t,n,i),t.lineTo(o+d,a+c),t.quadraticCurveTo(o,a+c,o,a+c-d),"center"===s&&"left"===r&&this.drawCaret(e,t,n,i),t.lineTo(o,a+u),t.quadraticCurveTo(o,a,o+u,a),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,r=n&&n.y;if(i||r){const n=gE[e.position].call(this,this._active,this._eventPosition);if(!n)return;const s=this._size=xE(this,e),o=Object.assign({},n,this._size),a=wE(t,e,o),l=CE(e,o,a,t);i._to===l.x&&r._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=s.width,this.height=s.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const s=j_(t.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&o&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,i,t),_w(e,t.textDirection),r.y+=s.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),ww(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map(e=>{let{datasetIndex:t,index:n}=e;const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[n],index:n}}),r=!Jb(n,i),s=this._positionChanged(i,t);(r||s)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],s=this._getActiveElements(e,r,t,n),o=this._positionChanged(s,e),a=t||!Jb(s,r)||o;return a&&(this._active=s,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),a}_getActiveElements(e,t,n,i){const r=this.options;if("mouseout"===e.type)return[];if(!i)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));const s=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&s.reverse(),s}_positionChanged(e,t){const{caretX:n,caretY:i,options:r}=this,s=gE[r.position].call(this,e,t);return!1!==s&&(n!==s.x||i!==s.y)}}a(IE,"positioners",gE);var PE={id:"tooltip",_element:IE,positioners:gE,afterInit(e,t,n){n&&(e.tooltip=new IE({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",c(c({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:NE},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function AE(e,t,n,i){const r=e.indexOf(t);if(-1===r)return((e,t,n,i)=>("string"===typeof t?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,i);return r!==e.lastIndexOf(t)?n:r}function DE(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class RE extends lk{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:i}of t)e[n]===i&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(qb(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:Rx(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:AE(n,e,Yb(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,i=[];let r=this.getLabels();r=0===e&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let s=e;s<=t;s++)i.push({value:s});return i}getLabelForValue(e){return DE.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function jE(e,t){const n=[],{bounds:i,step:r,min:s,max:o,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:h}=e,d=r||1,f=c-1,{min:p,max:m}=t,g=!qb(s),y=!qb(o),v=!qb(l),b=(m-p)/(u+1);let x,_,w,C,k=wx((m-p)/f/d)*d;if(k<1e-14&&!g&&!y)return[{value:p},{value:m}];C=Math.ceil(m/k)-Math.floor(p/k),C>f&&(k=wx(C*k/f/d)*d),qb(a)||(x=Math.pow(10,a),k=Math.ceil(k*x)/x),"ticks"===i?(_=Math.floor(p/k)*k,w=Math.ceil(m/k)*k):(_=p,w=m),g&&y&&r&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((o-s)/r,k/1e3)?(C=Math.round(Math.min((o-s)/k,c)),k=(o-s)/C,_=s,w=o):v?(_=g?s:_,w=y?o:w,C=l-1,k=(w-_)/C):(C=(w-_)/k,C=_x(C,Math.round(C),k/1e3)?Math.round(C):Math.ceil(C));const E=Math.max(Nx(k),Nx(_));x=Math.pow(10,qb(a)?E:a),_=Math.round(_*x)/x,w=Math.round(w*x)/x;let T=0;for(g&&(h&&_!==s?(n.push({value:s}),_<s&&T++,_x(Math.round((_+T*k)*x)/x,s,ME(s,b,e))&&T++):_<s&&T++);T<C;++T){const e=Math.round((_+T*k)*x)/x;if(y&&e>o)break;n.push({value:e})}return y&&h&&w!==o?n.length&&_x(n[n.length-1].value,o,ME(o,b,e))?n[n.length-1].value=o:n.push({value:o}):y&&w!==o||n.push({value:w}),n}function ME(e,t,n){let{horizontal:i,minRotation:r}=n;const s=Ex(r),o=(i?Math.sin(s):Math.cos(s))||.001,a=.75*t*(""+e).length;return Math.min(t/o,a)}a(RE,"id","category"),a(RE,"defaults",{ticks:{callback:DE}});class OE extends lk{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return qb(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this;const s=e=>i=t?i:e,o=e=>r=n?r:e;if(e){const e=xx(i),t=xx(r);e<0&&t<0?o(0):e>0&&t>0&&s(0)}if(i===r){let t=0===r?1:Math.abs(.05*r);o(r+t),e||s(i-t)}this.min=i,this.max=r}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:i}=e;return i?(t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(i," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=jE({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&kx(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-t)/Math.max(e.length-1,1)/2;t-=i,n+=i}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return i_(e,this.chart.options.locale,this.options.ticks.format)}}class LE extends OE{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Gb(e)?e:0,this.max=Gb(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Ex(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/i))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}a(LE,"id","linear"),a(LE,"defaults",{ticks:{callback:s_.formatters.numeric}});const FE=e=>Math.floor(bx(e)),zE=(e,t)=>Math.pow(10,FE(e)+t);function UE(e){return 1===e/Math.pow(10,FE(e))}function VE(e,t,n){const i=Math.pow(10,n),r=Math.floor(e/i);return Math.ceil(t/i)-r}function BE(e,t){let{min:n,max:i}=t;n=Kb(e.min,n);const r=[],s=FE(n);let o=function(e,t){let n=FE(t-e);for(;VE(e,t,n)>10;)n++;for(;VE(e,t,n)<10;)n--;return Math.min(n,FE(e))}(n,i),a=o<0?Math.pow(10,Math.abs(o)):1;const l=Math.pow(10,o),c=s>o?Math.pow(10,s):0,u=Math.round((n-c)*a)/a,h=Math.floor((n-c)/l/10)*l*10;let d=Math.floor((u-h)/Math.pow(10,o)),f=Kb(e.min,Math.round((c+h+d*Math.pow(10,o))*a)/a);for(;f<i;)r.push({value:f,major:UE(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,a=o>=0?1:a),f=Math.round((c+h+d*Math.pow(10,o))*a)/a;const p=Kb(e.max,f);return r.push({value:p,major:UE(p),significand:d}),r}class qE extends lk{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=OE.prototype.parse.apply(this,[e,t]);if(0!==n)return Gb(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Gb(e)?Math.max(0,e):null,this.max=Gb(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Gb(this._userMin)&&(this.min=e===zE(this.min,0)?zE(this.min,-1):zE(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let n=this.min,i=this.max;const r=t=>n=e?n:t,s=e=>i=t?i:e;n===i&&(n<=0?(r(1),s(10)):(r(zE(n,-1)),s(zE(i,1)))),n<=0&&r(zE(i,-1)),i<=0&&s(zE(n,1)),this.min=n,this.max=i}buildTicks(){const e=this.options,t=BE({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&kx(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":i_(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=bx(e),this._valueRange=bx(this.max)-bx(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(bx(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function HE(e){const t=e.ticks;if(t.display&&e.display){const e=j_(t.backdropPadding);return Yb(t.font&&t.font.size,h_.font.size)+e.height}return 0}function WE(e,t,n){return n=Hb(n)?n:[n],{w:f_(e,t.string,n),h:n.length*t.lineHeight}}function GE(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function KE(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],s=e._pointLabels.length,o=e.options.pointLabels,a=o.centerPointLabels?hx/s:0;for(let l=0;l<s;l++){const s=o.setContext(e.getPointLabelContext(l));r[l]=s.padding;const c=e.getPointPosition(l,e.drawingArea+r[l],a),u=M_(s.font),h=WE(e.ctx,u,e._pointLabels[l]);i[l]=h;const d=Ax(e.getIndexAngle(l)+a),f=Math.round(Tx(d));YE(n,t,d,GE(f,c.x,h.w,0,180),GE(f,c.y,h.h,90,270))}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){const i=[],r=e._pointLabels.length,s=e.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:HE(s)/2,additionalAngle:o?hx/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=t[u];const r=QE(e,u,l);i.push(r),"auto"===a&&(r.visible=XE(r,c),r.visible&&(c=r))}return i}(e,i,r)}function YE(e,t,n,i,r){const s=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;i.start<t.l?(a=(t.l-i.start)/s,e.l=Math.min(e.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/s,e.r=Math.max(e.r,t.r+a)),r.start<t.t?(l=(t.t-r.start)/o,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/o,e.b=Math.max(e.b,t.b+l))}function QE(e,t,n){const i=e.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=n,l=e.getPointPosition(t,i+r+o,s),c=Math.round(Tx(Ax(l.angle+gx))),u=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(l.y,a.h,c),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),d=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(l.x,a.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:d,top:u,right:d+a.w,bottom:u+a.h}}function XE(e,t){if(!t)return!0;const{left:n,top:i,right:r,bottom:s}=e;return!(v_({x:n,y:i},t)||v_({x:n,y:s},t)||v_({x:r,y:i},t)||v_({x:r,y:s},t))}function $E(e,t,n){const{left:i,top:r,right:s,bottom:o}=n,{backdropColor:a}=t;if(!qb(a)){const n=R_(t.borderRadius),l=j_(t.backdropPadding);e.fillStyle=a;const c=i-l.left,u=r-l.top,h=s-i+l.width,d=o-r+l.height;Object.values(n).some(e=>0!==e)?(e.beginPath(),T_(e,{x:c,y:u,w:h,h:d,radius:n}),e.fill()):e.fillRect(c,u,h,d)}}function JE(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,dx);else{let n=e.getPointPosition(0,t);r.moveTo(n.x,n.y);for(let s=1;s<i;s++)n=e.getPointPosition(s,t),r.lineTo(n.x,n.y)}}a(qE,"id","logarithmic"),a(qE,"defaults",{ticks:{callback:s_.formatters.logarithmic,major:{enabled:!0}}});class ZE extends OE{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=j_(HE(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=Gb(e)&&!isNaN(e)?e:0,this.max=Gb(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/HE(this.options))}generateTickLabels(e){OE.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((e,t)=>{const n=Xb(this.options.pointLabels.callback,[e,t],this);return n||0===n?n:""}).filter((e,t)=>this.chart.getDataVisibility(t))}fit(){const e=this.options;e.display&&e.pointLabels.display?KE(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,i){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,i))}getIndexAngle(e){return Ax(e*(dx/(this._pointLabels.length||1))+Ex(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(qb(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(qb(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const n=t[e];return function(e,t,n){return L_(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}getPointPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getIndexAngle(e)-gx+n;return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter,angle:i}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:i,bottom:r}=this._pointLabelItems[e];return{left:t,top:n,right:i,bottom:r}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),JE(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:n,grid:i,border:r}=t,s=this._pointLabels.length;let o,a,l;if(t.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const t=e._pointLabelItems[r];if(!t.visible)continue;const s=i.setContext(e.getPointLabelContext(r));$E(n,s,t);const o=M_(s.font),{x:a,y:l,textAlign:c}=t;E_(n,e._pointLabels[r],a,l+o.lineHeight/2,o,{color:s.color,textAlign:c,textBaseline:"middle"})}}(this,s),i.display&&this.ticks.forEach((e,t)=>{if(0!==t||0===t&&this.min<0){a=this.getDistanceFromCenterForValue(e.value);const n=this.getContext(t),o=i.setContext(n),l=r.setContext(n);!function(e,t,n,i,r){const s=e.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!i||!a||!l||n<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),JE(e,n,o,i),s.closePath(),s.stroke(),s.restore())}(this,o,a,s,l)}}),n.display){for(e.save(),o=s-1;o>=0;o--){const i=n.setContext(this.getPointLabelContext(o)),{color:r,lineWidth:s}=i;s&&r&&(e.lineWidth=s,e.strokeStyle=r,e.setLineDash(i.borderDash),e.lineDashOffset=i.borderDashOffset,a=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(o,a),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,n=t.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let r,s;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(i),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((i,o)=>{if(0===o&&this.min>=0&&!t.reverse)return;const a=n.setContext(this.getContext(o)),l=M_(a.font);if(r=this.getDistanceFromCenterForValue(this.ticks[o].value),a.showLabelBackdrop){e.font=l.string,s=e.measureText(i.label).width,e.fillStyle=a.backdropColor;const t=j_(a.backdropPadding);e.fillRect(-s/2-t.left,-r-l.size/2-t.top,s+t.width,l.size+t.height)}E_(e,i.label,0,-r,l,{color:a.color,strokeColor:a.textStrokeColor,strokeWidth:a.textStrokeWidth})}),e.restore()}drawTitle(){}}a(ZE,"id","radialLinear"),a(ZE,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:s_.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),a(ZE,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),a(ZE,"descriptors",{angleLines:{_fallback:"grid"}});const eT={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},tT=Object.keys(eT);function nT(e,t){return e-t}function iT(e,t){if(qb(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:s}=e._parseOpts;let o=t;return"function"===typeof i&&(o=i(o)),Gb(o)||(o="string"===typeof i?n.parse(o,i):n.parse(o)),null===o?null:(r&&(o="week"!==r||!Cx(s)&&!0!==s?n.startOf(o,r):n.startOf(o,"isoWeek",s)),+o)}function rT(e,t,n,i){const r=tT.length;for(let s=tT.indexOf(e);s<r-1;++s){const e=eT[tT[s]],r=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(r*e.size))<=i)return tT[s]}return tT[r-1]}function sT(e,t,n){if(n){if(n.length){const{lo:i,hi:r}=Mx(n,t);e[n[i]>=t?n[i]:n[r]]=!0}}else e[t]=!0}function oT(e,t,n){const i=[],r={},s=t.length;let o,a;for(o=0;o<s;++o)a=t[o],r[a]=o,i.push({value:a,major:!1});return 0!==s&&n?function(e,t,n,i){const r=e._adapter,s=+r.startOf(t[0].value,i),o=t[t.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,i))l=n[a],l>=0&&(t[l].major=!0);return t}(e,i,r,n):i}class aT extends lk{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),i=this._adapter=new pC(e.adapters.date);i.init(t),ix(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:iT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:r,minDefined:s,maxDefined:o}=this.getUserBounds();function a(e){s||isNaN(e.min)||(i=Math.min(i,e.min)),o||isNaN(e.max)||(r=Math.max(r,e.max))}s&&o||(a(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||a(this.getMinMax(!1))),i=Gb(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),r=Gb(r)&&!isNaN(r)?r:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,s=function(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}(i,r,this.max);return this._unit=t.unit||(n.autoSkip?rT(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(e,t,n,i,r){for(let s=tT.length-1;s>=tT.indexOf(n);s--){const n=tT[s];if(eT[n].common&&e._adapter.diff(r,i,n)>=t-1)return n}return tT[n?tT.indexOf(n):0]}(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=tT.indexOf(e)+1,n=tT.length;t<n;++t)if(eT[tT[t]].common)return tT[t]}(this._unit):void 0,this.initOffsets(i),e.reverse&&s.reverse(),oT(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=0,r=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),i=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),r=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const s=n.length<3?.5:.25;i=Rx(i,0,s),r=Rx(r,0,s),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,r=i.time,s=r.unit||rT(r.minUnit,t,n,this._getLabelCapacity(t)),o=Yb(i.ticks.stepSize,1),a="week"===s&&r.isoWeekday,l=Cx(a)||!0===a,c={};let u,h,d=t;if(l&&(d=+e.startOf(d,"isoWeek",a)),d=+e.startOf(d,l?"day":s),e.diff(n,t,s)>1e5*o)throw new Error(t+" and "+n+" are too far apart with stepSize of "+o+" "+s);const f="data"===i.ticks.source&&this.getDataTimestamps();for(u=d,h=0;u<n;u=+e.add(u,o,s),h++)sT(c,u,f);return u!==n&&"ticks"!==i.bounds&&1!==h||sT(c,u,f),Object.keys(c).sort(nT).map(e=>+e)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,i=this._unit,r=t||n[i];return this._adapter.format(e,r)}_tickFormatFunction(e,t,n,i){const r=this.options,s=r.ticks.callback;if(s)return Xb(s,[e,t,n],this);const o=r.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&o[a],u=l&&o[l],h=n[t],d=l&&u&&h&&h.major;return this._adapter.format(e,i||(d?u:c))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=Ex(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(i),s=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*r+o*s,h:n*s+o*r}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,r=this._tickFormatFunction(e,0,oT(this,[e],this._majorUnit),i),s=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return o>0?o:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(e=0,t=i.length;e<t;++e)n=n.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(iT(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Ux(e.sort(nT))}}function lT(e,t,n){let i,r,s,o,a=0,l=e.length-1;n?(t>=e[a].pos&&t<=e[l].pos&&({lo:a,hi:l}=Ox(e,"pos",t)),({pos:i,time:s}=e[a]),({pos:r,time:o}=e[l])):(t>=e[a].time&&t<=e[l].time&&({lo:a,hi:l}=Ox(e,"time",t)),({time:i,pos:s}=e[a]),({time:r,pos:o}=e[l]));const c=r-i;return c?s+(o-s)*(t-i)/c:s}a(aT,"id","time"),a(aT,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class cT extends aT{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=lT(t,this.min),this._tableRange=lT(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;++s)l=e[s],l>=t&&l<=n&&i.push(l);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(s=0,o=i.length;s<o;++s)c=i[s+1],a=i[s-1],l=i[s],Math.round((c+a)/2)!==l&&r.push({time:l,pos:s/(o-1)});return r}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return n.includes(e)&&n.length||n.splice(0,0,e),n.includes(t)&&1!==n.length||n.push(t),n.sort((e,t)=>e-t)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(lT(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return lT(this._table,n*this._tableRange+this._minPos,!0)}}a(cT,"id","timeseries"),a(cT,"defaults",aT.defaults);const uT=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],hT="label";function dT(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function fT(e,t){e.labels=t}function pT(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hT;const i=[];e.datasets=t.map(t=>{const r=e.datasets.find(e=>e[n]===t[n]);return r&&t.data&&!i.includes(r)?(i.push(r),Object.assign(r,t),r):c({},t)})}function mT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hT;const n={labels:[],datasets:[]};return fT(n,e.labels),pT(n,e.datasets,t),n}function gT(e,t){const{height:n=150,width:r=300,redraw:s=!1,datasetIdKey:o,type:a,data:l,options:u,plugins:h=[],fallbackContent:d,updateMode:f}=e,p=ab(e,uT),m=(0,i.useRef)(null),g=(0,i.useRef)(null),y=()=>{m.current&&(g.current=new zk(m.current,{type:a,data:mT(l,o),options:u&&c({},u),plugins:h}),dT(t,g.current))},v=()=>{dT(t,null),g.current&&(g.current.destroy(),g.current=null)};return(0,i.useEffect)(()=>{!s&&g.current&&u&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(g.current,u)},[s,u]),(0,i.useEffect)(()=>{!s&&g.current&&fT(g.current.config.data,l.labels)},[s,l.labels]),(0,i.useEffect)(()=>{!s&&g.current&&l.datasets&&pT(g.current.config.data,l.datasets,o)},[s,l.datasets]),(0,i.useEffect)(()=>{g.current&&(s?(v(),setTimeout(y)):g.current.update(f))},[s,u,l.labels,l.datasets,f]),(0,i.useEffect)(()=>{g.current&&(v(),setTimeout(y))},[a]),(0,i.useEffect)(()=>(y(),()=>v()),[]),i.createElement("canvas",c({ref:m,role:"img",height:n,width:r},p),d)}const yT=(0,i.forwardRef)(gT);function vT(e,t){return zk.register(t),(0,i.forwardRef)((t,n)=>i.createElement(yT,c(c({},t),{},{ref:n,type:e})))}const bT=vT("bar",rC);function xT(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=xT(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const _T=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=xT(e))&&(i&&(i+=" "),i+=t);return i},wT=["theme","type","isLoading"];!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var CT=e=>"number"==typeof e&&!isNaN(e),kT=e=>"string"==typeof e,ET=e=>"function"==typeof e,TT=e=>kT(e)||ET(e)?e:null,NT=(e,t)=>!1===e||CT(e)&&e>0?e:t,ST=e=>(0,i.isValidElement)(e)||kT(e)||ET(e)||CT(e);function IT(e){let{enter:t,exit:n,appendPosition:r=!1,collapse:s=!0,collapseDuration:o=300}=e;return function(e){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=e,p=r?"".concat(t,"--").concat(l):t,m=r?"".concat(n,"--").concat(l):n,g=(0,i.useRef)(0);return(0,i.useLayoutEffect)(()=>{let e=h.current,t=p.split(" "),n=i=>{i.target===h.current&&(f(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==i.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)},[]),(0,i.useEffect)(()=>{let e=h.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:i,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=i+"px",r.transition="all ".concat(n,"ms"),requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)})})}(e,u,o):u()};d||(c?t():(g.current=1,e.className+=" ".concat(m),e.addEventListener("animationend",t)))},[d]),i.createElement(i.Fragment,null,a)}}function PT(e,t){return{content:AT(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function AT(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,i.isValidElement)(e)&&!kT(e.type)?(0,i.cloneElement)(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):ET(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:n}):e}function DT(e){let{delay:t,isRunning:n,closeToast:r,type:s="default",hide:o,className:a,controlledProgress:l,progress:u,rtl:h,isIn:d,theme:f}=e,p=o||l&&0===u,m={animationDuration:"".concat(t,"ms"),animationPlayState:n?"running":"paused"};l&&(m.transform="scaleX(".concat(u,")"));let g=_T("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(f),"Toastify__progress-bar--".concat(s),{"Toastify__progress-bar--rtl":h}),y=ET(a)?a({rtl:h,type:s,defaultClassName:g}):_T(g,a),v={[l&&u>=1?"onTransitionEnd":"onAnimationEnd"]:l&&u<1?null:()=>{d&&r()}};return i.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":p},i.createElement("div",{className:"Toastify__progress-bar--bg Toastify__progress-bar-theme--".concat(f," Toastify__progress-bar--").concat(s)}),i.createElement("div",c({role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:y,style:m},v)))}var RT=1,jT=()=>"".concat(RT++);function MT(e,t,n){let i=1,r=0,s=[],o=[],a=t,l=new Map,u=new Set,h=()=>{o=Array.from(l.values()),u.forEach(e=>e())},d=e=>{var t,n;null==(n=null==(t=e.props)?void 0:t.onClose)||n.call(t,e.removalReason),e.isActive=!1},f=e=>{if(null==e)l.forEach(d);else{let t=l.get(e);t&&d(t)}h()},p=e=>{var t,i;let{toastId:r,updateId:s}=e.props,o=null==s;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(r,e),h(),n(PT(e,o?"added":"updated")),o&&(null==(i=(t=e.props).onOpen)||i.call(t))};return{id:e,props:a,observe:e=>(u.add(e),()=>u.delete(e)),toggle:(e,t)=>{l.forEach(n=>{var i;(null==t||t===n.props.toastId)&&(null==(i=n.toggle)||i.call(n,e))})},removeToast:f,toasts:l,clearQueue:()=>{r-=s.length,s=[]},buildToast:(t,o)=>{if((t=>{let{containerId:n,toastId:i,updateId:r}=t,s=n?n!==e:1!==e,o=l.has(i)&&null==r;return s||o})(o))return;let{toastId:u,updateId:d,data:m,staleId:g,delay:y}=o,v=null==d;v&&r++;let b=c(c(c({},a),{},{style:a.toastStyle,key:i++},Object.fromEntries(Object.entries(o).filter(e=>{let[t,n]=e;return null!=n}))),{},{toastId:u,updateId:d,data:m,isIn:!1,className:TT(o.className||a.toastClassName),progressClassName:TT(o.progressClassName||a.progressClassName),autoClose:!o.isLoading&&NT(o.autoClose,a.autoClose),closeToast(e){l.get(u).removalReason=e,f(u)},deleteToast(){let e=l.get(u);if(null!=e){if(n(PT(e,"removed")),l.delete(u),r--,r<0&&(r=0),s.length>0)return void p(s.shift());h()}}});b.closeButton=a.closeButton,!1===o.closeButton||ST(o.closeButton)?b.closeButton=o.closeButton:!0===o.closeButton&&(b.closeButton=!ST(a.closeButton)||a.closeButton);let x={content:t,props:b,staleId:g};a.limit&&a.limit>0&&r>a.limit&&v?s.push(x):CT(y)?setTimeout(()=>{p(x)},y):p(x)},setProps(e){a=e},setToggle:(e,t)=>{let n=l.get(e);n&&(n.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>o}}var OT=new Map,LT=[],FT=new Set,zT=e=>FT.forEach(t=>t(e)),UT=()=>OT.size>0;function VT(e,t){var n;if(t)return!(null==(n=OT.get(t))||!n.isToastActive(e));let i=!1;return OT.forEach(t=>{t.isToastActive(e)&&(i=!0)}),i}function BT(e){if(UT()){if(null==e||(e=>kT(e)||CT(e))(e))OT.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=OT.get(e.containerId);t?t.removeToast(e.id):OT.forEach(t=>{t.removeToast(e.id)})}}else LT=LT.filter(t=>null!=e&&t.options.toastId!==e)}function qT(e,t){ST(e)&&(UT()||LT.push({content:e,options:t}),OT.forEach(n=>{n.buildToast(e,t)}))}function HT(e,t){OT.forEach(n=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===n.id)&&n.toggle(e,null==t?void 0:t.id)})}function WT(e){let t=e.containerId||1;return{subscribe(n){let i=MT(t,e,zT);OT.set(t,i);let r=i.observe(n);return LT.forEach(e=>qT(e.content,e.options)),LT=[],()=>{r(),OT.delete(t)}},setProps(e){var n;null==(n=OT.get(t))||n.setProps(e)},getSnapshot(){var e;return null==(e=OT.get(t))?void 0:e.getSnapshot()}}}function GT(e){return e&&(kT(e.toastId)||CT(e.toastId))?e.toastId:jT()}function KT(e,t){return qT(e,t),t.toastId}function YT(e,t){return c(c({},t),{},{type:t&&t.type||e,toastId:GT(t)})}function QT(e){return(t,n)=>KT(t,YT(e,n))}function XT(e,t){return KT(e,YT("default",t))}function $T(e){let[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!1),o=(0,i.useRef)(null),a=(0,i.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:h,closeOnClick:d}=e;function f(){n(!0)}function p(){n(!1)}function m(n){let i=o.current;if(a.canDrag&&i){a.didMove=!0,t&&p(),"x"===e.draggableDirection?a.delta=n.clientX-a.start:a.delta=n.clientY-a.start,a.start!==n.clientX&&(a.canCloseOnClick=!1);let r="x"===e.draggableDirection?"".concat(a.delta,"px, var(--y)"):"0, calc(".concat(a.delta,"px + var(--y))");i.style.transform="translate3d(".concat(r,",0)"),i.style.opacity="".concat(1-Math.abs(a.delta/a.removalDistance))}}function g(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g);let t=o.current;if(a.canDrag&&a.didMove&&t){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return s(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=OT.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:n}),(0,i.useEffect)(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||p(),window.addEventListener("focus",f),window.addEventListener("blur",p),()=>{window.removeEventListener("focus",f),window.removeEventListener("blur",p)}},[e.pauseOnFocusLoss]);let y={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){a.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g);let n=o.current;a.canCloseOnClick=!0,a.canDrag=!0,n.style.transition="none","x"===e.draggableDirection?(a.start=t.clientX,a.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(a.start=t.clientY,a.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:n,bottom:i,left:r,right:s}=o.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=r&&t.clientX<=s&&t.clientY>=n&&t.clientY<=i?p():f()}};return l&&c&&(y.onMouseEnter=p,e.stacked||(y.onMouseLeave=f)),d&&(y.onClick=e=>{h&&h(e),a.canCloseOnClick&&u(!0)}),{playToast:f,pauseToast:p,isRunning:t,preventExitTransition:r,toastRef:o,eventHandlers:y}}XT.loading=(e,t)=>KT(e,YT("default",c({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t))),XT.promise=function(e,t,n){let i,{pending:r,error:s,success:o}=t;r&&(i=kT(r)?XT.loading(r,n):XT.loading(r.render,c(c({},n),r)));let a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,r)=>{if(null==t)return void XT.dismiss(i);let s=c(c(c({type:e},a),n),{},{data:r}),o=kT(t)?{render:t}:t;return i?XT.update(i,c(c({},s),o)):XT(o.render,c(c({},s),o)),r},u=ET(e)?e():e;return u.then(e=>l("success",o,e)).catch(e=>l("error",s,e)),u},XT.success=QT("success"),XT.info=QT("info"),XT.error=QT("error"),XT.warning=QT("warning"),XT.warn=XT.warning,XT.dark=(e,t)=>KT(e,YT("default",c({theme:"dark"},t))),XT.dismiss=function(e){BT(e)},XT.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};OT.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},XT.isActive=VT,XT.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=((e,t)=>{let{containerId:n}=t;var i;return null==(i=OT.get(n||1))?void 0:i.toasts.get(e)})(e,t);if(n){let{props:i,content:r}=n,s=c(c(c({delay:100},i),t),{},{toastId:t.toastId||e,updateId:jT()});s.toastId!==e&&(s.staleId=e);let o=s.render||r;delete s.render,KT(o,s)}},XT.done=e=>{XT.update(e,{progress:1})},XT.onChange=function(e){return FT.add(e),()=>{FT.delete(e)}},XT.play=e=>HT(!0,e),XT.pause=e=>HT(!1,e);var JT="undefined"!=typeof window?i.useLayoutEffect:i.useEffect,ZT=e=>{let{theme:t,type:n,isLoading:r}=e,s=ab(e,wT);return i.createElement("svg",c({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":"var(--toastify-icon-color-".concat(n,")")},s))};var eN={info:function(e){return i.createElement(ZT,c({},e),i.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return i.createElement(ZT,c({},e),i.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return i.createElement(ZT,c({},e),i.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return i.createElement(ZT,c({},e),i.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return i.createElement("div",{className:"Toastify__spinner"})}};function tN(e){let{theme:t,type:n,isLoading:r,icon:s}=e,o=null,a={theme:t,type:n};return!1===s||(ET(s)?o=s(c(c({},a),{},{isLoading:r})):(0,i.isValidElement)(s)?o=(0,i.cloneElement)(s,a):r?o=eN.spinner():(e=>e in eN)(n)&&(o=eN[n](a))),o}var nN=e=>{let{isRunning:t,preventExitTransition:n,toastRef:r,eventHandlers:s,playToast:o}=$T(e),{closeButton:a,children:l,autoClose:u,onClick:h,type:d,hideProgressBar:f,closeToast:p,transition:m,position:g,className:y,style:v,progressClassName:b,updateId:x,role:_,progress:w,rtl:C,toastId:k,deleteToast:E,isIn:T,isLoading:N,closeOnClick:S,theme:I,ariaLabel:P}=e,A=_T("Toastify__toast","Toastify__toast-theme--".concat(I),"Toastify__toast--".concat(d),{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":S}),D=ET(y)?y({rtl:C,position:g,type:d,defaultClassName:A}):_T(A,y),R=tN(e),j=!!w||!u,M={closeToast:p,type:d,theme:I},O=null;return!1===a||(O=ET(a)?a(M):(0,i.isValidElement)(a)?(0,i.cloneElement)(a,M):function(e){let{closeToast:t,theme:n,ariaLabel:r="close"}=e;return i.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(n),type:"button",onClick:e=>{e.stopPropagation(),t(!0)},"aria-label":r},i.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},i.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(M)),i.createElement(m,{isIn:T,done:E,position:g,preventExitTransition:n,nodeRef:r,playToast:o},i.createElement("div",c(c({id:k,tabIndex:0,onClick:h,"data-in":T,className:D},s),{},{style:v,ref:r},T&&{role:_,"aria-label":P}),null!=R&&i.createElement("div",{className:_T("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!N})},R),AT(l,e,!t),O,!e.customProgressBar&&i.createElement(DT,c(c({},x&&!j?{key:"p-".concat(x)}:{}),{},{rtl:C,theme:I,delay:u,isRunning:t,isIn:T,closeToast:p,hide:f,type:d,className:b,controlledProgress:j,progress:w||0}))))},iN=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}},rN=IT(iN("bounce",!0)),sN=(IT(iN("slide",!0)),IT(iN("zoom")),IT(iN("flip")),{position:"top-right",transition:rN,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function oN(e){let t=c(c({},sN),e),n=e.stacked,[r,s]=(0,i.useState)(!0),o=(0,i.useRef)(null),{getToastToRender:a,isToastActive:l,count:u}=function(e){var t;let{subscribe:n,getSnapshot:r,setProps:s}=(0,i.useRef)(WT(e)).current;s(e);let o=null==(t=(0,i.useSyncExternalStore)(n,r,r))?void 0:t.slice();return{getToastToRender:function(t){if(!o)return[];let n=new Map;return e.newestOnTop&&o.reverse(),o.forEach(e=>{let{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)}),Array.from(n,e=>t(e[0],e[1]))},isToastActive:VT,count:null==o?void 0:o.length}}(t),{className:h,style:d,rtl:f,containerId:p,hotKeys:m}=t;function g(e){let t=_T("Toastify__toast-container","Toastify__toast-container--".concat(e),{"Toastify__toast-container--rtl":f});return ET(h)?h({position:e,rtl:f,defaultClassName:t}):_T(t,TT(h))}function y(){n&&(s(!0),XT.play())}return JT(()=>{var e;if(n){let n=o.current.querySelectorAll('[data-in="true"]'),i=12,s=null==(e=t.position)?void 0:e.includes("top"),a=0,l=0;Array.from(n).reverse().forEach((e,t)=>{let n=e;n.classList.add("Toastify__toast--stacked"),t>0&&(n.dataset.collapsed="".concat(r)),n.dataset.pos||(n.dataset.pos=s?"top":"bot");let o=a*(r?.2:1)+(r?0:i*t);n.style.setProperty("--y","".concat(s?o:-1*o,"px")),n.style.setProperty("--g","".concat(i)),n.style.setProperty("--s","".concat(1-(r?l:0))),a+=n.offsetHeight,l+=.025})}},[r,u,n]),(0,i.useEffect)(()=>{function e(e){var t;let n=o.current;m(e)&&(null==(t=n.querySelector('[tabIndex="0"]'))||t.focus(),s(!1),XT.pause()),"Escape"===e.key&&(document.activeElement===n||null!=n&&n.contains(document.activeElement))&&(s(!0),XT.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[m]),i.createElement("section",{ref:o,className:"Toastify",id:p,onMouseEnter:()=>{n&&(s(!1),XT.pause())},onMouseLeave:y,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},a((e,t)=>{let r=t.length?c({},d):c(c({},d),{},{pointerEvents:"none"});return i.createElement("div",{tabIndex:-1,className:g(e),"data-stacked":n,style:r,key:"c-".concat(e)},t.map(e=>{let{content:t,props:r}=e;return i.createElement(nN,c(c({},r),{},{stacked:n,collapseAll:y,isIn:l(r.toastId,r.containerId),key:"t-".concat(r.key)}),t)}))}))}const aN={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,n){return e},captureMetaData:!1},lN=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",cN=new RegExp("^"+("["+lN+"]["+(lN+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*")+"$");function uN(e,t){const n=[];let i=t.exec(e);for(;i;){const r=[];r.startIndex=t.lastIndex-i[0].length;const s=i.length;for(let e=0;e<s;e++)r.push(i[e]);n.push(r),i=t.exec(e)}return n}const hN=function(e){const t=cN.exec(e);return!(null===t||"undefined"===typeof t)};let dN;dN="function"!==typeof Symbol?"@@xmlMetadata":Symbol("XML Node Metadata");class fN{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),void 0!==t&&(this.child[this.child.length-1][dN]={startIndex:t})}static getMetaDataSymbol(){return dN}}function pN(e,t){const n={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let i=1,r=!1,s=!1,o="";for(;t<e.length;t++)if("<"!==e[t]||s)if(">"===e[t]){if(s?"-"===e[t-1]&&"-"===e[t-2]&&(s=!1,i--):i--,0===i)break}else"["===e[t]?r=!0:o+=e[t];else{if(r&&xN(e,"!ENTITY",t)){let i,r;t+=7,[i,r,t]=gN(e,t+1),-1===r.indexOf("&")&&(n[i]={regx:RegExp("&".concat(i,";"),"g"),val:r})}else if(r&&xN(e,"!ELEMENT",t)){t+=8;const{index:n}=bN(e,t+1);t=n}else if(r&&xN(e,"!ATTLIST",t))t+=8;else if(r&&xN(e,"!NOTATION",t)){t+=9;const{index:n}=yN(e,t+1);t=n}else{if(!xN(e,"!--",t))throw new Error("Invalid DOCTYPE");s=!0}i++,o=""}if(0!==i)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:t}}const mN=(e,t)=>{for(;t<e.length&&/\s/.test(e[t]);)t++;return t};function gN(e,t){t=mN(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t])&&'"'!==e[t]&&"'"!==e[t];)n+=e[t],t++;if(_N(n),t=mN(e,t),"SYSTEM"===e.substring(t,t+6).toUpperCase())throw new Error("External entities are not supported");if("%"===e[t])throw new Error("Parameter entities are not supported");let i="";return[t,i]=vN(e,t,"entity"),[n,i,--t]}function yN(e,t){t=mN(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;_N(n),t=mN(e,t);const i=e.substring(t,t+6).toUpperCase();if("SYSTEM"!==i&&"PUBLIC"!==i)throw new Error('Expected SYSTEM or PUBLIC, found "'.concat(i,'"'));t+=i.length,t=mN(e,t);let r=null,s=null;if("PUBLIC"===i)[t,r]=vN(e,t,"publicIdentifier"),'"'!==e[t=mN(e,t)]&&"'"!==e[t]||([t,s]=vN(e,t,"systemIdentifier"));else if("SYSTEM"===i&&([t,s]=vN(e,t,"systemIdentifier"),!s))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:n,publicIdentifier:r,systemIdentifier:s,index:--t}}function vN(e,t,n){let i="";const r=e[t];if('"'!==r&&"'"!==r)throw new Error('Expected quoted string, found "'.concat(r,'"'));for(t++;t<e.length&&e[t]!==r;)i+=e[t],t++;if(e[t]!==r)throw new Error("Unterminated ".concat(n," value"));return[++t,i]}function bN(e,t){t=mN(e,t);let n="";for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;if(!_N(n))throw new Error('Invalid element name: "'.concat(n,'"'));let i="";if("E"===e[t=mN(e,t)]&&xN(e,"MPTY",t))t+=4;else if("A"===e[t]&&xN(e,"NY",t))t+=2;else{if("("!==e[t])throw new Error('Invalid Element Expression, found "'.concat(e[t],'"'));for(t++;t<e.length&&")"!==e[t];)i+=e[t],t++;if(")"!==e[t])throw new Error("Unterminated content model")}return{elementName:n,contentModel:i.trim(),index:t}}function xN(e,t,n){for(let i=0;i<t.length;i++)if(t[i]!==e[n+i+1])return!1;return!0}function _N(e){if(hN(e))return e;throw new Error("Invalid entity name ".concat(e))}const wN=/^[-+]?0x[a-fA-F0-9]+$/,CN=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,kN={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function EN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=Object.assign({},kN,t),!e||"string"!==typeof e)return e;let n=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(n))return e;if("0"===e)return 0;if(t.hex&&wN.test(n))return function(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}(n,16);if(-1!==n.search(/.+[eE].+/))return function(e,t,n){if(!n.eNotation)return e;const i=t.match(TN);if(i){let r=i[1]||"";const s=-1===i[3].indexOf("e")?"E":"e",o=i[2],a=r?e[o.length+1]===s:e[o.length]===s;return o.length>1&&a?e:1!==o.length||!i[3].startsWith(".".concat(s))&&i[3][0]!==s?n.leadingZeros&&!a?(t=(i[1]||"")+i[3],Number(t)):e:Number(t)}return e}(e,n,t);{const i=CN.exec(n);if(i){const r=i[1]||"",s=i[2];let o=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substring(0,e.length-1)),e;return e}(i[3]);const a=r?"."===e[s.length+1]:"."===e[s.length];if(!t.leadingZeros&&(s.length>1||1===s.length&&!a))return e;{const i=Number(n),a=String(i);if(0===i)return i;if(-1!==a.search(/[eE]/))return t.eNotation?i:e;if(-1!==n.indexOf("."))return"0"===a||a===o||a==="".concat(r).concat(o)?i:e;let l=s?o:n;return s?l===a||r+l===a?i:e:l===a||l===r+a?i:e}}return e}}const TN=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;class NN{constructor(e){var t;this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xa2"},pound:{regex:/&(pound|#163);/g,val:"\xa3"},yen:{regex:/&(yen|#165);/g,val:"\xa5"},euro:{regex:/&(euro|#8364);/g,val:"\u20ac"},copyright:{regex:/&(copy|#169);/g,val:"\xa9"},reg:{regex:/&(reg|#174);/g,val:"\xae"},inr:{regex:/&(inr|#8377);/g,val:"\u20b9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,16))}},this.addExternalEntities=SN,this.parseXml=RN,this.parseTextData=IN,this.resolveNameSpace=PN,this.buildAttributesMap=DN,this.isItStopNode=LN,this.replaceEntitiesValue=MN,this.readStopNodeData=UN,this.saveTextToParentTag=ON,this.addChild=jN,this.ignoreAttributesFn="function"===typeof(t=this.options.ignoreAttributes)?t:Array.isArray(t)?e=>{for(const n of t){if("string"===typeof n&&e===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}}:()=>!1}}function SN(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const i=t[n];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:e[i]}}}function IN(e,t,n,i,r,s,o){if(void 0!==e&&(this.options.trimValues&&!i&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));const i=this.options.tagValueProcessor(t,e,n,r,s);if(null===i||void 0===i)return e;if(typeof i!==typeof e||i!==e)return i;if(this.options.trimValues)return VN(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?VN(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function PN(e){if(this.options.removeNSPrefix){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}const AN=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function DN(e,t,n){if(!0!==this.options.ignoreAttributes&&"string"===typeof e){const n=uN(e,AN),i=n.length,r={};for(let e=0;e<i;e++){const i=this.resolveNameSpace(n[e][1]);if(this.ignoreAttributesFn(i,t))continue;let s=n[e][4],o=this.options.attributeNamePrefix+i;if(i.length)if(this.options.transformAttributeName&&(o=this.options.transformAttributeName(o)),"__proto__"===o&&(o="#__proto__"),void 0!==s){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);const e=this.options.attributeValueProcessor(i,s,t);r[o]=null===e||void 0===e?s:typeof e!==typeof s||e!==s?e:VN(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(r[o]=!0)}if(!Object.keys(r).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=r,e}return r}}const RN=function(e){e=e.replace(/\r\n?/g,"\n");const t=new fN("!xml");let n=t,i="",r="";for(let s=0;s<e.length;s++){if("<"===e[s])if("/"===e[s+1]){const t=FN(e,">",s,"Closing Tag is not closed.");let o=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){const e=o.indexOf(":");-1!==e&&(o=o.substr(e+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),n&&(i=this.saveTextToParentTag(i,n,r));const a=r.substring(r.lastIndexOf(".")+1);if(o&&-1!==this.options.unpairedTags.indexOf(o))throw new Error("Unpaired tag can not be used as closing tag: </".concat(o,">"));let l=0;a&&-1!==this.options.unpairedTags.indexOf(a)?(l=r.lastIndexOf(".",r.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=r.lastIndexOf("."),r=r.substring(0,l),n=this.tagsNodeStack.pop(),i="",s=t}else if("?"===e[s+1]){let t=zN(e,s,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,n,r),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new fN(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,r,t.tagName)),this.addChild(n,e,r,s)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){const t=FN(e,"--\x3e",s+4,"Comment is not closed.");if(this.options.commentPropName){const o=e.substring(s+4,t-2);i=this.saveTextToParentTag(i,n,r),n.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}s=t}else if("!D"===e.substr(s+1,2)){const t=pN(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){const t=FN(e,"]]>",s,"CDATA is not closed.")-2,o=e.substring(s+9,t);i=this.saveTextToParentTag(i,n,r);let a=this.parseTextData(o,n.tagname,r,!0,!1,!0,!0);void 0==a&&(a=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]):n.add(this.options.textNodeName,a),s=t+2}else{let o=zN(e,s,this.options.removeNSPrefix),a=o.tagName;const l=o.rawTagName;let c=o.tagExp,u=o.attrExpPresent,h=o.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),n&&i&&"!xml"!==n.tagname&&(i=this.saveTextToParentTag(i,n,r,!1));const d=n;d&&-1!==this.options.unpairedTags.indexOf(d.tagname)&&(n=this.tagsNodeStack.pop(),r=r.substring(0,r.lastIndexOf("."))),a!==t.tagname&&(r+=r?"."+a:a);const f=s;if(this.isItStopNode(this.options.stopNodes,r,a)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===a[a.length-1]?(a=a.substr(0,a.length-1),r=r.substr(0,r.length-1),c=a):c=c.substr(0,c.length-1),s=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(a))s=o.closeIndex;else{const n=this.readStopNodeData(e,l,h+1);if(!n)throw new Error("Unexpected end of ".concat(l));s=n.i,t=n.tagContent}const i=new fN(a);a!==c&&u&&(i[":@"]=this.buildAttributesMap(c,r,a)),t&&(t=this.parseTextData(t,a,r,!0,u,!0,!0)),r=r.substr(0,r.lastIndexOf(".")),i.add(this.options.textNodeName,t),this.addChild(n,i,r,f)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),r=r.substr(0,r.length-1),c=a):c=c.substr(0,c.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));const e=new fN(a);a!==c&&u&&(e[":@"]=this.buildAttributesMap(c,r,a)),this.addChild(n,e,r,f),r=r.substr(0,r.lastIndexOf("."))}else{const e=new fN(a);this.tagsNodeStack.push(n),a!==c&&u&&(e[":@"]=this.buildAttributesMap(c,r,a)),this.addChild(n,e,r,f),n=e}i="",s=h}}else i+=e[s]}return t.child};function jN(e,t,n,i){this.options.captureMetaData||(i=void 0);const r=this.options.updateTag(t.tagname,n,t[":@"]);!1===r||("string"===typeof r?(t.tagname=r,e.addChild(t,i)):e.addChild(t,i))}const MN=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){const n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function ON(e,t,n,i){return e&&(void 0===i&&(i=0===t.child.length),void 0!==(e=this.parseTextData(e,t.tagname,n,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,i))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function LN(e,t,n){const i="*."+n;for(const r in e){const n=e[r];if(i===n||t===n)return!0}return!1}function FN(e,t,n,i){const r=e.indexOf(t,n);if(-1===r)throw new Error(i);return r+t.length-1}function zN(e,t,n){const i=function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:">",r="";for(let s=t;s<e.length;s++){let t=e[s];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else if(t===i[0]){if(!i[1])return{data:r,index:s};if(e[s+1]===i[1])return{data:r,index:s}}else"\t"===t&&(t=" ");r+=t}}(e,t+1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:">");if(!i)return;let r=i.data;const s=i.index,o=r.search(/\s/);let a=r,l=!0;-1!==o&&(a=r.substring(0,o),r=r.substring(o+1).trimStart());const c=a;if(n){const e=a.indexOf(":");-1!==e&&(a=a.substr(e+1),l=a!==i.data.substr(e+1))}return{tagName:a,tagExp:r,closeIndex:s,attrExpPresent:l,rawTagName:c}}function UN(e,t,n){const i=n;let r=1;for(;n<e.length;n++)if("<"===e[n])if("/"===e[n+1]){const s=FN(e,">",n,"".concat(t," is not closed"));if(e.substring(n+2,s).trim()===t&&(r--,0===r))return{tagContent:e.substring(i,n),i:s};n=s}else if("?"===e[n+1]){n=FN(e,"?>",n+1,"StopNode is not closed.")}else if("!--"===e.substr(n+1,3)){n=FN(e,"--\x3e",n+3,"StopNode is not closed.")}else if("!["===e.substr(n+1,2)){n=FN(e,"]]>",n,"StopNode is not closed.")-2}else{const i=zN(e,n,">");if(i){(i&&i.tagName)===t&&"/"!==i.tagExp[i.tagExp.length-1]&&r++,n=i.closeIndex}}}function VN(e,t,n){if(t&&"string"===typeof e){const t=e.trim();return"true"===t||"false"!==t&&EN(e,n)}return function(e){return"undefined"!==typeof e}(e)?e:""}const BN=fN.getMetaDataSymbol();function qN(e,t){return HN(e,t)}function HN(e,t,n){let i;const r={};for(let s=0;s<e.length;s++){const o=e[s],a=WN(o);let l="";if(l=void 0===n?a:n+"."+a,a===t.textNodeName)void 0===i?i=o[a]:i+=""+o[a];else{if(void 0===a)continue;if(o[a]){let e=HN(o[a],t,l);const n=KN(e,t);void 0!==o[BN]&&(e[BN]=o[BN]),o[":@"]?GN(e,o[":@"],l,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==r[a]&&r.hasOwnProperty(a)?(Array.isArray(r[a])||(r[a]=[r[a]]),r[a].push(e)):t.isArray(a,l,n)?r[a]=[e]:r[a]=e}}}return"string"===typeof i?i.length>0&&(r[t.textNodeName]=i):void 0!==i&&(r[t.textNodeName]=i),r}function WN(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const e=t[n];if(":@"!==e)return e}}function GN(e,t,n,i){if(t){const r=Object.keys(t),s=r.length;for(let o=0;o<s;o++){const s=r[o];i.isArray(s,n+"."+s,!0,!0)?e[s]=[t[s]]:e[s]=t[s]}}}function KN(e,t){const{textNodeName:n}=t,i=Object.keys(e).length;return 0===i||!(1!==i||!e[n]&&"boolean"!==typeof e[n]&&0!==e[n])}const YN={allowBooleanAttributes:!1,unpairedTags:[]};function QN(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function XN(e,t){const n=t;for(;t<e.length;t++)if("?"==e[t]||" "==e[t]){const i=e.substr(n,t-n);if(t>5&&"xml"===i)return rS("InvalidXml","XML declaration allowed only at the start of the document.",aS(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}continue}return t}function $N(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}const JN='"',ZN="'";function eS(e,t){let n="",i="",r=!1;for(;t<e.length;t++){if(e[t]===JN||e[t]===ZN)""===i?i=e[t]:i!==e[t]||(i="");else if(">"===e[t]&&""===i){r=!0;break}n+=e[t]}return""===i&&{value:n,index:t,tagClosed:r}}const tS=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function nS(e,t){const n=uN(e,tS),i={};for(let r=0;r<n.length;r++){if(0===n[r][1].length)return rS("InvalidAttr","Attribute '"+n[r][2]+"' has no space in starting.",lS(n[r]));if(void 0!==n[r][3]&&void 0===n[r][4])return rS("InvalidAttr","Attribute '"+n[r][2]+"' is without value.",lS(n[r]));if(void 0===n[r][3]&&!t.allowBooleanAttributes)return rS("InvalidAttr","boolean attribute '"+n[r][2]+"' is not allowed.",lS(n[r]));const e=n[r][2];if(!sS(e))return rS("InvalidAttr","Attribute '"+e+"' is an invalid name.",lS(n[r]));if(i.hasOwnProperty(e))return rS("InvalidAttr","Attribute '"+e+"' is repeated.",lS(n[r]));i[e]=1}return!0}function iS(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function rS(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function sS(e){return hN(e)}function oS(e){return hN(e)}function aS(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function lS(e){return e.startIndex+e[1].length}class cS{constructor(e){this.externalEntities={},this.options=function(e){return Object.assign({},aN,e)}(e)}parse(e,t){if("string"===typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const n=function(e,t){t=Object.assign({},YN,t);const n=[];let i=!1,r=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let s=0;s<e.length;s++)if("<"===e[s]&&"?"===e[s+1]){if(s+=2,s=XN(e,s),s.err)return s}else{if("<"!==e[s]){if(QN(e[s]))continue;return rS("InvalidChar","char '"+e[s]+"' is not expected.",aS(e,s))}{let o=s;if(s++,"!"===e[s]){s=$N(e,s);continue}{let a=!1;"/"===e[s]&&(a=!0,s++);let l="";for(;s<e.length&&">"!==e[s]&&" "!==e[s]&&"\t"!==e[s]&&"\n"!==e[s]&&"\r"!==e[s];s++)l+=e[s];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),s--),!oS(l)){let t;return t=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",rS("InvalidTag",t,aS(e,s))}const c=eS(e,s);if(!1===c)return rS("InvalidAttr","Attributes for '"+l+"' have open quote.",aS(e,s));let u=c.value;if(s=c.index,"/"===u[u.length-1]){const n=s-u.length;u=u.substring(0,u.length-1);const r=nS(u,t);if(!0!==r)return rS(r.err.code,r.err.msg,aS(e,n+r.err.line));i=!0}else if(a){if(!c.tagClosed)return rS("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",aS(e,s));if(u.trim().length>0)return rS("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",aS(e,o));if(0===n.length)return rS("InvalidTag","Closing tag '"+l+"' has not been opened.",aS(e,o));{const t=n.pop();if(l!==t.tagName){let n=aS(e,t.tagStartPos);return rS("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+l+"'.",aS(e,o))}0==n.length&&(r=!0)}}else{const a=nS(u,t);if(!0!==a)return rS(a.err.code,a.err.msg,aS(e,s-u.length+a.err.line));if(!0===r)return rS("InvalidXml","Multiple possible root nodes found.",aS(e,s));-1!==t.unpairedTags.indexOf(l)||n.push({tagName:l,tagStartPos:o}),i=!0}for(s++;s<e.length;s++)if("<"===e[s]){if("!"===e[s+1]){s++,s=$N(e,s);continue}if("?"!==e[s+1])break;if(s=XN(e,++s),s.err)return s}else if("&"===e[s]){const t=iS(e,s);if(-1==t)return rS("InvalidChar","char '&' is not expected.",aS(e,s));s=t}else if(!0===r&&!QN(e[s]))return rS("InvalidXml","Extra text at the end",aS(e,s));"<"===e[s]&&s--}}}return i?1==n.length?rS("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",aS(e,n[0].tagStartPos)):!(n.length>0)||rS("InvalidXml","Invalid '"+JSON.stringify(n.map(e=>e.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):rS("InvalidXml","Start tag expected.",1)}(e,t);if(!0!==n)throw Error("".concat(n.err.msg,":").concat(n.err.line,":").concat(n.err.col))}const n=new NN(this.options);n.addExternalEntities(this.externalEntities);const i=n.parseXml(e);return this.options.preserveOrder||void 0===i?i:qN(i,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return fN.getMetaDataSymbol()}}const uS="@firebase/database",hS="0.14.4";let dS="";class fS{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),B(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:V(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class pS{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return H(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const mS=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new fS(t)}}catch(t){}return new pS},gS=mS("localStorage"),yS=mS("sessionStorage"),vS=new me("@firebase/database"),bS=function(){let e=1;return function(){return e++}}(),xS=function(e){const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,f(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t}(e),n=new Z;n.update(t);const i=n.digest();return g.encodeByteArray(i)},_S=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=_S.apply(null,n):e+="object"===typeof n?B(n):n,e+=" "}return e};let wS=null,CS=!0;const kS=function(e,t){f(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(vS.logLevel=ue.VERBOSE,wS=vS.log.bind(vS),t&&yS.set("logging_enabled",!0)):"function"===typeof e?wS=e:(wS=null,yS.remove("logging_enabled"))},ES=function(){if(!0===CS&&(CS=!1,null===wS&&!0===yS.get("logging_enabled")&&kS(!0)),wS){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=_S.apply(null,t);wS(i)}},TS=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];ES(e,...n)}},NS=function(){const e="FIREBASE INTERNAL ERROR: "+_S(...arguments);vS.error(e)},SS=function(){const e="FIREBASE FATAL ERROR: ".concat(_S(...arguments));throw vS.error(e),new Error(e)},IS=function(){const e="FIREBASE WARNING: "+_S(...arguments);vS.warn(e)},PS=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},AS="[MIN_NAME]",DS="[MAX_NAME]",RS=function(e,t){if(e===t)return 0;if(e===AS||t===DS)return-1;if(t===AS||e===DS)return 1;{const n=VS(e),i=VS(t);return null!==n?null!==i?n-i===0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},jS=function(e,t){return e===t?0:e<t?-1:1},MS=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+B(t))},OS=function(e){if("object"!==typeof e||null===e)return B(e);const t=[];for(const i in e)t.push(i);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=B(t[i]),n+=":",n+=OS(e[t[i]]);return n+="}",n},LS=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function FS(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const zS=function(e){f(!PS(e),"Invalid JSON number");const t=1023;let n,i,r,s,o;0===e?(i=0,r=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=s+t,r=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,r=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const US=new RegExp("^-?(0*)\\d{1,10}$"),VS=function(e){if(US.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},BS=function(e){try{e()}catch(t){setTimeout(()=>{const e=t.stack||"";throw IS("Exception was thrown by user callback.",e),t},Math.floor(0))}},qS=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class HS{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then(e=>this.appCheck=e)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){IS('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class WS{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(ES("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',IS(e)}}class GS{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}GS.OWNER="owner";const KS="5",YS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,QS="ac",XS="websocket",$S="long_polling";class JS{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=gS.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&gS.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function ZS(e,t,n){let i;if(f("string"===typeof t,"typeof type must == string"),f("object"===typeof n,"typeof params must == object"),t===XS)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==$S)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return FS(n,(e,t)=>{r.push(e+"="+t)}),i+r.join("&")}class eI{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;H(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return _(this.counters_)}}const tI={},nI={};function iI(e){const t=e.toString();return tI[t]||(tI[t]=new eI),tI[t]}class rI{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&BS(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const sI="start";class oI{constructor(e,t,n,i,r,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=TS(e),this.stats_=iI(t),this.urlFn=e=>(this.appCheckToken&&(e[QS]=this.appCheckToken),ZS(t,$S,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new rI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(O()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new aI(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===sI)n.id=s,n.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,()=>{n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const[r,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,s)},()=>{this.onClosed_()},this.urlFn);const e={};e[sI]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=KS,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[QS]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&YS.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oI.forceAllow_=!0}static forceDisallow(){oI.forceDisallow_=!0}static isAvailable(){return!O()&&(!!oI.forceAllow_||!oI.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=B(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=v(t),i=LS(n,1840);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(O())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=B(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class aI{constructor(e,t,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,O())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=bS(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=aI.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){ES("frame writing exception"),r.stack&&ES(r.stack),ES(r)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||ES("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),n()})}addTag(e,t){O()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{ES("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}},Math.floor(1))}}let lI=null;"undefined"!==typeof MozWebSocket?lI=MozWebSocket:"undefined"!==typeof WebSocket&&(lI=WebSocket);class cI{constructor(e,t,n,i,r,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=TS(this.connId),this.stats_=iI(t),this.connURL=cI.connectionURL_(t,s,o,i,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i,r){const s={};return s.v=KS,!O()&&"undefined"!==typeof location&&location.hostname&&YS.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),i&&(s[QS]=i),r&&(s.p=r),ZS(e,XS,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,gS.set("previous_websocket_failure",!0);try{let e;if(O()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(KS,"/").concat(dS,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/portal",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},i=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;i&&(e.proxy={origin:i})}this.mySock=new lI(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){cI.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==lI&&!cI.forceDisallow_}static previouslyFailed(){return gS.isInMemoryStorage||!0===gS.get("previous_websocket_failure")}markConnectionHealthy(){gS.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=V(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(f(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=B(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=LS(t,16384);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}cI.responsesRequiredToBeHealthy=2,cI.healthyTimeout=3e4;class uI{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[oI,cI]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=cI&&cI.isAvailable();let n=t&&!cI.previouslyFailed();if(e.webSocketOnly&&(t||IS("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[cI];else{const e=this.transports_=[];for(const t of uI.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);uI.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}uI.globalTransportInitialized_=!1;class hI{constructor(e,t,n,i,r,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=TS("c:"+this.id+":"),this.transportManager_=new uI(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=qS(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=MS("t",e),n=MS("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=MS("t",e),n=MS("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=MS("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?NS("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):NS("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),KS!==n&&IS("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),qS(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qS(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(gS.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class dI{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class fI{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===t&&(!n||n===i[r].context))return void i.splice(r,1)}validateEventType_(e){f(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class pI extends fI{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||R()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new pI}getInitialEvent(e){return f("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class mI{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function gI(){return new mI("")}function yI(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function vI(e){return e.pieces_.length-e.pieceNum_}function bI(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new mI(e.pieces_,t)}function xI(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function _I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function wI(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new mI(t,0)}function CI(e,t){const n=[];for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);if(t instanceof mI)for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new mI(n,0)}function kI(e){return e.pieceNum_>=e.pieces_.length}function EI(e,t){const n=yI(e),i=yI(t);if(null===n)return t;if(n===i)return EI(bI(e),bI(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function TI(e,t){const n=_I(e,0),i=_I(t,0);for(let r=0;r<n.length&&r<i.length;r++){const e=RS(n[r],i[r]);if(0!==e)return e}return n.length===i.length?0:n.length<i.length?-1:1}function NI(e,t){if(vI(e)!==vI(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function SI(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(vI(e)>vI(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class II{constructor(e,t){this.errorPrefix_=t,this.parts_=_I(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=ie(this.parts_[n]);PI(this)}}function PI(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+AI(e))}function AI(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class DI extends fI{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}static getInstance(){return new DI}getInitialEvent(e){return f("visible"===e,"Unknown event type: "+e),[this.visible_]}}const RI=1e3;class jI extends dI{constructor(e,t,n,i,r,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=jI.nextPersistentConnectionId_++,this.log_=TS("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RI,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!O())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");DI.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&pI.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(B(r)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const t=new P,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,i){this.initConnection_();const r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),f(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:t,query:e,tag:n};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,r=>{const s=r.d,o=r.s;jI.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&H(e,"w")){const n=W(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();IS("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=q(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=q(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),f(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,e=>{i&&setTimeout(()=>{i(e.s,e.d)},Math.floor(0))})}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const s={p:t,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+B(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):NS("Unrecognized action received from server: "+B(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RI,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=RI,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=RI),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+jI.nextConnectionId_++,r=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){f(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?ES("getToken() completed but was canceled"):(ES("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new hI(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{IS(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},r))}catch(NS){this.log_("Failed to get token: "+NS),s||(this.repoInfo_.nodeAdmin&&IS(NS),a())}}}interrupt(e){ES("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ES("Resuming connection for reason: "+e),delete this.interruptReasons_[e],G(this.interruptReasons_)&&(this.reconnectDelay_=RI,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>OS(e)).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new mI(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){ES("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){ES("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";O()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+dS.replace(/\./g,"-")]=1,R()?e["framework.cordova"]=1:M()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pI.getInstance().currentlyOnline();return G(this.interruptReasons_)&&e}}jI.nextPersistentConnectionId_=0,jI.nextConnectionId_=0;class MI{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new MI(e,t)}}class OI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new MI(AS,e),i=new MI(AS,t);return 0!==this.compare(n,i)}minPost(){return MI.MIN}}let LI;class FI extends OI{static get __EMPTY_NODE(){return LI}static set __EMPTY_NODE(e){LI=e}compare(e,t){return RS(e.name,t.name)}isDefinedOn(e){throw p("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return MI.MIN}maxPost(){return new MI(DS,LI)}makePost(e,t){return f("string"===typeof e,"KeyIndex indexValue must always be a string."),new MI(e,LI)}toString(){return".key"}}const zI=new FI;class UI{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class VI{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:VI.RED,this.left=null!=i?i:BI.EMPTY_NODE,this.right=null!=r?r:BI.EMPTY_NODE}copy(e,t,n,i,r){return new VI(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return BI.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return BI.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,VI.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,VI.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}VI.RED=!0,VI.BLACK=!1;class BI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:BI.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new BI(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,VI.BLACK,null,null))}remove(e){return new BI(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,VI.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new UI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new UI(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new UI(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new UI(this.root_,null,this.comparator_,!0,e)}}function qI(e,t){return RS(e.name,t.name)}function HI(e,t){return RS(e,t)}let WI;BI.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new VI(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const GI=function(e){return"number"===typeof e?"number:"+zS(e):"string:"+e},KI=function(e){if(e.isLeafNode()){const t=e.val();f("string"===typeof t||"number"===typeof t||"object"===typeof t&&H(t,".sv"),"Priority must be a string or number.")}else f(e===WI||e.isEmpty(),"priority of unexpected type.");f(e===WI||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let YI,QI,XI;class $I{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$I.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,f(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),KI(this.priorityNode_)}static set __childrenNodeConstructor(e){YI=e}static get __childrenNodeConstructor(){return YI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new $I(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:$I.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return kI(e)?this:".priority"===yI(e)?this.priorityNode_:$I.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:$I.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=yI(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(f(".priority"!==n||1===vI(e),".priority must be the last token in a path"),this.updateImmediateChild(n,$I.__childrenNodeConstructor.EMPTY_NODE.updateChild(bI(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+GI(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?zS(this.value_):this.value_,this.lazyHash_=xS(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===$I.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof $I.__childrenNodeConstructor?-1:(f(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,i=$I.VALUE_TYPE_ORDER.indexOf(t),r=$I.VALUE_TYPE_ORDER.indexOf(n);return f(i>=0,"Unknown leaf type: "+t),f(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}$I.VALUE_TYPE_ORDER=["object","boolean","number","string"];const JI=new class extends OI{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?RS(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return MI.MIN}maxPost(){return new MI(DS,new $I("[PRIORITY-POST]",XI))}makePost(e,t){const n=QI(e);return new MI(t,new $I("[PRIORITY-POST]",n))}toString(){return".priority"}},ZI=Math.log(2);class eP{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/ZI,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tP=function(e,t,n,i){e.sort(t);const r=function(t,i){const s=i-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new VI(a,o.node,VI.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=r(t,l),u=r(l+1,i);return o=e[l],a=n?n(o):o,new VI(a,o.node,VI.BLACK,c,u)}},s=function(t){let i=null,s=null,o=e.length;const a=function(t,i){const s=o-t,a=o;o-=t;const c=r(s+1,a),u=e[s],h=n?n(u):u;l(new VI(h,u.node,i,null,c))},l=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,VI.BLACK):(a(i,VI.BLACK),a(i,VI.RED))}return s}(new eP(e.length));return new BI(i||t,s)};let nP;const iP={};class rP{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return f(iP&&JI,"ChildrenNode.ts has not been loaded"),nP=nP||new rP({".priority":iP},{".priority":JI}),nP}get(e){const t=W(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof BI?t:null}hasIndex(e){return H(this.indexSet_,e.toString())}addIndex(e,t){f(e!==zI,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=t.getIterator(MI.Wrap);let s,o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),n.push(o),o=r.getNext();s=i?tP(n,e.getCompare()):iP;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=s,new rP(c,l)}addToIndexes(e,t){const n=K(this.indexes_,(n,i)=>{const r=W(this.indexSet_,i);if(f(r,"Missing index implementation for "+i),n===iP){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(MI.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),tP(n,r.getCompare())}return iP}{const i=t.get(e.name);let r=n;return i&&(r=r.remove(new MI(e.name,i))),r.insert(e,e.node)}});return new rP(n,this.indexSet_)}removeFromIndexes(e,t){const n=K(this.indexes_,n=>{if(n===iP)return n;{const i=t.get(e.name);return i?n.remove(new MI(e.name,i)):n}});return new rP(n,this.indexSet_)}}let sP;class oP{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&KI(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return sP||(sP=new oP(new BI(HI),null,rP.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||sP}updatePriority(e){return this.children_.isEmpty()?this:new oP(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?sP:t}}getChild(e){const t=yI(e);return null===t?this:this.getImmediateChild(t).getChild(bI(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(f(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new MI(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?sP:this.priorityNode_;return new oP(i,s,r)}}updateChild(e,t){const n=yI(e);if(null===n)return t;{f(".priority"!==yI(e)||1===vI(e),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(bI(e),t);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(JI,(s,o)=>{t[s]=o.val(e),n++,r&&oP.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1}),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+GI(this.getPriority().val())+":"),this.forEachChild(JI,(t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)}),this.lazyHash_=""===e?"":xS(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new MI(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new MI(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new MI(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,MI.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,MI.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===aP?-1:0}withIndex(e){if(e===zI||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new oP(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===zI||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(JI),n=t.getIterator(JI);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===zI?null:this.indexMap_.get(e.toString())}}oP.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const aP=new class extends oP{constructor(){super(new BI(HI),oP.EMPTY_NODE,rP.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return oP.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(MI,{MIN:{value:new MI(AS,oP.EMPTY_NODE)},MAX:{value:new MI(DS,aP)}}),FI.__EMPTY_NODE=oP.EMPTY_NODE,$I.__childrenNodeConstructor=oP,WI=aP,function(e){XI=e}(aP);function lP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return oP.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),f(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new $I(e,lP(t))}if(e instanceof Array){let n=oP.EMPTY_NODE;return FS(e,(t,i)=>{if(H(e,t)&&"."!==t.substring(0,1)){const e=lP(i);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(lP(t))}{const n=[];let i=!1;if(FS(e,(e,t)=>{if("."!==e.substring(0,1)){const r=lP(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new MI(e,r)))}}),0===n.length)return oP.EMPTY_NODE;const r=tP(n,qI,e=>e.name,HI);if(i){const e=tP(n,JI.getCompare());return new oP(r,lP(t),new rP({".priority":e},{".priority":JI}))}return new oP(r,lP(t),rP.Default)}}!function(e){QI=e}(lP);class cP extends OI{constructor(e){super(),this.indexPath_=e,f(!kI(e)&&".priority"!==yI(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?RS(e.name,t.name):r}makePost(e,t){const n=lP(e),i=oP.EMPTY_NODE.updateChild(this.indexPath_,n);return new MI(t,i)}maxPost(){const e=oP.EMPTY_NODE.updateChild(this.indexPath_,aP);return new MI(DS,e)}toString(){return _I(this.indexPath_,0).join("/")}}const uP=new class extends OI{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?RS(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return MI.MIN}maxPost(){return MI.MAX}makePost(e,t){const n=lP(e);return new MI(t,n)}toString(){return".value"}};function hP(e){return{type:"value",snapshotNode:e}}function dP(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function fP(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function pP(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class mP{constructor(e){this.index_=e}updateChild(e,t,n,i,r,s){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(fP(t,o)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(dP(t,n)):s.trackChildChange(pP(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(JI,(e,i)=>{t.hasChild(e)||n.trackChildChange(fP(e,i))}),t.isLeafNode()||t.forEachChild(JI,(t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||n.trackChildChange(pP(t,i,r))}else n.trackChildChange(dP(t,i))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?oP.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class gP{constructor(e){this.indexedFilter_=new mP(e.getIndex()),this.index_=e.getIndex(),this.startPost_=gP.getStartPost_(e),this.endPost_=gP.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,i,r,s){return this.matches(new MI(t,n))||(n=oP.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,r,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=oP.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(oP.EMPTY_NODE);const r=this;return t.forEachChild(JI,(e,t)=>{r.matches(new MI(e,t))||(i=i.updateImmediateChild(e,oP.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class yP{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new gP(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,i,r,s){return this.rangedFilter_.matches(new MI(t,n))||(n=oP.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,r,s):this.fullLimitUpdateChild_(e,t,n,r,s)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=oP.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=oP.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),n++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(oP.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:i=i.updateImmediateChild(t.name,oP.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,i,r){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;f(o.numChildren()===this.limit_,"");const a=new MI(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let u=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||o.hasChild(u.name));)u=i.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:s(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=r&&r.trackChildChange(pP(t,n,e)),o.updateImmediateChild(t,n);{null!=r&&r.trackChildChange(fP(t,e));const n=o.updateImmediateChild(t,oP.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=r&&r.trackChildChange(dP(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&s(l,a)>=0?(null!=r&&(r.trackChildChange(fP(l.name,l.node)),r.trackChildChange(dP(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,oP.EMPTY_NODE)):e}}class vP{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=JI}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:AS}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:DS}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===JI}copy(){const e=new vP;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function bP(e){const t={};if(e.isDefault())return t;let n;if(e.index_===JI?n="$priority":e.index_===uP?n="$value":e.index_===zI?n="$key":(f(e.index_ instanceof cP,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=B(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=B(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+B(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=B(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+B(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function xP(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==JI&&(t.i=e.index_.toString()),t}class _P extends dI{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=TS("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=_P.getListenId_(e,n),o={};this.listens_[s]=o;const a=bP(e._queryParams);this.restRequest_(r+".json",a,(e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,n),W(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}})}unlisten(e,t){const n=_P.getListenId_(e,t);delete this.listens_[n]}get(e){const t=bP(e._queryParams),n=e._path.toString(),i=new P;return this.restRequest_(n+".json",t,(e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))}),i.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(i=>{let[r,s]=i;r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+X(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let t=null;if(a.status>=200&&a.status<300){try{t=V(a.responseText)}catch(e){IS("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,t)}else 401!==a.status&&404!==a.status&&IS("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()})}}class wP{constructor(){this.rootNode_=oP.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function CP(){return{value:null,children:new Map}}function kP(e,t,n){if(kI(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=yI(t);e.children.has(i)||e.children.set(i,CP());kP(e.children.get(i),t=bI(t),n)}}function EP(e,t){if(kI(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(JI,(t,n)=>{kP(e,new mI(t),n)}),EP(e,t)}}if(e.children.size>0){const n=yI(t);if(t=bI(t),e.children.has(n)){EP(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function TP(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,i)=>{TP(i,new mI(t.toString()+"/"+e),n)})}class NP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&FS(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class SP{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new NP(e);const n=1e4+2e4*Math.random();qS(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;FS(e,(e,i)=>{i>0&&H(this.statsToReport_,e)&&(t[e]=i,n=!0)}),n&&this.server_.reportStats(t),qS(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var IP;function PP(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(IP||(IP={}));class AP{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=IP.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(kI(this.path)){if(null!=this.affectedTree.value)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new mI(e));return new AP(gI(),t,this.revert)}}return f(yI(this.path)===e,"operationForChild called for unrelated child."),new AP(bI(this.path),this.affectedTree,this.revert)}}class DP{constructor(e,t){this.source=e,this.path=t,this.type=IP.LISTEN_COMPLETE}operationForChild(e){return kI(this.path)?new DP(this.source,gI()):new DP(this.source,bI(this.path))}}class RP{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=IP.OVERWRITE}operationForChild(e){return kI(this.path)?new RP(this.source,gI(),this.snap.getImmediateChild(e)):new RP(this.source,bI(this.path),this.snap)}}class jP{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=IP.MERGE}operationForChild(e){if(kI(this.path)){const t=this.children.subtree(new mI(e));return t.isEmpty()?null:t.value?new RP(this.source,gI(),t.value):new jP(this.source,gI(),t)}return f(yI(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new jP(this.source,bI(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class MP{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(kI(e))return this.isFullyInitialized()&&!this.filtered_;const t=yI(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class OP{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function LP(e,t,n,i,r,s){const o=i.filter(e=>e.type===n);o.sort((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw p("Should only compare child_ events.");const i=new MI(t.childName,t.snapshotNode),r=new MI(n.childName,n.snapshotNode);return e.index_.compare(i,r)}(e,t,n)),o.forEach(n=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);r.forEach(r=>{r.respondsTo(n.type)&&t.push(r.createEvent(i,e.query_))})})}function FP(e,t){return{eventCache:e,serverCache:t}}function zP(e,t,n,i){return FP(new MP(t,n,i),e.serverCache)}function UP(e,t,n,i){return FP(e.eventCache,new MP(t,n,i))}function VP(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function BP(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let qP;class HP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(qP||(qP=new BI(jS)),qP);this.value=e,this.children=t}static fromObject(e){let t=new HP(null);return FS(e,(e,n)=>{t=t.set(new mI(e),n)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:gI(),value:this.value};if(kI(e))return null;{const n=yI(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(bI(e),t);if(null!=r){return{path:CI(new mI(n),r.path),value:r.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(kI(e))return this;{const t=yI(e),n=this.children.get(t);return null!==n?n.subtree(bI(e)):new HP(null)}}set(e,t){if(kI(e))return new HP(t,this.children);{const n=yI(e),i=(this.children.get(n)||new HP(null)).set(bI(e),t),r=this.children.insert(n,i);return new HP(this.value,r)}}remove(e){if(kI(e))return this.children.isEmpty()?new HP(null):new HP(null,this.children);{const t=yI(e),n=this.children.get(t);if(n){const i=n.remove(bI(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new HP(null):new HP(this.value,r)}return this}}get(e){if(kI(e))return this.value;{const t=yI(e),n=this.children.get(t);return n?n.get(bI(e)):null}}setTree(e,t){if(kI(e))return t;{const n=yI(e),i=(this.children.get(n)||new HP(null)).setTree(bI(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new HP(this.value,r)}}fold(e){return this.fold_(gI(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((i,r)=>{n[i]=r.fold_(CI(e,i),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,gI(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(kI(e))return null;{const i=yI(e),r=this.children.get(i);return r?r.findOnPath_(bI(e),CI(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,gI(),t)}foreachOnPath_(e,t,n){if(kI(e))return this;{this.value&&n(t,this.value);const i=yI(e),r=this.children.get(i);return r?r.foreachOnPath_(bI(e),CI(t,i),n):new HP(null)}}foreach(e){this.foreach_(gI(),e)}foreach_(e,t){this.children.inorderTraversal((n,i)=>{i.foreach_(CI(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class WP{constructor(e){this.writeTree_=e}static empty(){return new WP(new HP(null))}}function GP(e,t,n){if(kI(t))return new WP(new HP(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const o=EI(r,t);return s=s.updateChild(o,n),new WP(e.writeTree_.set(r,s))}{const i=new HP(n),r=e.writeTree_.setTree(t,i);return new WP(r)}}}function KP(e,t,n){let i=e;return FS(n,(e,n)=>{i=GP(i,CI(t,e),n)}),i}function YP(e,t){if(kI(t))return WP.empty();{const n=e.writeTree_.setTree(t,new HP(null));return new WP(n)}}function QP(e,t){return null!=XP(e,t)}function XP(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(EI(n.path,t)):null}function $P(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(JI,(e,n)=>{t.push(new MI(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new MI(e,n.value))}),t}function JP(e,t){if(kI(t))return e;{const n=XP(e,t);return new WP(null!=n?new HP(n):e.writeTree_.subtree(t))}}function ZP(e){return e.writeTree_.isEmpty()}function eA(e,t){return tA(gI(),e.writeTree_,t)}function tA(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal((t,r)=>{".priority"===t?(f(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=tA(CI(e,t),r,n)}),n.getChild(e).isEmpty()||null===i||(n=n.updateChild(CI(e,".priority"),i)),n}}function nA(e,t){return mA(t,e)}function iA(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);f(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&rA(t,i.path)?r=!1:SI(i.path,t.path)&&(s=!0)),o--}if(r){if(s)return function(e){e.visibleWrites=oA(e.allWrites,sA,gI()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=YP(e.visibleWrites,i.path);else{FS(i.children,t=>{e.visibleWrites=YP(e.visibleWrites,CI(i.path,t))})}return!0}return!1}function rA(e,t){if(e.snap)return SI(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&SI(CI(e.path,n),t))return!0;return!1}function sA(e){return e.visible}function oA(e,t,n){let i=WP.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const e=s.path;let t;if(s.snap)SI(n,e)?(t=EI(n,e),i=GP(i,t,s.snap)):SI(e,n)&&(t=EI(e,n),i=GP(i,gI(),s.snap.getChild(t)));else{if(!s.children)throw p("WriteRecord should have .snap or .children");if(SI(n,e))t=EI(n,e),i=KP(i,t,s.children);else if(SI(e,n))if(t=EI(e,n),kI(t))i=KP(i,gI(),s.children);else{const e=W(s.children,yI(t));if(e){const n=e.getChild(bI(t));i=GP(i,gI(),n)}}}}}return i}function aA(e,t,n,i,r){if(i||r){const s=JP(e.visibleWrites,t);if(!r&&ZP(s))return n;if(r||null!=n||QP(s,gI())){const s=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(SI(e.path,t)||SI(t,e.path))};return eA(oA(e.allWrites,s,t),n||oP.EMPTY_NODE)}return null}{const i=XP(e.visibleWrites,t);if(null!=i)return i;{const i=JP(e.visibleWrites,t);if(ZP(i))return n;if(null!=n||QP(i,gI())){return eA(i,n||oP.EMPTY_NODE)}return null}}}function lA(e,t,n,i){return aA(e.writeTree,e.treePath,t,n,i)}function cA(e,t){return function(e,t,n){let i=oP.EMPTY_NODE;const r=XP(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(JI,(e,t)=>{i=i.updateImmediateChild(e,t)}),i;if(n){const r=JP(e.visibleWrites,t);return n.forEachChild(JI,(e,t)=>{const n=eA(JP(r,new mI(e)),t);i=i.updateImmediateChild(e,n)}),$P(r).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}return $P(JP(e.visibleWrites,t)).forEach(e=>{i=i.updateImmediateChild(e.name,e.node)}),i}(e.writeTree,e.treePath,t)}function uA(e,t,n,i){return function(e,t,n,i,r){f(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=CI(t,n);if(QP(e.visibleWrites,s))return null;{const t=JP(e.visibleWrites,s);return ZP(t)?r.getChild(n):eA(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,i)}function hA(e,t){return function(e,t){return XP(e.visibleWrites,t)}(e.writeTree,CI(e.treePath,t))}function dA(e,t,n,i,r,s){return function(e,t,n,i,r,s,o){let a;const l=JP(e.visibleWrites,t),c=XP(l,gI());if(null!=c)a=c;else{if(null==n)return[];a=eA(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&e.length<r;)0!==t(l,i)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,s)}function fA(e,t,n){return function(e,t,n,i){const r=CI(t,n),s=XP(e.visibleWrites,r);if(null!=s)return s;if(i.isCompleteForChild(n))return eA(JP(e.visibleWrites,r),i.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function pA(e,t){return mA(CI(e.treePath,t),e.writeTree)}function mA(e,t){return{treePath:e,writeTree:t}}class gA{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;f("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),f(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===t&&"child_removed"===r)this.changeMap.set(n,pP(n,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===r)this.changeMap.set(n,fP(n,i.oldSnap));else if("child_changed"===t&&"child_added"===r)this.changeMap.set(n,dP(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==r)throw p("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(n,pP(n,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const yA=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class vA{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new MP(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fA(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:BP(this.viewCache_),r=dA(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function bA(e,t,n,i,r){const s=new gA;let o,a;if(n.type===IP.OVERWRITE){const l=n;l.source.fromUser?o=wA(e,t,l.path,l.snap,i,r,s):(f(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!kI(l.path),o=_A(e,t,l.path,l.snap,i,r,a,s))}else if(n.type===IP.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,i,r,s,o){let a=t;return i.foreach((i,l)=>{const c=CI(n,i);CA(t,yI(c))&&(a=wA(e,a,c,l,r,s,o))}),i.foreach((i,l)=>{const c=CI(n,i);CA(t,yI(c))||(a=wA(e,a,c,l,r,s,o))}),a}(e,t,l.path,l.children,i,r,s):(f(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=EA(e,t,l.path,l.children,i,r,a,s))}else if(n.type===IP.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,i,r,s){let o;if(null!=hA(i,n))return t;{const a=new vA(i,t,r),l=t.eventCache.getNode();let c;if(kI(n)||".priority"===yI(n)){let n;if(t.serverCache.isFullyInitialized())n=lA(i,BP(t));else{const e=t.serverCache.getNode();f(e instanceof oP,"serverChildren would be complete if leaf node"),n=cA(i,e)}c=e.filter.updateFullNode(l,n,s)}else{const r=yI(n);let u=fA(i,r,t.serverCache);null==u&&t.serverCache.isCompleteForChild(r)&&(u=l.getImmediateChild(r)),c=null!=u?e.filter.updateChild(l,r,u,bI(n),a,s):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(l,r,oP.EMPTY_NODE,bI(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=lA(i,BP(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=hA(i,gI()),zP(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,i,r,s):function(e,t,n,i,r,s,o){if(null!=hA(r,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(kI(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return _A(e,t,n,l.getNode().getChild(n),r,s,a,o);if(kI(n)){let i=new HP(null);return l.getNode().forEachChild(zI,(e,t)=>{i=i.set(new mI(e),t)}),EA(e,t,n,i,r,s,a,o)}return t}{let c=new HP(null);return i.foreach((e,t)=>{const i=CI(n,e);l.isCompleteForPath(i)&&(c=c.set(e,l.getNode().getChild(i)))}),EA(e,t,n,c,r,s,a,o)}}(e,t,a.path,a.affectedTree,i,r,s)}else{if(n.type!==IP.LISTEN_COMPLETE)throw p("Unknown operation type: "+n.type);o=function(e,t,n,i,r){const s=t.serverCache,o=UP(t,s.getNode(),s.isFullyInitialized()||kI(n),s.isFiltered());return xA(e,o,n,i,yA,r)}(e,t,n.path,i,s)}const l=s.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=VP(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(hP(VP(t)))}}(t,o,l),{viewCache:o,changes:l}}function xA(e,t,n,i,r,s){const o=t.eventCache;if(null!=hA(i,n))return t;{let a,l;if(kI(n))if(f(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=BP(t),r=cA(i,n instanceof oP?n:oP.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{const n=lA(i,BP(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=yI(n);if(".priority"===c){f(1===vI(n),"Can't have a priority with additional path components");const r=o.getNode();l=t.serverCache.getNode();const s=uA(i,n,r,l);a=null!=s?e.filter.updatePriority(r,s):o.getNode()}else{const u=bI(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=uA(i,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else h=fA(i,c,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),c,h,u,r,s):o.getNode()}}return zP(t,a,o.isFullyInitialized()||kI(n),e.filter.filtersNodes())}}function _A(e,t,n,i,r,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(kI(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),e,null)}else{const e=yI(n);if(!l.isCompleteForPath(n)&&vI(n)>1)return t;const r=bI(n),s=l.getNode().getImmediateChild(e).updateChild(r,i);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,r,yA,null)}const h=UP(t,c,l.isFullyInitialized()||kI(n),u.filtersNodes());return xA(e,h,n,r,new vA(r,h,s),a)}function wA(e,t,n,i,r,s,o){const a=t.eventCache;let l,c;const u=new vA(r,t,s);if(kI(n))c=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=zP(t,c,!0,e.filter.filtersNodes());else{const r=yI(n);if(".priority"===r)c=e.filter.updatePriority(t.eventCache.getNode(),i),l=zP(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=bI(n),c=a.getNode().getImmediateChild(r);let h;if(kI(s))h=i;else{const e=u.getCompleteChild(r);h=null!=e?".priority"===xI(s)&&e.getChild(wI(s)).isEmpty()?e:e.updateChild(s,i):oP.EMPTY_NODE}if(c.equals(h))l=t;else{l=zP(t,e.filter.updateChild(a.getNode(),r,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function CA(e,t){return e.eventCache.isCompleteForChild(t)}function kA(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function EA(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=kI(n)?i:new HP(null).setTree(n,i);const u=t.serverCache.getNode();return l.children.inorderTraversal((n,i)=>{if(u.hasChild(n)){const l=kA(0,t.serverCache.getNode().getImmediateChild(n),i);c=_A(e,c,new mI(n),l,r,s,o,a)}}),l.children.inorderTraversal((n,i)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===i.value;if(!u.hasChild(n)&&!l){const l=kA(0,t.serverCache.getNode().getImmediateChild(n),i);c=_A(e,c,new mI(n),l,r,s,o,a)}}),c}class TA{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new mP(n.getIndex()),r=(s=n).loadsAllData()?new mP(s.getIndex()):s.hasLimit()?new yP(s):new gP(s);var s;this.processor_=function(e){return{filter:e}}(r);const o=t.serverCache,a=t.eventCache,l=i.updateFullNode(oP.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(oP.EMPTY_NODE,a.getNode(),null),u=new MP(l,o.isFullyInitialized(),i.filtersNodes()),h=new MP(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=FP(h,u),this.eventGenerator_=new OP(this.query_)}get query(){return this.query_}}function NA(e,t){const n=BP(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!kI(t)&&!n.getImmediateChild(yI(t)).isEmpty())?n.getChild(t):null}function SA(e){return 0===e.eventRegistrations_.length}function IA(e,t,n){const i=[];if(n){f(null==t,"A cancel should cancel all event registrations.");const r=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,r);t&&i.push(t)})}if(t){let n=[];for(let i=0;i<e.eventRegistrations_.length;++i){const r=e.eventRegistrations_[i];if(r.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(i+1));break}}else n.push(r)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function PA(e,t,n,i){t.type===IP.MERGE&&null!==t.source.queryId&&(f(BP(e.viewCache_),"We should always have a full cache before handling merges"),f(VP(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=bA(e.processor_,r,t,n,i);var o,a;return o=e.processor_,a=s.viewCache,f(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),f(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),f(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,AA(e,s.changes,s.viewCache.eventCache.getNode(),null)}function AA(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],s=[];return t.forEach(t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}),LP(e,r,"child_removed",t,i,n),LP(e,r,"child_added",t,i,n),LP(e,r,"child_moved",s,i,n),LP(e,r,"child_changed",t,i,n),LP(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}let DA,RA;class jA{constructor(){this.views=new Map}}function MA(e,t,n,i){const r=t.source.queryId;if(null!==r){const s=e.views.get(r);return f(null!=s,"SyncTree gave us an op for an invalid query."),PA(s,t,n,i)}{let r=[];for(const s of e.views.values())r=r.concat(PA(s,t,n,i));return r}}function OA(e,t,n,i,r){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=lA(n,r?i:null),s=!1;e?s=!0:i instanceof oP?(e=cA(n,i),s=!1):(e=oP.EMPTY_NODE,s=!1);const o=FP(new MP(e,s,!1),new MP(i,r,!1));return new TA(t,o)}return o}function LA(e,t,n,i,r,s){const o=OA(e,t,i,r,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,i=[];n.getNode().isLeafNode()||n.getNode().forEachChild(JI,(e,t)=>{i.push(dP(e,t))});return n.isFullyInitialized()&&i.push(hP(n.getNode())),AA(e,i,n.getNode(),t)}(o,n)}function FA(e,t,n,i){const r=t._queryIdentifier,s=[];let o=[];const a=qA(e);if("default"===r)for(const[l,c]of e.views.entries())o=o.concat(IA(c,n,i)),SA(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const t=e.views.get(r);t&&(o=o.concat(IA(t,n,i)),SA(t)&&(e.views.delete(r),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!qA(e)&&s.push(new(f(DA,"Reference.ts has not been loaded"),DA)(t._repo,t._path)),{removed:s,events:o}}function zA(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function UA(e,t){let n=null;for(const i of e.views.values())n=n||NA(i,t);return n}function VA(e,t){if(t._queryParams.loadsAllData())return HA(e);{const n=t._queryIdentifier;return e.views.get(n)}}function BA(e,t){return null!=VA(e,t)}function qA(e){return null!=HA(e)}function HA(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let WA=1;class GA{constructor(e){this.listenProvider_=e,this.syncPointTree_=new HP(null),this.pendingWriteTree_={visibleWrites:WP.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function KA(e,t,n,i,r){return function(e,t,n,i,r){f(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=GP(e.visibleWrites,t,n)),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i,r),r?eD(e,new RP({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function YA(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(iA(e.pendingWriteTree_,t)){let t=new HP(null);return null!=i.snap?t=t.set(gI(),!0):FS(i.children,e=>{t=t.set(new mI(e),!0)}),eD(e,new AP(i.path,t,n))}return[]}function QA(e,t,n){return eD(e,new RP({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function XA(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||BA(o,t))){const l=FA(o,t,n,i);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!r){const n=-1!==c.findIndex(e=>e._queryParams.loadsAllData()),r=e.syncPointTree_.findOnPath(s,(e,t)=>qA(t));if(n&&!r){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold((e,t,n)=>{if(t&&qA(t)){return[HA(t)]}{let e=[];return t&&(e=zA(t)),FS(n,(t,n)=>{e=e.concat(n)}),e}})}(t);for(let t=0;t<n.length;++t){const i=n[t],r=i.query,s=iD(e,i);e.listenProvider_.startListening(cD(r),rD(e,r),s.hashFn,s.onComplete)}}}if(!r&&c.length>0&&!i)if(n){const n=null;e.listenProvider_.stopListening(cD(t),n)}else c.forEach(t=>{const n=e.queryToTagMap.get(sD(t));e.listenProvider_.stopListening(cD(t),n)})}!function(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=sD(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function $A(e,t,n,i){const r=oD(e,i);if(null!=r){const i=aD(r),s=i.path,o=i.queryId,a=EI(s,t);return lD(e,s,new RP(PP(o),a,n))}return[]}function JA(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(r,(e,t)=>{const n=EI(e,r);s=s||UA(t,n),o=o||qA(t)});let a,l=e.syncPointTree_.get(r);if(l?(o=o||qA(l),s=s||UA(l,gI())):(l=new jA,e.syncPointTree_=e.syncPointTree_.set(r,l)),null!=s)a=!0;else{a=!1,s=oP.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild((e,t)=>{const n=UA(t,gI());n&&(s=s.updateImmediateChild(e,n))})}const c=BA(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=sD(t);f(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const i=WA++;e.queryToTagMap.set(n,i),e.tagToQueryMap.set(i,n)}let u=LA(l,t,n,nA(e.pendingWriteTree_,r),s,a);if(!c&&!o&&!i){const n=VA(l,t);u=u.concat(function(e,t,n){const i=t._path,r=rD(e,t),s=iD(e,n),o=e.listenProvider_.startListening(cD(t),r,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(i);if(r)f(!qA(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold((e,t,n)=>{if(!kI(e)&&t&&qA(t))return[HA(t).query];{let e=[];return t&&(e=e.concat(zA(t).map(e=>e.query))),FS(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const i=t[n];e.listenProvider_.stopListening(cD(i),rD(e,i))}}return o}(e,t,n))}return u}function ZA(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,(e,n)=>{const i=UA(n,EI(e,t));if(i)return i});return aA(i,t,r,n,!0)}function eD(e,t){return tD(t,e.syncPointTree_,null,nA(e.pendingWriteTree_,gI()))}function tD(e,t,n,i){if(kI(e.path))return nD(e,t,n,i);{const r=t.get(gI());null==n&&null!=r&&(n=UA(r,gI()));let s=[];const o=yI(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=pA(i,o);s=s.concat(tD(a,l,e,t))}return r&&(s=s.concat(MA(r,e,i,n))),s}}function nD(e,t,n,i){const r=t.get(gI());null==n&&null!=r&&(n=UA(r,gI()));let s=[];return t.children.inorderTraversal((t,r)=>{const o=n?n.getImmediateChild(t):null,a=pA(i,t),l=e.operationForChild(t);l&&(s=s.concat(nD(l,r,o,a)))}),r&&(s=s.concat(MA(r,e,i,n))),s}function iD(e,t){const n=t.query,i=rD(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||oP.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,n){const i=oD(e,n);if(i){const n=aD(i),r=n.path,s=n.queryId,o=EI(r,t);return lD(e,r,new DP(PP(s),o))}return[]}(e,n._path,i):function(e,t){return eD(e,new DP({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const i=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}(t,n);return XA(e,n,null,i)}}}}function rD(e,t){const n=sD(t);return e.queryToTagMap.get(n)}function sD(e){return e._path.toString()+"$"+e._queryIdentifier}function oD(e,t){return e.tagToQueryMap.get(t)}function aD(e){const t=e.indexOf("$");return f(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new mI(e.substr(0,t))}}function lD(e,t,n){const i=e.syncPointTree_.get(t);f(i,"Missing sync point for query tag that we're tracking");return MA(i,n,nA(e.pendingWriteTree_,t),null)}function cD(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(f(RA,"Reference.ts has not been loaded"),RA)(e._repo,e._path):e}class uD{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new uD(t)}node(){return this.node_}}class hD{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=CI(this.path_,e);return new hD(this.syncTree_,t)}node(){return ZA(this.syncTree_,this.path_)}}const dD=function(e,t,n){return e&&"object"===typeof e?(f(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?fD(e[".sv"],t,n):"object"===typeof e[".sv"]?pD(e[".sv"],t):void f(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},fD=function(e,t,n){if("timestamp"===e)return n.timestamp;f(!1,"Unexpected server value: "+e)},pD=function(e,t,n){e.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!==typeof i&&f(!1,"Unexpected increment value: "+i);const r=t.node();if(f(null!==r&&"undefined"!==typeof r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!==typeof s?i:s+i},mD=function(e,t,n,i){return yD(t,new hD(n,e),i)},gD=function(e,t,n){return yD(e,new uD(t),n)};function yD(e,t,n){const i=e.getPriority().val(),r=dD(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const i=e,s=dD(i.getValue(),t,n);return s!==i.getValue()||r!==i.getPriority().val()?new $I(s,lP(r)):e}{const i=e;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new $I(r))),i.forEachChild(JI,(e,i)=>{const r=yD(i,t.getImmediateChild(e),n);r!==i&&(s=s.updateImmediateChild(e,r))}),s}}class vD{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function bD(e,t){let n=t instanceof mI?t:new mI(t),i=e,r=yI(n);for(;null!==r;){const e=W(i.node.children,r)||{children:{},childCount:0};i=new vD(r,i,e),n=bI(n),r=yI(n)}return i}function xD(e){return e.node.value}function _D(e,t){e.node.value=t,TD(e)}function wD(e){return e.node.childCount>0}function CD(e,t){FS(e.node.children,(n,i)=>{t(new vD(n,e,i))})}function kD(e,t,n,i){n&&!i&&t(e),CD(e,e=>{kD(e,t,!0,i)}),n&&i&&t(e)}function ED(e){return new mI(null===e.parent?e.name:ED(e.parent)+"/"+e.name)}function TD(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===xD(e)&&!wD(e)}(n),r=H(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,TD(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,TD(e))}(e.parent,e.name,e)}const ND=/[\[\].#$\/\u0000-\u001F\u007F]/,SD=/[\[\].#$\u0000-\u001F\u007F]/,ID=10485760,PD=function(e){return"string"===typeof e&&0!==e.length&&!ND.test(e)},AD=function(e){return"string"===typeof e&&0!==e.length&&!SD.test(e)},DD=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!PS(e)||e&&"object"===typeof e&&H(e,".sv")},RD=function(e,t,n,i){i&&void 0===t||jD(ne(e,"value"),t,n)},jD=function(e,t,n){const i=n instanceof mI?new II(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+AI(i));if("function"===typeof t)throw new Error(e+"contains a function "+AI(i)+" with contents = "+t.toString());if(PS(t))throw new Error(e+"contains "+t.toString()+" "+AI(i));if("string"===typeof t&&t.length>ID/3&&ie(t)>ID)throw new Error(e+"contains a string greater than "+ID+" utf8 bytes "+AI(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,r=!1;if(FS(t,(t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!PD(t)))throw new Error(e+" contains an invalid key ("+t+") "+AI(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=ie(t),PI(e)}(i,t),jD(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=ie(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)}),n&&r)throw new Error(e+' contains ".value" child '+AI(i)+" in addition to actual children.")}},MD=function(e,t,n,i){if(i&&void 0===t)return;const r=ne(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const s=[];FS(t,(e,t)=>{const i=new mI(e);if(jD(r,t,CI(n,i)),".priority"===xI(i)&&!DD(t))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(i)}),function(e,t){let n,i;for(n=0;n<t.length;n++){i=t[n];const r=_I(i);for(let t=0;t<r.length;t++)if(".priority"===r[t]&&t===r.length-1);else if(!PD(r[t]))throw new Error(e+"contains an invalid key ("+r[t]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(TI);let r=null;for(n=0;n<t.length;n++){if(i=t[n],null!==r&&SI(r,i))throw new Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}}(r,s)},OD=function(e,t,n){if(!n||void 0!==t){if(PS(t))throw new Error(ne(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!DD(t))throw new Error(ne(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},LD=function(e,t,n,i){if((!i||void 0!==n)&&!AD(n))throw new Error(ne(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},FD=function(e,t){if(".info"===yI(t))throw new Error(e+" failed = Can't modify data under /.info/")},zD=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!PD(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),AD(e)}(n))throw new Error(ne(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class UD{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function VD(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null===n||NI(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)}function BD(e,t,n){VD(e,n),HD(e,e=>NI(e,t))}function qD(e,t,n){VD(e,n),HD(e,e=>SI(e,t)||SI(t,e))}function HD(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];if(r){t(r.path)?(WD(e.eventLists_[i]),e.eventLists_[i]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function WD(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();wS&&ES("event: "+n.toString()),BS(i)}}}const GD="repo_interrupt";class KD{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new UD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=CP(),this.transactionQueueTree_=new vD,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function YD(e,t,n){if(e.stats_=iI(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new _P(e.repoInfo_,(t,n,i,r)=>{$D(e,t,n,i,r)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>JD(e,!0),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{B(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}e.persistentConnection_=new jI(e.repoInfo_,t,(t,n,i,r)=>{$D(e,t,n,i,r)},t=>{JD(e,t)},t=>{!function(e,t){FS(t,(t,n)=>{ZD(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){const n=e.toString();return nI[n]||(nI[n]=t()),nI[n]}(e.repoInfo_,()=>new SP(e.stats_,e.server_)),e.infoData_=new wP,e.infoSyncTree_=new GA({startListening:(t,n,i,r)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=QA(e.infoSyncTree_,t._path,o),setTimeout(()=>{r("ok")},0)),s},stopListening:()=>{}}),ZD(e,"connected",!1),e.serverSyncTree_=new GA({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,(n,i)=>{const s=r(n,i);qD(e.eventQueue_,t._path,s)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function QD(e){const t=e.infoData_.getNode(new mI(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function XD(e){return(t=(t={timestamp:QD(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function $D(e,t,n,i,r){e.dataUpdateCount++;const s=new mI(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const t=K(n,e=>lP(e));o=function(e,t,n,i){const r=oD(e,i);if(r){const i=aD(r),s=i.path,o=i.queryId,a=EI(s,t),l=HP.fromObject(n);return lD(e,s,new jP(PP(o),a,l))}return[]}(e.serverSyncTree_,s,t,r)}else{const t=lP(n);o=$A(e.serverSyncTree_,s,t,r)}else if(i){const t=K(n,e=>lP(e));o=function(e,t,n){const i=HP.fromObject(n);return eD(e,new jP({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=lP(n);o=QA(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=uR(e,s)),qD(e.eventQueue_,a,o)}function JD(e,t){ZD(e,"connected",t),!1===t&&function(e){oR(e,"onDisconnectEvents");const t=XD(e),n=CP();TP(e.onDisconnect_,gI(),(i,r)=>{const s=mD(i,r,e.serverSyncTree_,t);kP(n,i,s)});let i=[];TP(n,gI(),(t,n)=>{i=i.concat(QA(e.serverSyncTree_,t,n));const r=mR(e,t);uR(e,r)}),e.onDisconnect_=CP(),qD(e.eventQueue_,gI(),i)}(e)}function ZD(e,t,n){const i=new mI("/.info/"+t),r=lP(n);e.infoData_.updateSnapshot(i,r);const s=QA(e.infoSyncTree_,i,r);qD(e.eventQueue_,i,s)}function eR(e){return e.nextWriteId_++}function tR(e,t,n,i,r){oR(e,"set",{path:t.toString(),value:n,priority:i});const s=XD(e),o=lP(n,i),a=ZA(e.serverSyncTree_,t),l=gD(o,a,s),c=eR(e),u=KA(e.serverSyncTree_,t,l,c,!0);VD(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),(n,i)=>{const s="ok"===n;s||IS("set at "+t+" failed: "+n);const o=YA(e.serverSyncTree_,c,!s);qD(e.eventQueue_,t,o),aR(e,r,n,i)});const h=mR(e,t);uR(e,h),qD(e.eventQueue_,h,[])}function nR(e,t,n){e.server_.onDisconnectCancel(t.toString(),(i,r)=>{"ok"===i&&EP(e.onDisconnect_,t),aR(e,n,i,r)})}function iR(e,t,n,i){const r=lP(n);e.server_.onDisconnectPut(t.toString(),r.val(!0),(n,s)=>{"ok"===n&&kP(e.onDisconnect_,t,r),aR(e,i,n,s)})}function rR(e,t,n){let i;i=".info"===yI(t._path)?XA(e.infoSyncTree_,t,n):XA(e.serverSyncTree_,t,n),BD(e.eventQueue_,t._path,i)}function sR(e){e.persistentConnection_&&e.persistentConnection_.interrupt(GD)}function oR(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];ES(t,...i)}function aR(e,t,n,i){t&&BS(()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let r=e;i&&(r+=": "+i);const s=new Error(r);s.code=e,t(s)}})}function lR(e,t,n){return ZA(e.serverSyncTree_,t,n)||oP.EMPTY_NODE}function cR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||pR(e,t),xD(t)){const n=dR(e,t);f(n.length>0,"Sending zero length transaction queue");n.every(e=>0===e.status)&&function(e,t,n){const i=n.map(e=>e.currentWriteId),r=lR(e,t,i);let s=r;const o=r.hash();for(let c=0;c<n.length;c++){const e=n[c];f(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const i=EI(t,e.path);s=s.updateChild(i,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,i=>{oR(e,"transaction put response",{path:l.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(YA(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();pR(e,bD(e.transactionQueueTree_,t)),cR(e,e.transactionQueueTree_),qD(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)BS(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{IS("transaction at "+l.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}uR(e,t)}},o)}(e,ED(t),n)}else wD(t)&&CD(t,t=>{cR(e,t)})}function uR(e,t){const n=hR(e,t),i=ED(n);return function(e,t,n){if(0===t.length)return;const i=[];let r=[];const s=t.filter(e=>0===e.status),o=s.map(e=>e.currentWriteId);for(let a=0;a<t.length;a++){const s=t[a],l=EI(n,s.path);let c,u=!1;if(f(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)u=!0,c=s.abortReason,r=r.concat(YA(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)u=!0,c="maxretry",r=r.concat(YA(e.serverSyncTree_,s.currentWriteId,!0));else{const n=lR(e,s.path,o);s.currentInputSnapshot=n;const i=t[a].update(n.val());if(void 0!==i){jD("transaction failed: Data returned ",i,s.path);let t=lP(i);"object"===typeof i&&null!=i&&H(i,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=XD(e),c=gD(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=eR(e),o.splice(o.indexOf(a),1),r=r.concat(KA(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),r=r.concat(YA(e.serverSyncTree_,a,!0))}else u=!0,c="nodata",r=r.concat(YA(e.serverSyncTree_,s.currentWriteId,!0))}qD(e.eventQueue_,n,r),r=[],u&&(t[a].status=2,function(e){setTimeout(e,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&("nodata"===c?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(c),!1,null))))}pR(e,e.transactionQueueTree_);for(let a=0;a<i.length;a++)BS(i[a]);cR(e,e.transactionQueueTree_)}(e,dR(e,n),i),i}function hR(e,t){let n,i=e.transactionQueueTree_;for(n=yI(t);null!==n&&void 0===xD(i);)i=bD(i,n),n=yI(t=bI(t));return i}function dR(e,t){const n=[];return fR(e,t,n),n.sort((e,t)=>e.order-t.order),n}function fR(e,t,n){const i=xD(t);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);CD(t,t=>{fR(e,t,n)})}function pR(e,t){const n=xD(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,_D(t,n.length>0?n:void 0)}CD(t,t=>{pR(e,t)})}function mR(e,t){const n=ED(hR(e,t)),i=bD(e.transactionQueueTree_,t);return function(e,t,n){let i=n?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,t=>{gR(e,t)}),gR(e,i),kD(i,t=>{gR(e,t)}),n}function gR(e,t){const n=xD(t);if(n){const i=[];let r=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(f(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(f(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(YA(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&i.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?_D(t,void 0):n.length=s+1,qD(e.eventQueue_,ED(t),r);for(let e=0;e<i.length;e++)BS(i[e])}}const yR=function(e,t){const n=vR(e),i=n.namespace;"firebase.com"===n.domain&&SS(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||SS("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&IS("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new JS(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new mI(n.pathString)}},vR=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(r=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(i){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):IS("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}},bR="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class xR{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+B(this.snapshot.exportVal())}}class _R{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class wR{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class CR{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new P;return nR(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){FD("OnDisconnect.remove",this._path);const e=new P;return iR(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){FD("OnDisconnect.set",this._path),RD("OnDisconnect.set",e,this._path,!1);const t=new P;return iR(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){FD("OnDisconnect.setWithPriority",this._path),RD("OnDisconnect.setWithPriority",e,this._path,!1),OD("OnDisconnect.setWithPriority",t,!1);const n=new P;return function(e,t,n,i,r){const s=lP(n,i);e.server_.onDisconnectPut(t.toString(),s.val(!0),(n,i)=>{"ok"===n&&kP(e.onDisconnect_,t,s),aR(0,r,n,i)})}(this._repo,this._path,e,t,n.wrapCallback(()=>{})),n.promise}update(e){FD("OnDisconnect.update",this._path),MD("OnDisconnect.update",e,this._path,!1);const t=new P;return function(e,t,n,i){if(G(n))return ES("onDisconnect().update() called with empty data.  Don't do anything."),void aR(0,i,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(r,s)=>{"ok"===r&&FS(n,(n,i)=>{const r=lP(i);kP(e.onDisconnect_,CI(t,n),r)}),aR(0,i,r,s)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class kR{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return kI(this._path)?null:xI(this._path)}get ref(){return new ER(this._repo,this._path)}get _queryIdentifier(){const e=xP(this._queryParams),t=OS(e);return"{}"===t?"default":t}get _queryObject(){return xP(this._queryParams)}isEqual(e){if(!((e=re(e))instanceof kR))return!1;const t=this._repo===e._repo,n=NI(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class ER extends kR{constructor(e,t){super(e,t,new vP,!1)}get parent(){const e=wI(this._path);return null===e?null:new ER(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class TR{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new mI(e),n=SR(this.ref,e);return new TR(this._node.getChild(t),n,JI)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new TR(n,SR(this.ref,t),JI)))}hasChild(e){const t=new mI(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function NR(e,t){return(e=re(e))._checkNotDeleted("ref"),void 0!==t?SR(e._root,t):e._root}function SR(e,t){var n,i,r,s;return null===yI((e=re(e))._path)?(n="child",i="path",s=!1,(r=t)&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),LD(n,i,r,s)):LD("child","path",t,!1),new ER(e._repo,CI(e._path,t))}function IR(e,t){e=re(e),FD("set",e._path),RD("set",t,e._path,!1);const n=new P;return tR(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class PR{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new xR("value",this,new TR(e.snapshotNode,new ER(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new _R(this,e,t):null}matches(e){return e instanceof PR&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class AR{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new _R(this,e,t):null}createEvent(e,t){f(null!=e.childName,"Child events should have a childName.");const n=SR(new ER(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new xR(e.type,this,new TR(e.snapshotNode,n,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof AR&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function DR(e,t,n,i,r){let s;if("object"===typeof i&&(s=void 0,r=i),"function"===typeof i&&(s=i),r&&r.onlyOnce){const t=n,i=(n,i)=>{rR(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new wR(n,s||void 0),a="value"===t?new PR(o):new AR(t,o);return function(e,t,n){let i;i=".info"===yI(t._path)?JA(e.infoSyncTree_,t,n):JA(e.serverSyncTree_,t,n),BD(e.eventQueue_,t._path,i)}(e._repo,e,a),()=>rR(e._repo,e,a)}function RR(e,t,n,i){return DR(e,"value",t,n,i)}!function(e){f(!DA,"__referenceConstructor has already been defined"),DA=e}(ER),function(e){f(!RA,"__referenceConstructor has already been defined"),RA=e}(ER);const jR={};let MR=!1;function OR(e,t,n,i,r){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||SS("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ES("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let o,a,l=yR(s,r),c=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"/portal",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s="http://".concat(a,"?ns=").concat(c.namespace),l=yR(s,r),c=l.repoInfo):o=!l.repoInfo.secure;const u=r&&o?new GS(GS.OWNER):new WS(e.name,e.options,t);zD("Invalid Firebase Database URL",l),kI(l.path)||SS("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,i){let r=jR[t.name];r||(r={},jR[t.name]=r);let s=r[e.toURLString()];s&&SS("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new KD(e,MR,n,i),r[e.toURLString()]=s,s}(c,e,u,new HS(e.name,n));return new LR(h,e)}class LR{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(YD(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ER(this._repo,gI())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=jR[t];n&&n[e.key]===e||SS("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),sR(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&SS("Cannot call "+e+" on a deleted database.")}}const FR={".sv":"timestamp"};function zR(){return FR}jI.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},jI.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){!function(e){dS=e}(mt),ht(new se("database",(e,t)=>{let{instanceIdentifier:n}=t;return OR(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),vt(uS,hS,e),vt(uS,hS,"esm2017")}();var UR=n(579);zk.register(RE,LE,cE,eE,nE,aC,mE,PE,fE,Wk);const VR={apiKey:"AIzaSyA7H6G0mXCy9DmoLg3fSW3TrxIRcEzz9jg",authDomain:"portal-evelsa.firebaseapp.com",projectId:"portal-evelsa",storageBucket:"portal-evelsa.firebasestorage.app",messagingSenderId:"847174487471",appId:"1:847174487471:web:c3a57fd8315ce619a2335a"},BR=gt(VR),qR=Dr(BR),HR=function(e,t){const n="string"==typeof e?e:t||"(default)",i=dt("object"==typeof e?e:yt(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=N("firestore");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var r;const s=(e=ig(e,sg))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==o&&lc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=nc.MOCK_USER;else{t=A(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new pc(fc.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new nc(s)}e._authCredentials=new vc(new gc(t,n))}}(i,...e)}return i}(BR),WR="proyectos_v2",GR=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt(),t=arguments.length>1?arguments[1]:void 0;e=re(e);const n=dt(e,nb).getImmediate({identifier:t}),i=N("storage");return i&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:r}=i;r&&(e._overrideAuthToken="string"===typeof r?r:A(r,e.app.options.projectId))}(e,t,n,i)}(n,...i),n}(BR),KR=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt(),t=arguments.length>1?arguments[1]:void 0;const n=dt(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=N("database");e&&function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=re(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&SS("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&SS('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new GS(GS.OWNER);else if(i.mockUserToken){const t="string"===typeof i.mockUserToken?i.mockUserToken:A(i.mockUserToken,e.app.options.projectId);s=new GS(t)}!function(e,t,n,i){e.repoInfo_=new JS("".concat(t,":").concat(n),!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,n,s)}(n,...e)}return n}(BR),YR=e=>{if(!e)return"---";let t;if("function"===typeof e.toDate)t=e.toDate();else try{if(t=new Date(e),isNaN(t.getTime()))return"Fecha Inv\xe1lida"}catch(i){return"Fecha Inv\xe1lida"}const n=6e4*t.getTimezoneOffset();return new Date(t.getTime()+n).toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit"})},QR=e=>{let{breakInfo:t,onEndBreak:n}=e;const r=(e=>{const[t,n]=(0,i.useState)(0);return(0,i.useEffect)(()=>{if(!e)return void n(0);const t=e.toDate().getTime(),i=setInterval(()=>{const e=Date.now(),i=t-e;n(i>0?i:0)},1e3);return()=>clearInterval(i)},[e]),(e=>{if(e<=0)return"00:00";const t=Math.floor(e/1e3),n=String(Math.floor(t/60)).padStart(2,"0"),i=String(t%60).padStart(2,"0");return"".concat(n,":").concat(i)})(t)})(new Sc(t.inicio.seconds+4500,t.inicio.nanoseconds));return(0,UR.jsxs)("div",{className:"bg-yellow-500 text-white p-4 rounded-lg shadow-lg mb-8 flex justify-between items-center sticky top-20 z-30",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-bold",children:"En Descanso"}),(0,UR.jsx)("p",{className:"text-lg",children:"El trabajo se reanudar\xe1 autom\xe1ticamente."})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,UR.jsxs)("div",{className:"text-right",children:[(0,UR.jsx)("p",{className:"text-2xl font-mono",children:r}),(0,UR.jsx)("p",{className:"text-xs",children:"Tiempo Restante"})]}),(0,UR.jsx)("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 font-bold py-3 px-4 rounded-lg",children:"Volver al Trabajo"})]})]})},XR=e=>{let{message:t,type:n,onClose:i}=e;if(!t)return null;return(0,UR.jsxs)("div",{className:"".concat("p-4 mb-4 text-sm rounded-lg relative"," ").concat({error:"bg-red-100 text-red-800",success:"bg-green-100 text-green-800"}[n]),role:"alert",children:[(0,UR.jsx)("span",{className:"font-medium",children:t}),(0,UR.jsx)("button",{onClick:i,className:"absolute top-0 right-0 mt-2 mr-3 text-2xl font-semibold leading-none",children:"\xd7"})]})},$R=(e,t)=>{if(!e)return null;let n=new Date(e),i=0;for(;i<t;){n.setDate(n.getDate()+1);const e=n.getDay();0!==e&&6!==e&&i++}return n},JR=e=>{try{var t,n,i;const r=new cS({ignoreAttributes:!1,attributeNamePrefix:"@_",parseAttributeValue:!0}),s=r.parse(e)["cfdi:Comprobante"];if(!s)throw new Error("Nodo <cfdi:Comprobante> no encontrado.");const o=null===(t=s["cfdi:Complemento"])||void 0===t?void 0:t["tfd:TimbreFiscalDigital"];if(!o)throw new Error("Nodo <tfd:TimbreFiscalDigital> no encontrado.");let a=0;const l=s["cfdi:Impuestos"];if(l&&l["@_TotalImpuestosTrasladados"])a=l["@_TotalImpuestosTrasladados"];else if(l&&l["cfdi:Traslados"]){const e=l["cfdi:Traslados"];(Array.isArray(e["cfdi:Traslado"])?e["cfdi:Traslado"]:[e["cfdi:Traslado"]]).forEach(e=>{e&&"002"===e["@_Impuesto"]&&(a+=e["@_Importe"])})}return{folio:s["@_Folio"]||"S/F",uuid:o["@_UUID"],subtotal:s["@_SubTotal"],iva:a,monto:s["@_Total"],fechaEmision:new Date(s["@_Fecha"]),rfcEmisor:null===(n=s["cfdi:Emisor"])||void 0===n?void 0:n["@_Rfc"],rfcReceptor:null===(i=s["cfdi:Receptor"])||void 0===i?void 0:i["@_Rfc"]}}catch(r){return console.error("Error al parsear el XML:",r),null}},ZR=()=>{const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(null);if((0,i.useEffect)(()=>{(async()=>{t(!0);const e=Qg(cg(HR,"facturas"),$g("tipo","==","cliente"),$g("estado","==","Pendiente")),n=(await my(e)).docs.map(e=>e.data()),i=new Date,s={"0-30 D\xedas":0,"31-60 D\xedas":0,"61-90 D\xedas":0,"+90 D\xedas":0};n.forEach(e=>{const t=e.fechaEmision.toDate(),n=Math.abs(i-t),r=Math.ceil(n/864e5);r<=30?s["0-30 D\xedas"]+=e.monto:r<=60?s["31-60 D\xedas"]+=e.monto:r<=90?s["61-90 D\xedas"]+=e.monto:s["+90 D\xedas"]+=e.monto}),r({labels:Object.keys(s),datasets:[{label:"Monto Pendiente de Cobro",data:Object.values(s),backgroundColor:["rgba(75, 192, 192, 0.6)","rgba(255, 206, 86, 0.6)","rgba(255, 159, 64, 0.6)","rgba(255, 99, 132, 0.6)"],borderColor:["rgba(75, 192, 192, 1)","rgba(255, 206, 86, 1)","rgba(255, 159, 64, 1)","rgba(255, 99, 132, 1)"],borderWidth:1}]}),t(!1)})()},[]),e)return(0,UR.jsx)("p",{children:"Calculando reporte de antig\xfcedad..."});return(0,UR.jsx)("div",{className:"bg-white p-6 rounded-xl shadow-md",children:n&&(0,UR.jsx)(bT,{data:n,options:{indexAxis:"y",responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Monto Pendiente de Cobro por Antig\xfcedad"}}}})})},ej=e=>{let{title:t,message:n,onConfirm:i,onCancel:r,confirmText:s="Confirmar",cancelText:o="Cancelar",confirmColor:a="bg-green-600"}=e;return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-sm",children:[(0,UR.jsx)("h3",{className:"text-lg font-bold mb-4",children:t}),(0,UR.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:n}),(0,UR.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:r,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:o}),(0,UR.jsx)("button",{onClick:i,className:"".concat(a," hover:opacity-90 text-white font-bold py-2 px-4 rounded"),children:s})]})]})})},tj=e=>{let{project:t,onClose:n,onFinalized:r}=e;const[s,o]=(0,i.useState)([]),[a,l]=(0,i.useState)(t.asignadoTecnicosIds&&t.asignadoTecnicosIds[0]||""),[u,h]=(0,i.useState)(t.fechaEntregaInterna?t.fechaEntregaInterna.toDate().toISOString().split("T")[0]:""),[d,f]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{const e=Qg(cg(HR,"usuarios"),$g("rol","==","tecnico")),t=Qg(cg(HR,"usuarios"),$g("roles","array-contains","tecnico")),[n,i]=await Promise.all([my(e),my(t)]),r=new Map;n.forEach(e=>r.set(e.id,c({id:e.id},e.data()))),i.forEach(e=>r.set(e.id,c({id:e.id},e.data()))),o(Array.from(r.values()))})()},[]);return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Asignar Proyecto: ",t.npu]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"T\xe9cnico Asignado"}),(0,UR.jsx)("div",{className:"mt-2 max-h-48 overflow-y-auto border rounded-md p-2",children:s.map(e=>(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("input",{type:"radio",name:"technician",id:e.id,value:e.id,checked:a===e.id,onChange:e=>l(e.target.value),className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,UR.jsx)("label",{htmlFor:e.id,className:"ml-3 text-sm text-gray-700",children:e.nombreCompleto})]},e.id))})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha L\xedmite de Entrega (Interna)"}),(0,UR.jsx)("input",{type:"date",value:u,onChange:e=>h(e.target.value),className:"mt-1 block w-full px-3 py-2 border rounded-md"})]})]}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:n,disabled:d,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{var e;if(!a)return void alert("Debes seleccionar un t\xe9cnico.");f(!0);const i=ug(HR,WR,t.id),s={};s[a]=(null===(e=t.tecnicosStatus)||void 0===e?void 0:e[a])||"No Visto",await yy(i,{asignadoTecnicosIds:[a],tecnicosStatus:s,fechaAsignacionTecnico:Sc.now(),fechaEntregaInterna:u?Sc.fromDate(new Date(u)):null}),f(!1),r(),n()},disabled:d,className:"bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded",children:d?"Asignando...":"Guardar Asignaci\xf3n"})]})]})})},nj=e=>{let{project:t,onClose:n,onUpdate:r,user:s,userData:o,userRole:a}=e;const[l,u]=(0,i.useState)({prioridad:t.prioridad||"1 - Normal",fechaEntregaInterna:t.fechaEntregaInterna?t.fechaEntregaInterna.toDate().toISOString().split("T")[0]:"",notasSupervisor:t.notasSupervisor||"",precioCotizacionCliente:t.precioCotizacionCliente||"",costoProveedor:t.costoProveedor||"",cotizacionClienteRef:t.cotizacionClienteRef||"",poClienteRef:t.poClienteRef||"",cotizacionProveedorRef:t.cotizacionProveedorRef||""}),[h,d]=(0,i.useState)(!1),[f,p]=(0,i.useState)([]),[m,g]=(0,i.useState)(!0);(0,i.useEffect)(()=>{g(!0);const e=by(Qg(cg(HR,"bitacoras_proyectos"),$g("projectId","==",t.id),ey("fecha","desc")),e=>{p(e.docs.map(e=>c({id:e.id},e.data()))),g(!1)});return()=>e()},[t.id]);const y=e=>{const{name:t,value:n}=e.target;u(e=>c(c({},e),{},{[t]:n}))};return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Gestionar Proyecto: ",t.npu]}),(0,UR.jsxs)("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:["supervisor"===a&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Prioridad"}),(0,UR.jsxs)("select",{name:"prioridad",value:l.prioridad,onChange:y,className:"mt-1 block w-full p-2 border rounded-md",children:[(0,UR.jsx)("option",{value:"1 - Normal",children:"Normal"}),(0,UR.jsx)("option",{value:"2 - Alta",children:"Alta"}),(0,UR.jsx)("option",{value:"3 - Urgente",children:"Urgente"})]})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Fecha L\xedmite de Entrega"}),(0,UR.jsx)("input",{type:"date",name:"fechaEntregaInterna",value:l.fechaEntregaInterna,onChange:y,className:"mt-1 block w-full p-2 border rounded-md"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Notas del Supervisor"}),(0,UR.jsx)("textarea",{name:"notasSupervisor",value:l.notasSupervisor,onChange:y,rows:"8",className:"mt-1 block w-full p-2 border rounded-md"})]})]}),"administrador"===a&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,UR.jsx)("input",{type:"number",name:"precioCotizacionCliente",value:l.precioCotizacionCliente,onChange:y,placeholder:"Precio Cliente",className:"px-3 py-2 border rounded-md"}),(0,UR.jsx)("input",{type:"number",name:"costoProveedor",value:l.costoProveedor,onChange:y,placeholder:"Costo Proveedor",className:"px-3 py-2 border rounded-md"})]}),(0,UR.jsx)("input",{type:"text",name:"cotizacionClienteRef",value:l.cotizacionClienteRef,onChange:y,placeholder:"Ref. Cotizaci\xf3n Cliente",className:"w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("input",{type:"text",name:"poClienteRef",value:l.poClienteRef,onChange:y,placeholder:"Ref. PO Cliente",className:"w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("input",{type:"text",name:"cotizacionProveedorRef",value:l.cotizacionProveedorRef,onChange:y,placeholder:"Ref. Cotizaci\xf3n Proveedor",className:"w-full px-3 py-2 border rounded-md"})]}),"supervisor"===a&&(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Bit\xe1cora (Solo Lectura)"}),(0,UR.jsx)("div",{className:"bg-gray-50 border rounded-md p-2 h-96 overflow-y-auto space-y-2",children:m?(0,UR.jsx)("p",{children:"Cargando..."}):f.length>0?f.map(e=>(0,UR.jsxs)("div",{className:"text-xs border-b pb-1",children:[(0,UR.jsx)("p",{className:"text-gray-800 whitespace-pre-wrap",children:e.mensaje}),e.adjuntoUrl&&(0,UR.jsx)("a",{href:e.adjuntoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Ver adjunto"}),(0,UR.jsxs)("p",{className:"text-gray-500 mt-1 text-right",children:[e.autorNombre," - ",YR(e.fecha)]})]},e.id)):(0,UR.jsx)("p",{className:"text-gray-500",children:"No hay entradas."})})]})]}),(0,UR.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,UR.jsx)("button",{onClick:n,className:"bg-gray-300 hover:bg-gray-400 font-bold py-2 px-4 rounded",children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{d(!0);const e=ug(HR,WR,t.id),i={};"supervisor"===a?(i.prioridad=l.prioridad,i.fechaEntregaInterna=l.fechaEntregaInterna?Sc.fromDate(new Date(l.fechaEntregaInterna)):null,i.notasSupervisor=l.notasSupervisor):"administrador"===a&&(i.precioCotizacionCliente=Number(l.precioCotizacionCliente)||0,i.costoProveedor=Number(l.costoProveedor)||0,i.cotizacionClienteRef=l.cotizacionClienteRef,i.poClienteRef=l.poClienteRef,i.cotizacionProveedorRef=l.cotizacionProveedorRef);try{Object.keys(i).length>0&&await yy(e,i),r(),n(),XT.success("Proyecto actualizado correctamente.")}catch(s){XT.error("Error al guardar los cambios."),console.error("Error al guardar:",s)}finally{d(!1)}},disabled:h,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:h?"Guardando...":"Guardar Cambios"})]})]})})},ij=e=>{let{title:t,message:n,onConfirm:r,onCancel:s,confirmText:o="Confirmar",cancelText:a="Cancelar",confirmColor:l="bg-orange-600"}=e;const[c,u]=(0,i.useState)("");return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md",children:[(0,UR.jsx)("h3",{className:"text-lg font-bold mb-4",children:t}),(0,UR.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:n}),(0,UR.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Escribe el motivo aqu\xed...",rows:"3",className:"w-full p-2 border rounded-md"}),(0,UR.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,UR.jsx)("button",{onClick:s,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:a}),(0,UR.jsx)("button",{onClick:()=>r(c),className:"".concat(l," hover:opacity-90 text-white font-bold py-2 px-4 rounded"),children:o})]})]})})},rj=e=>{let{user:t,userData:n,selectedRole:r,setSelectedRole:s,isWorking:o}=e;const a=(null===n||void 0===n?void 0:n.roles)&&n.roles.length>1;return(0,i.useEffect)(()=>{if(null===t||void 0===t||!t.uid)return;const e=new Audio("https://freesound.org/data/previews/131/131660_2398463-lq.mp3"),n=by(Qg(cg(HR,"notificaciones"),$g("recipientId","==",t.uid),$g("read","==",!1)),t=>{const n=[];if(t.docChanges().forEach(e=>{"added"===e.type&&n.push(c({id:e.doc.id},e.doc.data()))}),n.length>2?(XT.info("\ud83d\udd14 Tienes ".concat(n.length," notificaciones nuevas sin leer.")),e.play().catch(e=>console.log("La interacci\xf3n del usuario es necesaria para reproducir sonido."))):n.forEach((t,n)=>{setTimeout(()=>{XT.info("\ud83d\udd14 ".concat(t.message)),e.play().catch(e=>console.log("La interacci\xf3n del usuario es necesaria para reproducir sonido."))},1e3*n)}),n.length>0){const e=(pg(i=ig(i=HR,fg)),new Cy(i,e=>xy(i,e)));n.forEach(t=>{const n=ug(HR,"notificaciones",t.id);e.update(n,{read:!0})}),e.commit()}var i});return()=>n()},[t]),(0,UR.jsx)("header",{className:"bg-white shadow-md sticky top-0 z-40",children:(0,UR.jsxs)("div",{className:"max-w-7xl mx-auto py-3 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,UR.jsx)("div",{className:"flex items-center",children:n&&"cliente"===n.rol&&n.logoUrl?(0,UR.jsx)("img",{src:n.logoUrl,onError:e=>{e.target.onerror=null,e.target.src="https://placehold.co/150x50/FFFFFF/000000?text=Logo+Cliente"},alt:"Logo Cliente",className:"h-12 w-auto mr-4 object-contain"}):(0,UR.jsx)("img",{src:"https://www.grupoevelsa.com/assets/images/Logo Evelsa 2.png",alt:"Logo Grupo Evelsa",className:"h-12 w-auto mr-4"})}),t&&(0,UR.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,UR.jsxs)("span",{className:"text-gray-600 hidden sm:block",children:["Hola, ",n?n.nombreCompleto.split(" ")[0]:t.email]}),a&&(0,UR.jsx)("div",{className:"relative",children:(0,UR.jsx)("select",{value:r,onChange:e=>s(e.target.value),className:"appearance-none bg-gray-100 border border-gray-300 rounded-md py-2 pl-3 pr-8 text-sm font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:n.roles.map(e=>(0,UR.jsx)("option",{value:e,className:"capitalize",children:e.charAt(0).toUpperCase()+e.slice(1)},e))})}),(0,UR.jsx)("button",{onClick:()=>vi(qR),disabled:o,className:"font-bold py-2 px-4 rounded-lg transition duration-300 ".concat(o?"bg-gray-400 text-gray-700 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"),title:o?"Debes 'Finalizar D\xeda' antes de salir":"Cerrar sesi\xf3n",children:"Salir"})]})]})})},sj=e=>{let{project:t,user:n,userData:r,onClose:s,selectedRole:o}=e;const[a,l]=(0,i.useState)([]),[u,h]=(0,i.useState)(""),[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(!0),[g,y]=(0,i.useState)(!1),[v,b]=(0,i.useState)(""),x="supervisor"!==o;(0,i.useEffect)(()=>{const e=by(Qg(cg(HR,"bitacoras_proyectos"),$g("projectId","==",t.id),ey("fecha","asc")),e=>{l(e.docs.map(e=>c({id:e.id},e.data()))),m(!1)},e=>{console.error("Error fetching log entries:",e),b("No se pudo cargar la bit\xe1cora."),m(!1)});return()=>e()},[t.id]);return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl h-[90vh] flex flex-col",children:[(0,UR.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold",children:["Bit\xe1cora del Proyecto: ",t.npu]}),(0,UR.jsx)("button",{onClick:s,className:"text-gray-600 hover:text-gray-900 text-2xl font-bold",children:"\xd7"})]}),(0,UR.jsx)("div",{className:"flex-grow overflow-y-auto border rounded-md p-4 space-y-4 mb-4 bg-gray-50",children:p?(0,UR.jsx)("p",{children:"Cargando bit\xe1cora..."}):0===a.length?(0,UR.jsx)("p",{children:"No hay entradas en la bit\xe1cora."}):a.map(e=>{return(0,UR.jsxs)("div",{className:"p-3 bg-white rounded-lg shadow-sm",children:[(0,UR.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:e.mensaje}),e.adjuntoUrl&&(0,UR.jsx)("a",{href:e.adjuntoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Ver adjunto"}),(0,UR.jsxs)("p",{className:"text-xs text-gray-500 mt-2 text-right",children:[e.autorNombre," - ",(t=e.fecha,t?new Date(1e3*t.seconds).toLocaleString("es-MX"):"---")]})]},e.id);var t})}),x&&(0,UR.jsxs)("div",{className:"border-t pt-4",children:[(0,UR.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"A\xf1adir nueva nota...",rows:"3",className:"w-full p-2 border rounded-md"}),(0,UR.jsx)("input",{type:"file",id:"file-input-".concat(t.id),onChange:e=>{e.target.files[0]&&f(e.target.files[0])},className:"w-full text-sm mt-2"}),(0,UR.jsx)(XR,{message:v,type:"error",onClose:()=>b("")}),(0,UR.jsx)("button",{onClick:async()=>{if(u||d){y(!0),b("");try{let e="";if(d){const n=ib(sb(GR,"bitacoras/".concat(t.id,"/").concat(Date.now(),"_").concat(d.name)),d);e=await rb((await n).ref)}await vy(cg(HR,"bitacoras_proyectos"),{projectId:t.id,autorId:n.uid,autorNombre:r.nombreCompleto,mensaje:u,adjuntoUrl:e,fecha:Sc.now()}),h(""),f(null);const i=document.getElementById("file-input-".concat(t.id));i&&(i.value="")}catch(e){console.error("Error al guardar en bit\xe1cora:",e),b("No se pudo guardar la nota. Por favor, intente de nuevo.")}finally{y(!1)}}},disabled:g,className:"w-full mt-2 bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded-lg disabled:bg-gray-300",children:g?"Guardando...":"A\xf1adir a la Bit\xe1cora"})]})]})})},oj=()=>{const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)({nombre:"",servicioIdNumerico:"",dependencia:"",durationType:"fixed",totalHoras:"",baseHoras:"",porUnidad:"",nombreUnidad:""}),[s,o]=(0,i.useState)(!0),[a,l]=(0,i.useState)(""),[u,h]=(0,i.useState)("");(0,i.useEffect)(()=>{const e=by(Qg(cg(HR,"servicios")),e=>{t(e.docs.map(e=>c({id:e.id},e.data()))),o(!1)},e=>{l("No se pudieron cargar los servicios."),o(!1)});return()=>e()},[]);const d=e=>{const{name:t,value:n,type:i}=e.target;r(e=>c(c({},e),{},{[t]:n}))},f=e=>{const t=e.calculoDuracion;return t?t.totalHoras?"".concat(t.totalHoras,"h Total"):void 0!==t.baseHoras?"".concat(t.baseHoras,"h + ").concat(t.porUnidad,"h/").concat(t.nombreUnidad||"unidad"):"Inv\xe1lido":"N/A"};return(0,UR.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border",children:[(0,UR.jsx)("h3",{className:"text-xl font-bold mb-4",children:"A\xf1adir Nuevo Servicio"}),(0,UR.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l(""),h(""),!n.nombre||!n.servicioIdNumerico||!n.dependencia)return void l("Nombre, ID Num\xe9rico y Dependencia son obligatorios.");let t={};if("fixed"===n.durationType){if(!n.totalHoras)return void l("Debe especificar las horas totales para duraci\xf3n fija.");t={totalHoras:Number(n.totalHoras)}}else{if(!n.baseHoras||!n.porUnidad||!n.nombreUnidad)return void l("Horas base, valor por unidad y nombre de unidad son obligatorios para duraci\xf3n variable.");t={baseHoras:Number(n.baseHoras),porUnidad:Number(n.porUnidad),nombreUnidad:n.nombreUnidad}}try{await vy(cg(HR,"servicios"),{nombre:n.nombre,servicioIdNumerico:n.servicioIdNumerico,dependencia:n.dependencia,calculoDuracion:t}),h("\xa1Servicio '".concat(n.nombre,"' a\xf1adido con \xe9xito!")),r({nombre:"",servicioIdNumerico:"",dependencia:"",durationType:"fixed",totalHoras:"",baseHoras:"",porUnidad:"",nombreUnidad:""})}catch(i){l("Error al a\xf1adir el servicio: ".concat(i.message))}},className:"space-y-4",children:[(0,UR.jsx)("input",{type:"text",name:"nombre",value:n.nombre,onChange:d,placeholder:"Nombre del Servicio",className:"w-full p-2 border rounded",required:!0}),(0,UR.jsx)("input",{type:"text",name:"servicioIdNumerico",value:n.servicioIdNumerico,onChange:d,placeholder:"ID Num\xe9rico (ej: 0001)",className:"w-full p-2 border rounded",required:!0}),(0,UR.jsx)("input",{type:"text",name:"dependencia",value:n.dependencia,onChange:d,placeholder:"Dependencia",className:"w-full p-2 border rounded",required:!0}),(0,UR.jsxs)("fieldset",{className:"border p-3 rounded",children:[(0,UR.jsx)("legend",{className:"text-sm font-medium",children:"Tipo de Duraci\xf3n"}),(0,UR.jsxs)("div",{className:"flex space-x-4",children:[(0,UR.jsxs)("label",{children:[(0,UR.jsx)("input",{type:"radio",name:"durationType",value:"fixed",checked:"fixed"===n.durationType,onChange:d})," Fija"]}),(0,UR.jsxs)("label",{children:[(0,UR.jsx)("input",{type:"radio",name:"durationType",value:"variable",checked:"variable"===n.durationType,onChange:d})," Variable"]})]})]}),"fixed"===n.durationType&&(0,UR.jsx)("input",{type:"number",name:"totalHoras",value:n.totalHoras,onChange:d,placeholder:"Horas Totales Estimadas",className:"w-full p-2 border rounded"}),"variable"===n.durationType&&(0,UR.jsxs)("div",{className:"space-y-2 border p-3 rounded bg-gray-50",children:[(0,UR.jsx)("input",{type:"number",name:"baseHoras",value:n.baseHoras,onChange:d,placeholder:"Horas Base",className:"w-full p-2 border rounded"}),(0,UR.jsx)("input",{type:"number",step:"0.01",name:"porUnidad",value:n.porUnidad,onChange:d,placeholder:"Horas por Unidad (ej: 0.75)",className:"w-full p-2 border rounded"}),(0,UR.jsx)("input",{type:"text",name:"nombreUnidad",value:n.nombreUnidad,onChange:d,placeholder:"Nombre de la Unidad (ej: punto, foto)",className:"w-full p-2 border rounded"})]}),(0,UR.jsx)(XR,{message:a,type:"error",onClose:()=>l("")}),(0,UR.jsx)(XR,{message:u,type:"success",onClose:()=>h("")}),(0,UR.jsx)("button",{type:"submit",className:"w-full bg-[#b0ef26] hover:bg-[#9ac91e] font-bold py-2 px-4 rounded",children:"A\xf1adir Servicio"})]})]}),(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border",children:[(0,UR.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Servicios Existentes"}),(0,UR.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Nombre"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"ID Num."}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Dependencia"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Duraci\xf3n Estimada"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y",children:s?(0,UR.jsx)("tr",{children:(0,UR.jsx)("td",{colSpan:"4",children:"Cargando..."})}):e.map(e=>(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-2 text-sm",children:e.nombre}),(0,UR.jsx)("td",{className:"px-4 py-2 text-sm",children:e.servicioIdNumerico}),(0,UR.jsx)("td",{className:"px-4 py-2 text-sm",children:e.dependencia}),(0,UR.jsx)("td",{className:"px-4 py-2 text-sm",children:f(e)})]},e.id))})]})})]})]})},aj=e=>{let{onUserAdded:t}=e;const[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),[c,u]=(0,i.useState)("cliente"),[h,d]=(0,i.useState)(""),[f,p]=(0,i.useState)(""),[m,g]=(0,i.useState)(""),[y,v]=(0,i.useState)("");return(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[(0,UR.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Crear Nuevo Usuario"}),(0,UR.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),g(""),v(""),a&&n&&s)if("cliente"!==c||h)try{const e=Dr(gt(VR,"Secondary-".concat((new Date).getTime()))),i=await async function(e,t,n){var i;const r=Bn(e),s={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(null===(i=r._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const e=await zn(r,s,"signUpPassword");o=ci(r,e)}else o=ci(r,s).catch(async e=>{if(e.code==="auth/".concat("missing-recaptcha-token")){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await zn(r,s,"signUpPassword");return ci(r,e)}return Promise.reject(e)});const a=await o.catch(e=>Promise.reject(e)),l=await ui._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(l.user),l}(e,n,s);await gy(ug(HR,"usuarios",i.user.uid),{email:n,rol:c,nombreCompleto:a,clienteIdNumerico:"cliente"===c?h.padStart(3,"0"):"",logoUrl:"cliente"===c?f:""}),v("\xa1Usuario ".concat(n," con rol '").concat(c,"' creado con \xe9xito!")),r(""),o(""),l(""),u("cliente"),d(""),p(""),t&&t()}catch(i){g("Error al crear usuario: ".concat(i.message))}else g("Para clientes, el ID Num\xe9rico es obligatorio.");else g("Nombre, email y contrase\xf1a son obligatorios.")},className:"space-y-4",children:[(0,UR.jsx)("input",{type:"text",value:a,onChange:e=>l(e.target.value),placeholder:"Nombre Completo",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"}),(0,UR.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm",children:[(0,UR.jsx)("option",{value:"cliente",children:"Cliente"}),(0,UR.jsx)("option",{value:"administrador",children:"Administrador"}),(0,UR.jsx)("option",{value:"directivo",children:"Directivo"}),(0,UR.jsx)("option",{value:"ecotech",children:"Encargada Ecotech"}),(0,UR.jsx)("option",{value:"supervisor",children:"Supervisor de Proyectos"}),(0,UR.jsx)("option",{value:"tecnico",children:"T\xe9cnico"}),(0,UR.jsx)("option",{value:"finanzas",children:"Finanzas"}),(0,UR.jsx)("option",{value:"practicante",children:"Practicante"})]}),(0,UR.jsx)("input",{type:"email",value:n,onChange:e=>r(e.target.value),placeholder:"Email de Acceso",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"}),(0,UR.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),placeholder:"Contrase\xf1a (m\xednimo 6 caracteres)",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"}),"cliente"===c&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("input",{type:"text",value:h,onChange:e=>d(e.target.value),placeholder:"ID Num\xe9rico Cliente (ej: 001)",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"}),(0,UR.jsx)("input",{type:"text",value:f,onChange:e=>p(e.target.value),placeholder:"URL del Logo (Opcional)",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"})]}),(0,UR.jsx)(XR,{message:m,type:"error",onClose:()=>g("")}),(0,UR.jsx)(XR,{message:y,type:"success",onClose:()=>v("")}),(0,UR.jsx)("button",{type:"submit",className:"w-full bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded-lg",children:"Crear Usuario"})]})]})},lj=e=>{let{collectionName:t,title:n,fields:r,placeholderTexts:s}=e;const[o,a]=(0,i.useState)([]),[l,u]=(0,i.useState)({}),[h,d]=(0,i.useState)(!0),[f,p]=(0,i.useState)(""),[m,g]=(0,i.useState)("");(0,i.useEffect)(()=>{const e=by(Qg(cg(HR,t)),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));a(t),d(!1)},e=>{console.error("Error fetching ".concat(t,":"),e),p("No se pudieron cargar los datos de ".concat(n,".")),d(!1)});return()=>e()},[t,n]);const y=e=>{const{name:t,value:n}=e.target;u(e=>c(c({},e),{},{[t]:n}))};return(0,UR.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[(0,UR.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:["A\xf1adir Nuevo ",n.slice(0,-1)]}),(0,UR.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r.some(e=>!l[e]))p("Todos los campos son obligatorios.");else{p(""),g("");try{await vy(cg(HR,t),l),g("\xa1".concat(n.slice(0,-1)," a\xf1adido con \xe9xito!")),u({})}catch(i){p("Error al a\xf1adir el nuevo \xedtem: ".concat(i.message))}}},className:"space-y-4",children:[r.map((e,t)=>(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700 capitalize",children:e.replace(/([A-Z])/g," $1")}),(0,UR.jsx)("input",{type:"text",name:e,value:l[e]||"",onChange:y,placeholder:s[t],className:"mt-1 block w-full px-3 py-2 border rounded-md"})]},e)),(0,UR.jsx)(XR,{message:f,type:"error",onClose:()=>p("")}),(0,UR.jsx)(XR,{message:m,type:"success",onClose:()=>g("")}),(0,UR.jsx)("button",{type:"submit",className:"w-full bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded-lg",children:"A\xf1adir"})]})]}),(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[(0,UR.jsxs)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:[n," Existentes"]}),(0,UR.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsx)("tr",{children:r.map(e=>(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:e.replace(/([A-Z])/g," $1")},e))})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:h?(0,UR.jsx)("tr",{children:(0,UR.jsx)("td",{colSpan:r.length,children:"Cargando..."})}):o.map(e=>(0,UR.jsx)("tr",{children:r.map(t=>(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e[t]},"".concat(e.id,"-").concat(t)))},e.id))})]})})]})]})},cj=e=>{let{user:t,userData:n,selectedRole:r}=e;const[s,o]=(0,i.useState)("projects"),[a,l]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[d,f]=(0,i.useState)(null),p=()=>{h(!0);return by(Qg(cg(HR,WR),ey("fechaApertura","desc")),e=>{l(e.docs.map(e=>c({id:e.id},e.data()))),h(!1)})};return(0,i.useEffect)(()=>{const e=p();return()=>e()},[]),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,UR.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,UR.jsx)("button",{onClick:()=>o("projects"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("projects"===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Proyectos"}),(0,UR.jsx)("button",{onClick:()=>o("users"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("users"===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Usuarios"}),(0,UR.jsx)("button",{onClick:()=>o("services"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("services"===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Servicios"}),(0,UR.jsx)("button",{onClick:()=>o("providers"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("providers"===s?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Proveedores"})]})}),"users"===s&&(0,UR.jsx)(aj,{onUserAdded:()=>{}}),"projects"===s&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)(dj,{onProjectAdded:p}),(0,UR.jsx)("h2",{className:"text-2xl font-bold text-gray-800 my-6",children:"Todos los Proyectos"}),u?(0,UR.jsx)("p",{children:"Cargando tabla..."}):(0,UR.jsx)(fj,{projects:a,onUpdateProject:p,userRole:"administrador",selectedRole:r,onManageClick:f})]}),"services"===s&&(0,UR.jsx)(oj,{}),"providers"===s&&(0,UR.jsx)(lj,{collectionName:"proveedores",title:"Proveedores",fields:["nombre","proveedorIdNumerico"],placeholderTexts:["Nombre del Proveedor","ID Num\xe9rico (ej: 01)"]}),d&&(0,UR.jsx)(nj,{project:d,onClose:()=>f(null),onUpdate:p,user:t,userData:n,userRole:"administrador"})]})},uj=e=>{let{url:t,onClose:n}=e;return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50",children:(0,UR.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full h-full max-w-6xl max-h-[90vh] flex flex-col",children:[(0,UR.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,UR.jsx)("h3",{className:"text-lg font-bold",children:"Visor de Documentos"}),(0,UR.jsx)("button",{onClick:n,className:"text-gray-600 hover:text-gray-900 text-2xl font-bold",children:"\xd7"})]}),(0,UR.jsx)("div",{className:"flex-grow",children:(0,UR.jsx)("iframe",{src:t,title:"Visor de Heyzine",className:"w-full h-full",frameBorder:"0",allowFullScreen:!0})})]})})},hj=e=>{let{projects:t,onOpenModal:n}=e;const i=t.filter(e=>"Terminado"===e.estadoCliente&&e.urlHeyzine);return(0,UR.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-8",children:i.map(e=>(0,UR.jsxs)("button",{className:"group text-left focus:outline-none",onClick:()=>n(e.urlHeyzine),children:[(0,UR.jsxs)("div",{className:"relative pt-[141%] bg-gray-200 rounded-lg shadow-lg group-hover:shadow-2xl transition-all duration-300 transform group-hover:-translate-y-1 overflow-hidden",children:[(0,UR.jsx)("img",{src:"https://firebasestorage.googleapis.com/v0/b/portal-evelsa.firebasestorage.app/o/portada%20Carpetas.jpeg?alt=media&token=417eb65c-1694-4efc-9e2a-55528d43a8d6",alt:"Portada de proyecto",className:"absolute inset-0 w-full h-full object-cover"}),(0,UR.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-40"}),(0,UR.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-center items-center p-4 text-white text-center",children:[(0,UR.jsx)("h4",{className:"font-bold text-lg leading-tight",children:e.clienteNombre}),(0,UR.jsx)("hr",{className:"w-1/4 my-2 border-gray-400"}),(0,UR.jsx)("p",{className:"text-sm",children:e.servicioNombre})]})]}),(0,UR.jsx)("p",{className:"text-sm font-semibold text-gray-700 mt-3 truncate group-hover:text-blue-600",children:e.servicioNombre})]},e.id))})},dj=e=>{var t;let{onProjectAdded:n}=e;const[r,s]=(0,i.useState)({clienteId:"",servicioId:"",proveedorId:"",comentariosApertura:"",fechaApertura:(new Date).toISOString().split("T")[0],precioCotizacionCliente:"",costoProveedor:"",cotizacionClienteRef:"",poClienteRef:"",cotizacionProveedorRef:"",cantidadUnidades:1}),[o,a]=(0,i.useState)(null),l=i.useRef(null),[u,h]=(0,i.useState)({clientes:[],servicios:[],proveedores:[]}),[d,f]=(0,i.useState)(""),[p,m]=(0,i.useState)(!1),g="ecologia y asesoria ambiental"===(null===(t=u.proveedores.find(e=>e.id===r.proveedorId))||void 0===t?void 0:t.nombre.toLowerCase().trim());(0,i.useEffect)(()=>{(async()=>{try{const[e,t,n]=await Promise.all([my(Qg(cg(HR,"usuarios"),$g("rol","==","cliente"))),my(cg(HR,"servicios")),my(cg(HR,"proveedores"))]),i=(e,t)=>(e.nombreCompleto||e.nombre).localeCompare(t.nombreCompleto||t.nombre);h({clientes:e.docs.map(e=>c({id:e.id},e.data())).sort(i),servicios:t.docs.map(e=>c({id:e.id},e.data())).sort(i),proveedores:n.docs.map(e=>c({id:e.id},e.data())).sort(i)})}catch(e){f("Error al cargar datos maestros.")}})()},[]),(0,i.useEffect)(()=>{g&&s(e=>c(c({},e),{},{costoProveedor:"0"}))},[r.proveedorId,g]);const y=e=>{const{name:t,value:n}=e.target;if(s(e=>c(c({},e),{},{[t]:n})),"servicioId"===t){const e=u.servicios.find(e=>e.id===n);a(e)}},v=o&&o.calculoDuracion&&o.calculoDuracion.porUnidad;return(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-8",children:[(0,UR.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Crear Nuevo Proyecto"}),(0,UR.jsxs)("form",{ref:l,onSubmit:async e=>{if(e.preventDefault(),r.clienteId&&r.servicioId&&r.proveedorId){m(!0),f("");try{var t;let e=0;if(o&&o.calculoDuracion)if(o.calculoDuracion.totalHoras)e=o.calculoDuracion.totalHoras;else if(void 0!==o.calculoDuracion.baseHoras){const t=o.calculoDuracion.baseHoras||0,n=o.calculoDuracion.porUnidad||0;e=t+n*(Number(r.cantidadUnidades)||1)}const i=new Date(r.fechaApertura).getFullYear(),c=ug(HR,"contadores","proyectos_".concat(i)),h=await Ty(HR,async e=>{const t=await e.get(c),n=(t.exists()?t.data().consecutivo:0)+1;return e.set(c,{consecutivo:n},{merge:!0}),n}),d=i.toString().slice(-2),f=h.toString().padStart(3,"0"),p=u.clientes.find(e=>e.id===r.clienteId),m=u.servicios.find(e=>e.id===r.servicioId),y=u.proveedores.find(e=>e.id===r.proveedorId),v="".concat(p.clienteIdNumerico,"-").concat(m.servicioIdNumerico,"-").concat(y.proveedorIdNumerico,"-").concat(f).concat(d);await vy(cg(HR,WR),{npu:v,clienteId:r.clienteId,clienteNombre:p.nombreCompleto,servicioId:r.servicioId,servicioNombre:m.nombre,proveedorId:r.proveedorId,proveedorNombre:y.nombre,fechaApertura:Sc.fromDate(new Date(r.fechaApertura)),estado:r.poClienteRef?"Activo":"Cotizaci\xf3n",prioridad:"1 - Normal",dependencia:m.dependencia||"Sin Dependencia",precioCotizacionCliente:Number(r.precioCotizacionCliente)||0,costoProveedor:Number(r.costoProveedor)||0,horasEstimadas:e,horasRegistradas:0,facturasClienteIds:[],facturasProveedorIds:[],faseFacturacion:"N/A",cotizacionClienteRef:r.cotizacionClienteRef,poClienteRef:r.poClienteRef,cotizacionProveedorRef:r.cotizacionProveedorRef,poProveedor:g?"N/A":v.slice(-8),cantidadUnidades:null!==o&&void 0!==o&&null!==(t=o.calculoDuracion)&&void 0!==t&&t.porUnidad?Number(r.cantidadUnidades):null,asignadoTecnicosIds:[],comentariosApertura:r.comentariosApertura,fechaAsignacionTecnico:null,fechaEntregaInterna:null,notasSupervisor:"",fechaFinTecnicoReal:null}),s({clienteId:"",servicioId:"",proveedorId:"",comentariosApertura:"",fechaApertura:(new Date).toISOString().split("T")[0],precioCotizacionCliente:"",costoProveedor:"",cotizacionClienteRef:"",poClienteRef:"",cotizacionProveedorRef:"",cantidadUnidades:1}),a(null),l.current.reset(),n&&n()}catch(i){console.error("Error al crear proyecto:",i),f("Ocurri\xf3 un error: ".concat(i.message))}m(!1)}else f("Cliente, Servicio y Proveedor son obligatorios.")},className:"space-y-6",children:[(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fecha de Apertura"}),(0,UR.jsx)("input",{type:"date",name:"fechaApertura",value:r.fechaApertura,onChange:y,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"})]}),(0,UR.jsxs)("select",{name:"clienteId",value:r.clienteId,onChange:y,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm",children:[(0,UR.jsx)("option",{value:"",children:"Seleccione un Cliente"}),u.clientes.map(e=>(0,UR.jsx)("option",{value:e.id,children:e.nombreCompleto},e.id))]}),(0,UR.jsxs)("select",{name:"servicioId",value:r.servicioId,onChange:y,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm",children:[(0,UR.jsx)("option",{value:"",children:"Seleccione un Proyecto/Servicio"}),u.servicios.map(e=>(0,UR.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,UR.jsxs)("select",{name:"proveedorId",value:r.proveedorId,onChange:y,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm",children:[(0,UR.jsx)("option",{value:"",children:"Seleccione un Proveedor"}),u.proveedores.map(e=>(0,UR.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,UR.jsx)("textarea",{name:"comentariosApertura",value:r.comentariosApertura,onChange:y,placeholder:"Comentarios de apertura",className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"}),v&&(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("label",{className:"block text-sm font-medium text-gray-700 capitalize",children:["Cantidad de ",o.calculoDuracion.nombreUnidad||"Unidades"]}),(0,UR.jsx)("input",{type:"number",name:"cantidadUnidades",value:r.cantidadUnidades,onChange:y,className:"mt-1 block w-full px-3 py-2 border rounded-md"})]})]}),(0,UR.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border-t pt-6",children:[(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-700",children:"Informaci\xf3n del Cliente"}),(0,UR.jsx)("input",{type:"number",name:"precioCotizacionCliente",value:r.precioCotizacionCliente,onChange:y,placeholder:"Precio Cotizaci\xf3n (con IVA)",className:"mt-1 block w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("input",{type:"text",name:"cotizacionClienteRef",value:r.cotizacionClienteRef,onChange:y,placeholder:"N\xba o Referencia de Cotizaci\xf3n",className:"mt-1 block w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("input",{type:"text",name:"poClienteRef",value:r.poClienteRef,onChange:y,placeholder:"N\xba de Orden de Compra (PO)",className:"mt-1 block w-full px-3 py-2 border rounded-md"})]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-700",children:"Informaci\xf3n del Proveedor"}),(0,UR.jsx)("input",{type:"number",name:"costoProveedor",value:r.costoProveedor,onChange:y,placeholder:"Costo (con IVA)",disabled:g,className:"mt-1 block w-full px-3 py-2 border rounded-md disabled:bg-gray-100"}),(0,UR.jsx)("input",{type:"text",name:"cotizacionProveedorRef",value:r.cotizacionProveedorRef,onChange:y,placeholder:"N\xba o Ref. de Cotizaci\xf3n Proveedor",disabled:g,className:"mt-1 block w-full px-3 py-2 border rounded-md"})]})]}),(0,UR.jsx)(XR,{message:d,type:"error",onClose:()=>f("")}),(0,UR.jsx)("button",{type:"submit",disabled:p,className:"w-full bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded-lg disabled:bg-gray-400",children:p?"Creando...":"Crear Proyecto y Generar NPU"})]})]})},fj=e=>{let{projects:t,onUpdateProject:n,userRole:r,supervisorView:s,onManageClick:o,onAssignClick:a,user:l,userData:u,selectedRole:h}=e;const[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(1),[g,y]=(0,i.useState)(10),[v,b]=(0,i.useState)({}),[x,_]=(0,i.useState)({}),[w,C]=(0,i.useState)(null),[k,E]=(0,i.useState)("");(0,i.useEffect)(()=>{const e=(()=>{const e=Qg(cg(HR,"usuarios"),$g("rol","==","tecnico")),t=by(Qg(cg(HR,"usuarios"),$g("roles","array-contains","tecnico")),t=>{const n={};t.forEach(e=>{n[e.id]=e.data().nombreCompleto}),my(e).then(e=>{e.forEach(e=>{n[e.id]||(n[e.id]=e.data().nombreCompleto)}),b(n)})}),n=by(Qg(cg(HR,"facturas")),e=>{const t={};e.forEach(e=>{t[e.id]=e.data().folio}),_(t)});return()=>{t(),n()}})();return()=>e()},[]);const T="administrador"===r?t.filter(e=>{var t,n,i;return(null===(t=e.npu)||void 0===t?void 0:t.toLowerCase().includes(k.toLowerCase()))||(null===(n=e.clienteNombre)||void 0===n?void 0:n.toLowerCase().includes(k.toLowerCase()))||(null===(i=e.servicioNombre)||void 0===i?void 0:i.toLowerCase().includes(k.toLowerCase()))}):t,N=T.slice((p-1)*g,p*g),S=Math.ceil(T.length/g),I=e=>m(e),P=async e=>{var t;await(t=ug(HR,WR,e),xy(ig(t.firestore,fg),[new vd(t._key,sd.none())])),C(null)};return(0,UR.jsxs)(UR.Fragment,{children:["administrador"===r&&(0,UR.jsxs)("div",{className:"mb-4 flex flex-col md:flex-row justify-between items-center",children:[(0,UR.jsx)("input",{type:"text",placeholder:"Buscar por NPU, cliente, servicio o dependencia...",className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md mb-2 md:mb-0",onChange:e=>{E(e.target.value),m(1)}}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:g,onChange:e=>{y(Number(e.target.value)),m(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:25,children:"25"}),(0,UR.jsx)("option",{value:50,children:"50"}),(0,UR.jsx)("option",{value:100,children:"100"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsxs)("thead",{className:"bg-gray-50",children:["supervisor"===r&&"new"===s&&(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha Apertura"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]}),"supervisor"===r&&"techDetail"===s&&(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Estado"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Prioridad"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Horas (Reg/Est)"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase",children:"Ver M\xe1s"})]}),"administrador"===r&&(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha Apertura"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Proveedor"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"N\xba Proy. Lab."}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Comentarios"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Prov."}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Precio"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Costo"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ref. Cliente"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ref. Proveedor"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fact. Cliente"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fact. Proveedor"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estado"}),(0,UR.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})]}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>{var t,n,l,c,u,h;const p=d===e.id;let m="A Tiempo";if("supervisor"===r){var g;const t=new Date;t.setHours(0,0,0,0);const n=null===(g=e.fechaEntregaInterna)||void 0===g?void 0:g.toDate();n?(n.setHours(0,0,0,0),n<t?m="Atrasado":(n-t)/864e5<=3&&(m="Por Vencer")):m="Sin Fecha"}const y=null===(t=e.proveedorNombre)||void 0===t?void 0:t.toLowerCase().includes("ecotech");return(0,UR.jsxs)(i.Fragment,{children:[(0,UR.jsx)("tr",{className:p?"bg-blue-50":"",children:"administrador"===r&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:YR(e.fechaApertura)}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium",children:e.npu}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.proveedorNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(null===(n=e.datosEcotech)||void 0===n?void 0:n.numeroProyecto)||"---"}),(0,UR.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",title:e.comentariosApertura,children:(0,UR.jsx)("p",{className:"w-32 truncate",children:e.comentariosApertura||"---"})}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.poProveedor}),(0,UR.jsxs)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-green-600",children:["$",(e.precioCotizacionCliente||0).toFixed(2)]}),(0,UR.jsxs)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-red-600",children:["$",(e.costoProveedor||0).toFixed(2)]}),(0,UR.jsxs)("td",{className:"px-4 py-2 text-xs",children:[(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Cot:"})," ",e.cotizacionClienteRef||"N/A"]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"PO:"})," ",e.poClienteRef||"N/A"]})]}),(0,UR.jsx)("td",{className:"px-4 py-2 text-xs",children:(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Cot:"})," ",e.cotizacionProveedorRef||"N/A"]})}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:x[e.facturaClienteId]||"---"}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:x[e.facturaProveedorId]||("ecologia y asesoria ambiental"===(null===(l=e.proveedorNombre)||void 0===l?void 0:l.toLowerCase().trim())?"N/A":"---")}),(0,UR.jsx)("td",{className:"px-4 py-2",children:(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("Activo"===e.estado?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"),children:e.estado})}),(0,UR.jsx)("td",{className:"px-4 py-2",children:(0,UR.jsxs)("div",{className:"flex items-center space-x-4",children:["Cotizaci\xf3n"===e.estado&&(0,UR.jsx)("button",{onClick:()=>(async e=>{await yy(ug(HR,WR,e),{estado:"Activo",estadoCliente:"Activo"})})(e.id),className:"text-green-600",children:"Activar"}),(0,UR.jsx)("button",{onClick:()=>o(e),className:"text-indigo-600",children:"Gestionar"}),"Terminado"!==e.estado&&"Archivado"!==e.estado&&(0,UR.jsx)("button",{onClick:()=>{return t=e.id,n=e.npu,void C({title:"Confirmar Eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que quieres borrar el proyecto ".concat(n,"? Esta acci\xf3n no se puede deshacer."),onConfirm:()=>P(t),confirmText:"S\xed, Borrar",confirmColor:"bg-red-600"});var t,n},className:"text-red-600",children:"Borrar"})]})})]})}),"supervisor"===r&&"new"===s&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:YR(e.fechaApertura)}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium",children:e.npu}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-4 py-2",children:(0,UR.jsx)("button",{onClick:()=>a(e),className:"text-indigo-600 font-medium",children:"Asignar"})})]}),"supervisor"===r&&"techDetail"===s&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("td",{className:"px-4 py-3",children:(0,UR.jsx)(wj,{status:m})}),(0,UR.jsx)("td",{className:"px-4 py-3 text-sm",children:e.prioridad||"1 - Normal"}),(0,UR.jsxs)("td",{className:"px-4 py-3 text-sm",children:[(0,UR.jsxs)("span",{className:"font-semibold",children:[(e.horasRegistradas||0).toFixed(1),"h"]})," /",(0,UR.jsxs)("span",{className:"text-gray-600",children:[(e.horasEstimadas||0).toFixed(1),"h"]})]}),(0,UR.jsx)("td",{className:"px-4 py-3 text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-4 py-3",children:(0,UR.jsx)("button",{onClick:()=>{return t=e.id,void f(e=>e===t?null:t);var t},className:"text-indigo-600 font-medium",children:d===e.id?"Ocultar":"Detalles..."})})]}),p&&(0,UR.jsx)("tr",{className:"bg-gray-50 border-b-2 border-blue-200",children:(0,UR.jsx)("td",{colSpan:"5",className:"p-4",children:(0,UR.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-semibold",children:"Cliente:"}),(0,UR.jsx)("p",{children:e.clienteNombre})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-semibold",children:"Fecha L\xedmite (Supervisor):"}),(0,UR.jsx)("p",{children:YR(e.fechaEntregaInterna)})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-semibold",children:"Estado Detallado:"}),e.fechaFinTecnicoReal?(0,UR.jsxs)("p",{className:"text-purple-800",children:["T\xe9cnico finaliz\xf3 el ",YR(e.fechaFinTecnicoReal),". En espera de proveedor."]}):(0,UR.jsx)("p",{className:"text-gray-600",children:"El t\xe9cnico est\xe1 trabajando en el proyecto."})]}),(0,UR.jsxs)("div",{className:"col-span-full",children:[(0,UR.jsx)("p",{className:"font-semibold",children:"Notas del Supervisor:"}),(0,UR.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:e.notasSupervisor||"No hay notas."})]}),y&&(0,UR.jsxs)("div",{className:"col-span-3 border-t pt-2 mt-2",children:[(0,UR.jsx)("p",{className:"font-semibold text-gray-800",children:"Info Ecotech:"}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"N\xba Proy:"})," ",(null===(c=e.datosEcotech)||void 0===c?void 0:c.numeroProyecto)||"N/A",", ",(0,UR.jsx)("strong",{children:"Puntos:"})," ",(null===(u=e.datosEcotech)||void 0===u?void 0:u.puntosDeTrabajo)||"N/A",", ",(0,UR.jsx)("strong",{children:"Estatus:"})," ",(null===(h=e.datosEcotech)||void 0===h?void 0:h.estatus)||"N/A"]})]}),(0,UR.jsxs)("div",{className:"col-span-full flex justify-end items-center space-x-4 border-t pt-3 mt-2",children:[(0,UR.jsx)("button",{onClick:()=>a(e),className:"bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-yellow-600",children:"Reasignar T\xe9cnico"}),(0,UR.jsx)("button",{onClick:()=>o(e),className:"bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700",children:"Gestionar"})]})]})})})]},e.id)})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",p," de ",S]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>I(p-1),disabled:1===p,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>I(p+1),disabled:p===S||0===S,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]}),w&&(0,UR.jsx)(ej,c(c({},w),{},{onCancel:()=>C(null)}))]})},pj=e=>{let{projects:t,onUpdateProject:n}=e;const[r,s]=(0,i.useState)(null);return(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Documentos Finales"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,UR.jsxs)("div",{className:"flex space-x-4",children:[(0,UR.jsx)("button",{onClick:()=>(e=>{const t=!!e.urlDocumento2,n="Preliminar"===e.faseFacturacion||"Fase 2 Pendiente"===e.faseFacturacion;s({action:"approve",payload:{project:e},title:"Confirmar Aprobaci\xf3n",message:t?n?"Aprobar y finalizar este proyecto? Se archivar\xe1 y no se volver\xe1 a facturar.":"Aprobar esta entrega final y enviarla a facturaci\xf3n?":"Aprobar esta entrega preliminar y enviarla a facturaci\xf3n?"})})(e),className:"text-green-600 hover:text-green-900",children:"Aprobar"}),(0,UR.jsx)("button",{onClick:()=>{return t=e.id,void s({action:"reject",payload:{projectId:t},title:"Rechazar Proyecto",message:"Por favor, introduce el motivo del rechazo para notificar al practicante.",confirmText:"Rechazar",confirmColor:"bg-orange-600"});var t},className:"text-orange-600 hover:text-orange-900",children:"Rechazar"})]})}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,UR.jsxs)("div",{className:"flex flex-col space-y-1",children:[e.urlHeyzine&&(0,UR.jsx)("a",{href:e.urlHeyzine,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600",children:"Ver Proyecto (Heyzine)"}),e.fase1_urlNotaEntregaFirmada&&(0,UR.jsx)("a",{href:e.fase1_urlNotaEntregaFirmada,target:"_blank",rel:"noopener noreferrer",className:"text-red-600",children:"Ver Nota 1 (Firmada)"}),e.fase2_urlNotaEntregaFirmada&&(0,UR.jsx)("a",{href:e.fase2_urlNotaEntregaFirmada,target:"_blank",rel:"noopener noreferrer",className:"text-red-600",children:"Ver Nota 2 (Firmada)"})]})}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.npu})]},e.id))})]})}),"approve"===(null===r||void 0===r?void 0:r.action)&&(0,UR.jsx)(ej,{title:r.title,message:r.message,onConfirm:async()=>{if(!r||"approve"!==r.action)return;const{project:e}=r.payload,t=ug(HR,WR,e.id),i=!!e.urlDocumento2;try{i?"Preliminar"===e.faseFacturacion||"Fase 2 Pendiente"===e.faseFacturacion?await yy(t,{estado:"Archivado",estadoCliente:"Terminado"}):await yy(t,{estado:"Pendiente de Factura",estadoCliente:"Terminado"}):await yy(t,{estado:"Pendiente de Factura",faseFacturacion:"Preliminar"})}catch(NS){console.error("Error al aprobar proyecto:",NS),alert("Ocurri\xf3 un error al aprobar el proyecto.")}finally{s(null),n()}},onCancel:()=>s(null)}),"reject"===(null===r||void 0===r?void 0:r.action)&&(0,UR.jsx)(ij,{title:r.title,message:r.message,onConfirm:async e=>{if(!r||"reject"!==r.action)return;if(!e||""===e.trim())return void alert("El motivo del rechazo no puede estar vac\xedo.");const{projectId:t}=r.payload,i=ug(HR,WR,t);try{await yy(i,{estado:"Terminado Internamente",motivoRechazo:e})}catch(NS){console.error("Error al rechazar proyecto:",NS),alert("Ocurri\xf3 un error al rechazar el proyecto.")}finally{s(null),n()}},onCancel:()=>s(null),confirmText:r.confirmText,confirmColor:r.confirmColor})]})},mj=e=>{let{projects:t,onOpenModal:n}=e;const[r,s]=(0,i.useState)(null),o=t.reduce((e,t)=>{const n=t.dependencia||"Sin Dependencia";return e[n]||(e[n]=[]),e[n].push(t),e},{});return(0,UR.jsx)("div",{className:"space-y-4",children:Object.entries(o).map(e=>{let[t,i]=e;return(0,UR.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,UR.jsxs)("button",{onClick:()=>{return s(r===(e=t)?null:e);var e},className:"w-full p-4 text-left font-bold text-lg text-gray-800 flex justify-between items-center hover:bg-gray-50 transition",children:[(0,UR.jsxs)("span",{children:[t," ",(0,UR.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["(",i.length,")"]})]}),(0,UR.jsx)("span",{className:"transform transition-transform duration-300 ".concat(r===t?"rotate-180":""),children:"\u25bc"})]}),r===t&&(0,UR.jsx)("ul",{className:"divide-y divide-gray-200 border-t",children:i.map(e=>{return(0,UR.jsxs)("li",{className:"p-4 md:px-6 md:py-4 flex flex-col md:flex-row md:items-center",children:[(0,UR.jsx)("div",{className:"flex-1 mb-4 md:mb-0",children:(0,UR.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.servicioNombre})}),(0,UR.jsx)("div",{className:"w-full md:w-40 mb-4 md:mb-0",children:(0,UR.jsx)("div",{className:"text-sm text-gray-500 hidden md:block",children:(i=e.fechaApertura,i?new Date(1e3*i.seconds).toLocaleDateString("es-MX"):"---")})}),(0,UR.jsx)("div",{className:"w-full md:w-40 mb-4 md:mb-0",children:(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat((t=e.estadoCliente,"Activo"===t?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800")),children:e.estadoCliente})}),(0,UR.jsxs)("div",{className:"w-full md:w-56 flex items-center space-x-4",children:[e.urlHeyzine&&(0,UR.jsx)("button",{onClick:()=>n(e.urlHeyzine),className:"text-sm font-medium text-blue-600 hover:text-blue-900",children:"Ver Proyecto"}),e.urlNotaPdf1&&(0,UR.jsx)("a",{href:e.urlNotaPdf1,download:!0,className:"text-sm font-medium text-red-600 hover:text-red-900",children:"Nota 1"}),e.urlNotaPdf2&&(0,UR.jsx)("a",{href:e.urlNotaPdf2,download:!0,className:"text-sm font-medium text-red-600 hover:text-red-900",children:"Nota 2"})]})]},e.id);var t,i})})]},t)})})},gj=e=>{let{user:t,userData:n}=e;const[r,s]=(0,i.useState)([]),[o,a]=(0,i.useState)([]),[l,u]=(0,i.useState)(!0),[h,d]=(0,i.useState)("shelf"),[f,p]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!t)return void u(!1);const e=by(Qg(cg(HR,WR),$g("clienteId","==",t.uid),$g("estadoCliente","in",["Activo","Terminado"])),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));t.sort((e,t)=>{var n,i;return((null===(n=t.fechaApertura)||void 0===n?void 0:n.seconds)||0)-((null===(i=e.fechaApertura)||void 0===i?void 0:i.seconds)||0)}),s(t);const n=new Map;t.forEach(e=>{if("Terminado"===e.estadoCliente&&e.urlHeyzine){var t,i;const r=e.servicioId,s=n.get(r);(!s||(null===(t=e.fechaApertura)||void 0===t?void 0:t.seconds)>(null===(i=s.fechaApertura)||void 0===i?void 0:i.seconds))&&n.set(r,e)}}),a(Array.from(n.values())),u(!1)},e=>{console.error("Error fetching client projects: ",e),"failed-precondition"===e.code&&console.error("IMPORTANTE: Se requiere un \xedndice compuesto en Firestore. Ve a la URL que aparece en el mensaje de error en la consola para crearlo con un solo clic."),u(!1)});return()=>e()},[t]),(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:["Proyectos de ",n.nombreCompleto]}),(0,UR.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,UR.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,UR.jsx)("button",{onClick:()=>d("shelf"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("shelf"===h?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Estanter\xeda de Proyectos"}),(0,UR.jsx)("button",{onClick:()=>d("list"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("list"===h?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Lista Detallada"})]})}),l?(0,UR.jsx)("p",{children:"Cargando proyectos..."}):0===r.length?(0,UR.jsx)("p",{className:"text-center text-gray-500 mt-8",children:"No hay proyectos para mostrar."}):"shelf"===h?(0,UR.jsx)(hj,{projects:o,onOpenModal:p}):(0,UR.jsx)(mj,{projects:r,onOpenModal:p}),f&&(0,UR.jsx)(uj,{url:f,onClose:()=>p(null)})]})},yj=e=>{let{chartData:t}=e;const n={labels:t.labels,datasets:[{label:"Valor en Cotizaci\xf3n",data:t.cotizacionData,backgroundColor:"rgba(255, 159, 64, 0.7)"},{label:"Valor Activo",data:t.activoData,backgroundColor:"rgba(54, 162, 235, 0.7)"},{label:"Valor Pdto. Factura",data:t.pendienteFacturaData,backgroundColor:"rgba(255, 206, 86, 0.7)"},{type:"line",label:"Valor Total Ofertado",data:t.totalData,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!0,tension:.2,yAxisID:"y1"}]};return(0,UR.jsx)(bT,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},tooltip:{mode:"index",intersect:!1},legend:{position:"bottom"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0},y1:{position:"right",grid:{drawOnChartArea:!1},beginAtZero:!0}}},data:n})},vj=e=>{let{chartData:t}=e;const n={labels:t.labels,datasets:[{label:"Pagado",data:t.pagadoData,backgroundColor:"rgba(75, 192, 192, 0.7)"},{label:"Programado a Pago",data:t.programadoData,backgroundColor:"rgba(54, 162, 235, 0.7)"},{label:"Vence Hoy",data:t.venceHoyData,backgroundColor:"rgba(255, 159, 64, 0.7)"},{label:"Vencido",data:t.vencidoData,backgroundColor:"rgba(255, 99, 132, 0.7)"},{label:"Pdte. de Programaci\xf3n",data:t.pdteProgramacionData,backgroundColor:"rgba(201, 203, 207, 0.7)"},{type:"line",label:"Total Facturado",data:t.totalFacturadoData,borderColor:"#36A2EB",tension:.2,yAxisID:"y1"}]};return(0,UR.jsx)(bT,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},tooltip:{mode:"index",intersect:!1},legend:{position:"bottom"}},scales:{x:{stacked:!0},y:{stacked:!0,beginAtZero:!0},y1:{position:"right",grid:{drawOnChartArea:!1},beginAtZero:!0}}},data:n})},bj=e=>{let{chartData:t}=e;const n={labels:t.labels,datasets:[{label:"Ingresos Programados",data:t.ingresosData,borderColor:"rgb(54, 162, 235)",backgroundColor:"rgba(54, 162, 235, 0.5)",type:"bar"},{label:"Egresos Programados",data:t.egresosData,borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.5)",type:"bar"}]};return(0,UR.jsx)(bT,{options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1},legend:{position:"bottom"}},scales:{y:{beginAtZero:!0}}},data:n})},xj=e=>{let{chartData:t}=e;const n={labels:t.labels,datasets:[{label:"Proyectos Entregados (Mes Actual)",data:t.completedData,backgroundColor:"rgba(153, 102, 255, 0.7)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1}]};return(0,UR.jsx)(bT,{options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!1}},scales:{x:{beginAtZero:!0,ticks:{stepSize:1}}}},data:n})},_j=e=>{let{title:t,value:n,unit:i="",trend:r=null}=e;return(0,UR.jsxs)("div",{className:"bg-white p-5 rounded-xl shadow-md",children:[(0,UR.jsx)("h3",{className:"font-bold text-gray-500 truncate",children:t}),(0,UR.jsxs)("p",{className:"text-3xl font-bold mt-2",children:[n,(0,UR.jsx)("span",{className:"text-xl font-semibold ml-1",children:i})]})]})},wj=e=>{let{status:t}=e;return(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat({Atrasado:"bg-red-100 text-red-800","Por Vencer":"bg-orange-100 text-orange-800","A Tiempo":"bg-green-100 text-green-800","Sin Fecha":"bg-gray-100 text-gray-600"}[t]||"bg-gray-100"),children:t})},Cj=e=>{let{projects:t,techniciansMap:n}=e;const[r,s]=(0,i.useState)("delivered"),o=(new Date).getMonth(),a=(new Date).getFullYear(),[l,c]=(0,i.useState)(String(o)),[u,h]=(0,i.useState)(a),[d,f]=(0,i.useState)(1),[p,m]=(0,i.useState)(10),{filteredProjects:g,totalSum:y}=i.useMemo(()=>{let e=[];e="delivered"===r?t.filter(e=>{const t=e.fase2_fechaFinTecnico||e.fase1_fechaFinTecnico;return(null===t||void 0===t?void 0:t.toDate().getMonth())===parseInt(l,10)&&(null===t||void 0===t?void 0:t.toDate().getFullYear())===u}):t.filter(e=>{var t,n;return"Activo"===e.estado&&!e.fechaFinTecnicoReal&&(null===(t=e.fechaEntregaInterna)||void 0===t?void 0:t.toDate().getMonth())===parseInt(l,10)&&(null===(n=e.fechaEntregaInterna)||void 0===n?void 0:n.toDate().getFullYear())===u});const n=e.reduce((e,t)=>e+(t.precioCotizacionCliente||0),0);return e.sort((e,t)=>{var n,i;const s=(null===(n="delivered"===r?e.fase2_fechaFinTecnico||e.fase1_fechaFinTecnico:e.fechaEntregaInterna)||void 0===n?void 0:n.toDate())||0;return((null===(i="delivered"===r?t.fase2_fechaFinTecnico||t.fase1_fechaFinTecnico:t.fechaEntregaInterna)||void 0===i?void 0:i.toDate())||0)-s}),{filteredProjects:e,totalSum:n}},[t,r,l,u]),v=g.slice((d-1)*p,d*p),b=Math.ceil(g.length/p),x=e=>f(e),_=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],w=Array.from({length:5},(e,t)=>a-t);return(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg border flex flex-wrap items-center gap-x-6 gap-y-4",children:[(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("label",{className:"text-sm font-medium",children:"Ver:"}),(0,UR.jsxs)("select",{value:r,onChange:e=>{s(e.target.value),f(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:[(0,UR.jsx)("option",{value:"delivered",children:"Entregados en"}),(0,UR.jsx)("option",{value:"pending",children:"Pendientes para"})]})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("label",{className:"text-sm font-medium",children:"Mes:"}),(0,UR.jsx)("select",{value:l,onChange:e=>{c(e.target.value),f(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:_.map((e,t)=>(0,UR.jsx)("option",{value:String(t),children:e},t))})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("label",{className:"text-sm font-medium",children:"A\xf1o:"}),(0,UR.jsx)("select",{value:u,onChange:e=>{h(parseInt(e.target.value,10)),f(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:w.map(e=>(0,UR.jsx)("option",{value:e,children:e},e))})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-2 ml-auto",children:[(0,UR.jsx)("span",{className:"text-sm",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:p,onChange:e=>{m(Number(e.target.value)),f(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:15,children:"15"}),(0,UR.jsx)("option",{value:25,children:"25"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Proyecto"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Monto"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Responsable"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"delivered"===r?"Nota Entrega":"Fecha L\xedmite"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(e=>(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-2",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.servicioNombre}),(0,UR.jsxs)("td",{className:"px-4 py-2 font-semibold",children:["$",(e.precioCotizacionCliente||0).toFixed(2)]}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.responsableNombre}),(0,UR.jsx)("td",{className:"px-4 py-2",children:"delivered"===r?e.notaEntregaNumero:YR(e.fechaEntregaInterna)})]},e.id))}),(0,UR.jsx)("tfoot",{className:"bg-gray-100 border-t-2",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsxs)("td",{className:"px-4 py-3 font-bold text-right text-sm",colSpan:"2",children:["Total ","delivered"===r?"Entregado":"Pendiente"," (",_[l]," ",u,"):"]}),(0,UR.jsxs)("td",{className:"px-4 py-3 font-bold text-lg text-gray-900",children:["$",y.toFixed(2)]}),(0,UR.jsx)("td",{colSpan:"2"})]})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",d," de ",b]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>x(d-1),disabled:1===d,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>x(d+1),disabled:d===b||0===b,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]})]})},kj=e=>{let{title:t,invoices:n,getInvoiceStatusBadge:r}=e;const[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),[c,u]=(0,i.useState)(1),[h,d]=(0,i.useState)(10),{filteredInvoices:f,totalSum:p}=i.useMemo(()=>{let e=s?n.filter(e=>e.estado===s):n;if(a){const t=parseInt(a,10);e=e.filter(e=>{var n;return(null===(n=e.fechaPromesaPago)||void 0===n?void 0:n.toDate().getMonth())===t})}const t=e.reduce((e,t)=>e+(t.monto||0),0);return{filteredInvoices:e,totalSum:t}},[n,s,a]),m=i.useMemo(()=>{const e=new Set;n.forEach(t=>{var n;null!==(n=t.fechaPromesaPago)&&void 0!==n&&n.toDate&&e.add(t.fechaPromesaPago.toDate().getMonth())});const t=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],i=Array.from(e).sort((e,t)=>e-t).map(e=>({value:String(e),label:t[e]}));return[{value:"",label:"Todos los Meses"},...i]},[n]),g=f.slice((c-1)*h,c*h),y=Math.ceil(f.length/h),v=e=>u(e);return(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:t}),(0,UR.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("label",{htmlFor:"".concat(t,"-status-filter"),className:"text-sm font-medium",children:"Estado:"}),(0,UR.jsxs)("select",{id:"".concat(t,"-status-filter"),value:s,onChange:e=>{o(e.target.value),u(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:[(0,UR.jsx)("option",{value:"",children:"Todos"}),(0,UR.jsx)("option",{value:"Pend. de Autorizaci\xf3n",children:"Pend. Autorizaci\xf3n"}),(0,UR.jsx)("option",{value:"Prog. a Pago",children:"Prog. a Pago"}),(0,UR.jsx)("option",{value:"Vencida",children:"Vencida"})]})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("label",{htmlFor:"".concat(t,"-month-filter"),className:"text-sm font-medium",children:"Mes Pago Prog.:"}),(0,UR.jsx)("select",{id:"".concat(t,"-month-filter"),value:a,onChange:e=>{l(e.target.value),u(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:m.map(e=>(0,UR.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:h,onChange:e=>{d(Number(e.target.value)),u(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:15,children:"15"}),(0,UR.jsx)("option",{value:25,children:"25"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Estado"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Monto"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Fecha Prog. Pago"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Planta"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase",children:"Factura"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-2",children:r(e.estado)}),(0,UR.jsxs)("td",{className:"px-4 py-2 font-semibold text-gray-900",children:["$",(e.monto||0).toFixed(2)]}),(0,UR.jsx)("td",{className:"px-4 py-2",children:YR(e.fechaPromesaPago)}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.planta||"N/A"}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.servicio||"General"}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.folio})]},e.id))}),(0,UR.jsx)("tfoot",{className:"bg-gray-100",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-3 font-bold text-right",children:"Total:"}),(0,UR.jsxs)("td",{className:"px-4 py-3 font-bold text-lg text-gray-900",colSpan:"4",children:["$",p.toFixed(2)]})]})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",c," de ",y]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>v(c-1),disabled:1===c,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>v(c+1),disabled:c===y||0===y,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]})]})},Ej=e=>{let{invoices:t,projectsMap:n}=e;const[r,s]=(0,i.useState)(""),[o,a]=(0,i.useState)(1),[l,u]=(0,i.useState)(10),{processedInvoices:h,totalSum:d}=i.useMemo(()=>{const e=t.filter(e=>"Pend. de Autorizaci\xf3n"===e.estado||"Prog. a Pago"===e.estado||"Vencida"===e.estado),i=r?e.filter(e=>e.proveedorNombre===r):e,s=i.reduce((e,t)=>e+(t.monto||0),0);return{processedInvoices:i.map(e=>{let t="N/A";if(e.proyectoId&&"general"!==e.proyectoId){const i=n.get(e.proyectoId);t=i&&i.facturasClienteIds&&i.facturasClienteIds.length>0?"Facturado":"No Facturado"}return c(c({},e),{},{projectBillingStatus:t})}),totalSum:s}},[t,r,n]),f=h.slice((o-1)*l,o*l),p=Math.ceil(h.length/l),m=e=>a(e),g=[...new Set(t.map(e=>e.proveedorNombre))].sort(),y=e=>(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat({Facturado:"bg-green-100 text-green-800","No Facturado":"bg-red-100 text-red-800","N/A":"bg-gray-100 text-gray-700"}[e]||"bg-gray-100"),children:e});return(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Cuentas por Pagar"}),(0,UR.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{htmlFor:"provider-filter",className:"text-sm font-medium mr-2",children:"Filtrar por Proveedor:"}),(0,UR.jsxs)("select",{id:"provider-filter",value:r,onChange:e=>{s(e.target.value),a(1)},className:"border-gray-300 rounded-md p-2 text-sm",children:[(0,UR.jsx)("option",{value:"",children:"Todos"}),g.map(e=>(0,UR.jsx)("option",{value:e,children:e},e))]})]}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:l,onChange:e=>{u(Number(e.target.value)),a(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:15,children:"15"}),(0,UR.jsx)("option",{value:25,children:"25"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Factura"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Proveedor"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Monto"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Fecha Prog. Pago"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Estatus"}),(0,UR.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium",children:"Estatus Cobro"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(e=>{return(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-2",children:e.folio}),(0,UR.jsx)("td",{className:"px-4 py-2",children:e.proveedorNombre||"N/A"}),(0,UR.jsxs)("td",{className:"px-4 py-2 font-semibold text-gray-900",children:["$",(e.monto||0).toFixed(2)]}),(0,UR.jsx)("td",{className:"px-4 py-2",children:YR(e.fechaPromesaPago)}),(0,UR.jsx)("td",{className:"px-4 py-2",children:(t=e.estado,(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat({"Prog. a Pago":"bg-blue-100 text-blue-800","Pend. de Autorizaci\xf3n":"bg-yellow-100 text-yellow-800",Vencida:"bg-red-100 text-yellow-800"}[t]||"bg-gray-100"),children:t}))}),(0,UR.jsx)("td",{className:"px-4 py-2",children:y(e.projectBillingStatus)})]},e.id);var t})}),(0,UR.jsx)("tfoot",{className:"bg-gray-100",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-4 py-3 font-bold text-right",children:"Total:"}),(0,UR.jsxs)("td",{className:"px-4 py-3 font-bold text-lg text-gray-900",colSpan:"4",children:["$",d.toFixed(2)]})]})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",o," de ",p]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>m(o-1),disabled:1===o,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>m(o+1),disabled:o===p||0===p,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]})]})},Tj=()=>{const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(null),[a,l]=(0,i.useState)("kpis");if((0,i.useEffect)(()=>{(async()=>{try{const e=Qg(cg(HR,WR)),t=Qg(cg(HR,"facturas")),n=Qg(cg(HR,"usuarios"),$g("rol","==","tecnico")),[i,r,s]=await Promise.all([my(e),my(t),my(n)]),a=i.docs.map(e=>c({id:e.id},e.data())),l=r.docs.map(e=>c({id:e.id},e.data())),u=((e,t,n)=>{const i=(new Date).getFullYear(),r=(new Date).getMonth(),s=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],o=new Date;o.setHours(0,0,0,0);const a=864e5,l=Array(12).fill(0).map(()=>({cotizacion:0,activo:0,pendienteFactura:0,total:0}));e.forEach(e=>{var t;if(null!==(t=e.fechaApertura)&&void 0!==t&&t.toDate&&e.fechaApertura.toDate().getFullYear()===i){const t=e.fechaApertura.toDate().getMonth(),n=e.precioCotizacionCliente||0;switch(l[t].total+=n,e.estado){case"Cotizaci\xf3n":l[t].cotizacion+=n;break;case"Activo":case"Terminado Internamente":case"En Revisi\xf3n Final":l[t].activo+=n;break;case"Pendiente de Factura":l[t].pendienteFactura+=n}}});const u=Array(12).fill(0).map(()=>({totalFacturado:0,pdteProgramacion:0,programado:0,venceHoy:0,vencido:0,pagado:0}));t.forEach(e=>{var t;if("cliente"===e.tipo&&null!==(t=e.fechaEmision)&&void 0!==t&&t.toDate&&e.fechaEmision.toDate().getFullYear()===i){const t=e.fechaEmision.toDate().getMonth(),i=e.monto||0;if("Cancelada"!==e.estado&&(u[t].totalFacturado+=i),"Pagada"===e.estado)u[t].pagado+=i;else if("Pendiente"===e.estado){var n;if(null!==(n=e.fechaPromesaPago)&&void 0!==n&&n.toDate){const n=e.fechaPromesaPago.toDate();n.setHours(0,0,0,0),n<o?u[t].vencido+=i:n.getTime()===o.getTime()?u[t].venceHoy+=i:u[t].programado+=i}else u[t].pdteProgramacion+=i}}});const h=Array(8).fill(0).map(()=>({ingresos:0,egresos:0})),d=[],f=new Date;for(let c=0;c<8;c++){const e=new Date(f.getTime()+7*c*a);d.push("Sem ".concat(c+1," (").concat(e.getDate(),"/").concat(e.getMonth()+1,")"))}t.forEach(e=>{var t;if("Pendiente"===e.estado&&null!==(t=e.fechaPromesaPago)&&void 0!==t&&t.toDate){const t=e.fechaPromesaPago.toDate(),n=Math.floor((t-f)/a),i=Math.floor(n/7);i>=0&&i<8&&("cliente"===e.tipo?h[i].ingresos+=e.monto||0:"proveedor"===e.tipo&&(h[i].egresos+=e.monto||0))}});const p={};n.forEach(e=>{p[e.id]={name:e.nombreCompleto.split(" ")[0],completed:0}}),e.forEach(e=>{[e.fechaFinTecnico1,e.fechaFinTecnico2].filter(Boolean).forEach(t=>{const n=t.toDate();n.getMonth()===r&&n.getFullYear()===i&&(e.asignadoTecnicosIds||[]).forEach(e=>{p[e]&&(p[e].completed+=1)})})});let m=0,g=0,y=0,v=0,b=0,x=0;e.forEach(e=>{var t,n,i,r;(e.precioCotizacionCliente||0)>0&&(e.costoProveedor||0)>=0&&(m+=(e.precioCotizacionCliente-e.costoProveedor)/e.precioCotizacionCliente,g++),null!==(t=e.fechaAsignacionTecnico)&&void 0!==t&&t.toDate&&null!==(n=e.fechaFinTecnico1)&&void 0!==n&&n.toDate&&(y+=(e.fechaFinTecnico1.toDate()-e.fechaAsignacionTecnico.toDate())/a,v++),null!==(i=e.fechaApertura)&&void 0!==i&&i.toDate&&null!==(r=e.fechaAsignacionTecnico)&&void 0!==r&&r.toDate&&(b+=(e.fechaAsignacionTecnico.toDate()-e.fechaApertura.toDate())/a,x++)});const _={avgMargin:g>0?(m/g*100).toFixed(1):0,avgDeliveryDays:v>0?(y/v).toFixed(1):0,avgActivationDays:x>0?(b/x).toFixed(1):0,invoicedThisMonth:u[r].totalFacturado.toLocaleString("es-MX",{style:"currency",currency:"MXN"})};o.setHours(0,0,0,0);const w={};n.forEach(e=>{w[e.id]=e.nombreCompleto});const C=new Map(e.map(e=>[e.id,e])),k=e.map(e=>{var t;const n=null===(t=e.asignadoTecnicosIds)||void 0===t?void 0:t[0];return c(c({},e),{},{responsableNombre:w[n]||"No Asignado",notaEntregaNumero:e.fase2_numeroNotaInterna||e.fase1_numeroNotaInterna||"N/A",fechaEntregaReal:e.fechaFinTecnicoReal||null})}),E=e=>{const n=new Date;return n.setHours(0,0,0,0),t.filter(t=>t.tipo===e&&"Pagada"!==t.estado&&"Cancelada"!==t.estado).map(e=>{var t;const i=e.proyectoId&&"general"!==e.proyectoId?C.get(e.proyectoId):null;let r="Pend. de Autorizaci\xf3n";if("Pagada"===e.estado)r="Pagada";else if("Cancelada"===e.estado)r="Cancelada";else if(null!==(t=e.fechaPromesaPago)&&void 0!==t&&t.toDate){const t=e.fechaPromesaPago.toDate();t.setHours(0,0,0,0),r=t<n?"Vencida":"Prog. a Pago"}return c(c({},e),{},{estado:r,planta:(null===i||void 0===i?void 0:i.ubicacionCliente)||(null===i||void 0===i?void 0:i.clienteNombre)||e.clienteNombre||e.proveedorNombre||"N/A",servicio:(null===i||void 0===i?void 0:i.servicioNombre)||e.descripcion||"Gasto General"})}).sort((e,t)=>{var n,i;return((null===(n=e.fechaPromesaPago)||void 0===n?void 0:n.toDate())||new Date("2999-12-31"))-((null===(i=t.fechaPromesaPago)||void 0===i?void 0:i.toDate())||new Date("2999-12-31"))})},T=E("cliente"),N=E("proveedor");return{kpis:_,pipeline:{labels:s,cotizacionData:l.map(e=>e.cotizacion),activoData:l.map(e=>e.activo),pendienteFacturaData:l.map(e=>e.pendienteFactura),totalData:l.map(e=>e.total)},accountsReceivable:{labels:s,totalFacturadoData:u.map(e=>e.totalFacturado),pagadoData:u.map(e=>e.pagado),programadoData:u.map(e=>e.programado),venceHoyData:u.map(e=>e.venceHoy),vencidoData:u.map(e=>e.vencido),pdteProgramacionData:u.map(e=>e.pdteProgramacion)},cashFlow:{labels:d,ingresosData:h.map(e=>e.ingresos),egresosData:h.map(e=>e.egresos)},technicianProductivity:{labels:Object.values(p).map(e=>e.name),completedData:Object.values(p).map(e=>e.completed)},allOperationalProjects:k,techniciansMap:w,accountsReceivableList:T,accountsPayableList:N,projectsMap:C}})(a,l,s.docs.map(e=>c({id:e.id},e.data())));o(u)}catch(e){console.error("Error al obtener datos para el dashboard directivo:",e),r("No se pudieron cargar las m\xe9tricas.")}finally{t(!1)}})()},[]),e)return(0,UR.jsx)("div",{className:"text-center py-10",children:"Calculando m\xe9tricas... \u2699\ufe0f"});if(n)return(0,UR.jsx)("div",{className:"text-center py-10 text-red-600",children:n});return(0,UR.jsxs)("div",{className:"space-y-8",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Directivos"}),(0,UR.jsx)("p",{className:"text-gray-600",children:"Vista general de la salud y rendimiento del negocio."})]}),(0,UR.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,UR.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,UR.jsx)("button",{onClick:()=>l("kpis"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("kpis"===a?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"M\xe9tricas y Finanzas"}),(0,UR.jsx)("button",{onClick:()=>l("operativo"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("operativo"===a?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Seguimiento Operativo"}),(0,UR.jsx)("button",{onClick:()=>l("cobrar"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("cobrar"===a?"border-blue-500":"border-transparent text-gray-500"),children:"Cuentas por Cobrar"}),(0,UR.jsx)("button",{onClick:()=>l("pagar"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("pagar"===a?"border-blue-500":"border-transparent text-gray-500"),children:"Cuentas por Pagar"})]})}),"kpis"===a&&(0,UR.jsxs)(UR.Fragment,{children:[(null===s||void 0===s?void 0:s.kpis)&&(0,UR.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[(0,UR.jsx)(_j,{title:"Margen Promedio",value:s.kpis.avgMargin,unit:"%"}),(0,UR.jsx)(_j,{title:"Tiempo Prom. Entrega",value:s.kpis.avgDeliveryDays,unit:"d\xedas"}),(0,UR.jsx)(_j,{title:"Tiempo Prom. Activaci\xf3n",value:s.kpis.avgActivationDays,unit:"d\xedas"}),(0,UR.jsx)(_j,{title:"Facturado (Mes Actual)",value:s.kpis.invoicedThisMonth})]}),(0,UR.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[(0,UR.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Pipeline de Proyectos (Mensual)"}),(0,UR.jsx)("div",{className:"h-80",children:(null===s||void 0===s?void 0:s.pipeline)&&(0,UR.jsx)(yj,{chartData:s.pipeline})})]}),(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[(0,UR.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Salud de Cuentas por Cobrar (Mensual)"}),(0,UR.jsx)("div",{className:"h-80",children:(null===s||void 0===s?void 0:s.accountsReceivable)&&(0,UR.jsx)(vj,{chartData:s.accountsReceivable})})]}),(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[(0,UR.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Flujo de Caja Proyectado (Pr\xf3ximas 8 Semanas)"}),(0,UR.jsx)("div",{className:"h-80",children:(null===s||void 0===s?void 0:s.cashFlow)&&(0,UR.jsx)(bj,{chartData:s.cashFlow})})]}),(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-md",children:[(0,UR.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Productividad por T\xe9cnico (Mes Actual)"}),(0,UR.jsx)("div",{className:"h-80",children:(null===s||void 0===s?void 0:s.technicianProductivity)&&(0,UR.jsx)(xj,{chartData:s.technicianProductivity})})]})]})]}),"operativo"===a&&s&&(0,UR.jsx)(Cj,{projects:s.allOperationalProjects,techniciansMap:s.techniciansMap}),"cobrar"===a&&s&&(0,UR.jsx)(kj,{title:"Cuentas por Cobrar",invoices:s.accountsReceivableList,getInvoiceStatusBadge:e=>(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat({Pagada:"bg-green-100 text-green-800",Vencida:"bg-red-100 text-red-800","Prog. a Pago":"bg-blue-100 text-blue-800","Pend. de Autorizaci\xf3n":"bg-yellow-100 text-yellow-800",Cancelada:"bg-gray-100 text-gray-700"}[e]||"bg-gray-100"),children:e})}),"pagar"===a&&s&&(0,UR.jsx)(Ej,{invoices:s.accountsPayableList,projectsMap:s.projectsMap})]})},Nj=()=>{const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),s=()=>{r(!0);const e=by(Qg(cg(HR,WR),$g("proveedorNombre","==","Ecotech Ingenieria del Medio Ambiente"),$g("estado","==","Activo")),e=>{t(e.docs.map(e=>c({id:e.id},e.data()))),r(!1)},e=>{console.error("Error fetching projects for Ecotech: ",e),r(!1)});return e};return(0,i.useEffect)(()=>{const e=s();return()=>e()},[]),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Gesti\xf3n de Proyectos Ecotech"}),n?(0,UR.jsx)("p",{children:"Cargando proyectos de Ecotech..."}):0===e.length?(0,UR.jsx)("p",{className:"text-center text-gray-500 mt-8",children:"No hay proyectos de Ecotech activos."}):(0,UR.jsx)(Sj,{projects:e,onUpdateProject:s})]})},Sj=e=>{let{projects:t,onUpdateProject:n}=e;const[r,s]=(0,i.useState)(null),[o,a]=(0,i.useState)(""),[l,c]=(0,i.useState)(1),[u,h]=(0,i.useState)(10),d=e=>{var t,n,r,s,o,a,l,c,u,h,d,f;let{project:p,onClose:m,onFinalized:g}=e;const[y,v]=(0,i.useState)((null===(t=p.datosEcotech)||void 0===t?void 0:t.numeroProyecto)||""),[b,x]=(0,i.useState)((null===(n=p.datosEcotech)||void 0===n?void 0:n.puntosDeTrabajo)||""),[_,w]=(0,i.useState)((null===(r=p.datosEcotech)||void 0===r?void 0:r.notas)||""),[C,k]=(0,i.useState)((null===(s=p.datosEcotech)||void 0===s?void 0:s.numeroGuiaEnvio)||""),[E,T]=(0,i.useState)((null===(o=p.datosEcotech)||void 0===o?void 0:o.numeroGuiaRegreso)||""),[N,S]=(0,i.useState)((null===(a=p.datosEcotech)||void 0===a?void 0:a.fechaMuestreo)||""),[I,P]=(0,i.useState)(!1),A=async e=>{P(!0);const t=ug(HR,WR,p.id);try{await yy(t,e),g(),m()}catch(n){alert("Error al actualizar el estado."),P(!1)}};return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-2",children:["Gestionar Proyecto Ecotech: ",p.npu]}),(0,UR.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Estado actual: ",(0,UR.jsx)("span",{className:"font-bold",children:(null===(l=p.datosEcotech)||void 0===l?void 0:l.estatus)||"Pendiente"})]}),(0,UR.jsxs)("div",{className:"space-y-4 mb-6",children:["Pendiente"===(null===(c=p.datosEcotech)||void 0===c?void 0:c.estatus)&&(0,UR.jsx)("button",{onClick:()=>A({"datosEcotech.estatus":"Pend. No de proyecto"}),className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg",children:"Empezar Tarea"}),"Pend. No de proyecto"===(null===(u=p.datosEcotech)||void 0===u?void 0:u.estatus)&&(0,UR.jsxs)("div",{className:"p-4 border rounded-md bg-gray-50",children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Introduce la Fecha de Muestreo"}),(0,UR.jsx)("input",{type:"date",value:N,onChange:e=>S(e.target.value),className:"mt-1 block w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("button",{onClick:()=>A({"datosEcotech.estatus":"En Proceso","datosEcotech.fechaMuestreo":Sc.fromDate(new Date(N))}),disabled:!N,className:"w-full mt-3 bg-blue-600 text-white font-bold py-2 rounded-lg disabled:bg-gray-400",children:'Guardar Fecha y Poner "En Proceso"'})]}),"En Proceso"===(null===(h=p.datosEcotech)||void 0===h?void 0:h.estatus)&&(0,UR.jsx)("button",{onClick:()=>A({"datosEcotech.estatus":"Enviado Dig.","datosEcotech.fechaEnvioDigital":Sc.now()}),className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg",children:'Marcar como "Enviado Digitalmente"'}),"Enviado Dig."===(null===(d=p.datosEcotech)||void 0===d?void 0:d.estatus)&&(0,UR.jsxs)("div",{className:"p-4 border rounded-md bg-gray-50",children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Introduce la Gu\xeda de Env\xedo F\xedsico"}),(0,UR.jsx)("input",{type:"text",value:C,onChange:e=>k(e.target.value),placeholder:"N\xfamero de gu\xeda...",className:"mt-1 block w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("button",{onClick:()=>A({"datosEcotech.estatus":"Enviado F\xedsicamente","datosEcotech.numeroGuiaEnvio":C}),disabled:!C,className:"w-full mt-3 bg-blue-600 text-white font-bold py-2 rounded-lg disabled:bg-gray-400",children:'Marcar como "Enviado F\xedsicamente"'})]}),"Enviado F\xedsicamente"===(null===(f=p.datosEcotech)||void 0===f?void 0:f.estatus)&&(0,UR.jsxs)("div",{className:"p-4 border rounded-md bg-gray-50",children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Introduce la Gu\xeda de Regreso para Finalizar"}),(0,UR.jsx)("input",{type:"text",value:E,onChange:e=>T(e.target.value),placeholder:"N\xfamero de gu\xeda...",className:"mt-1 block w-full px-3 py-2 border rounded-md"}),(0,UR.jsx)("button",{onClick:()=>A({"datosEcotech.estatus":"Terminado","datosEcotech.numeroGuiaRegreso":E}),disabled:!E,className:"w-full mt-3 bg-green-600 text-white font-bold py-2 rounded-lg disabled:bg-gray-400",children:"Finalizar Proyecto"})]})]}),(0,UR.jsxs)("div",{className:"space-y-4 border-t pt-6",children:[(0,UR.jsx)("h4",{className:"text-md font-semibold text-gray-800",children:"Informaci\xf3n Adicional"}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"N\xfamero de Proyecto (Laboratorio)"}),(0,UR.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value),className:"mt-1 block w-full px-3 py-2 border rounded-md"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Puntos de Trabajo"}),(0,UR.jsx)("input",{type:"number",value:b,onChange:e=>x(e.target.value),className:"mt-1 block w-full px-3 py-2 border rounded-md"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Notas"}),(0,UR.jsx)("textarea",{value:_,onChange:e=>w(e.target.value),rows:"3",className:"mt-1 block w-full px-3 py-2 border rounded-md"})]})]}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:m,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:"Cerrar"}),(0,UR.jsx)("button",{onClick:async()=>{P(!0);const e=ug(HR,WR,p.id);try{await yy(e,{"datosEcotech.numeroProyecto":y,"datosEcotech.puntosDeTrabajo":Number(b)||0,"datosEcotech.notas":_,"datosEcotech.numeroGuiaEnvio":C,"datosEcotech.numeroGuiaRegreso":E}),g()}catch(t){alert("No se pudieron guardar los cambios.")}finally{P(!1)}},className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded",children:I?"Guardando...":"Guardar Cambios"})]})]})})},f=t.filter(e=>e.npu&&e.npu.toLowerCase().includes(o.toLowerCase())||e.clienteNombre&&e.clienteNombre.toLowerCase().includes(o.toLowerCase())||e.servicioNombre&&e.servicioNombre.toLowerCase().includes(o.toLowerCase())),p=l*u,m=p-u,g=f.slice(m,p),y=Math.ceil(f.length/u),v=e=>c(e);return(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsxs)("div",{className:"mb-4 flex flex-col md:flex-row justify-between items-center",children:[(0,UR.jsx)("input",{type:"text",placeholder:"Buscar por NPU, cliente o servicio...",className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md mb-2 md:mb-0",onChange:e=>{a(e.target.value),c(1)}}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:u,onChange:e=>{h(Number(e.target.value)),c(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:25,children:"25"}),(0,UR.jsx)("option",{value:50,children:"50"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"N\xba Proyecto Lab."}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Puntos"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notas"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Gu\xeda Env\xedo"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Gu\xeda Regreso"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estatus Interno"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(e=>{var t,n,i,r,o,a;const l=(e=>{var t,n,i,r,s,o;const a=new Date;return a.setHours(0,0,0,0),"Terminado"===(null===(t=e.datosEcotech)||void 0===t?void 0:t.estatus)?{text:"Terminado",class:"bg-blue-100 text-blue-800"}:null!==(n=e.datosEcotech)&&void 0!==n&&null!==(i=n.fechaEnvioDigital)&&void 0!==i&&i.toDate?a>$R(null===(l=e.datosEcotech)||void 0===l?void 0:l.fechaEnvioDigital.toDate(),15)?{text:"Vencido Lab.",class:"bg-red-100 text-red-800 font-bold"}:{text:null===(c=e.datosEcotech)||void 0===c?void 0:c.estatus,class:"bg-green-100 text-green-800"}:null!==(r=e.datosEcotech)&&void 0!==r&&null!==(s=r.fechaMuestreo)&&void 0!==s&&s.toDate?a>$R(null===(u=e.datosEcotech)||void 0===u?void 0:u.fechaMuestreo.toDate(),3)?{text:"Vencido Internamente",class:"bg-orange-100 text-orange-800 font-semibold"}:{text:null===(h=e.datosEcotech)||void 0===h?void 0:h.estatus,class:"bg-green-100 text-green-800"}:{text:(null===(o=e.datosEcotech)||void 0===o?void 0:o.estatus)||"Pendiente",class:"bg-gray-100 text-gray-700"};var l,c,u,h})(e);return(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.npu}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(null===(t=e.datosEcotech)||void 0===t?void 0:t.numeroProyecto)||"---"}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(null===(n=e.datosEcotech)||void 0===n?void 0:n.puntosDeTrabajo)||"---"}),(0,UR.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",title:null===(i=e.datosEcotech)||void 0===i?void 0:i.notas,children:(0,UR.jsx)("p",{className:"w-40 truncate",children:(null===(r=e.datosEcotech)||void 0===r?void 0:r.notas)||"---"})}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(null===(o=e.datosEcotech)||void 0===o?void 0:o.numeroGuiaEnvio)||"---"}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(null===(a=e.datosEcotech)||void 0===a?void 0:a.numeroGuiaRegreso)||"---"}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(l.class),children:l.text})}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,UR.jsx)("button",{onClick:()=>s(e),className:"text-indigo-600 hover:text-indigo-900",children:"Gestionar"})})]},e.id)})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",l," de ",y]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>v(l-1),disabled:1===l,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>v(l+1),disabled:l===y||0===y,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]}),r&&(0,UR.jsx)(d,{project:r,onClose:()=>s(null),onFinalized:n})]})},Ij=e=>{let{techData:t}=e;const{nombre:n,proyectosActivos:i,proyectosEntregados:r,horasAsignadas:s,capacidadSemanal:o,saturacion:a,diasParaTerminar:l,rendimiento:c}=t;return(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200 flex flex-col space-y-4",children:[(0,UR.jsx)("h3",{className:"text-xl font-bold text-gray-800 truncate",children:n}),(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-600",children:[(0,UR.jsx)("span",{children:"Saturaci\xf3n (Horas Semanales)"}),(0,UR.jsxs)("span",{children:[s.toFixed(1),"h / ",o,"h"]})]}),(0,UR.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-4 mt-1",children:(0,UR.jsx)("div",{className:"h-4 rounded-full ".concat((u=a,u>100?"bg-red-500":u>85?"bg-yellow-500":"bg-green-500")),style:{width:"".concat(Math.min(a,100),"%")}})}),a>100&&(0,UR.jsxs)("p",{className:"text-xs text-red-600 font-semibold mt-1",children:["\xa1Sobrecargado por ",(a-100).toFixed(0),"%!"]})]}),(0,UR.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center border-t border-b py-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"text-2xl font-bold",children:i}),(0,UR.jsx)("p",{className:"text-sm text-gray-500",children:"Proyectos Activos"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"text-2xl font-bold",children:r}),(0,UR.jsx)("p",{className:"text-sm text-gray-500",children:"Entregados (2025)"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"text-2xl font-bold",children:l.toFixed(1)}),(0,UR.jsx)("p",{className:"text-sm text-gray-500",children:"D\xedas para Terminar"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("p",{className:"text-2xl font-bold ".concat((e=>e<80?"text-red-600":e<100?"text-orange-500":"text-green-600")(c)),children:[c.toFixed(0),"%"]}),(0,UR.jsx)("p",{className:"text-sm text-gray-500",children:"Rendimiento (Est. vs Real)"})]})]})]});var u},Pj=e=>{let{user:t,userData:n,selectedRole:r}=e;const[s,o]=(0,i.useState)("new"),[a,l]=(0,i.useState)([]),[u,h]=(0,i.useState)([]),[d,f]=(0,i.useState)([]),[p,m]=(0,i.useState)(!0),[g,y]=(0,i.useState)(null),[v,b]=(0,i.useState)(null),x=async()=>{try{const e=Qg(cg(HR,WR),$g("estado","!=","Cotizaci\xf3n")),t=Qg(cg(HR,"usuarios"),$g("rol","==","tecnico")),n=Qg(cg(HR,"usuarios"),$g("roles","array-contains","tecnico")),i=Qg(cg(HR,WR),$g("estado","==","En Revisi\xf3n Final")),[r,s,o,a]=await Promise.all([my(e),my(t),my(n),my(i)]),u=r.docs.map(e=>c({id:e.id},e.data())),d=new Map;s.forEach(e=>d.set(e.id,c({id:e.id},e.data()))),o.forEach(e=>d.set(e.id,c({id:e.id},e.data()))),l(u),h(Array.from(d.values())),f(a.docs.map(e=>c({id:e.id},e.data())))}catch(e){console.error("Error fetching supervisor data:",e)}finally{m(!1)}};(0,i.useEffect)(()=>{m(!0),x()},[]),(0,i.useEffect)(()=>{if("review"!==s)return void f([]);const e=by(Qg(cg(HR,WR),$g("estado","==","En Revisi\xf3n Final")),e=>{f(e.docs.map(e=>c({id:e.id},e.data())))});return()=>e()},[s]);const _=i.useMemo(()=>{if(0===u.length)return{healthData:[],newProjects:[],projectsByTechnician:{}};const e=u.map(e=>{const t=a.filter(t=>{var n;return null===(n=t.asignadoTecnicosIds)||void 0===n?void 0:n.includes(e.id)}),n=t.filter(e=>"Activo"===e.estado&&!e.fechaFinTecnicoReal),i=n.reduce((e,t)=>e+Math.max(0,(t.horasEstimadas||0)-(t.horasRegistradas||0)),0),r=5*(e.horasDisponiblesDiarias||8),s=r>0?i/r*100:0,o=(e.horasDisponiblesDiarias||8)>0?i/(e.horasDisponiblesDiarias||8):0,l=a.filter(t=>{var n,i;return(null===(n=t.asignadoTecnicosIds)||void 0===n?void 0:n.includes(e.id))&&("Archivado"===t.estado||"Facturado"===t.estado)&&(null===(i=t.fase1_fechaFinTecnico||t.fechaFinTecnicoReal)||void 0===i?void 0:i.toDate().getFullYear())===(new Date).getFullYear()}).length,c=a.filter(t=>{var n;return(null===(n=t.asignadoTecnicosIds)||void 0===n?void 0:n.includes(e.id))&&t.horasEstimadas>0&&t.horasRegistradas>0&&t.fechaFinTecnicoReal});let u=100;if(c.length>0){const e=c.reduce((e,t)=>e+t.horasEstimadas/t.horasRegistradas,0);u=e/c.length*100}return{id:e.id,nombre:e.nombreCompleto,proyectosActivos:n.length,proyectosEntregados:l,horasAsignadas:i,capacidadSemanal:r,saturacion:s,diasParaTerminar:o,rendimiento:u}}),t=a.filter(e=>"Activo"===e.estado&&(!e.asignadoTecnicosIds||0===e.asignadoTecnicosIds.length)),n={};u.forEach(e=>{n[e.id]=a.filter(t=>{var n;return"Activo"===t.estado&&(null===(n=t.asignadoTecnicosIds)||void 0===n?void 0:n.includes(e.id))}),n[e.id].sort((e,t)=>(t.prioridad||"").localeCompare(e.prioridad||""))});const i=a.filter(e=>"En Revisi\xf3n Final"===e.estado);return{healthData:e,newProjects:t,projectsByTechnician:n,projectsForReview:i}},[a,u]);return(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Panel de Supervisi\xf3n"}),p?(0,UR.jsx)("p",{children:"Calculando m\xe9tricas..."}):(0,UR.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr,3fr] gap-8",children:[(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsx)("h2",{className:"text-lg font-semibold text-gray-700",children:"Vistas de Gesti\xf3n"}),(0,UR.jsx)("button",{onClick:()=>o("new"),className:"w-full p-3 rounded-lg text-left transition-colors ".concat("new"===s?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-50"),children:(0,UR.jsxs)("div",{className:"flex justify-between items-center",children:[(0,UR.jsx)("span",{className:"font-bold",children:"Nuevos por Asignar"}),_.newProjects.length>0&&(0,UR.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold text-white bg-red-500 rounded-full",children:_.newProjects.length})]})}),(0,UR.jsx)("button",{onClick:()=>o("review"),className:"w-full p-3 rounded-lg text-left transition-colors ".concat("review"===s?"bg-blue-600 text-white shadow-lg":"bg-white hover:bg-gray-50"),children:(0,UR.jsxs)("div",{className:"flex justify-between items-center",children:[(0,UR.jsx)("span",{className:"font-bold",children:"Revisi\xf3n Final"}),d.length>0&&(0,UR.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold text-white bg-red-500 rounded-full",children:d.length})]})}),(0,UR.jsx)("hr",{className:"my-4"}),(0,UR.jsx)("h2",{className:"text-lg font-semibold text-gray-700",children:"Equipo T\xe9cnico"}),(0,UR.jsx)("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto pr-2",children:_.healthData.map(e=>(0,UR.jsx)("button",{onClick:()=>o(e.id),className:"w-full text-left transition-colors ".concat(s===e.id?"ring-2 ring-blue-500":""),children:(0,UR.jsx)(Ij,{techData:e})},e.id))})]}),(0,UR.jsxs)("div",{className:"min-w-0",children:["new"===s&&(0,UR.jsx)(fj,{projects:_.newProjects,userRole:"supervisor",supervisorView:"new",onAssignClick:b,user:t,userData:n,selectedRole:r}),"review"===s&&(0,UR.jsx)(pj,{projects:d,onUpdateProject:x}),_.projectsByTechnician[s]&&(0,UR.jsx)(fj,{projects:_.projectsByTechnician[s],userRole:"supervisor",supervisorView:"techDetail",onManageClick:y,onAssignClick:b,user:t,userData:n,selectedRole:r})]})]}),g&&(0,UR.jsx)(nj,{project:g,onClose:()=>y(null),onUpdate:x,user:t,userData:n,userRole:"supervisor"}),v&&(0,UR.jsx)(tj,{project:v,onClose:()=>b(null),onFinalized:x})]})},Aj=e=>{var t;let{user:n,userData:r,selectedRole:s,setIsWorkingState:o}=e;const[a,l]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(!0),[g,y]=(0,i.useState)(null),[v,b]=(0,i.useState)(""),[x,_]=(0,i.useState)(null),[w,C]=(0,i.useState)(!0),[k,E]=(0,i.useState)(null),T=(N=null===r||void 0===r||null===(t=r.ultimoDescanso)||void 0===t?void 0:t.toDate(),S=new Date,!(!N||!S)&&N.getFullYear()===S.getFullYear()&&N.getMonth()===S.getMonth()&&N.getDate()===S.getDate());var N,S;const I=i.useCallback(async e=>{const t=ug(HR,"usuarios",n.uid),i={projectId:e,inicio:Sc.now()};if(d&&d.projectId){const e=ug(cg(HR,"registrosDeTiempo"));await gy(e,{tecnicoId:n.uid,projectId:d.projectId,fechaInicio:d.inicio,fechaFin:Sc.now()})}const r=ug(HR,WR,e);await yy(r,{["tecnicosStatus.".concat(n.uid)]:"En Proceso"}),await yy(t,{tareaActiva:i})},[n,d]),P=i.useCallback(async()=>{if(!d)return;const e=ug(HR,"usuarios",n.uid),t=ug(cg(HR,"registrosDeTiempo"));await gy(t,{tecnicoId:n.uid,projectId:d.projectId,fechaInicio:d.inicio,fechaFin:Sc.now()}),await yy(e,{tareaActiva:Ny()})},[n,d]),A=i.useCallback(async()=>{d&&await P(),XT.info("Tu jornada finalizo el cron\xf3metro se ha detenido.")},[d,P]),D=i.useCallback(async()=>{if(!d)return;await P();const e=ug(HR,"usuarios",n.uid);await yy(e,{enDescanso:{inicio:Sc.now(),proyectoPausadoId:d.projectId},ultimoDescanso:Sc.now()})},[d,P,n.uid]),R=i.useCallback(async()=>{if(!k||null===n||void 0===n||!n.uid)return;const e=ug(HR,"usuarios",n.uid);await I(k.proyectoPausadoId),await yy(e,{enDescanso:Ny()})},[k,I,n]);(0,i.useEffect)(()=>{if(null===n||void 0===n||!n.uid)return m(!1),f(null),E(null),void o(!1);m(!0);const e=by(ug(HR,"usuarios",n.uid),async e=>{const t=e.data(),n=null===t||void 0===t?void 0:t.tareaActiva,i=null===t||void 0===t?void 0:t.enDescanso;if(E(i||null),n&&n.projectId)try{const e=ug(HR,WR,n.projectId),t=await fy(e);f(c(c({},n),{},{projectId:t.id,projectDetails:t.exists()?c({id:t.id},t.data()):null})),o(!0)}catch(r){console.error("Error fetching active project details:",r),f(null),o(!1)}else f(null),o(!1);i&&o(!1),m(!1)},e=>{console.error("Error listening to user document:",e),m(!1),f(null),E(null),o(!1)});return()=>e()},[n,o]),(0,i.useEffect)(()=>{if(!k)return;const e=k.inicio.toMillis()+45e5-Date.now();if(e<=0)return void R();const t=setTimeout(R,e);return()=>clearTimeout(t)},[k,R]),(0,i.useEffect)(()=>{if(null===n||void 0===n||!n.uid)return l([]),void h(!1);h(!0);const e=by(Qg(cg(HR,WR),$g("asignadoTecnicosIds","array-contains",n.uid),$g("estado","==","Activo")),e=>{l(e.docs.map(e=>c({id:e.id},e.data()))),h(!1)},e=>{console.error("Error fetching technician projects:",e),l([]),h(!1)});return()=>e()},[n]);const j=e=>{_({title:"Confirmar Finalizaci\xf3n T\xe9cnica",message:"Esta acci\xf3n registrar\xe1 la fecha de hoy como tu fin de tarea, el proyecto seguira activo hasta que generes la nota de entrega. \xbfEst\xe1s seguro?",onConfirm:()=>(async e=>{const t=ug(HR,WR,e);try{await yy(t,{fechaFinTecnicoReal:Sc.now()}),XT.success("Tarea t\xe9cnica finalizada y registrada.")}catch(n){alert("Error al finalizar la tarea t\xe9cnica.")}_(null)})(e),confirmText:"S\xed, Finalizar"})},{newProjectsCount:M,kanbanProjects:O}=i.useMemo(()=>{if(null===n||void 0===n||!n.uid)return{newProjectsCount:0,kanbanProjects:[]};const e=a.sort((e,t)=>(t.prioridad||"").localeCompare(e.prioridad||"")),t=a.filter(e=>{var t;return"No Visto"===(null===(t=e.tecnicosStatus)||void 0===t?void 0:t[n.uid])}).length;return{newProjectsCount:t,kanbanProjects:e}},[a,n]),L=e=>{let{project:t,onClose:n,onFinalized:r}=e;const[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)(null),[c,u]=(0,i.useState)(!1),[h,d]=(0,i.useState)("");return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Gestionar Tarea: ",t.npu]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Comentarios Finales (para Nota de Entrega)"}),(0,UR.jsx)("textarea",{value:s,onChange:e=>o(e.target.value),rows:"4",className:"mt-1 block w-full px-3 py-2 border rounded-md"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Subir Evidencia T\xe9cnica (PDF)"}),(0,UR.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{e.target.files[0]&&l(e.target.files[0])},className:"mt-1 block w-full text-sm"})]})]}),(0,UR.jsx)(XR,{message:h,type:"error",onClose:()=>d("")}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:n,disabled:c,className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{if(a){u(!0),d("");try{const e=ib(sb(GR,"evidencia_tecnicos/".concat(t.id,"/").concat(Date.now(),"_").concat(a.name)),a),i=await rb((await e).ref),{numeroNota:o}=await(async()=>{if("undefined"===typeof window.jspdf)throw new Error("La librer\xeda para generar PDFs (jsPDF) no se ha cargado.");const{jsPDF:e}=window.jspdf,n=new e,i=(new Date).getFullYear(),r=ug(HR,"contadores","notas_entrega_".concat(i)),o=await Ty(HR,async e=>{const t=await e.get(r),n=(t.exists()?t.data().consecutivo:0)+1;return e.set(r,{consecutivo:n},{merge:!0}),n}),a="".concat(i,"-").concat(o.toString().padStart(4,"0")),l=await fetch("https://www.grupoevelsa.com/assets/images/Logo Evelsa 2.png"),c=await l.blob(),u=new FileReader;await new Promise((e,t)=>{u.onload=e,u.onerror=t,u.readAsDataURL(c)});const h=u.result;n.addImage(h,"PNG",15,15,50,15),n.setFont("helvetica","bold"),n.setFontSize(10),n.text("ECOLOG\xcdA Y ASESOR\xcdA AMBIENTAL S. DE R.L. DE C.V.",105,35,{align:"center"}),n.setFont("helvetica","normal"),n.setFontSize(8),n.text("HERMANOS ESCOBAR 6150-2 PARQUE INDUSTRIAL OMEGA",105,40,{align:"center"}),n.text("CP.32410 CD. JU\xc1REZ, CHIHUAHUA. RFC EAA12060765A",105,44,{align:"center"}),n.setFontSize(16),n.setFont("helvetica","bold"),n.text("NOTA DE ENTREGA",105,55,{align:"center"}),n.text(a,180,65),n.setFontSize(11),n.setFont("helvetica","normal"),n.text("FECHA: ".concat((new Date).toLocaleDateString("es-MX")),20,75),n.text("PROYECTO: ".concat(t.npu),20,85),n.text("NOMBRE/RAZ\xd3N SOCIAL: ".concat(t.clienteNombre),20,95),n.rect(15,105,180,40),n.text("DESCRIPCI\xd3N",20,111),n.text("CANTIDAD",170,111);const d=n.splitTextToSize(t.servicioNombre,145);n.text(d,20,118),n.text("1",175,118),n.text("Comentarios:",20,155);const f=n.splitTextToSize(s,170);return n.text(f,20,162),n.text("RECIBIDO POR:",20,250),n.line(20,260,100,260),n.text("NOMBRE Y FIRMA",45,265),n.save("Nota_Entrega_".concat(a,".pdf")),{numeroNota:a}})(),l=ug(HR,WR,t.id),c={estado:"Terminado Internamente"},u=Sc.now();t.fase1_fechaFinTecnico?(c.fase2_comentariosTecnico=s,c.fase2_urlEvidencia=i,c.fase2_numeroNotaInterna=o,c.fase2_fechaFinTecnico=u):(c.fase1_comentariosTecnico=s,c.fase1_urlEvidencia=i,c.fase1_numeroNotaInterna=o,c.fase1_fechaFinTecnico=u),t.fechaFinTecnicoReal||(c.fechaFinTecnicoReal=u),await yy(l,c),r(),n()}catch(e){console.error("Error al completar la tarea:",e),d(e.message||"Ocurri\xf3 un error al guardar los datos."),u(!1)}}else d("Es obligatorio subir el archivo PDF de evidencia.")},disabled:c,className:"bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded",children:c?"Enviando...":"Generar Nota y Finalizar Tarea"})]})]})})},F=e=>{let{project:t}=e;const n=(null===d||void 0===d?void 0:d.projectId)===t.id,i=n?"Trabajando en este":d?"Cambiar a este Proyecto":"Empezar a Trabajar";return(0,UR.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-md border-l-4 transition-all ".concat(n?"ring-2 ring-blue-500":""," ").concat("3 - Urgente"===t.prioridad?"border-red-500":"2 - Alta"===t.prioridad?"border-orange-500":"border-gray-300"),children:[(0,UR.jsx)("p",{className:"font-bold text-gray-800",children:t.servicioNombre}),(0,UR.jsx)("p",{className:"text-sm text-gray-600",children:t.clienteNombre}),(0,UR.jsx)("p",{className:"text-sm text-gray-400",children:t.npu}),(0,UR.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["Prioridad: ",(0,UR.jsx)("span",{className:"font-semibold",children:t.prioridad||"N/A"})]}),(0,UR.jsx)("button",{onClick:()=>I(t.id),disabled:n||k,className:"w-full mt-4 bg-green-600 text-white font-bold py-2 rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed hover:bg-green-700",children:i})]})},z=e=>{var t;let{project:n}=e;if(!n)return null;const i=null===(t=n.projectDetails.proveedorNombre)||void 0===t?void 0:t.toLowerCase().includes("ecologia"),r=!!n.projectDetails.fechaFinTecnicoReal;return(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Herramientas para: ",n.projectDetails.npu]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsx)("button",{onClick:()=>{y(n.projectDetails),b("log")},className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-700",children:"Ver Bit\xe1cora"}),i?(0,UR.jsx)("button",{onClick:()=>{y(n.projectDetails),b("task")},className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:"Generar Nota de Entrega"}):(0,UR.jsxs)(UR.Fragment,{children:[!r&&(0,UR.jsx)("button",{onClick:()=>j(n.projectId),className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Finalizar Parte T\xe9cnica"}),r&&(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("p",{className:"text-center p-2 bg-green-100 text-green-800 rounded-md text-sm font-semibold",children:"Parte T\xe9cnica Finalizada (En espera de proveedor)"}),(0,UR.jsx)("button",{onClick:()=>{y(n.projectDetails),b("task")},className:"w-full text-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:"Generar Nota de Entrega Final"})]})]})]})]})},U=()=>(0,UR.jsxs)("div",{className:"text-center p-10 bg-white rounded-lg shadow-lg h-full flex flex-col justify-center",children:[(0,UR.jsx)("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"\xbfEn qu\xe9 vas a trabajar hoy?"}),(0,UR.jsx)("p",{className:"text-gray-500",children:"Selecciona un proyecto de tu Kanban para empezar trabajar en un proyecto."})]}),V=u||p;return(0,UR.jsxs)("div",{children:[k&&(0,UR.jsx)(QR,{breakInfo:k,onEndBreak:R}),d&&!k&&(0,UR.jsx)(Dj,{task:d,onEndDay:A,onStartBreak:D,breakTakenToday:T}),M>0&&w&&(0,UR.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6 rounded-md shadow-md relative",role:"alert",children:[(0,UR.jsx)("button",{onClick:()=>C(!1),className:"absolute top-2 right-2 text-yellow-700 font-bold text-lg",children:"\xd7"}),(0,UR.jsx)("p",{className:"font-bold",children:"\xa1Atenci\xf3n!"}),(0,UR.jsxs)("p",{children:["Tienes ",M," proyecto(s) nuevo(s) asignado(s). \xa1Rev\xedsalos en tu Kanban!"]})]}),(0,UR.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[2fr,1fr] gap-8",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Mi Kanban de Tareas"}),V?(0,UR.jsx)("p",{children:"Cargando..."}):(0,UR.jsx)("div",{className:"space-y-4 max-h-[75vh] overflow-y-auto pr-4 rounded-lg",children:O.length>0?O.map(e=>(0,UR.jsx)(F,{project:e},e.id)):(0,UR.jsx)("p",{className:"text-gray-500 p-4 bg-white rounded-md",children:"No tienes proyectos activos asignados."})})]}),(0,UR.jsx)("div",{className:"sticky top-40 h-fit",children:!V&&(d?(0,UR.jsx)(z,{project:d}):(0,UR.jsx)(U,{}))})]}),g&&"log"===v&&(0,UR.jsx)(sj,{project:g,user:n,userData:r,onClose:()=>y(null),selectedRole:s}),g&&"task"===v&&(0,UR.jsx)(L,{project:g,onClose:()=>y(null),onFinalized:()=>{}}),x&&(0,UR.jsx)(ej,c(c({},x),{},{onCancel:()=>_(null)}))]})},Dj=e=>{var t,n;let{task:r,onEndDay:s,onStartBreak:o,breakTakenToday:a}=e;const l=(e=>{const[t,n]=(0,i.useState)(0);return(0,i.useEffect)(()=>{if(!e)return void n(0);const t=e.toDate().getTime(),i=setInterval(()=>{const e=Date.now();n(e-t)},1e3);return()=>clearInterval(i)},[e]),(e=>{const t=Math.floor(e/1e3),n=String(Math.floor(t/3600)).padStart(2,"0"),i=String(Math.floor(t%3600/60)).padStart(2,"0"),r=String(t%60).padStart(2,"0");return"".concat(n,":").concat(i,":").concat(r)})(t)})(r.inicio);return(0,UR.jsxs)("div",{className:"bg-blue-600 text-white p-4 rounded-lg shadow-lg mb-8 flex justify-between items-center sticky top-20 z-30",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-bold",children:"Trabajando ahora en:"}),(0,UR.jsxs)("p",{className:"text-lg",children:[null===(t=r.projectDetails)||void 0===t?void 0:t.npu," - ",null===(n=r.projectDetails)||void 0===n?void 0:n.servicioNombre]})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,UR.jsx)("p",{className:"text-2xl font-mono",children:l}),(0,UR.jsx)("button",{onClick:o,disabled:a,className:"bg-green-500 hover:bg-green-600 font-bold py-3 px-4 rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed",title:a?"Ya tomaste tu descanso de hoy":"Ir a comer",children:"Ir a Comer"}),(0,UR.jsx)("button",{onClick:s,className:"bg-red-600 hover:bg-red-700 font-bold py-3 px-4 rounded-lg",children:"Finalizar D\xeda"})]})]})},Rj=e=>{let{user:t,userData:n}=e;const[r,s]=(0,i.useState)("dashboard"),[o,a]=(0,i.useState)([]),[l,u]=(0,i.useState)(!0),h=()=>{u(!0);const e=by(Qg(cg(HR,WR),$g("estado","in",["Pendiente de Factura","Facturado"])),e=>{const t=e.docs.map(e=>c({id:e.id},e.data()));t.forEach(e=>{if("Facturado"===e.estado&&"Preliminar"===e.faseFacturacion){console.log("[AUTO-REACTIVACI\xd3N] Proyecto ".concat(e.npu," detectado para Fase 2."));const t=ug(HR,WR,e.id),n={};e.asignadoTecnicosIds&&e.asignadoTecnicosIds.forEach(e=>{n[e]="En Proceso"}),yy(t,{estado:"Activo",tecnicosStatus:n,faseFacturacion:"Fase 2 Pendiente"})}}),a(t.filter(e=>"Pendiente de Factura"===e.estado)),u(!1)});return e};return(0,i.useEffect)(()=>{let e=()=>{};return"pendientes"===r?e=h():u(!1),()=>e()},[r]),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Panel de Finanzas"}),(0,UR.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,UR.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,UR.jsx)("button",{onClick:()=>s("dashboard"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("dashboard"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Dashboard"}),(0,UR.jsx)("button",{onClick:()=>s("pendientes"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("pendientes"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Pendientes de Gesti\xf3n"}),(0,UR.jsx)("button",{onClick:()=>s("cobrar"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("cobrar"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Cuentas por Cobrar"}),(0,UR.jsx)("button",{onClick:()=>s("pagar"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ".concat("pagar"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Cuentas por Pagar"})]})}),"dashboard"===r&&(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-2xl font-bold text-gray-800 my-6",children:"An\xe1lisis Financiero"}),(0,UR.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:(0,UR.jsx)(ZR,{})})]}),"pendientes"===r&&(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-2xl font-bold text-gray-800 my-6",children:"Proyectos Pendientes de Facturar"}),l?(0,UR.jsx)("p",{children:"Cargando proyectos..."}):(0,UR.jsx)(jj,{projects:o,onUpdate:h})]}),"cobrar"===r&&(0,UR.jsx)(Mj,{invoiceType:"cliente",onUpdate:()=>{}}),"pagar"===r&&(0,UR.jsx)(Mj,{invoiceType:"proveedor",onUpdate:()=>{}})]})},jj=e=>{let{projects:t,onUpdate:n}=e;const[r,s]=(0,i.useState)(null),[o,a]=(0,i.useState)(""),[l,u]=(0,i.useState)(1),[h,d]=(0,i.useState)(10),f=e=>{var t,n,r;let{project:s,onClose:o,onFinalized:a}=e;const[l,u]=(0,i.useState)("upload"),[h,d]=(0,i.useState)(null),[f,p]=(0,i.useState)(null),[m,g]=(0,i.useState)(null),[y,v]=(0,i.useState)(null),[b,x]=(0,i.useState)(!1),[_,w]=(0,i.useState)(""),[C,k]=(0,i.useState)([]),[E,T]=(0,i.useState)(""),[N,S]=(0,i.useState)(""),I=null===(t=s.proveedorNombre)||void 0===t?void 0:t.toLowerCase().includes("ecologia");(0,i.useEffect)(()=>{if("link"===l){const e=by(Qg(cg(HR,"facturas"),ey("fechaEmision","desc")),e=>{k(e.docs.map(e=>c({id:e.id},e.data())))});return()=>e()}},[l]);const P=(e,t)=>{const n=e.target.files[0];if(!n)return;"client"===t&&d(n),"provider"===t&&p(n);const i=new FileReader;i.onload=e=>{const n=e.target.result,i=JR(n);i?("client"===t&&g(i),"provider"===t&&v(i),w("")):w("Error al leer el XML. Aseg\xfarate de que es un archivo CFDI v\xe1lido.")},i.readAsText(n)},A=async(e,t)=>{if(!e)return null;const n=ib(sb(GR,t),e);return rb((await n).ref)};return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Gestionar Facturas: ",s.npu]}),(0,UR.jsx)("div",{className:"mb-4 border-b border-gray-200",children:(0,UR.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,UR.jsx)("button",{onClick:()=>u("upload"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("upload"===l?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Subir Nueva Factura (XML)"}),(0,UR.jsx)("button",{onClick:()=>u("link"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("link"===l?"border-blue-500 text-blue-600":"border-transparent text-gray-500"),children:"Enlazar Factura Existente"})]})}),"upload"===l&&(0,UR.jsxs)("div",{className:"grid grid-cols-1 ".concat(I?"":"md:grid-cols-2"," gap-6"),children:[(0,UR.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-800",children:"Factura a Cliente"}),(null===(n=s.facturasClienteIds)||void 0===n?void 0:n.length)>0?(0,UR.jsx)("p",{className:"text-green-600 font-semibold",children:"\u2713 Factura ya adjuntada."}):(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Subir archivo XML"}),(0,UR.jsx)("input",{type:"file",name:"clientXml",accept:".xml",onChange:e=>P(e,"client"),className:"block w-full text-sm"}),m&&(0,UR.jsxs)("div",{className:"text-xs bg-gray-50 p-2 rounded-md mt-2 space-y-1",children:[(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Folio:"})," ",m.folio]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Subtotal:"})," $",m.subtotal.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"IVA:"})," $",m.iva.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Total:"})," $",m.monto.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Fecha:"})," ",m.fechaEmision.toLocaleDateString()]}),(0,UR.jsxs)("p",{className:"truncate",children:[(0,UR.jsx)("strong",{children:"UUID:"})," ",m.uuid]})]})]})]}),!I&&(0,UR.jsxs)("div",{className:"space-y-4 p-4 border rounded-lg",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-800",children:"Factura de Proveedor"}),(null===(r=s.facturasProveedorIds)||void 0===r?void 0:r.length)>0?(0,UR.jsx)("p",{className:"text-green-600 font-semibold",children:"\u2713 Factura ya adjuntada."}):(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Subir archivo XML"}),(0,UR.jsx)("input",{type:"file",name:"providerXml",accept:".xml",onChange:e=>P(e,"provider"),className:"block w-full text-sm"}),y&&(0,UR.jsxs)("div",{className:"text-xs bg-gray-50 p-2 rounded-md mt-2 space-y-1",children:[(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Folio:"})," ",y.folio]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Subtotal:"})," $",y.subtotal.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"IVA:"})," $",y.iva.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Total:"})," $",y.monto.toFixed(2)]}),(0,UR.jsxs)("p",{children:[(0,UR.jsx)("strong",{children:"Fecha:"})," ",y.fechaEmision.toLocaleDateString()]}),(0,UR.jsxs)("p",{className:"truncate",children:[(0,UR.jsx)("strong",{children:"UUID:"})," ",y.uuid]})]})]})]})]}),"link"===l&&(0,UR.jsxs)("div",{className:"grid grid-cols-1 ".concat(I?"":"md:grid-cols-2"," gap-6"),children:[(0,UR.jsxs)("div",{className:"space-y-2 p-4 border rounded-lg",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-800",children:"Enlazar Factura de Cliente"}),(0,UR.jsxs)("select",{value:E,onChange:e=>T(e.target.value),className:"block w-full border rounded-md p-2",children:[(0,UR.jsx)("option",{value:"",children:"Seleccione una factura..."}),C.filter(e=>"cliente"===e.tipo).map(e=>(0,UR.jsx)("option",{value:e.id,children:"Folio: ".concat(e.folio," - ").concat(e.clienteNombre||e.descripcion," - $").concat(e.monto.toFixed(2))},e.id))]})]}),!I&&(0,UR.jsxs)("div",{className:"space-y-2 p-4 border rounded-lg",children:[(0,UR.jsx)("h4",{className:"font-semibold text-gray-800",children:"Enlazar Factura de Proveedor"}),(0,UR.jsxs)("select",{value:N,onChange:e=>S(e.target.value),className:"block w-full border rounded-md p-2",children:[(0,UR.jsx)("option",{value:"",children:"Seleccione una factura..."}),C.filter(e=>"proveedor"===e.tipo).map(e=>(0,UR.jsx)("option",{value:e.id,children:"Folio: ".concat(e.folio," - ").concat(e.proveedorNombre||e.descripcion," - $").concat(e.monto.toFixed(2))},e.id))]})]})]}),(0,UR.jsx)(XR,{message:_,type:"error",onClose:()=>w("")}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:o,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded",children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{x(!0),w("");try{var e,t;const n=ug(HR,WR,s.id),i={};if("upload"===l){if(h&&m){const e=await A(h,"facturas_clientes/".concat(s.id,"/").concat(h.name)),t=await vy(cg(HR,"facturas"),{tipo:"cliente",proyectoId:s.id,folio:m.folio,uuid:m.uuid,subtotal:m.subtotal,iva:m.iva,monto:m.monto,fechaEmision:Sc.fromDate(m.fechaEmision),estado:"Pendiente",urlXml:e,pdfUrl:"",clienteNombre:s.clienteNombre});i.facturasClienteIds=Sy(t.id)}if(!I&&f&&y){const e=await A(f,"facturas_proveedores/".concat(s.id,"/").concat(f.name)),t=await vy(cg(HR,"facturas"),{tipo:"proveedor",proyectoId:s.id,folio:y.folio,uuid:y.uuid,subtotal:y.subtotal,iva:y.iva,monto:y.monto,fechaEmision:Sc.fromDate(y.fechaEmision),estado:"Pendiente",urlXml:e,proveedorNombre:s.proveedorNombre});i.facturasProveedorIds=Sy(t.id)}}else E&&(await yy(ug(HR,"facturas",E),{proyectosIds:Sy(s.id)}),i.facturasClienteIds=Sy(E)),N&&!I&&(await yy(ug(HR,"facturas",N),{proyectosIds:Sy(s.id)}),i.facturasProveedorIds=Sy(N));const r=(null===(e=s.facturasClienteIds)||void 0===e?void 0:e.length)>0||m||E,c=I||(null===(t=s.facturasProveedorIds)||void 0===t?void 0:t.length)>0||y||N;r&&c&&(i.estado="Facturado"),Object.keys(i).length>0&&await yy(n,i),a(),o()}catch(n){w("Ocurri\xf3 un error al guardar las facturas."),console.error("Error saving invoices:",n),x(!1)}},className:"bg-[#b0ef26] text-black font-bold py-2 px-4 rounded",disabled:b,children:b?"Guardando...":"Guardar Cambios"})]})]})})},p=t.filter(e=>e.npu&&e.npu.toLowerCase().includes(o.toLowerCase())||e.clienteNombre&&e.clienteNombre.toLowerCase().includes(o.toLowerCase())||e.servicioNombre&&e.servicioNombre.toLowerCase().includes(o.toLowerCase())),m=p.slice((l-1)*h,l*h),g=Math.ceil(p.length/h),y=e=>u(e);return(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsxs)("div",{className:"mb-4 flex flex-col md:flex-row justify-between items-center",children:[(0,UR.jsx)("input",{type:"text",placeholder:"Buscar por NPU, cliente o servicio...",className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md mb-2 md:mb-0",onChange:e=>{a(e.target.value),u(1)}}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:h,onChange:e=>{d(Number(e.target.value)),u(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:25,children:"25"}),(0,UR.jsx)("option",{value:50,children:"50"})]})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Docs Admin"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factura Cliente"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factura Proveedor"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(e=>{var t;return(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-6 py-4",children:e.npu}),(0,UR.jsx)("td",{className:"px-6 py-4",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-6 py-4",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-6 py-4",children:(0,UR.jsxs)("div",{className:"flex space-x-2 text-sm",children:[e.urlCotizacionCliente&&(0,UR.jsx)("a",{href:e.urlCotizacionCliente,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500",children:"Cot.C"}),e.urlPOCliente&&(0,UR.jsx)("a",{href:e.urlPOCliente,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500",children:"PO.C"})]})}),(0,UR.jsx)("td",{className:"px-6 py-4",children:e.facturaClienteId?(0,UR.jsx)("span",{className:"text-green-600",children:"\u2713 Adjuntada"}):(0,UR.jsx)("span",{className:"text-orange-500",children:"Pendiente"})}),(0,UR.jsx)("td",{className:"px-6 py-4",children:null!==(t=e.proveedorNombre)&&void 0!==t&&t.toLowerCase().includes("ecologia")?(0,UR.jsx)("span",{className:"text-gray-500",children:"N/A"}):e.facturaProveedorId?(0,UR.jsx)("span",{className:"text-green-600",children:"\u2713 Adjuntada"}):(0,UR.jsx)("span",{className:"text-orange-500",children:"Pendiente"})}),(0,UR.jsx)("td",{className:"px-6 py-4",children:(0,UR.jsx)("button",{onClick:()=>s(e),className:"text-indigo-600 hover:text-indigo-900",children:"Gestionar Facturas"})})]},e.id)})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",l," de ",g]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>y(l-1),disabled:1===l,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>y(l+1),disabled:l===g||0===g,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]}),r&&(0,UR.jsx)(f,{project:r,onClose:()=>s(null),onFinalized:n})]})},Mj=e=>{let{invoiceType:t,onUpdate:n}=e;const[r,s]=(0,i.useState)([]),[o,a]=(0,i.useState)(!0),[l,u]=(0,i.useState)(!1),[h,d]=(0,i.useState)(null),[f,p]=(0,i.useState)(""),[m,g]=(0,i.useState)(1),[y,v]=(0,i.useState)(10);(0,i.useEffect)(()=>{a(!0);const e=by(Qg(cg(HR,"facturas"),$g("tipo","==",t),ey("fechaEmision","desc")),e=>{s(e.docs.map(e=>c({id:e.id},e.data()))),a(!1)});return()=>e()},[t]);const b=r.filter(e=>e.folio&&String(e.folio).toLowerCase().includes(f.toLowerCase())||e.clienteNombre&&e.clienteNombre.toLowerCase().includes(f.toLowerCase())||e.proveedorNombre&&e.proveedorNombre.toLowerCase().includes(f.toLowerCase())||e.descripcion&&e.descripcion.toLowerCase().includes(f.toLowerCase())),x=m*y,_=x-y,w=b.slice(_,x),C=Math.ceil(b.length/y),k=e=>g(e),E=e=>{let{onClose:n,onFinalized:r}=e;const[s,o]=(0,i.useState)({folio:"",monto:"",fechaEmision:(new Date).toISOString().split("T")[0],entidadId:"",descripcion:""}),[a,l]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[d,f]=(0,i.useState)([]),[p,m]=(0,i.useState)(""),[g,y]=(0,i.useState)(!1),[v,b]=(0,i.useState)("");(0,i.useEffect)(()=>{let e;e="cliente"===t?Qg(cg(HR,"usuarios"),$g("rol","==","cliente")):Qg(cg(HR,"proveedores")),my(e).then(e=>{const t=e.docs.map(e=>c({id:e.id},e.data())).sort((e,t)=>(e.nombreCompleto||e.nombre).localeCompare(t.nombreCompleto||t.nombre));f(t)})},[]),(0,i.useEffect)(()=>{u&&o(e=>c(c({},e),{},{folio:u.folio,subtotal:u.subtotal,iva:u.iva,monto:u.monto,fechaEmision:u.fechaEmision.toISOString().split("T")[0]}))},[u]);return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["A\xf1adir Factura General (",t,")"]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Subir archivo XML (la informaci\xf3n se cargar\xe1 autom\xe1ticamente)"}),(0,UR.jsx)("input",{type:"file",name:"xmlFile",accept:".xml",onChange:e=>{const t=e.target.files[0];if(!t)return;l(t);const n=new FileReader;n.onload=e=>{const t=e.target.result,n=JR(t);n?(h(n),b("")):b("Error al leer el XML. Aseg\xfarate de que es un archivo CFDI v\xe1lido.")},n.readAsText(t)},className:"block w-full text-sm"}),(0,UR.jsx)("hr",{}),(0,UR.jsxs)("select",{value:s.entidadId,onChange:e=>o(t=>c(c({},t),{},{entidadId:e.target.value})),name:"entidadId",className:"block w-full border rounded-md p-2",children:[(0,UR.jsxs)("option",{value:"",children:["Seleccione un ",t]}),d.map(e=>(0,UR.jsx)("option",{value:e.id,children:e.nombreCompleto||e.nombre},e.id)),(0,UR.jsx)("option",{value:"otro",children:"Otro (especificar)"})]}),"otro"===s.entidadId&&(0,UR.jsx)("input",{type:"text",value:p,onChange:e=>m(e.target.value),placeholder:"Nombre del ".concat(t),className:"block w-full border rounded-md p-2"}),(0,UR.jsx)("input",{type:"text",name:"descripcion",placeholder:"Descripci\xf3n (ej: Renta de oficina)",value:s.descripcion,onChange:e=>o(t=>c(c({},t),{},{descripcion:e.target.value})),className:"block w-full border rounded-md p-2"}),(0,UR.jsx)("input",{type:"text",name:"folio",placeholder:"Folio (del XML)",value:s.folio,disabled:!0,className:"block w-full border rounded-md p-2 bg-gray-100"}),(0,UR.jsx)("input",{type:"number",name:"subtotal",placeholder:"Subtotal (del XML)",value:s.subtotal||"",disabled:!0,className:"block w-full border rounded-md p-2 bg-gray-100"}),(0,UR.jsx)("input",{type:"number",name:"iva",placeholder:"IVA (del XML)",value:s.iva||"",disabled:!0,className:"block w-full border rounded-md p-2 bg-gray-100"}),(0,UR.jsx)("input",{type:"number",name:"monto",placeholder:"Monto (del XML)",value:s.monto,disabled:!0,className:"block w-full border rounded-md p-2 bg-gray-100"}),(0,UR.jsx)("input",{type:"date",name:"fechaEmision",value:s.fechaEmision,disabled:!0,className:"block w-full border rounded-md p-2 bg-gray-100"})]}),(0,UR.jsx)(XR,{message:v,type:"error",onClose:()=>b("")}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:n,children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{if(u&&a&&""!==s.entidadId&&("otro"!==s.entidadId||p)){y(!0);try{var e,i;const o=await(async(e,t)=>{if(!e)return null;const n=ib(sb(GR,t),e);return rb((await n).ref)})(a,"facturas_".concat(t,"/").concat(Date.now(),"/").concat(a.name)),l="otro"===s.entidadId?p:(null===(e=d.find(e=>e.id===s.entidadId))||void 0===e?void 0:e.nombreCompleto)||(null===(i=d.find(e=>e.id===s.entidadId))||void 0===i?void 0:i.nombre);await vy(cg(HR,"facturas"),{tipo:t,proyectoId:"general",folio:s.folio,uuid:u.uuid,subtotal:Number(s.subtotal),iva:Number(s.iva),monto:Number(s.monto),fechaEmision:Sc.fromDate(new Date(s.fechaEmision)),estado:"Pendiente",descripcion:s.descripcion||"",urlXml:o,urlPdf:"",["cliente"===t?"clienteNombre":"proveedorNombre"]:l}),r(),n()}catch(o){console.error("Error al guardar factura general:",o),b("Ocurri\xf3 un error al guardar."),y(!1)}}else b("Debes subir un XML v\xe1lido y seleccionar un cliente/proveedor.")},disabled:g,className:"bg-[#b0ef26] text-black font-bold py-2 px-4 rounded",children:g?"Guardando...":"Guardar Factura"})]})]})})},T=e=>{let{invoice:t,onClose:n,onFinalized:r}=e;const[s,o]=(0,i.useState)({fechaPromesaPago:t.fechaPromesaPago?t.fechaPromesaPago.toDate().toISOString().split("T")[0]:"",fechaPagoReal:t.fechaPagoReal?t.fechaPagoReal.toDate().toISOString().split("T")[0]:""}),[a,l]=(0,i.useState)(!1);return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Gestionar Factura: ",t.folio]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Fecha Promesa de Pago"}),(0,UR.jsx)("input",{type:"date",value:s.fechaPromesaPago,onChange:e=>o(c(c({},s),{},{fechaPromesaPago:e.target.value})),className:"mt-1 block w-full border rounded-md p-2"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Fecha de Pago Real"}),(0,UR.jsx)("input",{type:"date",value:s.fechaPagoReal,onChange:e=>o(c(c({},s),{},{fechaPagoReal:e.target.value})),className:"mt-1 block w-full border rounded-md p-2"})]})]}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-between items-center",children:[(0,UR.jsx)("button",{onClick:async()=>{if(window.confirm("\xbfEst\xe1s seguro de que quieres cancelar esta factura? Esta acci\xf3n es irreversible.")){if(l(!0),await yy(ug(HR,"facturas",t.id),{estado:"Cancelada"}),t.proyectoId&&"general"!==t.proyectoId){const e="cliente"===t.tipo?"facturaClienteId":"facturaProveedorId";await yy(ug(HR,WR,t.proyectoId),{[e]:Ny(),estado:"Pendiente de Factura"})}r(),n()}},disabled:a,className:"bg-red-600 text-white font-bold py-2 px-4 rounded disabled:bg-red-300",children:"Cancelar Factura"}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:n,disabled:a,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded mr-2",children:"Cerrar"}),(0,UR.jsx)("button",{onClick:async()=>{l(!0);const e={fechaPromesaPago:s.fechaPromesaPago?Sc.fromDate(new Date(s.fechaPromesaPago)):Ny(),fechaPagoReal:s.fechaPagoReal?Sc.fromDate(new Date(s.fechaPagoReal)):Ny()};s.fechaPagoReal?e.estado="Pagada":"Pagada"===t.estado&&(e.estado="Pendiente"),await yy(ug(HR,"facturas",t.id),e),r(),n()},disabled:a,className:"bg-[#b0ef26] text-black font-bold py-2 px-4 rounded",children:a?"Guardando...":"Guardar"})]})]})]})})},N=e=>e?new Date(1e3*e.seconds).toLocaleDateString("es-MX"):"---";return(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("div",{className:"mb-4 flex flex-col md:flex-row justify-between items-center",children:[(0,UR.jsx)("input",{type:"text",placeholder:"Buscar por folio, cliente/prov. o descripci\xf3n...",className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-md mb-2 md:mb-0",onChange:e=>{p(e.target.value),g(1)}}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:y,onChange:e=>{v(Number(e.target.value)),g(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:25,children:"25"}),(0,UR.jsx)("option",{value:50,children:"50"})]}),(0,UR.jsx)("button",{onClick:()=>u(!0),className:"ml-4 bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-2 px-4 rounded-lg",children:"+ A\xf1adir Factura General"})]})]}),(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Folio"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"cliente"===t?"Cliente":"Proveedor"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Descripci\xf3n"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Subtotal"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"IVA"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Total"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Fecha Emisi\xf3n"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Fecha Promesa Pago"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Fecha Pago"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Estado"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",children:"Acciones"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o?(0,UR.jsx)("tr",{children:(0,UR.jsx)("td",{colSpan:"11",children:"Cargando..."})}):w.map(e=>{const t=(e=>{var t;const n=new Date;if(n.setHours(0,0,0,0),"Pagada"===e.estado)return{text:"Pagada",class:"bg-green-100 text-green-800"};if("Cancelada"===e.estado)return{text:"Cancelada",class:"bg-gray-100 text-gray-700"};if(null!==(t=e.fechaPromesaPago)&&void 0!==t&&t.toDate){const t=e.fechaPromesaPago.toDate();return t.setHours(0,0,0,0),t<n?{text:"Vencida",class:"bg-red-100 text-red-800"}:{text:"Prog. a Pago",class:"bg-blue-100 text-blue-800"}}return{text:"Pend. de Autorizaci\xf3n",class:"bg-yellow-100 text-yellow-800"}})(e);return(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("td",{className:"px-6 py-4",children:e.folio}),(0,UR.jsx)("td",{className:"px-6 py-4",children:e.clienteNombre||e.proveedorNombre}),(0,UR.jsx)("td",{className:"px-6 py-4",children:e.descripcion||("general"!==e.proyectoId?"Gasto de Proyecto":"---")}),(0,UR.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(e.subtotal||0).toFixed(2)]}),(0,UR.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(e.iva||0).toFixed(2)]}),(0,UR.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold",children:["$",(e.monto||0).toFixed(2)]}),(0,UR.jsx)("td",{className:"px-6 py-4",children:N(e.fechaEmision)}),(0,UR.jsx)("td",{className:"px-6 py-4",children:N(e.fechaPromesaPago)}),(0,UR.jsx)("td",{className:"px-6 py-4",children:N(e.fechaPagoReal)}),(0,UR.jsx)("td",{className:"px-6 py-4",children:(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t.class),children:t.text})}),(0,UR.jsx)("td",{className:"px-6 py-4",children:(0,UR.jsx)("button",{onClick:()=>d(e),className:"text-indigo-600",children:"Gestionar"})})]},e.id)})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",m," de ",C]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>k(m-1),disabled:1===m,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>k(m+1),disabled:m===C||0===C,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]}),l&&(0,UR.jsx)(E,{onClose:()=>u(!1),onFinalized:n}),h&&(0,UR.jsx)(T,{invoice:h,onClose:()=>d(null),onFinalized:n})]})},Oj=()=>{const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),[s,o]=(0,i.useState)(null),[a,l]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[d,f]=(0,i.useState)("desc"),[p,m]=(0,i.useState)(1),[g,y]=(0,i.useState)(10),[v,b]=(0,i.useState)(""),x=()=>{r(!0);const e=by(Qg(cg(HR,WR),$g("estado","in",["Terminado Internamente","En Revisi\xf3n Final"])),e=>{t(e.docs.map(e=>c({id:e.id},e.data()))),r(!1)},e=>{console.error("Error fetching projects for practicante: ",e),r(!1)});return e};(0,i.useEffect)(()=>{const e=x();return()=>e()},[]);const _=i.useMemo(()=>{const t=e.filter(e=>{var t,n,i;return(null===(t=e.npu)||void 0===t?void 0:t.toLowerCase().includes(v.toLowerCase()))||(null===(n=e.clienteNombre)||void 0===n?void 0:n.toLowerCase().includes(v.toLowerCase()))||(null===(i=e.servicioNombre)||void 0===i?void 0:i.toLowerCase().includes(v.toLowerCase()))}),n=[...t];return n.sort((e,t)=>{const n=e.fase2_fechaFinTecnico||e.fase1_fechaFinTecnico,i=t.fase2_fechaFinTecnico||t.fase1_fechaFinTecnico,r=(null===n||void 0===n?void 0:n.toDate())||new Date(0),s=(null===i||void 0===i?void 0:i.toDate())||new Date(0);return r<s?"asc"===d?-1:1:r>s?"asc"===d?1:-1:0}),n},[e,d,v]),w=_.slice((p-1)*g,p*g),C=Math.ceil(_.length/g),k=e=>m(e),E=e=>{h({title:"Confirmar Env\xedo",message:"\xbfEst\xe1s seguro de que todos los documentos est\xe1n listos y quieres enviar este proyecto a revisi\xf3n final?",onConfirm:()=>{(async e=>{l(e);try{await yy(ug(HR,WR,e),{estado:"En Revisi\xf3n Final",motivoRechazo:Ny()})}catch(NS){console.error("Error sending project to review:",NS),alert("Ocurri\xf3 un error al enviar el proyecto a revisi\xf3n.")}finally{l(null)}})(e),h(null)}})},T=e=>{let{project:t,onClose:n,onFinalized:r}=e;const[s,o]=(0,i.useState)(t.urlHeyzine||""),[a,l]=(0,i.useState)(null),[c,u]=(0,i.useState)(null),[h,d]=(0,i.useState)(!1),f=e=>t=>{t.target.files[0]&&e(t.target.files[0])},p=async(e,t)=>{if(!e)return null;const n=ib(sb(GR,t),e);return rb((await n).ref)};return(0,UR.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,UR.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg",children:[(0,UR.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Gestionar Entrega Final: ",t.npu]}),(0,UR.jsxs)("div",{className:"space-y-4",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Enlace Heyzine (\xdanico)"}),(0,UR.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),className:"mt-1 block w-full border rounded-md p-2"})]}),(0,UR.jsx)("hr",{}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Subir/Reemplazar Nota de Entrega 1 (Firmada)"}),(0,UR.jsx)("input",{type:"file",accept:".pdf",onChange:f(l),className:"mt-1 block w-full text-sm"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium",children:"Subir/Reemplazar Nota de Entrega 2 (Firmada)"}),(0,UR.jsx)("input",{type:"file",accept:".pdf",onChange:f(u),className:"mt-1 block w-full text-sm"})]})]}),(0,UR.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,UR.jsx)("button",{onClick:n,className:"bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded",children:"Cancelar"}),(0,UR.jsx)("button",{onClick:async()=>{d(!0);const e={urlHeyzine:s},i=await p(a,"notas_entrega_cliente/".concat(t.id,"/nota1_").concat(null===a||void 0===a?void 0:a.name)),o=await p(c,"notas_entrega_cliente/".concat(t.id,"/nota2_").concat(null===c||void 0===c?void 0:c.name));i&&(e.urlNotaPdf1=i),o&&(e.urlNotaPdf2=o),Object.keys(e).length>0&&await yy(ug(HR,WR,t.id),e),r(),n()},className:"bg-blue-600 text-white font-bold py-2 px-4 rounded",children:h?"Guardando...":"Guardar Documentos"})]})]})})};return(0,UR.jsxs)("div",{children:[(0,UR.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,UR.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Proyectos Listos para Documentar"}),(0,UR.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,UR.jsx)("input",{type:"text",placeholder:"Buscar por NPU, Cliente...",value:v,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,UR.jsxs)("div",{className:"flex items-center",children:[(0,UR.jsx)("span",{className:"text-sm mr-2",children:"Mostrar:"}),(0,UR.jsxs)("select",{value:g,onChange:e=>{y(Number(e.target.value)),m(1)},className:"px-2 py-1 border border-gray-300 rounded-md",children:[(0,UR.jsx)("option",{value:10,children:"10"}),(0,UR.jsx)("option",{value:25,children:"25"}),(0,UR.jsx)("option",{value:50,children:"50"})]})]}),(0,UR.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,UR.jsx)("span",{className:"text-sm font-medium",children:"Ordenar por Fecha:"}),(0,UR.jsx)("button",{onClick:()=>f("asc"===d?"desc":"asc"),className:"p-2 border rounded-md text-sm bg-white shadow-sm",children:"asc"===d?"Ascendente \u2191":"Descendente \u2193"})]})]})]}),n?(0,UR.jsx)("p",{children:"Cargando..."}):0===_.length?(0,UR.jsx)("p",{children:"No hay proyectos pendientes."}):(0,UR.jsxs)(UR.Fragment,{children:[(0,UR.jsx)("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:(0,UR.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,UR.jsx)("thead",{className:"bg-gray-50",children:(0,UR.jsxs)("tr",{children:[(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPU"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Cliente"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Servicio"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estado"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Documentos y correcciones"}),(0,UR.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),(0,UR.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(e=>{const t="En Revisi\xf3n Final"===e.estado?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800";return(0,UR.jsxs)("tr",{className:e.motivoRechazo?"bg-orange-50":"",children:[(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.npu}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.clienteNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.servicioNombre}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,UR.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(t),children:e.estado})}),(0,UR.jsx)("td",{className:"px-6 py-4",children:(0,UR.jsxs)("div",{className:"flex flex-col space-y-2 text-sm",children:[e.fase1_urlEvidencia&&(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-semibold text-xs",children:"Fase 1:"}),(0,UR.jsx)("a",{href:e.fase1_urlEvidencia,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600",children:"Ver Evidencia 1"}),(0,UR.jsxs)("p",{children:["Nota Interna: ",(0,UR.jsx)("span",{className:"font-semibold",children:e.fase1_numeroNotaInterna||"N/A"})]})]}),e.fase2_urlEvidencia&&(0,UR.jsxs)("div",{children:[(0,UR.jsx)("p",{className:"font-semibold text-xs",children:"Fase 2:"}),(0,UR.jsx)("a",{href:e.fase2_urlEvidencia,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600",children:"Ver Evidencia 2"}),(0,UR.jsxs)("p",{children:["Nota Interna: ",(0,UR.jsx)("span",{className:"font-semibold",children:e.fase2_numeroNotaInterna||"N/A"})]})]}),e.motivoRechazo&&(0,UR.jsxs)("div",{className:"mt-2 p-2 bg-red-100 text-red-800 rounded-md text-xs border border-red-200",children:[(0,UR.jsx)("p",{className:"font-bold",children:"Requiere Correcci\xf3n:"}),(0,UR.jsx)("p",{children:e.motivoRechazo})]})]})}),(0,UR.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,UR.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,UR.jsx)("button",{onClick:()=>o(e),className:"text-indigo-600 hover:text-indigo-800",children:"Gestionar Entrega"}),"Terminado Internamente"===e.estado?(0,UR.jsx)("button",{onClick:()=>E(e.id),disabled:a===e.id,className:"text-green-600 hover:text-green-800 disabled:opacity-50",children:a===e.id?"Enviando...":"Enviar a Revisi\xf3n"}):(0,UR.jsx)("span",{className:"text-sm font-semibold text-gray-500",children:"Enviado"})]})})]},e.id)})})]})}),(0,UR.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,UR.jsxs)("span",{className:"text-sm text-gray-700",children:["P\xe1gina ",p," de ",C]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("button",{onClick:()=>k(p-1),disabled:1===p,className:"px-3 py-1 border rounded-md bg-white mr-2 disabled:opacity-50",children:"Anterior"}),(0,UR.jsx)("button",{onClick:()=>k(p+1),disabled:p===C||0===C,className:"px-3 py-1 border rounded-md bg-white disabled:opacity-50",children:"Siguiente"})]})]})]}),s&&(0,UR.jsx)(T,{project:s,onClose:()=>o(null),onFinalized:x}),u&&(0,UR.jsx)(ej,c(c({},u),{},{onCancel:()=>h(null)}))]})},Lj=e=>{let{user:t,userData:n,selectedRole:i,setIsTechnicianWorking:r}=e;return(0,UR.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(()=>{switch(i){case"administrador":return(0,UR.jsx)(cj,{user:t,userData:n,selectedRole:i});case"cliente":return(0,UR.jsx)(gj,{user:t,userData:n});case"directivo":return(0,UR.jsx)(Tj,{user:t,userData:n});case"ecotech":return(0,UR.jsx)(Nj,{user:t,userData:n});case"supervisor":return(0,UR.jsx)(Pj,{user:t,userData:n,selectedRole:i});case"tecnico":return(0,UR.jsx)(Aj,{user:t,userData:n,selectedRole:i,setIsWorkingState:r});case"finanzas":return(0,UR.jsx)(Rj,{user:t,userData:n});case"practicante":return(0,UR.jsx)(Oj,{});default:return(0,UR.jsxs)("div",{children:[(0,UR.jsx)("h2",{className:"text-2xl font-bold",children:"Rol no reconocido"}),(0,UR.jsx)("p",{children:"Contacte al administrador."})]})}})()})},Fj=()=>{const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)("");return(0,UR.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#cdcdcd]",children:(0,UR.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-xl shadow-2xl",children:[(0,UR.jsx)("img",{src:"https://www.grupoevelsa.com/assets/images/Logo Evelsa 2.png",alt:"Logo Grupo Evelsa",className:"h-16 mx-auto mb-6"}),(0,UR.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"Acceso al Portal"}),(0,UR.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),o("");try{await function(e,t,n){return yi(re(e),ni.credential(t,n))}(qR,e,n)}catch(i){o("Email o contrase\xf1a incorrectos.")}},className:"space-y-6",children:[(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,UR.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"})]}),(0,UR.jsxs)("div",{children:[(0,UR.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Contrase\xf1a"}),(0,UR.jsx)("input",{type:"password",value:n,onChange:e=>r(e.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm"})]}),s&&(0,UR.jsx)("p",{className:"text-red-500 text-sm text-center",children:s}),(0,UR.jsx)("button",{type:"submit",className:"w-full bg-[#b0ef26] hover:bg-[#9ac91e] text-black font-bold py-3 px-4 rounded-lg transition duration-300 text-lg",children:"Entrar"})]})]})})};function zj(){const[e,t]=(0,i.useState)(null),[n,r]=(0,i.useState)(null),[s,o]=(0,i.useState)(!0),[a,l]=(0,i.useState)(null),[c,u]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{const e=function(e,t,n,i){return re(e).onAuthStateChanged(t,n,i)}(qR,async e=>{if(e){const n=ug(HR,"usuarios",e.uid),i=await fy(n);if(i.exists()){const n=i.data();r(n),t(e),n.roles&&n.roles.length>0?l(n.roles[0]):n.rol&&l(n.rol)}else console.error("Usuario autenticado pero no encontrado en Firestore. Deslogueando..."),vi(qR)}else t(null),r(null),l(null);o(!1)});return()=>e()},[]),(0,i.useEffect)(()=>{const e=async e=>{if(qR.currentUser&&null!==n&&void 0!==n&&n.tareaActiva){console.log("Cierre de ventana detectado, pausando tarea activa...");const e=ug(HR,"usuarios",qR.currentUser.uid),t=ug(cg(HR,"registrosDeTiempo"));await gy(t,{tecnicoId:qR.currentUser.uid,projectId:n.tareaActiva.projectId,fechaInicio:n.tareaActiva.inicio,fechaFin:Sc.now()}),await yy(e,{tareaActiva:Ny()})}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[n]),(0,i.useEffect)(()=>{if(null===e||void 0===e||!e.uid||!n||n.roles&&!n.roles.includes("tecnico"))return;const t=NR(KR,"/status/"+e.uid),i={state:"offline",last_changed:zR()},r={state:"online",last_changed:zR()},s=RR(NR(KR,".info/connected"),e=>{!0===e.val()&&(IR(t,r),function(e){return e=re(e),new CR(e._repo,e._path)}(t).set(i))});return()=>{s(),IR(t,i)}},[e,n]),s?(0,UR.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#cdcdcd] text-gray-700",children:"Cargando..."}):(0,UR.jsxs)("div",{className:"bg-[#c9c9c9] min-h-screen font-sans",children:[(0,UR.jsx)(oN,{position:"bottom-right",autoClose:8e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),(0,UR.jsx)(rj,{user:e,userData:n,selectedRole:a,setSelectedRole:l,isWorking:c}),(0,UR.jsx)("main",{children:e&&n?(0,UR.jsx)(Lj,{user:e,userData:n,selectedRole:a,setIsTechnicianWorking:u}):(0,UR.jsx)(Fj,{})})]})}r.createRoot(document.getElementById("root")).render((0,UR.jsx)(i.StrictMode,{children:(0,UR.jsx)(zj,{})}))})();
//# sourceMappingURL=main.ee9f1923.js.map