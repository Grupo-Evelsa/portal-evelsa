{"ast":null,"code":"import _objectSpread from\"C:/Users/CAD/Documents/portal-evelsa/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{initializeApp}from'firebase/app';import{getAuth,onAuthStateChanged,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut}from'firebase/auth';import{getFirestore,collection,addDoc,query,where,getDocs,doc,getDoc,updateDoc,onSnapshot,setDoc,Timestamp,runTransaction,orderBy// Import orderBy\n}from'firebase/firestore';import{getStorage,ref,uploadBytesResumable,getDownloadURL}from'firebase/storage';// --- INSTRUCCIONES DE CONFIGURACIÓN DE FIREBASE ---\n// Pega aquí el objeto de configuración que obtuviste de tu proyecto de Firebase.\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyA7H6G0mXCy9DmoLg3fSW3TrxIRcEzz9jg\",authDomain:\"portal-evelsa.firebaseapp.com\",projectId:\"portal-evelsa\",storageBucket:\"portal-evelsa.firebasestorage.app\",messagingSenderId:\"847174487471\",appId:\"1:847174487471:web:c3a57fd8315ce619a2335a\"};// --- Inicialización de Firebase ---\nconst app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);const storage=getStorage(app);// --- Componente de Alerta Reutilizable ---\nconst Alert=_ref=>{let{message,type,onClose}=_ref;if(!message)return null;const baseClasses=\"p-4 mb-4 text-sm rounded-lg relative\";const typeClasses={error:\"bg-red-100 text-red-700\",success:\"bg-green-100 text-green-700\"};return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(baseClasses,\" \").concat(typeClasses[type]),role:\"alert\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:message}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"absolute top-0 right-0 mt-2 mr-3 text-2xl font-semibold leading-none\",children:\"\\xD7\"})]});};// --- Componente de Cabecera ---\nconst Header=_ref2=>{let{user,userData}=_ref2;return/*#__PURE__*/_jsx(\"header\",{className:\"bg-white shadow-md sticky top-0 z-40\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[userData&&userData.rol==='cliente'&&userData.logoUrl?/*#__PURE__*/_jsx(\"img\",{src:userData.logoUrl,onError:e=>{e.target.onerror=null;e.target.src=\"https://placehold.co/100x40/003366/FFFFFF?text=Logo\";},alt:\"Logo Cliente\",className:\"h-10 w-auto mr-3 object-contain\"}):/*#__PURE__*/_jsx(\"svg\",{className:\"w-10 h-10 text-blue-800 mr-3\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-800\",children:\"Portal Grupo Evelsa\"})]}),user&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600 mr-4\",children:[\"Hola, \",userData?userData.nombreCompleto:user.email]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>signOut(auth),className:\"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300\",children:\"Cerrar Sesi\\xF3n\"})]})]})});};// --- Componentes de Gestión (Para Empleados) ---\n// ... (UserManagement, ServiceManagement, ProviderManagement sin cambios significativos)\nconst UserManagement=_ref3=>{let{onUserAdded}=_ref3;/* ... código ... */return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Formulario para crear usuarios aqu\\xED.\"})});};const ServiceManagement=()=>{/* ... código ... */return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Gesti\\xF3n de Servicios aqu\\xED.\"})});};const ProviderManagement=()=>{/* ... código ... */return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Gesti\\xF3n de Proveedores aqu\\xED.\"})});};const NewProjectForm=_ref4=>{let{onProjectAdded}=_ref4;/* ... sin cambios significativos ... */return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-8\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Formulario de creaci\\xF3n de proyectos aqu\\xED.\"})});};// --- INICIA EL CÓDIGO NUEVO Y MEJORADO ---\nconst ProjectsTable=_ref5=>{let{projects,onUpdateProject}=_ref5;const ManageDeliveryModal=_ref6=>{let{project,onClose,onFinalized}=_ref6;const[formData,setFormData]=useState({fechaEntrega:new Date().toISOString().split('T')[0],// Hoy por defecto\nnotaEntrega:'',urlHeyzine:project.urlHeyzine||''});const[pdfFile,setPdfFile]=useState(null);const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[uploadProgress,setUploadProgress]=useState(0);const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleFileChange=e=>{if(e.target.files[0]){setPdfFile(e.target.files[0]);}};const handleFinalize=async()=>{if(!formData.fechaEntrega||!formData.notaEntrega){setError(\"La fecha y el número de nota de entrega son obligatorios.\");return;}setLoading(true);setError('');let pdfUrl=project.urlPdf||'';try{if(pdfFile){const storageRef=ref(storage,\"notas_entrega/\".concat(project.id,\"/\").concat(pdfFile.name));const uploadTask=uploadBytesResumable(storageRef,pdfFile);await new Promise((resolve,reject)=>{uploadTask.on('state_changed',snapshot=>setUploadProgress(snapshot.bytesTransferred/snapshot.totalBytes*100),error=>{console.error(\"Error al subir archivo:\",error);reject(error);},async()=>{pdfUrl=await getDownloadURL(uploadTask.snapshot.ref);resolve();});});}const projectRef=doc(db,\"proyectos\",project.id);await updateDoc(projectRef,{estado:'Terminado',fechaEntrega:Timestamp.fromDate(new Date(formData.fechaEntrega)),notaEntrega:formData.notaEntrega,urlHeyzine:formData.urlHeyzine,urlPdf:pdfUrl});onFinalized();onClose();}catch(err){setError(\"Error al finalizar: \".concat(err.message));setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-bold mb-4\",children:[\"Gestionar Entrega: \",project.npu]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Fecha de Entrega\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"fechaEntrega\",value:formData.fechaEntrega,onChange:handleChange,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"N\\xFAmero de Nota de Entrega\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"notaEntrega\",value:formData.notaEntrega,onChange:handleChange,className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Enlace de Heyzine\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"urlHeyzine\",value:formData.urlHeyzine,onChange:handleChange,placeholder:\"https://heyzine.com/...\",className:\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"PDF de la Nota de Entrega\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".pdf\",onChange:handleFileChange,className:\"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"})]}),loading&&uploadProgress>0&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2.5 rounded-full\",style:{width:\"\".concat(uploadProgress,\"%\")}})})]}),/*#__PURE__*/_jsx(Alert,{message:error,type:\"error\",onClose:()=>setError('')}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,disabled:loading,className:\"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded disabled:bg-gray-200\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleFinalize,disabled:loading,className:\"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded disabled:bg-gray-400\",children:loading?'Guardando...':'Guardar y Finalizar'})]})]})});};const[modalProject,setModalProject]=useState(null);const formatDate=timestamp=>{if(!timestamp)return'---';return new Date(timestamp.seconds*1000).toLocaleDateString('es-MX');};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto bg-white rounded-lg shadow\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"NPU\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Cliente\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Servicio\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Fecha Apertura\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Estado\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:projects.map(project=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\",children:project.npu}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:project.clienteNombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:project.servicioNombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:formatDate(project.fechaApertura)}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full \".concat(project.estado==='Activo'?'bg-orange-100 text-orange-800':'bg-green-100 text-green-800'),children:project.estado})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium\",children:project.estado==='Activo'?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModalProject(project),className:\"text-indigo-600 hover:text-indigo-900\",children:\"Gestionar Entrega\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"a\",{href:project.urlPdf,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-red-600 hover:text-red-900\",children:\"PDF\"}),/*#__PURE__*/_jsx(\"a\",{href:project.urlHeyzine,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-blue-600 hover:text-blue-900\",children:\"Flipbook\"})]})})]},project.id))})]})}),modalProject&&/*#__PURE__*/_jsx(ManageDeliveryModal,{project:modalProject,onClose:()=>setModalProject(null),onFinalized:onUpdateProject})]});};// --- TERMINA EL CÓDIGO NUEVO ---\nconst ClientProjectCards=_ref7=>{let{projects}=_ref7;/* ... sin cambios significativos ... */return/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Tarjetas de proyectos del cliente aqu\\xED.\"})});};const Dashboard=_ref8=>{let{user,userData}=_ref8;const[projects,setProjects]=useState([]);const[loading,setLoading]=useState(true);const[view,setView]=useState('projects');const fetchProjects=()=>{setLoading(true);let q;if(userData.rol==='empleado'){q=query(collection(db,\"proyectos\"),orderBy(\"fechaApertura\",\"desc\"));}else{q=query(collection(db,\"proyectos\"),where(\"clienteId\",\"==\",user.uid),orderBy(\"fechaApertura\",\"desc\"));}const unsubscribe=onSnapshot(q,querySnapshot=>{const projectsData=querySnapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setProjects(projectsData);setLoading(false);},error=>{console.error(\"Error fetching projects: \",error);if(error.code==='failed-precondition'){console.error(\"Este error puede requerir un índice en Firestore. Ve a la URL que aparece en el mensaje de error en la consola para crearlo automáticamente.\");}setLoading(false);});return()=>unsubscribe();};useEffect(()=>{const unsubscribe=fetchProjects();return unsubscribe;},[user,userData]);const EmployeeView=()=>/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-8\",\"aria-label\":\"Tabs\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setView('projects'),className:\"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm \".concat(view==='projects'?'border-blue-500 text-blue-600':'border-transparent text-gray-500 hover:text-gray-700'),children:\"Proyectos\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setView('users'),className:\"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm \".concat(view==='users'?'border-blue-500 text-blue-600':'border-transparent text-gray-500 hover:text-gray-700'),children:\"Usuarios\"})]})}),view==='projects'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NewProjectForm,{onProjectAdded:fetchProjects}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 my-6\",children:\"Todos los Proyectos\"}),/*#__PURE__*/_jsx(ProjectsTable,{projects:projects,onUpdateProject:fetchProjects})]}),view==='users'&&/*#__PURE__*/_jsx(UserManagement,{onUserAdded:()=>{}})]});return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-6\",children:userData.rol==='empleado'?'Panel de Administración':\"Proyectos de \".concat(userData.nombreCompleto)}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Cargando...\"}),!loading&&(userData.rol==='empleado'?/*#__PURE__*/_jsx(EmployeeView,{}):/*#__PURE__*/_jsx(ClientProjectCards,{projects:projects}))]});};const AuthPage=()=>{/* ... sin cambios significativos ... */return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-100\",children:/*#__PURE__*/_jsx(\"p\",{children:\"P\\xE1gina de autenticaci\\xF3n aqu\\xED.\"})});};export default function App(){const[user,setUser]=useState(null);const[userData,setUserData]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async currentUser=>{if(currentUser){const userDocRef=doc(db,\"usuarios\",currentUser.uid);// Usamos getDoc aquí para una carga inicial más rápida\nconst userDoc=await getDoc(userDocRef);if(userDoc.exists()){setUserData(userDoc.data());setUser(currentUser);}else{// Si el usuario existe en Auth pero no en Firestore, lo deslogueamos.\nconsole.error(\"Usuario no encontrado en la base de datos.\");signOut(auth);}}else{setUser(null);setUserData(null);}// Ocultamos la pantalla de carga después de procesar todo.\nsetLoading(false);});// Limpieza al desmontar el componente\nreturn()=>unsubscribe();},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50 text-gray-700\",children:\"Cargando...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 min-h-screen font-sans\",children:[/*#__PURE__*/_jsx(Header,{user:user,userData:userData}),/*#__PURE__*/_jsx(\"main\",{children:user&&userData?/*#__PURE__*/_jsx(Dashboard,{user:user,userData:userData}):/*#__PURE__*/_jsx(AuthPage,{})})]});}","map":{"version":3,"names":["React","useState","useEffect","initializeApp","getAuth","onAuthStateChanged","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","getFirestore","collection","addDoc","query","where","getDocs","doc","getDoc","updateDoc","onSnapshot","setDoc","Timestamp","runTransaction","orderBy","getStorage","ref","uploadBytesResumable","getDownloadURL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","app","auth","db","storage","Alert","_ref","message","type","onClose","baseClasses","typeClasses","error","success","className","concat","role","children","onClick","Header","_ref2","user","userData","rol","logoUrl","src","onError","e","target","onerror","alt","fill","stroke","viewBox","xmlns","strokeLinecap","strokeLinejoin","strokeWidth","d","nombreCompleto","email","UserManagement","_ref3","onUserAdded","ServiceManagement","ProviderManagement","NewProjectForm","_ref4","onProjectAdded","ProjectsTable","_ref5","projects","onUpdateProject","ManageDeliveryModal","_ref6","project","onFinalized","formData","setFormData","fechaEntrega","Date","toISOString","split","notaEntrega","urlHeyzine","pdfFile","setPdfFile","setError","loading","setLoading","uploadProgress","setUploadProgress","handleChange","name","value","prev","_objectSpread","handleFileChange","files","handleFinalize","pdfUrl","urlPdf","storageRef","id","uploadTask","Promise","resolve","reject","on","snapshot","bytesTransferred","totalBytes","console","projectRef","estado","fromDate","err","npu","onChange","placeholder","accept","style","width","disabled","modalProject","setModalProject","formatDate","timestamp","seconds","toLocaleDateString","map","clienteNombre","servicioNombre","fechaApertura","href","rel","ClientProjectCards","_ref7","Dashboard","_ref8","setProjects","view","setView","fetchProjects","q","uid","unsubscribe","querySnapshot","projectsData","docs","data","code","EmployeeView","AuthPage","App","setUser","setUserData","currentUser","userDocRef","userDoc","exists"],"sources":["C:/Users/CAD/Documents/portal-evelsa/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { \r\n    getAuth, \r\n    onAuthStateChanged, \r\n    createUserWithEmailAndPassword, \r\n    signInWithEmailAndPassword, \r\n    signOut \r\n} from 'firebase/auth';\r\nimport { \r\n    getFirestore, \r\n    collection, \r\n    addDoc, \r\n    query, \r\n    where, \r\n    getDocs, \r\n    doc, \r\n    getDoc,\r\n    updateDoc,\r\n    onSnapshot,\r\n    setDoc,\r\n    Timestamp,\r\n    runTransaction,\r\n    orderBy // Import orderBy\r\n} from 'firebase/firestore';\r\nimport { \r\n    getStorage, \r\n    ref, \r\n    uploadBytesResumable, \r\n    getDownloadURL \r\n} from 'firebase/storage';\r\n\r\n// --- INSTRUCCIONES DE CONFIGURACIÓN DE FIREBASE ---\r\n// Pega aquí el objeto de configuración que obtuviste de tu proyecto de Firebase.\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyA7H6G0mXCy9DmoLg3fSW3TrxIRcEzz9jg\",\r\n  authDomain: \"portal-evelsa.firebaseapp.com\",\r\n  projectId: \"portal-evelsa\",\r\n  storageBucket: \"portal-evelsa.firebasestorage.app\",\r\n  messagingSenderId: \"847174487471\",\r\n  appId: \"1:847174487471:web:c3a57fd8315ce619a2335a\"\r\n};\r\n\r\n// --- Inicialización de Firebase ---\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth(app);\r\nconst db = getFirestore(app);\r\nconst storage = getStorage(app);\r\n\r\n// --- Componente de Alerta Reutilizable ---\r\nconst Alert = ({ message, type, onClose }) => {\r\n    if (!message) return null;\r\n    const baseClasses = \"p-4 mb-4 text-sm rounded-lg relative\";\r\n    const typeClasses = {\r\n        error: \"bg-red-100 text-red-700\",\r\n        success: \"bg-green-100 text-green-700\"\r\n    };\r\n    return (\r\n        <div className={`${baseClasses} ${typeClasses[type]}`} role=\"alert\">\r\n            <span className=\"font-medium\">{message}</span>\r\n            <button onClick={onClose} className=\"absolute top-0 right-0 mt-2 mr-3 text-2xl font-semibold leading-none\">&times;</button>\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\n// --- Componente de Cabecera ---\r\nconst Header = ({ user, userData }) => (\r\n    <header className=\"bg-white shadow-md sticky top-0 z-40\">\r\n        <div className=\"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center\">\r\n            <div className=\"flex items-center\">\r\n                 {userData && userData.rol === 'cliente' && userData.logoUrl ? (\r\n                    <img src={userData.logoUrl} onError={(e)=>{e.target.onerror = null; e.target.src=\"https://placehold.co/100x40/003366/FFFFFF?text=Logo\"}} alt=\"Logo Cliente\" className=\"h-10 w-auto mr-3 object-contain\"/>\r\n                ) : (\r\n                    <svg className=\"w-10 h-10 text-blue-800 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\"></path></svg>\r\n                )}\r\n                <h1 className=\"text-2xl font-bold text-gray-800\">Portal Grupo Evelsa</h1>\r\n            </div>\r\n            {user && (\r\n                <div className=\"flex items-center\">\r\n                    <span className=\"text-gray-600 mr-4\">\r\n                        Hola, {userData ? userData.nombreCompleto : user.email}\r\n                    </span>\r\n                    <button\r\n                        onClick={() => signOut(auth)}\r\n                        className=\"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300\"\r\n                    >\r\n                        Cerrar Sesión\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    </header>\r\n);\r\n\r\n// --- Componentes de Gestión (Para Empleados) ---\r\n// ... (UserManagement, ServiceManagement, ProviderManagement sin cambios significativos)\r\n\r\nconst UserManagement = ({ onUserAdded }) => { /* ... código ... */ return <div className=\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\"><p>Formulario para crear usuarios aquí.</p></div>;};\r\nconst ServiceManagement = () => { /* ... código ... */ return <div className=\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\"><p>Gestión de Servicios aquí.</p></div>;};\r\nconst ProviderManagement = () => { /* ... código ... */ return <div className=\"bg-white p-6 rounded-xl shadow-lg border border-gray-200\"><p>Gestión de Proveedores aquí.</p></div>;};\r\n\r\n\r\nconst NewProjectForm = ({ onProjectAdded }) => { /* ... sin cambios significativos ... */  return <div className=\"bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-8\"><p>Formulario de creación de proyectos aquí.</p></div>;};\r\n\r\n\r\n// --- INICIA EL CÓDIGO NUEVO Y MEJORADO ---\r\n\r\nconst ProjectsTable = ({ projects, onUpdateProject }) => {\r\n    \r\n    const ManageDeliveryModal = ({ project, onClose, onFinalized }) => {\r\n        const [formData, setFormData] = useState({\r\n            fechaEntrega: new Date().toISOString().split('T')[0], // Hoy por defecto\r\n            notaEntrega: '',\r\n            urlHeyzine: project.urlHeyzine || ''\r\n        });\r\n        const [pdfFile, setPdfFile] = useState(null);\r\n        const [error, setError] = useState('');\r\n        const [loading, setLoading] = useState(false);\r\n        const [uploadProgress, setUploadProgress] = useState(0);\r\n\r\n        const handleChange = (e) => {\r\n            const { name, value } = e.target;\r\n            setFormData(prev => ({ ...prev, [name]: value }));\r\n        };\r\n\r\n        const handleFileChange = (e) => {\r\n            if (e.target.files[0]) {\r\n                setPdfFile(e.target.files[0]);\r\n            }\r\n        };\r\n\r\n        const handleFinalize = async () => {\r\n            if (!formData.fechaEntrega || !formData.notaEntrega) {\r\n                setError(\"La fecha y el número de nota de entrega son obligatorios.\");\r\n                return;\r\n            }\r\n            setLoading(true);\r\n            setError('');\r\n\r\n            let pdfUrl = project.urlPdf || '';\r\n            \r\n            try {\r\n                if (pdfFile) {\r\n                    const storageRef = ref(storage, `notas_entrega/${project.id}/${pdfFile.name}`);\r\n                    const uploadTask = uploadBytesResumable(storageRef, pdfFile);\r\n\r\n                    await new Promise((resolve, reject) => {\r\n                         uploadTask.on('state_changed',\r\n                            (snapshot) => setUploadProgress((snapshot.bytesTransferred / snapshot.totalBytes) * 100),\r\n                            (error) => { console.error(\"Error al subir archivo:\", error); reject(error); },\r\n                            async () => {\r\n                                pdfUrl = await getDownloadURL(uploadTask.snapshot.ref);\r\n                                resolve();\r\n                            }\r\n                        );\r\n                    });\r\n                }\r\n                \r\n                const projectRef = doc(db, \"proyectos\", project.id);\r\n                await updateDoc(projectRef, {\r\n                    estado: 'Terminado',\r\n                    fechaEntrega: Timestamp.fromDate(new Date(formData.fechaEntrega)),\r\n                    notaEntrega: formData.notaEntrega,\r\n                    urlHeyzine: formData.urlHeyzine,\r\n                    urlPdf: pdfUrl\r\n                });\r\n                \r\n                onFinalized();\r\n                onClose();\r\n\r\n            } catch(err) {\r\n                 setError(`Error al finalizar: ${err.message}`);\r\n                 setLoading(false);\r\n            }\r\n        };\r\n\r\n        return (\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4\">\r\n                <div className=\"bg-white p-6 rounded-lg shadow-xl w-full max-w-lg\">\r\n                    <h3 className=\"text-lg font-bold mb-4\">Gestionar Entrega: {project.npu}</h3>\r\n                    <div className=\"space-y-4\">\r\n                         <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700\">Fecha de Entrega</label>\r\n                            <input type=\"date\" name=\"fechaEntrega\" value={formData.fechaEntrega} onChange={handleChange} className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"/>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700\">Número de Nota de Entrega</label>\r\n                            <input type=\"text\" name=\"notaEntrega\" value={formData.notaEntrega} onChange={handleChange} className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"/>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700\">Enlace de Heyzine</label>\r\n                            <input type=\"text\" name=\"urlHeyzine\" value={formData.urlHeyzine} onChange={handleChange} placeholder=\"https://heyzine.com/...\" className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md\"/>\r\n                        </div>\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700\">PDF de la Nota de Entrega</label>\r\n                            <input type=\"file\" accept=\".pdf\" onChange={handleFileChange} className=\"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"/>\r\n                        </div>\r\n                        {loading && uploadProgress > 0 && <div className=\"w-full bg-gray-200 rounded-full h-2.5\"><div className=\"bg-blue-600 h-2.5 rounded-full\" style={{width: `${uploadProgress}%`}}></div></div>}\r\n                    </div>\r\n                    <Alert message={error} type=\"error\" onClose={() => setError('')} />\r\n                    <div className=\"mt-6 flex justify-end space-x-3\">\r\n                        <button onClick={onClose} disabled={loading} className=\"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded disabled:bg-gray-200\">Cancelar</button>\r\n                        <button onClick={handleFinalize} disabled={loading} className=\"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded disabled:bg-gray-400\">\r\n                            {loading ? 'Guardando...' : 'Guardar y Finalizar'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const [modalProject, setModalProject] = useState(null);\r\n\r\n    const formatDate = (timestamp) => {\r\n        if (!timestamp) return '---';\r\n        return new Date(timestamp.seconds * 1000).toLocaleDateString('es-MX');\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className=\"overflow-x-auto bg-white rounded-lg shadow\">\r\n                <table className=\"min-w-full divide-y divide-gray-200\">\r\n                    <thead className=\"bg-gray-50\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">NPU</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Cliente</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Servicio</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Fecha Apertura</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Estado</th>\r\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Acciones</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                        {projects.map(project => (\r\n                            <tr key={project.id}>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{project.npu}</td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{project.clienteNombre}</td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{project.servicioNombre}</td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{formatDate(project.fechaApertura)}</td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${project.estado === 'Activo' ? 'bg-orange-100 text-orange-800' : 'bg-green-100 text-green-800'}`}>\r\n                                        {project.estado}\r\n                                    </span>\r\n                                </td>\r\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                                    {project.estado === 'Activo' ? (\r\n                                        <button onClick={() => setModalProject(project)} className=\"text-indigo-600 hover:text-indigo-900\">Gestionar Entrega</button>\r\n                                    ) : (\r\n                                         <div className=\"flex items-center space-x-4\">\r\n                                            <a href={project.urlPdf} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-red-600 hover:text-red-900\">PDF</a>\r\n                                            <a href={project.urlHeyzine} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 hover:text-blue-900\">Flipbook</a>\r\n                                         </div>\r\n                                     )}\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            {modalProject && <ManageDeliveryModal project={modalProject} onClose={() => setModalProject(null)} onFinalized={onUpdateProject} />}\r\n        </>\r\n    );\r\n};\r\n\r\n// --- TERMINA EL CÓDIGO NUEVO ---\r\n\r\n\r\nconst ClientProjectCards = ({ projects }) => { /* ... sin cambios significativos ... */  return <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\"><p>Tarjetas de proyectos del cliente aquí.</p></div>;};\r\n\r\nconst Dashboard = ({ user, userData }) => {\r\n    const [projects, setProjects] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [view, setView] = useState('projects'); \r\n\r\n    const fetchProjects = () => {\r\n        setLoading(true);\r\n        let q;\r\n        if (userData.rol === 'empleado') {\r\n            q = query(collection(db, \"proyectos\"), orderBy(\"fechaApertura\", \"desc\"));\r\n        } else {\r\n            q = query(collection(db, \"proyectos\"), where(\"clienteId\", \"==\", user.uid), orderBy(\"fechaApertura\", \"desc\"));\r\n        }\r\n        \r\n        const unsubscribe = onSnapshot(q, (querySnapshot) => {\r\n            const projectsData = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n            setProjects(projectsData);\r\n            setLoading(false);\r\n        }, (error) => {\r\n            console.error(\"Error fetching projects: \", error);\r\n            if (error.code === 'failed-precondition') {\r\n                 console.error(\"Este error puede requerir un índice en Firestore. Ve a la URL que aparece en el mensaje de error en la consola para crearlo automáticamente.\");\r\n            }\r\n            setLoading(false);\r\n        });\r\n        \r\n        return () => unsubscribe();\r\n    };\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = fetchProjects();\r\n        return unsubscribe;\r\n    }, [user, userData]);\r\n\r\n    const EmployeeView = () => (\r\n         <>\r\n            <div className=\"mb-6 border-b border-gray-200\">\r\n                <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\r\n                    <button onClick={() => setView('projects')} className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${view === 'projects' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}>\r\n                        Proyectos\r\n                    </button>\r\n                     <button onClick={() => setView('users')} className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${view === 'users' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'}`}>\r\n                        Usuarios\r\n                    </button>\r\n                </nav>\r\n            </div>\r\n            {view === 'projects' && (\r\n                <>\r\n                    <NewProjectForm onProjectAdded={fetchProjects} />\r\n                    <h2 className=\"text-2xl font-bold text-gray-800 my-6\">Todos los Proyectos</h2>\r\n                    <ProjectsTable projects={projects} onUpdateProject={fetchProjects} />\r\n                </>\r\n            )}\r\n            {view === 'users' && <UserManagement onUserAdded={() => {}} />}\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <div className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\r\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">\r\n                {userData.rol === 'empleado' ? 'Panel de Administración' : `Proyectos de ${userData.nombreCompleto}`}\r\n            </h1>\r\n            {loading && <p>Cargando...</p>}\r\n            {!loading && (userData.rol === 'empleado' ? <EmployeeView /> : <ClientProjectCards projects={projects} />)}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst AuthPage = () => { /* ... sin cambios significativos ... */ return <div className=\"min-h-screen flex items-center justify-center bg-gray-100\"><p>Página de autenticación aquí.</p></div>; };\r\n\r\n\r\nexport default function App() {\r\n    const [user, setUser] = useState(null);\r\n    const [userData, setUserData] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\r\n            if (currentUser) {\r\n                const userDocRef = doc(db, \"usuarios\", currentUser.uid);\r\n                // Usamos getDoc aquí para una carga inicial más rápida\r\n                const userDoc = await getDoc(userDocRef);\r\n                if (userDoc.exists()) {\r\n                    setUserData(userDoc.data());\r\n                    setUser(currentUser);\r\n                } else {\r\n                    // Si el usuario existe en Auth pero no en Firestore, lo deslogueamos.\r\n                    console.error(\"Usuario no encontrado en la base de datos.\");\r\n                    signOut(auth);\r\n                }\r\n            } else {\r\n                setUser(null);\r\n                setUserData(null);\r\n            }\r\n            // Ocultamos la pantalla de carga después de procesar todo.\r\n            setLoading(false);\r\n        });\r\n\r\n        // Limpieza al desmontar el componente\r\n        return () => unsubscribe();\r\n    }, []);\r\n\r\n    if (loading) {\r\n        return <div className=\"min-h-screen flex items-center justify-center bg-gray-50 text-gray-700\">Cargando...</div>;\r\n    }\r\n    \r\n    return (\r\n        <div className=\"bg-gray-50 min-h-screen font-sans\">\r\n             <Header user={user} userData={userData}/>\r\n             <main>\r\n                {user && userData ? <Dashboard user={user} userData={userData} /> : <AuthPage />}\r\n             </main>\r\n        </div>\r\n    );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}